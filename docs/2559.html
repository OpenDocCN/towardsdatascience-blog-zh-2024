<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Evaluating Model Retraining Strategies</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Evaluating Model Retraining Strategies</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/evaluating-model-retraining-strategies-9c337d95409a?source=collection_archive---------2-----------------------#2024-10-20">https://towardsdatascience.com/evaluating-model-retraining-strategies-9c337d95409a?source=collection_archive---------2-----------------------#2024-10-20</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="62f1" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">How data drift and concept drift matter to choose the right retraining strategy?</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@reinhard.sellmair?source=post_page---byline--9c337d95409a--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Reinhard Sellmair" class="l ep by dd de cx" src="../Images/0aaf2ae9c27f551f9ef6921d110318b5.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*F8YN4sJb1MerkqyR4QzYnQ.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--9c337d95409a--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://medium.com/@reinhard.sellmair?source=post_page---byline--9c337d95409a--------------------------------" rel="noopener follow">Reinhard Sellmair</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--9c337d95409a--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">9 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Oct 20, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj la lb ab q ee lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lf k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lg an ao ap id lh li lj" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep lk cn"><div class="l ae"><div class="ab cb"><div class="ll lm ln lo lp lq ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj mk"><img src="../Images/b6d9de178844a026183cbd16af50612d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aZ3jKYdTtpAPROHFHXGgoA.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">(created with Image Creator in Bing)</figcaption></figure><h1 id="d401" class="nb nc fq bf nd ne nf gq ng nh ni gt nj nk nl nm nn no np nq nr ns nt nu nv nw bk">Introduction</h1><p id="1d6c" class="pw-post-body-paragraph nx ny fq nz b go oa ob oc gr od oe of og oh oi oj ok ol om on oo op oq or os fj bk">Many people in the field of MLOps have probably heard a story like this:</p><p id="6854" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">Company A embarked on an ambitious quest to harness the power of machine learning. It was a journey fraught with challenges, as the team struggled to pinpoint a topic that would not only leverage the prowess of machine learning but also deliver tangible business value. After many brainstorming sessions, they finally settled on a use case that promised to revolutionize their operations. With excitement, they contracted Company B, a reputed expert, to build and deploy a ML model. Following months of rigorous development and testing, the model passed all acceptance criteria, marking a significant milestone for Company A, who looked forward to future opportunities.</p><p id="84a6" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">However, as time passed, the model began producing unexpected results, rendering it ineffective for its intended use. Company A reached out to Company B for advice, only to learn that the changed circumstances required building a new model, necessitating an even higher investment as the original.</p><p id="ccd0" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">What went wrong? Was the model Company B created not as good as expected? Was Company A just unlucky that something unexpected happened?</p><p id="25e7" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">Probably the issue was that even the most rigorous testing of a model before deployment does not guarantee that this model will perform well for an unlimited amount of time. The two most important aspects that impact a model’s performance over time are data drift and concept drift.</p><p id="b3e7" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk"><strong class="nz fr">Data Drift</strong>: Also known as covariate shift, this occurs when the statistical properties of the input data change over time. If an ML model was trained on data from a specific demographic but the demographic characteristics of the input data change, the model’s performance can degrade. Imagine you taught a child multiplication tables until 10. It can quickly give you the correct answers for what is 3 * 7 or 4 * 9. However, one time you ask what is 4 * 13, and although the rules of multiplication did not change it may give you the wrong answer because it did not memorize the solution.</p><p id="dc79" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk"><strong class="nz fr">Concept Drift</strong>: This happens when the relationship between the input data and the target variable changes. This can lead to a degradation in model performance as the model’s predictions no longer align with the evolving data patterns. An example here could be spelling reforms. When you were a child, you may have learned to write “co-operate”, however now it is written as “cooperate”. Although you mean the same word, your output of writing that word has changed over time.</p><p id="9af0" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">In this article I investigate how different scenarios of data drift and concept drift impact a model’s performance over time. Furthermore, I show what retraining strategies can mitigate performance degradation.</p><p id="aec9" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">I focus on evaluating retraining strategies with respect to the model’s prediction performance. In practice more aspects like:</p><ul class=""><li id="d04e" class="nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os oy oz pa bk"><strong class="nz fr">Data Availability and Quality</strong>: Ensure that sufficient and high-quality data is available for retraining the model.</li><li id="09b3" class="nx ny fq nz b go pb ob oc gr pc oe of og pd oi oj ok pe om on oo pf oq or os oy oz pa bk"><strong class="nz fr">Computational Costs</strong>: Evaluate the computational resources required for retraining, including hardware and processing time.</li><li id="e734" class="nx ny fq nz b go pb ob oc gr pc oe of og pd oi oj ok pe om on oo pf oq or os oy oz pa bk"><strong class="nz fr">Business Impact</strong>: Consider the potential impact on business operations and outcomes when choosing a retraining strategy.</li><li id="a712" class="nx ny fq nz b go pb ob oc gr pc oe of og pd oi oj ok pe om on oo pf oq or os oy oz pa bk"><strong class="nz fr">Regulatory Compliance</strong>: Ensure that the retraining strategy complies with any relevant regulations and standards, e.g. anti-discrimination.</li></ul><p id="f7a5" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">need to be considered to identify a suitable retraining strategy.</p><h1 id="0c7b" class="nb nc fq bf nd ne nf gq ng nh ni gt nj nk nl nm nn no np nq nr ns nt nu nv nw bk">Data Synthetization</h1><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj mk"><img src="../Images/64b1a6bc63bc5cff19c9d904e241f5fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6kZD6xVBBPfqr5Agmv_wrg.jpeg"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">(created with Image Creator in Bing)</figcaption></figure><p id="d4eb" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">To highlight the differences between data drift and concept drift I synthesized datasets where I controlled to what extent these aspects appear.</p><p id="cd43" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">I generated datasets in 100 steps where I changed parameters incrementally to simulate the evolution of the dataset. Each step contains multiple data points and can be interpreted as the amount of data that was collected over an hour, a day or a week. After every step the model was re-evaluated and could be retrained.</p><p id="7994" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">To create the datasets, I first randomly sampled features from a normal distribution where mean µ and standard deviation σ depend on the step number s:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div class="mi mj pg"><img src="../Images/21accb943cab84be5919b10c73d07ec3.png" data-original-src="https://miro.medium.com/v2/resize:fit:458/format:webp/1*k0uiwR_9fyKACXze6vJzzg.png"/></div></figure><p id="349e" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">The data drift of feature xi depends on how much µi and σi are changing with respect to the step number s.</p><p id="9977" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">All features are aggregated as follows:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div class="mi mj ph"><img src="../Images/89b0e66c590f9604e2abcc299b295eed.png" data-original-src="https://miro.medium.com/v2/resize:fit:518/format:webp/1*BvAR6Dv6uuTZUjrreFIQGw.png"/></div></figure><p id="0625" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">Where ci are coefficients that describe the impact of feature xi on X. Concept drift can be controlled by changing these coefficients with respect to s. A random number ε which is not available for model training is added to consider that the features do not contain complete information to predict the target y.</p><p id="ae09" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">The target variable y is calculated by inputting X into a non-linear function. By doing this we create a more challenging task for the ML model since there is no linear relation between the features and the target. For the scenarios in this article, I chose a sine function.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div class="mi mj pi"><img src="../Images/1364afc8dbd6921c20ebc1c343ad6102.png" data-original-src="https://miro.medium.com/v2/resize:fit:344/format:webp/1*hGuTf28U4oPmHeT8ik6_aA.png"/></div></figure><h1 id="230f" class="nb nc fq bf nd ne nf gq ng nh ni gt nj nk nl nm nn no np nq nr ns nt nu nv nw bk">Scenario Analysis</h1><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj mk"><img src="../Images/7879fabd0027dada605891831f21d422.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sm-Jwwq4jKFu7X3TtOhTiQ.jpeg"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">(created with Image Creator in Bing)</figcaption></figure><p id="e02c" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">I created the following scenarios to analyze:</p><ul class=""><li id="41d8" class="nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os oy oz pa bk"><strong class="nz fr">Steady State:</strong> simulating no data or concept drift — parameters µ, σ, and c were independent of step s</li><li id="d1d2" class="nx ny fq nz b go pb ob oc gr pc oe of og pd oi oj ok pe om on oo pf oq or os oy oz pa bk"><strong class="nz fr">Distribution Drift: </strong>simulating data drift — parameters µ, σ were linear functions of s, parameters c is independent of s</li><li id="f80b" class="nx ny fq nz b go pb ob oc gr pc oe of og pd oi oj ok pe om on oo pf oq or os oy oz pa bk"><strong class="nz fr">Coefficient Drift: </strong>simulating concept drift: parameters µ, σ were independent of s, parameters c are a linear function of s</li><li id="8b85" class="nx ny fq nz b go pb ob oc gr pc oe of og pd oi oj ok pe om on oo pf oq or os oy oz pa bk"><strong class="nz fr">Black Swan: </strong>simulating an unexpected and sudden change — parameters µ, σ, and c were independent of step s except for one step when these parameters were changed</li></ul><p id="0118" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">The COVID-19 pandemic serves as a quintessential example of a Black Swan event. A Black Swan is characterized by its extreme rarity and unexpectedness. COVID-19 could not have been predicted to mitigate its effects beforehand. Many deployed ML models suddenly produced unexpected results and had to be retrained after the outbreak.</p><p id="5fd7" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">For each scenario I used the first 20 steps as training data of the initial model. For the remaining steps I evaluated three retraining strategies:</p><ul class=""><li id="6e67" class="nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os oy oz pa bk"><strong class="nz fr"><em class="pj">None</em>: </strong>No retraining — the model trained on the training data was used for all remaining steps.</li><li id="988d" class="nx ny fq nz b go pb ob oc gr pc oe of og pd oi oj ok pe om on oo pf oq or os oy oz pa bk"><strong class="nz fr"><em class="pj">All Data</em>: </strong>All previous data was used to train a new model, e.g. the model evaluated at step 30 was trained on the data from step 0 to 29.</li><li id="abff" class="nx ny fq nz b go pb ob oc gr pc oe of og pd oi oj ok pe om on oo pf oq or os oy oz pa bk"><strong class="nz fr"><em class="pj">Window</em>: </strong>A fixed window size was used to select the training data, e.g. for a window size of 10 the training data at step 30 contained step 20 to 29.</li></ul><p id="ae9b" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">I used a XG Boost regression model and mean squared error (MSE) as evaluation metric.</p><h2 id="f3fc" class="pk nc fq bf nd pl pm pn ng po pp pq nj og pr ps pt ok pu pv pw oo px py pz qa bk">Steady State</h2><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qb"><img src="../Images/30ca7f88807354199e0dd656fc593f86.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k-29LWjPFOhwW8E-S2Oc0w.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Prediction error of steady state scenario</figcaption></figure><p id="ea91" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">The diagram above shows the evaluation results of the steady state scenario. As the first 20 steps were used to train the models the evaluation error was much lower than at later steps. The performance of the <em class="pj">None</em> and <em class="pj">Window</em> retraining strategies remained at a similar level throughout the scenario. The <em class="pj">All Data</em> strategy slightly reduced the prediction error at higher step numbers.</p><p id="4d58" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">In this case <em class="pj">All Data</em><strong class="nz fr"> </strong>is the best strategy because it profits from an increasing amount of training data while the models of the other strategies were trained on a constant training data size.</p><h2 id="ecc7" class="pk nc fq bf nd pl pm pn ng po pp pq nj og pr ps pt ok pu pv pw oo px py pz qa bk">Distribution Drift (Data Drift)</h2><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qb"><img src="../Images/7078ada35dc9de7ba1f329f1249c5572.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ukS26Y0OT6my58Tot3IgCQ.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Prediction error of distribution drift scenario</figcaption></figure><p id="e227" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">When the input data distributions changed, we can clearly see that the prediction error continuously increased if the model was not retrained on the latest data. Retraining on all data or on a data window resulted in very similar performances. The reason for this is that although <em class="pj">All Data</em><strong class="nz fr"> </strong>was using more data, older data was not relevant for predicting the most recent data.</p><h2 id="1242" class="pk nc fq bf nd pl pm pn ng po pp pq nj og pr ps pt ok pu pv pw oo px py pz qa bk">Coefficient Drift (Concept Drift)</h2><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qb"><img src="../Images/cd1fa6455b041e6e0dbc79a0c63b1a67.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jNlWEp8aEHBfz5gPcDl_Vw.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Prediction error of coefficient drift scenario</figcaption></figure><p id="b82a" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">Changing coefficients means that the importance of features changes over time. In this case we can see that the <em class="pj">None</em> retraining strategy had drastic increase of the prediction error. Additionally, the results showed that retraining on all data also lead to a continuous increase of prediction error while the <em class="pj">Window</em> retraining strategy kept the prediction error on a constant level.</p><p id="96d8" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">The reason why the <em class="pj">All Data</em> strategy performance also decreased over time was that the training data contained more and more cases where similar inputs resulted in different outputs. Hence, it became more challenging for the model to identify clear patterns to derive decision rules. This was less of a problem for the <em class="pj">Window</em><strong class="nz fr"> </strong>strategy since older data was ignore which allowed the model to “forget” older patterns and focus on most recent cases.</p><h2 id="e32a" class="pk nc fq bf nd pl pm pn ng po pp pq nj og pr ps pt ok pu pv pw oo px py pz qa bk">Black Swan</h2><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qb"><img src="../Images/e662136c11e4449771ef27c39905d738.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8dox5qY8QsH37mCLpuJv4w.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Prediction error of black swan event scenario</figcaption></figure><p id="7de9" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">The black swan event occurred at step 39, the errors of all models suddenly increased at this point. However, after retraining a new model on the latest data, the errors of the <em class="pj">All Data</em> and <em class="pj">Window</em> strategy recovered to the previous level. Which is not the case with the <em class="pj">None</em> retraining strategy, here the error increased around 3-fold compared to before the black swan event and remained on that level until the end of the scenario.</p><p id="61dc" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">In contrast to the previous scenarios, the black swan event contained both: data drift and concept drift. It is remarkable that the <em class="pj">All Data</em> and <em class="pj">Window</em> strategy recovered in the same way after the black swan event while we found a significant difference between these strategies in the concept drift scenario. Probably the reason for this is that data drift occurred at the same time as concept drift. Hence, patterns that have been learned on older data were not relevant anymore after the black swan event because the input data has shifted.</p><p id="1c7b" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">An example for this could be that you are a translator and you get requests to translate a language that you haven’t translated before (data drift). At the same time there was a comprehensive spelling reform of this language (concept drift). While translators who translated this language for many years may be struggling with applying the reform it wouldn’t affect you because you even didn’t know the rules before the reform.</p><p id="7803" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">To reproduce this analysis or explore further you can check out my <a class="af qc" href="https://github.com/ReinhardSellmair/mlmm" rel="noopener ugc nofollow" target="_blank">git repository</a>.</p><h1 id="9229" class="nb nc fq bf nd ne nf gq ng nh ni gt nj nk nl nm nn no np nq nr ns nt nu nv nw bk">Conclusion</h1><p id="14dc" class="pw-post-body-paragraph nx ny fq nz b go oa ob oc gr od oe of og oh oi oj ok ol om on oo op oq or os fj bk">Identifying, quantifying, and mitigating the impact of data drift and concept drift is a challenging topic. In this article I analyzed simple scenarios to present basic characteristics of these concepts. More comprehensive analyses will undoubtedly provide deeper and more detailed conclusions on this topic.</p><p id="ea08" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">Here is what I learned from this project:</p><p id="397a" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">Mitigating concept drift is more challenging than data drift. While data drift could be handled by basic retraining strategies concept drift requires a more careful selection of training data. Ironically, cases where data drift and concept drift occur at the same time may be easier to handle than pure concept drift cases.</p><p id="879f" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">A comprehensive analysis of the training data would be the ideal starting point of finding an appropriate retraining strategy. Thereby, it is essential to partition the training data with respect to the time when it was recorded. To make the most realistic assessment of the model’s performance, the latest data should only be used as test data. To make an initial assessment regarding data drift and concept drift the remaining training data can be split into two equally sized sets with the older data in one set and the newer data in the other. Comparing feature distributions of these sets allows to assess data drift. Training one model on each set and comparing the change of feature importance would allow to make an initial assessment on concept drift.</p><p id="c3b6" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">No retraining turned out to be the worst option in all scenarios. Furthermore, in cases where model retraining is not taken into consideration it is also more likely that data to evaluate and/or retrain the model is not collected in an automated way. This means that model performance degradation may be unrecognized or only be noticed at a late stage. Once developers become aware that there is a potential issue with the model precious time would be lost until new data is collected that can be used to retrain the model.</p><p id="a21e" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk">Identifying the perfect retraining strategy at an early stage is very difficult and may be even impossible if there are unexpected changes in the serving data. Hence, I think a reasonable approach is to start with a retraining strategy that performed well on the partitioned training data. This strategy should be reviewed and updated the time when cases occurred where it did not address changes in the optimal way. Continuous model monitoring is essential to quickly notice and react when the model performance decreases.</p><p id="0791" class="pw-post-body-paragraph nx ny fq nz b go ot ob oc gr ou oe of og ov oi oj ok ow om on oo ox oq or os fj bk"><em class="pj">If not otherwise stated all images were created by the author.</em></p></div></div></div></div>    
</body>
</html>