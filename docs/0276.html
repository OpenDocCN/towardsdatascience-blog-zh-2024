<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Getting Started Predicting Time Series Data with Facebook Prophet</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Getting Started Predicting Time Series Data with Facebook Prophet</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/getting-started-predicting-time-series-data-with-facebook-prophet-c74ad3040525?source=collection_archive---------2-----------------------#2024-01-30">https://towardsdatascience.com/getting-started-predicting-time-series-data-with-facebook-prophet-c74ad3040525?source=collection_archive---------2-----------------------#2024-01-30</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="a83d" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">This article aims to take away the entry barriers to get started with time series analysis in a hands-on tutorial using Prophet</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@jonas_dieckmann?source=post_page---byline--c74ad3040525--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Jonas Dieckmann" class="l ep by dd de cx" src="../Images/b3345d7d4ba503b08bd4dc715390d650.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*mql_rVqbJfGV44cWo8IazA.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--c74ad3040525--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://medium.com/@jonas_dieckmann?source=post_page---byline--c74ad3040525--------------------------------" rel="noopener follow">Jonas Dieckmann</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--c74ad3040525--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">9 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Jan 30, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj lc ld ab q ee le lf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count la lb">3</span></p></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lg k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lh an ao ap id li lj lk" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep ll cn"><div class="l ae"><div class="ab cb"><div class="lm ln lo lp lq lr ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><p id="c1d1" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">When getting started with data science, time series analysis is a common thing people would love to try themselves! The general idea here is to learn from historical patterns over time to predict the future. Typical use cases could be weather predictions or sales forecasting. But what does all this have to do with this wise prophet below?!</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="no np ed nq bh nr"><div class="nf ng nh"><img src="../Images/6b84a482c13b16a83fedc78c40fa8e57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gHRE9pon-unvA-sq.jpg"/></div></div><figcaption class="nt nu nv nf ng nw nx bf b bg z dx">AI-generated image by leonardo.ai</figcaption></figure><p id="4d07" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">This article aims to take away the entry barriers to get started with time series analysis in a hands-on tutorial using one of the easiest tools called <a class="af ny" href="https://facebook.github.io/prophet/" rel="noopener ugc nofollow" target="_blank">Facebook Prophet</a> within <a class="af ny" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank">Google Colab</a> (both are free!). In case you want to get started immediately, feel free to skip the next two chapters where I will give a short background on time series principles and also Facebook Prophet itself. Have fun!</p><p id="ad24" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">This article is structured into three main sections:</p><p id="070b" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">#1 Brief introduction to Time Series Analysis principles<br/>#2 An Introduction to Facebook Prophet <br/>#3 Hands-on tutorial on how to use Prophet in Google Colab (for free)</p></div></div></div><div class="ab cb nz oa ob oc" role="separator"><span class="od by bm oe of og"/><span class="od by bm oe of og"/><span class="od by bm oe of"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="6987" class="oh oi fq bf oj ok ol gq om on oo gt op oq or os ot ou ov ow ox oy oz pa pb pc bk">#1 General Principles of Time Series Analysis</h1><p id="ca28" class="pw-post-body-paragraph mj mk fq ml b go pd mn mo gr pe mq mr ms pf mu mv mw pg my mz na ph nc nd ne fj bk">Imagine you are a store manager for consumer products and you want to predict the upcoming product demand to better manage the supply. A reasonable machine learning approach for this scenario is to run some time series analysis which involves understanding, modeling, and making predictions based on sequential data points. [1]</p><p id="a241" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">The below graphic illustrates an artificial development of historic product demand (dark-blue line) over time, which can be used to analyze a time series pattern. Our ultimate goal would be to predict (red-dotted line) the actual future demand (light-blue line) as precise as possible:</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="no np ed nq bh nr"><div class="nf ng pi"><img src="../Images/76be98eabce3d974413bec2d78f08e89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*viwKD0fddQEv5g0Y5pcUxg.png"/></div></div><figcaption class="nt nu nv nf ng nw nx bf b bg z dx">Example of a plotted time series. Image by author</figcaption></figure><p id="1e4d" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">A time series is typically decomposed into three main components:</p><ol class=""><li id="7e80" class="mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne pj pk pl bk"><strong class="ml fr">Trend</strong>: the long-term movement or general direction in the data.</li><li id="b2cf" class="mj mk fq ml b go pm mn mo gr pn mq mr ms po mu mv mw pp my mz na pq nc nd ne pj pk pl bk"><strong class="ml fr">Seasonality</strong>: fluctuations or patterns that repeat at regular intervals</li><li id="8a7e" class="mj mk fq ml b go pm mn mo gr pn mq mr ms po mu mv mw pp my mz na pq nc nd ne pj pk pl bk"><strong class="ml fr">Residual/error</strong>: remainder or leftover variation in the data</li></ol><p id="4cf0" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">The decomposition of a time series into these three components, often referred to as additive or multiplicative decomposition, allows analysts to better understand the underlying structure and patterns. This understanding is essential for selecting appropriate forecasting models and making accurate predictions based on historical data. [2]</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="no np ed nq bh nr"><div class="nf ng pr"><img src="../Images/7014027115a20cfee7d61ec8779c0dd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*O_TTrIydOCuPt3OcnVb9gg.png"/></div></div><figcaption class="nt nu nv nf ng nw nx bf b bg z dx">Example of a decomposed time series into trend + seasonality + error. Image by author</figcaption></figure></div></div></div><div class="ab cb nz oa ob oc" role="separator"><span class="od by bm oe of og"/><span class="od by bm oe of og"/><span class="od by bm oe of"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="db8f" class="oh oi fq bf oj ok ol gq om on oo gt op oq or os ot ou ov ow ox oy oz pa pb pc bk">#2 What is Facebook Prophet?</h1><p id="1f7a" class="pw-post-body-paragraph mj mk fq ml b go pd mn mo gr pe mq mr ms pf mu mv mw pg my mz na ph nc nd ne fj bk">Prophet is an open-source tool released by Facebook's Data Science team that produces time series forecasting data based on an additive model where a non-linear trend fits with seasonality and holiday effects. The design principles allow parameter adjustments without much knowledge of the underlying model which makes the method applicable to teams with less statistical knowledge. [3]</p><p id="2b79" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Prophet is particularly well-suited for business forecasting applications, and it has gained popularity due to its ease of use and effectiveness in handling a wide range of time series data. As with every tool, keep in mind that while Prophet is powerful, the choice of forecasting method depends on the specific characteristics of the data and the goals of the analysis. In general, it is not granted that Prophet performs better than other models. However, Prophet comes with some useful features e.g., a reflection of seasonality change pre- and post-COVID or treating lockdowns as one-off holidays.</p><p id="1298" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">For a more in-depth introduction by Meta (Facebook) itself, look at the video below<a class="af ny" href="https://www.youtube.com/watch?v=eJrbKU09h-0&amp;ab_channel=MetaOpenSource" rel="noopener ugc nofollow" target="_blank"> on YouTube</a>.</p><figure class="ni nj nk nl nm nn"><div class="ps io l ed"><div class="pt pu l"/></div></figure><p id="4a97" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">In the following tutorial, we will implement and use Prophet with Python. However, you are more than happy to run your analysis using R as well!</p></div></div></div><div class="ab cb nz oa ob oc" role="separator"><span class="od by bm oe of og"/><span class="od by bm oe of og"/><span class="od by bm oe of"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="8b9f" class="oh oi fq bf oj ok ol gq om on oo gt op oq or os ot ou ov ow ox oy oz pa pb pc bk">#3 Hands-on tutorial on how to use Prophet</h1><p id="ce33" class="pw-post-body-paragraph mj mk fq ml b go pd mn mo gr pe mq mr ms pf mu mv mw pg my mz na ph nc nd ne fj bk">In case you have limited experience with or no access to your coding environment, I recommend making use of <a class="af ny" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank">Google Colaboratory (“Colab”)</a> which is somewhat like “<em class="pv">a</em> <em class="pv">free Jupyter notebook environment that requires no setup and runs entirely in the cloud</em>.” While this tutorial claims more about the simplicity and advantages of Colab, there are drawbacks as reduced computing power compared to proper cloud environments. However, I believe Colab might not be a bad service to take the first steps with Prophet.</p><p id="dadd" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">To set up a basic environment for Time Series Analysis within Colab you can follow these two steps:</p><ol class=""><li id="f790" class="mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne pj pk pl bk">Open <a class="af ny" href="https://colab.research.google.com/" rel="noopener ugc nofollow" target="_blank">https://colab.research.google.com/</a> and register for a free account</li><li id="b1c5" class="mj mk fq ml b go pm mn mo gr pn mq mr ms po mu mv mw pp my mz na pq nc nd ne pj pk pl bk">Create a new <em class="pv">notebook </em>within Colab</li><li id="aa6e" class="mj mk fq ml b go pm mn mo gr pn mq mr ms po mu mv mw pp my mz na pq nc nd ne pj pk pl bk">Install &amp; use the <em class="pv">prophet </em>package:</li></ol><pre class="ni nj nk nl nm pw px py bp pz bb bk"><span id="6f7d" class="qa oi fq px b bg qb qc l qd qe">pip install prophet</span></pre><pre class="qf pw px py bp pz bb bk"><span id="6fcf" class="qa oi fq px b bg qb qc l qd qe">from prophet import Prophet</span></pre><h2 id="36bc" class="qg oi fq bf oj qh qi qj om qk ql qm op ms qn qo qp mw qq qr qs na qt qu qv qw bk">Loading and preparing Data</h2><p id="5542" class="pw-post-body-paragraph mj mk fq ml b go pd mn mo gr pe mq mr ms pf mu mv mw pg my mz na ph nc nd ne fj bk">I uploaded a small dummy dataset representing the monthly amount of passengers for a local bus company (2012–2023). You can find the data <a class="af ny" href="https://raw.githubusercontent.com/jonasdieckmann/prophet_tutorial/main/passengers.csv" rel="noopener ugc nofollow" target="_blank">here on GitHub</a>.</p><p id="c3d6" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">As the first step, we will load the data using pandas and create two separate datasets: a training subset with the years 2012 to 2022 as well as a test subset with the year 2023. We will train our time series model with the first subset and aim to predict the passenger amount for 2023. With the second subset, we will be able to validate the accuracy later.</p><pre class="ni nj nk nl nm pw px py bp pz bb bk"><span id="c203" class="qa oi fq px b bg qb qc l qd qe">import pandas as pd<br/><br/>df_data = pd.read_csv("https://raw.githubusercontent.com/jonasdieckmann/prophet_tutorial/main/passengers.csv")<br/><br/>df_data_train = df_data[df_data["Month"] &lt; "2023-01"]<br/>df_data_test = df_data[df_data["Month"] &gt;= "2023-01"]<br/><br/>display(df_data_train)</span></pre><p id="91a9" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">The output for the display command can be seen below. The dataset contains two columns: the indication of the year-month combination as well as a numeric column with the passenger amount in that month. Per default, Prophet is designed to work with daily (or even hourly) data, but we will make sure that the monthly pattern can be used as well.</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div class="nf ng qx"><img src="../Images/083ecb9d59735390a75f1cdfde35f4d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:418/format:webp/1*9G45IjOk8vx86oPZV-CalA.png"/></div><figcaption class="nt nu nv nf ng nw nx bf b bg z dx">Passenger dataset. Image by autor</figcaption></figure><h2 id="c499" class="qg oi fq bf oj qh qi qj om qk ql qm op ms qn qo qp mw qq qr qs na qt qu qv qw bk">Decomposing training data</h2><p id="3301" class="pw-post-body-paragraph mj mk fq ml b go pd mn mo gr pe mq mr ms pf mu mv mw pg my mz na ph nc nd ne fj bk">To get a better understanding of the time series components within our dummy data, we will run a quick decomposing. For that, we import the method from <em class="pv">statsmodels </em>library and run the decomposing on our dataset. We decided on an additive model and indicated, that one period contains 12 elements (months) in our data. A daily dataset would be period=365.</p><pre class="ni nj nk nl nm pw px py bp pz bb bk"><span id="3aba" class="qa oi fq px b bg qb qc l qd qe">from statsmodels.tsa.seasonal import seasonal_decompose<br/><br/>decompose = seasonal_decompose(df_data_train.Passengers, model='additive', extrapolate_trend='freq', period=12)<br/><br/>decompose.plot().show()</span></pre><p id="fa02" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">This short piece of code will give us a visual impression of time series itself, but especially about the trend, the seasonality, and the residuals over time:</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div class="nf ng qy"><img src="../Images/52c693392ede2122ae4d49aeb2225592.png" data-original-src="https://miro.medium.com/v2/resize:fit:1260/format:webp/1*YiO-bCXIuFctJWuy4ALBCg.png"/></div><figcaption class="nt nu nv nf ng nw nx bf b bg z dx">Decomposed elements for the passenger dummy data. Image by author</figcaption></figure><p id="8c7f" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">We can now clearly see both, a significantly increasing trend over the past 10 years as well as a recognizable seasonality pattern every year. Following those indications, we would now expect the model to predict some further increasing amount of passengers, following the seasonality peaks in the summer of the future year. But let’s try it out — time to apply some machine learning!</p><h2 id="895a" class="qg oi fq bf oj qh qi qj om qk ql qm op ms qn qo qp mw qq qr qs na qt qu qv qw bk">Model fitting with Facebook Prophet</h2><p id="34d0" class="pw-post-body-paragraph mj mk fq ml b go pd mn mo gr pe mq mr ms pf mu mv mw pg my mz na ph nc nd ne fj bk">To fit models in Prophet, it is important to have at least a ‘ds’ (datestamp) and ‘y’ (value to be forecasted) column. We should make sure that our columns are renamed the reflect the same.</p><pre class="ni nj nk nl nm pw px py bp pz bb bk"><span id="d207" class="qa oi fq px b bg qb qc l qd qe">df_train_prophet = df_data_train<br/><br/># date variable needs to be named "ds" for prophet<br/>df_train_prophet = df_train_prophet.rename(columns={"Month": "ds"})<br/><br/># target variable needs to be named "y" for prophet<br/>df_train_prophet = df_train_prophet.rename(columns={"Passengers": "y"})</span></pre><p id="d756" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Now the magic can begin. The process to fit the model is fairly straightforward. However, please have a look at the <a class="af ny" href="https://facebook.github.io/prophet/docs/handling_shocks.html" rel="noopener ugc nofollow" target="_blank">documentation </a>to get an idea of the large amount of options and parameters we could adjust in this step. To keep things simple, we will fit a simple model without any further adjustments for now — but please keep in mind that real-world data is never perfect: you will definitely need parameter tuning in the future.</p><pre class="ni nj nk nl nm pw px py bp pz bb bk"><span id="d2b5" class="qa oi fq px b bg qb qc l qd qe">model_prophet  = Prophet()<br/>model_prophet.fit(df_train_prophet)</span></pre><p id="d475" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">That’s all we have to do to fit the model. Let’s make some predictions!</p><h2 id="491f" class="qg oi fq bf oj qh qi qj om qk ql qm op ms qn qo qp mw qq qr qs na qt qu qv qw bk">Making predictions</h2><p id="833e" class="pw-post-body-paragraph mj mk fq ml b go pd mn mo gr pe mq mr ms pf mu mv mw pg my mz na ph nc nd ne fj bk">We have to make predictions on a table that has a ‘ds’ column with the dates you want predictions for. To set up this table, use the <em class="pv">make_future_dataframe</em> method, and it will automatically include historical dates. This way, you can see how well the model fits the past data and predicts the future. Since we handle monthly data, we will indicate the frequency with “freq=12" and ask for a future horizon of 12 months (“periods=12”).</p><pre class="ni nj nk nl nm pw px py bp pz bb bk"><span id="1a1a" class="qa oi fq px b bg qb qc l qd qe">df_future = model_prophet.make_future_dataframe(periods=12, freq='MS')<br/>display(df_future)</span></pre><p id="df2d" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">This new dataset then contains both, the training period as well as the additional 12 months we want to predict:</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div class="nf ng qz"><img src="../Images/67f5957194177eec969937a413b16b0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:306/format:webp/1*OWeD3a-4nANeemRsFXWSTg.png"/></div><figcaption class="nt nu nv nf ng nw nx bf b bg z dx">Future dataset. Image by author</figcaption></figure><p id="62e6" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">To make predictions, we simply call the <em class="pv">predict </em>method from Prophet and provide the future dataset. The prediction output will contain a large dataset with many different columns, but we will focus only on the predicted value <em class="pv">yhat </em>as well as the uncertainty intervals <em class="pv">yhat_lower </em>and <em class="pv">yhat_upper</em>.</p><pre class="ni nj nk nl nm pw px py bp pz bb bk"><span id="1898" class="qa oi fq px b bg qb qc l qd qe">forecast_prophet = model_prophet.predict(df_future)<br/>forecast_prophet[['ds', 'yhat', 'yhat_lower', 'yhat_upper']].round().tail()</span></pre><p id="028b" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">The table below gives us some idea about how the output is generated and stored. For August 2023, the model predicts a passenger amount of 532 people. The uncertainty interval (which is set by default to 80%) tells us in simple terms that we can expect most likely a passenger amount between 508 and 556 people in that month.</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div class="nf ng ra"><img src="../Images/2db589424d17336f514f1af97cb1c9ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*2h6AfVHA5-DqM91sk0U5mA.png"/></div><figcaption class="nt nu nv nf ng nw nx bf b bg z dx">Prediction subset. Image by author</figcaption></figure><p id="b2d2" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Finally, we want to visualize the output to better understand the predictions and the intervals.</p><h2 id="5679" class="qg oi fq bf oj qh qi qj om qk ql qm op ms qn qo qp mw qq qr qs na qt qu qv qw bk">Visualizing results</h2><p id="c401" class="pw-post-body-paragraph mj mk fq ml b go pd mn mo gr pe mq mr ms pf mu mv mw pg my mz na ph nc nd ne fj bk">To plot the results, we can make use of Prophet’s built-in plotting tools. With the plot method, we can display the original time series data alongside the forecasted values.</p><pre class="ni nj nk nl nm pw px py bp pz bb bk"><span id="9666" class="qa oi fq px b bg qb qc l qd qe">import matplotlib.pyplot as plt<br/><br/># plot the time series <br/>forecast_plot = model_prophet.plot(forecast_prophet)<br/><br/># add a vertical line at the end of the training period<br/>axes = forecast_plot.gca()<br/>last_training_date = forecast_prophet['ds'].iloc[-12]<br/>axes.axvline(x=last_training_date, color='red', linestyle='--', label='Training End')<br/><br/># plot true test data for the period after the red line<br/>df_data_test['Month'] = pd.to_datetime(df_data_test['Month'])<br/>plt.plot(df_data_test['Month'], df_data_test['Passengers'],'ro', markersize=3, label='True Test Data')<br/><br/># show the legend to distinguish between the lines<br/>plt.legend()</span></pre><p id="df6b" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Besides the general time series plot, we also added a dotted line to indicate the end of the training period and hence the start of the prediction period. Further, we made use of the true test dataset that we had prepared in the beginning.</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="no np ed nq bh nr"><div class="nf ng rb"><img src="../Images/4f9654f9a8bee5bd9b32e54ca2a7f1df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bWBuoSz6mZc_zbGqLQTHGg.png"/></div></div><figcaption class="nt nu nv nf ng nw nx bf b bg z dx">Plotted results for the time series analysis incl. true test data and the prediction. Image by author</figcaption></figure><p id="5b4b" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">It can be seen that our model isn’t too bad. Most of the true passenger values are actually within the predicted uncertainty intervals. However, the summer months seem to be too pessimistic still, which is a pattern we can see in previous years already. This is a good moment to start exploring the parameters and features we could use with Prophet.</p><p id="281e" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">In our example, the seasonality is not a constant additive factor but it grows with the trend over time. Hence, we might consider changing the <em class="pv">seasonality_mode </em>from “additive” to “multiplicative” during the model fit. [4]</p><p id="8b62" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Our tutorial will conclude here to give some time to explore the large number of possibilities that Prophet offers to us. To review the full code together, I consolidated the snippets in this <a class="af ny" href="https://raw.githubusercontent.com/jonasdieckmann/prophet_tutorial/main/prophet_tutorial.py" rel="noopener ugc nofollow" target="_blank">Python file</a>. Additionally, you could upload<a class="af ny" href="https://raw.githubusercontent.com/jonasdieckmann/prophet_tutorial/main/Prophet_Tutorial.ipynb" rel="noopener ugc nofollow" target="_blank"> this notebook</a> directly to Colab and run it yourself. Let me know how it worked out for you!</p></div></div></div><div class="ab cb nz oa ob oc" role="separator"><span class="od by bm oe of og"/><span class="od by bm oe of og"/><span class="od by bm oe of"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="dfd8" class="oh oi fq bf oj ok ol gq om on oo gt op oq or os ot ou ov ow ox oy oz pa pb pc bk">Conclusion</h1><p id="51df" class="pw-post-body-paragraph mj mk fq ml b go pd mn mo gr pe mq mr ms pf mu mv mw pg my mz na ph nc nd ne fj bk">Prophet is a powerful tool for predicting future values in time series data, especially when your data has repeating patterns like monthly or yearly cycles. It’s user-friendly and can quickly provide accurate predictions for your specific data. However, it’s essential to be aware of its limitations. If your data doesn’t have a clear pattern or if there are significant changes that the model hasn’t seen before, Prophet may not perform optimally. Understanding these limitations is crucial for using the tool wisely.</p><p id="d905" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">The good news is that experimenting with Prophet on your datasets is highly recommended! Every dataset is unique, and tweaking settings and trying different approaches can help you discover what works best for your specific situation. So, dive in, explore, and see how Prophet can enhance your time series forecasting.</p></div></div></div><div class="ab cb nz oa ob oc" role="separator"><span class="od by bm oe of og"/><span class="od by bm oe of og"/><span class="od by bm oe of"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div class="ni nj nk nl nm rc"><a href="https://medium.com/@jonas_dieckmann?source=post_page-----c74ad3040525--------------------------------" rel="noopener follow" target="_blank"><div class="rd ab ig"><div class="re ab co cb rf rg"><h2 class="bf fr hw z io rh iq ir ri it iv fp bk">Jonas Dieckmann - Medium</h2><div class="rj l"><h3 class="bf b hw z io rh iq ir ri it iv dx">Read writing from Jonas Dieckmann on Medium. analytics manager &amp; product owner @ philips | passionate and writing about…</h3></div><div class="rk l"><p class="bf b dy z io rh iq ir ri it iv dx">medium.com</p></div></div><div class="rl l"><div class="rm l rn ro rp rl rq lr rc"/></div></div></a></div><p id="18dd" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">I hope you find it useful. Let me know your thoughts! And feel free to connect on LinkedIn <a class="af ny" href="https://www.linkedin.com/in/jonas-dieckmann/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/jonas-dieckmann/</a> and/or to follow me here on medium.</p></div></div></div><div class="ab cb nz oa ob oc" role="separator"><span class="od by bm oe of og"/><span class="od by bm oe of og"/><span class="od by bm oe of"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h2 id="ea06" class="qg oi fq bf oj qh qi qj om qk ql qm op ms qn qo qp mw qq qr qs na qt qu qv qw bk">See also some of my other articles:</h2><div class="rr rs rt ru rv rc"><a href="https://pub.towardsai.net/how-to-use-chatgpt-api-for-direct-interaction-from-colab-or-databricks-39969a0ead5f?source=post_page-----c74ad3040525--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="rd ab ig"><div class="re ab co cb rf rg"><h2 class="bf fr hw z io rh iq ir ri it iv fp bk">How To Use ChatGPT API for Direct Interaction From Colab or Databricks</h2><div class="rj l"><h3 class="bf b hw z io rh iq ir ri it iv dx">Have you wondered how you can use OpenAI’s API to interact directly with GPT algorithms? It’s easy, free, and also more…</h3></div><div class="rk l"><p class="bf b dy z io rh iq ir ri it iv dx">pub.towardsai.net</p></div></div><div class="rl l"><div class="rw l rn ro rp rl rq lr rc"/></div></div></a></div><div class="rr rs rt ru rv rc"><a rel="noopener follow" target="_blank" href="/how-to-set-started-with-tensorflow-using-keras-api-and-google-colab-5421e5e4ef56?source=post_page-----c74ad3040525--------------------------------"><div class="rd ab ig"><div class="re ab co cb rf rg"><h2 class="bf fr hw z io rh iq ir ri it iv fp bk">How to get started with TensorFlow using Keras API and Google Colab</h2><div class="rj l"><h3 class="bf b hw z io rh iq ir ri it iv dx">Step-by-step tutorial to analyze human activity with neuronal networks</h3></div><div class="rk l"><p class="bf b dy z io rh iq ir ri it iv dx">towardsdatascience.com</p></div></div><div class="rl l"><div class="rx l rn ro rp rl rq lr rc"/></div></div></a></div></div></div></div><div class="ab cb nz oa ob oc" role="separator"><span class="od by bm oe of og"/><span class="od by bm oe of og"/><span class="od by bm oe of"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h2 id="a986" class="qg oi fq bf oj qh qi qj om qk ql qm op ms qn qo qp mw qq qr qs na qt qu qv qw bk">References</h2><p id="8491" class="pw-post-body-paragraph mj mk fq ml b go pd mn mo gr pe mq mr ms pf mu mv mw pg my mz na ph nc nd ne fj bk">[1] <strong class="ml fr">Shumway, Robert H.; Stoffer, David S. (2017)</strong>: Time Series Analysis and Its Applications. Cham: Springer International Publishing.</p><p id="8515" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">[2] <strong class="ml fr">Brownlee, Jason (2017)</strong>: Introduction to Time Series Forecasting With Python</p><p id="17b8" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">[3] <strong class="ml fr">Rafferty, Greg (2021)</strong>: Forecasting Time Series Data with Facebook Prophet</p><p id="7143" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">[4] <a class="af ny" href="https://facebook.github.io/prophet/docs/quick_start.html" rel="noopener ugc nofollow" target="_blank">https://facebook.github.io/prophet/docs/quick_start.html</a></p></div></div></div></div>    
</body>
</html>