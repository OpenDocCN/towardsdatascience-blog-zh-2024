<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>The (lesser known) rising application of LLMs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>The (lesser known) rising application of LLMs</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/the-lesser-known-rising-application-of-llms-775834116477?source=collection_archive---------3-----------------------#2024-05-13">https://towardsdatascience.com/the-lesser-known-rising-application-of-llms-775834116477?source=collection_archive---------3-----------------------#2024-05-13</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="gr gs gt gu gv ab"><div><div class="ab gw"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@vianney.mixtur_39698?source=post_page---byline--775834116477--------------------------------" rel="noopener follow"><div class="l gx gy by gz ha"><div class="l ed"><img alt="Vianney Mixtur" class="l ep by dd de cx" src="../Images/a97e69c63123e450910f6887b7c0813d.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*06l1WHymNX7PaO6Bf8DQjQ.jpeg"/><div class="hb by l dd de em n hc eo"/></div></div></a></div></div><div class="hd ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--775834116477--------------------------------" rel="noopener follow"><div class="l he hf by gz hg"><div class="l ed"><img alt="Towards Data Science" class="l ep by br hh cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hb by l br hh em n hc eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hi ab q"><div class="ab q hj"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hk hl bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hm" data-testid="authorName" href="https://medium.com/@vianney.mixtur_39698?source=post_page---byline--775834116477--------------------------------" rel="noopener follow">Vianney Mixtur</a></p></div></div></div><span class="hn ho" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hk hl dx"><button class="hp hq ah ai aj ak al am an ao ap aq ar hr hs ht" disabled="">Follow</button></p></div></div></span></div></div><div class="l hu"><span class="bf b bg z dx"><div class="ab cn hv hw hx"><div class="hy hz ab"><div class="bf b bg z dx ab ia"><span class="ib l hu">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hm ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--775834116477--------------------------------" rel="noopener follow"><p class="bf b bg z ic id ie if ig ih ii ij bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hn ho" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">8 min read</span><div class="ik il l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">May 13, 2024</span></div></span></div></span></div></div></div><div class="ab cp im in io ip iq ir is it iu iv iw ix iy iz ja jb"><div class="h k w ea eb q"><div class="jr l"><div class="ab q js jt"><div class="pw-multi-vote-icon ed ib ju jv jw"><div class=""><div class="jx jy jz ka kb kc kd am ke kf kg jw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kh ki kj kk kl km kn"><p class="bf b dy z dx"><span class="jy">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao jx kq kr ab q ee ks kt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="kp"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count ko kp">5</span></p></button></div></div></div><div class="ab q jc jd je jf jg jh ji jj jk jl jm jn jo jp jq"><div class="ku k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al kv an ao ap hr kw kx ky" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep kz cn"><div class="l ae"><div class="ab cb"><div class="la lb lc ld le lf ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al kv an ao ap hr lg lh kt li lj lk ll lm s ln lo lp lq lr ls lt u lu lv lw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al kv an ao ap hr lg lh kt li lj lk ll lm s ln lo lp lq lr ls lt u lu lv lw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al kv an ao ap hr lg lh kt li lj lk ll lm s ln lo lp lq lr ls lt u lu lv lw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><h1 id="56fa" class="lx ly fq bf lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bk">Overview</h1><p id="f449" class="pw-post-body-paragraph mv mw fq mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk"><strong class="mx fr">Large Language Models</strong> (LLMs) are often described as <strong class="mx fr">Generative Artificial Intelligence</strong> (GenAI) as they indeed have the ability to generate text. The first popular application of LLMs were chatbots with ChatGPT leading the way. Then we extended their horizon to other tasks such as <a class="af nt" href="https://vianmixt.notion.site/Practical-Semantic-Search-with-MongoDB-and-OpenAI-451692801b41465fae1bea5f70238279" rel="noopener ugc nofollow" target="_blank"><strong class="mx fr">semantic search</strong></a> and <strong class="mx fr">retrieval augmented generation</strong>(RAG). Today, I want to talk about a rising application for LLM which is <strong class="mx fr">structuring unstructed data</strong> for which I am going to show you an example by structuring raw texts into JSON data.</p><p id="326f" class="pw-post-body-paragraph mv mw fq mx b my nu na nb nc nv ne nf ng nw ni nj nk nx nm nn no ny nq nr ns fj bk">Using LLMs for <strong class="mx fr">data structuration and extraction</strong> is a very promising application with a lot of potential. Here’s why:</p><ul class=""><li id="7627" class="mv mw fq mx b my nu na nb nc nv ne nf ng nw ni nj nk nx nm nn no ny nq nr ns nz oa ob bk"><strong class="mx fr">Improved accuracy :</strong> LLMs understand the nuances of human language. This allows them to identify key information within messy, unstructured text with greater accuracy than traditional rule-based systems</li><li id="06da" class="mv mw fq mx b my oc na nb nc od ne nf ng oe ni nj nk of nm nn no og nq nr ns nz oa ob bk"><strong class="mx fr">Automation potential</strong> : Extracting information from unstructured data can be a time-consuming and laborious task. LLMs can automate this process, freeing up human resources for other tasks and allowing for faster analysis of larger datasets.</li><li id="d0ea" class="mv mw fq mx b my oc na nb nc od ne nf ng oe ni nj nk of nm nn no og nq nr ns nz oa ob bk"><strong class="mx fr">Adaptability and learning capabilities</strong>: LLMs, on the other hand, can be continuously fine-tuned and adapted to handle new data sources and information types. As they are exposed to more unstructured data, they can learn and improve their ability to identify patterns and extract relevant information.</li><li id="5f63" class="mv mw fq mx b my oc na nb nc od ne nf ng oe ni nj nk of nm nn no og nq nr ns nz oa ob bk"><strong class="mx fr">Business outcome :</strong> A vast amount of valuable information resides within unstructured textual data sources like emails, customer reviews, social media conversations, and internal documents. However, this data is often difficult to analyze. LLMs can unlock this hidden potential by transforming unstructured data into a structured format. This allows businesses to leverage powerful analytics tools to identify trends, and gain insights. Essentially, by structuring unstructured data with LLMs, businesses can transform a liability (unusable data) into an asset (valuable insights) that drives better decision-making and improves overall business outcomes.</li></ul></div></div></div><div class="ab cb oh oi oj ok" role="separator"><span class="ol by bm om on oo"/><span class="ol by bm om on oo"/><span class="ol by bm om on"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="7a4b" class="lx ly fq bf lz ma op mc md me oq mg mh mi or mk ml mm os mo mp mq ot ms mt mu bk">An example</h1><p id="0de9" class="pw-post-body-paragraph mv mw fq mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">Recently, I was searching for an open-source recipes dataset for a personal project but I could not find any except for <a class="af nt" href="https://github.com/ronaldlong46/public-domain-recipes" rel="noopener ugc nofollow" target="_blank">this github repository</a> containing the recipes displayed on <a class="af nt" href="https://publicdomainrecipes.com/" rel="noopener ugc nofollow" target="_blank">publicdomainrecipes.com</a>.</p><figure class="ox oy oz pa pb pc ou ov paragraph-image"><div role="button" tabindex="0" class="pd pe ed pf bh pg"><div class="ou ov ow"><img src="../Images/04ad1e467b2d1359d7502b35c19f079e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nP7oGyWBMxZ0xkvO"/></div></div><figcaption class="pi pj pk ou ov pl pm bf b bg z dx">Photo by <a class="af nt" href="https://unsplash.com/@ugmonk?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Jeff Sheldon</a> on <a class="af nt" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="f214" class="pw-post-body-paragraph mv mw fq mx b my nu na nb nc nv ne nf ng nw ni nj nk nx nm nn no ny nq nr ns fj bk">Unfortunately, I needed a dataset that was more exploitable, i.e something closer to <strong class="mx fr">tabular data</strong> or to a <strong class="mx fr">NoSQL document</strong>. That’s how I thought about finding a way to transform the raw data into something more suitable to my needs, without spending hours, days and weeks doing it manually.</p><p id="90b7" class="pw-post-body-paragraph mv mw fq mx b my nu na nb nc nv ne nf ng nw ni nj nk nx nm nn no ny nq nr ns fj bk">Let me show you how I used the power of Large Language Models to automate the process of converting the raw text into structured documents.</p><h2 id="455e" class="pn ly fq bf lz po pp pq md pr ps pt mh ng pu pv pw nk px py pz no qa qb qc qd bk">Dataset</h2><p id="3e49" class="pw-post-body-paragraph mv mw fq mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">The original dataset is a collection of markdown files. Each file representing a recipe.</p><figure class="ox oy oz pa pb pc"><div class="qe ic l ed"><div class="qf qg l"/></div><figcaption class="pi pj pk ou ov pl pm bf b bg z dx">An example of markdown file describing a recipe to make french crêpes.</figcaption></figure><p id="cbf0" class="pw-post-body-paragraph mv mw fq mx b my nu na nb nc nv ne nf ng nw ni nj nk nx nm nn no ny nq nr ns fj bk">As you can see, this is not completely unstructured, there are nice tabular metadata on top of the file, then there are 4 distincts sections:</p><ul class=""><li id="52df" class="mv mw fq mx b my nu na nb nc nv ne nf ng nw ni nj nk nx nm nn no ny nq nr ns nz oa ob bk">An introduction,</li><li id="5a53" class="mv mw fq mx b my oc na nb nc od ne nf ng oe ni nj nk of nm nn no og nq nr ns nz oa ob bk">The list of ingredients</li><li id="37ee" class="mv mw fq mx b my oc na nb nc od ne nf ng oe ni nj nk of nm nn no og nq nr ns nz oa ob bk">Directions</li><li id="f352" class="mv mw fq mx b my oc na nb nc od ne nf ng oe ni nj nk of nm nn no og nq nr ns nz oa ob bk">Some tips.</li></ul><p id="9068" class="pw-post-body-paragraph mv mw fq mx b my nu na nb nc nv ne nf ng nw ni nj nk nx nm nn no ny nq nr ns fj bk">Based on this observation, <a class="af nt" href="https://www.linkedin.com/in/sebastianbahr/" rel="noopener ugc nofollow" target="_blank">Sebastian Bahr</a>, developed a parser to transform the markdown files into JSON <a class="af nt" href="https://github.com/sebastianbahr/RecipeRecommender" rel="noopener ugc nofollow" target="_blank">here</a>.</p><p id="b4db" class="pw-post-body-paragraph mv mw fq mx b my nu na nb nc nv ne nf ng nw ni nj nk nx nm nn no ny nq nr ns fj bk">The output of the parser is already more exploitable, besides Sebastian used it to <a class="af nt" rel="noopener" target="_blank" href="/build-a-recipe-recommender-chatbot-using-rag-and-hybrid-search-part-i-c4aa07d14dcf">build a recipe recommender chatbot</a>. However, there are still some drawbacks. The ingredients and directions keys contain raw texts that could be better structured. <br/>As-is, some useful information is hidden. <br/>For example, the quantities for the ingredients, the preparation or cooking time for each step.</p><h2 id="94c5" class="pn ly fq bf lz po pp pq md pr ps pt mh ng pu pv pw nk px py pz no qa qb qc qd bk">Code</h2><p id="c634" class="pw-post-body-paragraph mv mw fq mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">In the remainder of this article, I’ll show the steps that I undertook to get to JSON documents that look like the one below.</p><pre class="ox oy oz pa pb qh qi qj bp qk bb bk"><span id="4bba" class="ql ly fq qi b bg qm qn l qo qp">{<br/>    "name": "Crêpes",<br/>    "serving_size": 4,<br/>    "ingredients": [<br/>        {<br/>            "id": 1,<br/>            "name": "white flour",<br/>            "quantity": 300.0,<br/>            "unit": "g"<br/>        },<br/>        {<br/>            "id": 2,<br/>            "name": "eggs",<br/>            "quantity": 3.0,<br/>            "unit": "unit"<br/>        },<br/>        {<br/>            "id": 3,<br/>            "name": "milk",<br/>            "quantity": 60.0,<br/>            "unit": "cl"<br/>        },<br/>        {<br/>            "id": 4,<br/>            "name": "beer",<br/>            "quantity": 20.0,<br/>            "unit": "cl"<br/>        },<br/>        {<br/>            "id": 5,<br/>            "name": "butter",<br/>            "quantity": 30.0,<br/>            "unit": "g"<br/>        }<br/>    ],<br/>    "steps": [<br/>        {<br/>            "number": 1,<br/>            "description": "Mix flour, eggs, and melted butter in a bowl.",<br/>            "preparation_time": null,<br/>            "cooking_time": null,<br/>            "used_ingredients": [1,2,5]<br/>        },<br/>        {<br/>            "number": 2,<br/>            "description": "Slowly add milk and beer until the dough becomes fluid enough.",<br/>            "preparation_time": 5,<br/>            "cooking_time": null,<br/>            "used_ingredients": [3,4]<br/>        },<br/>        {<br/>            "number": 3,<br/>            "description": "Let the dough rest for one hour.",<br/>            "preparation_time": 60,<br/>            "cooking_time": null,<br/>            "used_ingredients": []<br/>        },<br/>        {<br/>            "number": 4,<br/>            "description": "Cook the crêpe in a flat pan, one ladle at a time.",<br/>            "preparation_time": 10,<br/>            "cooking_time": null,<br/>            "used_ingredients": []<br/>        }<br/>    ]<br/>}</span></pre><p id="a53c" class="pw-post-body-paragraph mv mw fq mx b my nu na nb nc nv ne nf ng nw ni nj nk nx nm nn no ny nq nr ns fj bk">The code to reproduce the tutorial is on GitHub <a class="af nt" href="https://github.com/VianneyMI/baker" rel="noopener ugc nofollow" target="_blank">here</a>.</p><p id="a264" class="pw-post-body-paragraph mv mw fq mx b my nu na nb nc nv ne nf ng nw ni nj nk nx nm nn no ny nq nr ns fj bk">I relied on two powerful libraries <code class="cx qq qr qs qi b"><a class="af nt" href="https://www.langchain.com/" rel="noopener ugc nofollow" target="_blank">langchain</a></code> for communicating with LLM providers and <code class="cx qq qr qs qi b"><a class="af nt" href="https://docs.pydantic.dev/latest/" rel="noopener ugc nofollow" target="_blank">pydantic</a></code> to format the output of the LLMs.</p><p id="0722" class="pw-post-body-paragraph mv mw fq mx b my nu na nb nc nv ne nf ng nw ni nj nk nx nm nn no ny nq nr ns fj bk">First, I defined the two main components of a recipe with the <code class="cx qq qr qs qi b">Ingredient</code>and <code class="cx qq qr qs qi b">Step</code>classes.</p><p id="8262" class="pw-post-body-paragraph mv mw fq mx b my nu na nb nc nv ne nf ng nw ni nj nk nx nm nn no ny nq nr ns fj bk">In each class, I defined the relevant attributes and provided a description of the field and examples. Those are then fed to the LLMs by <code class="cx qq qr qs qi b">langchain</code> leading to better results.</p><pre class="ox oy oz pa pb qh qi qj bp qk bb bk"><span id="543e" class="ql ly fq qi b bg qm qn l qo qp">"""`schemas.py`"""<br/><br/>from pydantic import BaseModel, Field, field_validator<br/><br/>class Ingredient(BaseModel):<br/>    """Ingredient schema"""<br/><br/>    id: int = Field(<br/>        description="Randomly generated unique identifier of the ingredient",<br/>        examples=[1, 2, 3, 4, 5, 6],<br/>    )<br/>    name: str = Field(<br/>        description="The name of the ingredient", <br/>        examples=["flour", "sugar", "salt"]<br/>    )<br/>    quantity: float | None = Field(<br/>        None,<br/>        description="The quantity of the ingredient",<br/>        examples=[200, 4, 0.5, 1, 1, 1],<br/>    )<br/>    unit: str | None = Field(<br/>        None,<br/>        description="The unit in which the quantity is specified",<br/>        examples=["ml", "unit", "l", "unit", "teaspoon", "tablespoon"],<br/>    )<br/><br/>    @field_validator("quantity", mode="before")<br/>    def parse_quantity(cls, value: float | int | str | None):<br/>        """Converts the quantity to a float if it is not already one"""<br/><br/>        if isinstance(value, str):<br/>            try:<br/>                value = float(value)<br/>            except ValueError:<br/>                try:<br/>                    value = eval(value)<br/>                except Exception as e:<br/>                    print(e)<br/>                    pass<br/><br/>        return value<br/><br/><br/>class Step(BaseModel):<br/>    number: int | None = Field(<br/>        None,<br/>        description="The position of the step in the recipe",<br/>        examples=[1, 2, 3, 4, 5, 6],<br/>    )<br/>    description: str = Field(<br/>        description="The action that needs to be performed during that step",<br/>        examples=[<br/>            "Preheat the oven to 180°C",<br/>            "Mix the flour and sugar in a bowl",<br/>            "Add the eggs and mix well",<br/>            "Pour the batter into a greased cake tin",<br/>            "Bake for 30 minutes",<br/>            "Let the cake cool down before serving",<br/>        ],<br/>    )<br/>    preparation_time: int | None = Field(<br/>        None,<br/>        description="The preparation time mentioned in the step description if any.",<br/>        examples=[5, 10, 15, 20, 25, 30],<br/>    )<br/>    cooking_time: int | None = Field(<br/>        None,<br/>        description="The cooking time mentioned in the step description if any.",<br/>        examples=[5, 10, 15, 20, 25, 30],<br/>    )<br/>    used_ingredients: list[int] = Field(<br/>        [],<br/>        description="The list of ingredient ids used in the step",<br/>        examples=[[1, 2], [3, 4], [5, 6], [7, 8], [9, 10], [11, 12]],<br/>    )<br/><br/><br/>class Recipe(BaseModel):<br/>    """Recipe schema"""<br/><br/>    name: str = Field(<br/>        description="The name of the recipe",<br/>        examples=[<br/>            "Chocolate Cake",<br/>            "Apple Pie",<br/>            "Pasta Carbonara",<br/>            "Pumpkin Soup",<br/>            "Chili con Carne",<br/>        ],<br/>    )<br/>    serving_size: int | None = Field(<br/>        None,<br/>        description="The number of servings the recipe makes",<br/>        examples=[1, 2, 4, 6, 8, 10],<br/>    )<br/>    ingredients: list[Ingredient] = []<br/>    steps: list[Step] = []<br/>    total_preparation_time: int | None = Field(<br/>        None,<br/>        description="The total preparation time for the recipe",<br/>        examples=[5, 10, 15, 20, 25, 30],<br/>    )<br/>    total_cooking_time: int | None = Field(<br/>        None,<br/>        description="The total cooking time for the recipe",<br/>        examples=[5, 10, 15, 20, 25, 30],<br/>    )<br/>    comments: list[str] = []</span></pre><p id="86fb" class="pw-post-body-paragraph mv mw fq mx b my nu na nb nc nv ne nf ng nw ni nj nk nx nm nn no ny nq nr ns fj bk"><strong class="mx fr">Technical Details</strong></p><ul class=""><li id="ff8c" class="mv mw fq mx b my nu na nb nc nv ne nf ng nw ni nj nk nx nm nn no ny nq nr ns nz oa ob bk">It is important to not have a model which is too strict here otherwise, the pydantic validation of the JSON outputted by the LLM will fail. A good way to give some flexibility is too provide default values like <code class="cx qq qr qs qi b">None</code> or empty lists <code class="cx qq qr qs qi b">[]</code> depending on the targeted output type.</li><li id="afd5" class="mv mw fq mx b my oc na nb nc od ne nf ng oe ni nj nk of nm nn no og nq nr ns nz oa ob bk">Note the <code class="cx qq qr qs qi b">field_validator</code>on the <code class="cx qq qr qs qi b">quantity</code>attribute of the <code class="cx qq qr qs qi b">Ingredient</code> , is there to help the engine parse quantities. It was not initially there but by doing some trials, I found out that the LLM was often providing quantities as strings such as <code class="cx qq qr qs qi b">1/3</code>or <code class="cx qq qr qs qi b">1/2</code> .</li><li id="7765" class="mv mw fq mx b my oc na nb nc od ne nf ng oe ni nj nk of nm nn no og nq nr ns nz oa ob bk">The <code class="cx qq qr qs qi b">used_ingredients</code>allow to formally link the ingredients to the relevant steps of the recipes.</li></ul><p id="f832" class="pw-post-body-paragraph mv mw fq mx b my nu na nb nc nv ne nf ng nw ni nj nk nx nm nn no ny nq nr ns fj bk">The model of the output being defined the rest of the process is pretty smooth.</p><p id="b16d" class="pw-post-body-paragraph mv mw fq mx b my nu na nb nc nv ne nf ng nw ni nj nk nx nm nn no ny nq nr ns fj bk">In a <code class="cx qq qr qs qi b">prompt.py</code>file, I defined a <code class="cx qq qr qs qi b">create_prompt</code>function to easily generate prompts. A “new” prompt is generated for every recipe. All prompts have the same basis but the recipe itself is passed as a variable to the base prompt to create a new one.</p><pre class="ox oy oz pa pb qh qi qj bp qk bb bk"><span id="39e7" class="ql ly fq qi b bg qm qn l qo qp">""" `prompt.py`<br/><br/>The import statements and the create_prompt function have not been included <br/>in this snippet.<br/>"""<br/># Note : Extra spaces have been included here for readability.<br/><br/>DEFAULT_BASE_PROMPT = """<br/>What are the ingredients and their associated quantities <br/>as well as the steps to make the recipe described <br/>by the following {ingredients} and {steps} provided as raw text ?<br/><br/>In particular, please provide the following information:<br/>- The name of the recipe<br/>- The serving size<br/>- The ingredients and their associated quantities<br/>- The steps to make the recipe and in particular, the duration of each step<br/>- The total duration of the recipe broken <br/>down into preparation, cooking and waiting time. <br/>The totals must be consistent with the sum of the durations of the steps. <br/>- Any additional comments<br/><br/>{format_instructions}<br/>Make sure to provide a valid and well-formatted JSON.<br/><br/>"""</span></pre><p id="ef60" class="pw-post-body-paragraph mv mw fq mx b my nu na nb nc nv ne nf ng nw ni nj nk nx nm nn no ny nq nr ns fj bk">The communication with the LLM logic was defined in the<code class="cx qq qr qs qi b">run</code>function of the<code class="cx qq qr qs qi b">core.py</code>file, that I won’t show here for brevity.</p><p id="41ec" class="pw-post-body-paragraph mv mw fq mx b my nu na nb nc nv ne nf ng nw ni nj nk nx nm nn no ny nq nr ns fj bk">Finally, I combined all those components in my<code class="cx qq qr qs qi b">demo.ipynb</code>notebook whose content is shown below.</p><pre class="ox oy oz pa pb qh qi qj bp qk bb bk"><span id="1fe3" class="ql ly fq qi b bg qm qn l qo qp"># demo.ipynb<br/>import os<br/>from pathlib import Path<br/><br/>import pandas as pd<br/>from langchain.output_parsers import PydanticOutputParser<br/>from langchain_mistralai.chat_models import ChatMistralAI<br/>from dotenv import load_dotenv<br/><br/>from core import run<br/>from prompt import DEFAULT_BASE_PROMPT, create_prompt<br/>from schemas import Recipe<br/> # End of first cell<br/><br/># Setup environment<br/>load_dotenv()<br/>MISTRAL_API_KEY = os.getenv("MISTRAL_API_KEY") #1<br/> # End of second cell<br/> <br/># Load the data<br/>path_to_data = Path(os.getcwd()) / "data" / "input" #2<br/>df = pd.read_json("data/input/recipes_v1.json")<br/>df.head()<br/> # End of third cell<br/><br/># Preparing the components of the system<br/>llm = ChatMistralAI(api_key=MISTRAL_API_KEY, model_name="open-mixtral-8x7b")<br/>parser = PydanticOutputParser(pydantic_object=Recipe)<br/>prompt = create_prompt(<br/>    DEFAULT_BASE_PROMPT, <br/>    parser, <br/>    df["ingredients"][0], <br/>    df["direction"][0]<br/>)<br/>#prompt  <br/>  # End of fourth cell<br/><br/># Combining the components  <br/>example = await run(llm, prompt, parser)<br/>#example<br/> # End of fifth cell</span></pre><p id="1d35" class="pw-post-body-paragraph mv mw fq mx b my nu na nb nc nv ne nf ng nw ni nj nk nx nm nn no ny nq nr ns fj bk">I used <a class="af nt" href="https://mistral.ai/" rel="noopener ugc nofollow" target="_blank">MistralAI</a> as a LLM provider, with their <code class="cx qq qr qs qi b">open-mixtral-8x7b</code>model which is a very good open-source alternative to <a class="af nt" href="https://openai.com/" rel="noopener ugc nofollow" target="_blank">OpenAI</a>. <code class="cx qq qr qs qi b">langchain</code>allows you to easily switch provider given you have created an account on the provider’s platform.</p><p id="7056" class="pw-post-body-paragraph mv mw fq mx b my nu na nb nc nv ne nf ng nw ni nj nk nx nm nn no ny nq nr ns fj bk">If you are trying to reproduce the results:</p><ul class=""><li id="626c" class="mv mw fq mx b my nu na nb nc nv ne nf ng nw ni nj nk nx nm nn no ny nq nr ns nz oa ob bk">(#1) — Make sure you have a <code class="cx qq qr qs qi b">MISTRAL_API_KEY</code>in a .env file or in your OS environment.</li><li id="37b7" class="mv mw fq mx b my oc na nb nc od ne nf ng oe ni nj nk of nm nn no og nq nr ns nz oa ob bk">(#2) — Be careful to the path to the data. If you clone my repo, this won’t be an issue.</li></ul><p id="e0ff" class="pw-post-body-paragraph mv mw fq mx b my nu na nb nc nv ne nf ng nw ni nj nk nx nm nn no ny nq nr ns fj bk">Running the code on the entire dataset cost less than 2€.<br/>The structured dataset resulting from this code can be found <a class="af nt" href="https://github.com/VianneyMI/baker/blob/main/data/output/parsed_recipes_all_8x7b.json" rel="noopener ugc nofollow" target="_blank">here</a> in my repository.<br/>I am happy with the results but I could still try to iterate on the prompt, my field descriptions or the model used to improve them. I might try MistralAI newer model, the <code class="cx qq qr qs qi b">open-mixtral-8x22b</code> or try another LLM provider by simply changing 2 or 3 lines of code thanks to <code class="cx qq qr qs qi b">langchain</code> .</p><p id="bf83" class="pw-post-body-paragraph mv mw fq mx b my nu na nb nc nv ne nf ng nw ni nj nk nx nm nn no ny nq nr ns fj bk">When I am ready, I can get back to my original project. Stay tuned if you want to know what it was. In the meantime, let me know in the comments what would you do with the final dataset ?</p><h1 id="9cce" class="lx ly fq bf lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bk">Conclusion</h1><p id="9572" class="pw-post-body-paragraph mv mw fq mx b my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">Large Language Models (LLMs) offer a powerful tool for structuring unstructured data. Their ability to understand and interpret human language nuances, automate laborious tasks, and adapt to evolving data make them an invaluable resource in data analysis. By unlocking the hidden potential within unstructured textual data, businesses can transform this data into valuable insights, driving better decision-making and business outcomes. The example provided, of transforming raw recipes data into a structured format, is just one of the countless possibilities that LLMs offer.</p><p id="bfa8" class="pw-post-body-paragraph mv mw fq mx b my nu na nb nc nv ne nf ng nw ni nj nk nx nm nn no ny nq nr ns fj bk">As we continue to explore and develop these models, we can expect to see many more innovative applications in the future. The journey of harnessing the full potential of LLMs is just beginning, and the road ahead promises to be an exciting one.</p></div></div></div></div>    
</body>
</html>