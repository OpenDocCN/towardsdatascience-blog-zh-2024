- en: Assorted Flavors of Fourier Series on a Finite Domain
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/assorted-flavors-of-fourier-series-on-a-finite-domain-8c93904df6ae?source=collection_archive---------8-----------------------#2024-04-22](https://towardsdatascience.com/assorted-flavors-of-fourier-series-on-a-finite-domain-8c93904df6ae?source=collection_archive---------8-----------------------#2024-04-22)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Choose the one that behaves nicely at the boundaries
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://sebastiengilbert.medium.com/?source=post_page---byline--8c93904df6ae--------------------------------)[![Sébastien
    Gilbert](../Images/380f6588c3ef718947bcf82061f190eb.png)](https://sebastiengilbert.medium.com/?source=post_page---byline--8c93904df6ae--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--8c93904df6ae--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--8c93904df6ae--------------------------------)
    [Sébastien Gilbert](https://sebastiengilbert.medium.com/?source=post_page---byline--8c93904df6ae--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--8c93904df6ae--------------------------------)
    ·8 min read·Apr 22, 2024
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/943ece461119ff88df80b6316e0712f4.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Hilda Gea](https://unsplash.com/@hildagea?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: If you look up the history of Fourier analysis, you’ll see that Jean-Baptiste
    Joseph Fourier formalized the series that would bear his name while working on
    the heat flow problem.
  prefs: []
  type: TYPE_NORMAL
- en: A Fourier series represents a periodic signal as a sum of sinusoids whose frequencies
    are integer multiple of the fundamental frequency.
  prefs: []
  type: TYPE_NORMAL
- en: We intuitively know that a hot spot in a conductive medium will spread heat
    in all directions until the temperature is uniform. There is no visible oscillatory
    behavior in this phenomenon, neither in space nor time. Why then introduce a series
    of sinusoids?
  prefs: []
  type: TYPE_NORMAL
- en: The initial temperature profile, the governing differential equation, and the
    boundary conditions determine the evolution of the temperature function u(x, t)
    in the problem of a one-dimensional conductive medium such as a thin metal bar.
    As it turns out, the spatial frequency components of the initial temperature profile
    will be damped by a decaying exponential over time, with an exponential factor
    that grows like the square of the spatial frequency. In other words, high frequencies
    in the initial temperature profile decay much faster than the low frequencies,
    which explains the smoothing of the temperature distribution.
  prefs: []
  type: TYPE_NORMAL
- en: In this story, **we will review the basics of Fourier series for a function
    defined on a finite domain**. We’ll cast the problem such that the resulting Fourier
    series has some desirable properties at the domain boundaries. This approach will
    pay off when we apply the Fourier series to solve a problem involving differential
    equations with some constraints at the boundaries.
  prefs: []
  type: TYPE_NORMAL
- en: 'Fourier series: a tool to represent periodic functions'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Fourier series can approximate periodic functions. Let g(x) be a periodic function
    with period 2L.
  prefs: []
  type: TYPE_NORMAL
- en: Why a period of 2L?
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: We are interested in functions defined on the finite domain [0, L]. We can construct
    a periodic function g(x) whose period is 2L from the function f(x) defined over
    [0, L] with some padding chosen to have desirable properties. We’ll get back to
    this point later.
  prefs: []
  type: TYPE_NORMAL
- en: 'Assuming a Fourier series exists, we can write g(x) as:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/aeab02e899cce3d2c8f58f0245f183a0.png)'
  prefs: []
  type: TYPE_IMG
- en: 'As an example, let’s consider the following periodic function g(x), with period
    2L = 0.6:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1307a14360c06815253d5d057496350a.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 1: The periodic function g(x). Image by the author.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Applying equations (2), (3), (4) and using Simpson numerical integration gives
    the following values for a₀, aₙ, and bₙ:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e67ab50a42152d5da69a7562a6829957.png)'
  prefs: []
  type: TYPE_IMG
- en: These values, the Fourier coefficients, allow us to build an approximation of
    g(x) with equation (1). The more terms we include in the summation, the more precise
    will be the approximation. Figure 2 shows a few approximations with various numbers
    of terms from the summation in equation (1).
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/c98232aae91d29c72b95c8fd3b0cc2bb.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 2: Reconstructions of g(x) with various numbers of terms in the Fourier
    series. Image by the author.'
  prefs: []
  type: TYPE_NORMAL
- en: 'We can already formulate a few observations:'
  prefs: []
  type: TYPE_NORMAL
- en: Finite discontinuities in the signal are tolerable, but they generate wiggling
    in the reconstructed approximation. We refer to these oscillations in the neighborhood
    of discontinuities as the [Gibbs phenomenon](https://en.wikipedia.org/wiki/Gibbs_phenomenon).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The Fourier series is the sum of an infinite number of terms, but we can truncate
    the summation and still have a reasonable approximation of the original function.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The original signal could be a sample of discrete points. The Fourier series
    can interpolate the function anywhere on the x-axis.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Functions defined on a finite domain
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In engineering problems, we often encounter functions defined on a finite domain.
    For example, in the case of the one-dimensional temperature distribution of a
    conductive medium, the temperature function is defined over the [0, L] range,
    where L is the length of the thin metal bar. How can the Fourier series be used
    in this setting?
  prefs: []
  type: TYPE_NORMAL
- en: To answer this question, we first acknowledge that any periodic function g(x)
    that coincides with the function on interest f(x) over the range [0, L] is a valid
    candidate for a Fourier series representation of f(x). After all, we don’t care
    how the Fourier series behaves outside the [0, L] range.
  prefs: []
  type: TYPE_NORMAL
- en: The naive periodic replication of f(x)
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The most straightforward way to build g(x) is to replicate f(x) in the interval
    [-L, 0], as in figure 3:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/a08bb4ccd4790c76369614c79b013ef6.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 3: f(x) defined over [0, 0.3] is replicated in the range [-0.3, 0] to
    build the periodic function g(x) with period 0.6\. Image by the author.'
  prefs: []
  type: TYPE_NORMAL
- en: 'The Fourier integration for the naive periodic replication of f(x) yields equations
    (5) to (7):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4731390e815e9ab986d6470b0364bc26.png)'
  prefs: []
  type: TYPE_IMG
- en: 'By inserting (5), (6), (7) in equation (1) to f(x) from Figure 3, we obtain
    the Fourier series reconstruction shown in Figure 4:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e3bdbc354410090d484f912585555ef2.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 4: The function f(x) (the original signal) from Figure 3 and the Fourier
    series, displayed as the signal reconstruction. Image by the author.'
  prefs: []
  type: TYPE_NORMAL
- en: The Fourier series closely matches the original signal, except at the range
    boundaries, where the reconstruction oscillates and jumps. Since we explicitly
    constructed a periodic signal of period L, the Fourier series interprets the transitions
    at x=0 and x=L as finite discontinuities.
  prefs: []
  type: TYPE_NORMAL
- en: Finite discontinuities are allowed by the Fourier series, but the Gibbs phenomenon
    degrades the reconstruction around the discontinuities.
  prefs: []
  type: TYPE_NORMAL
- en: For many engineering cases, this is problematic. For example, in the case of
    heat transfer in a thin metal bar, what happens at the bar extremities (a.k.a.
    the boundary conditions) is an intrinsic part of the problem description. We could
    have an isolated bar, which implies the temperature gradient must be 0 at both
    ends. Alternatively, we could have arbitrary set temperatures at x=0 and x=L.
    In these common scenarios, we cannot use the naive periodic replication of f(x)
    because the Gibbs phenomenon corrupts the signal at the ends of the range.
  prefs: []
  type: TYPE_NORMAL
- en: Even half-range expansion
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Instead of replicating f(x), we could have a flipped version of f(x) in the
    range [-L, 0], like in Figure 5:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/ca44992bd77047bfc379e25b6f5e4292.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 5: g(x) = f(-x) in the range [-L, 0]. Image by the author.'
  prefs: []
  type: TYPE_NORMAL
- en: 'This approach eliminates the discontinuities at x=0 and x=L. The Fourier integration
    for the even half-range expansion of f(x) yields equations (8) to (10):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/efa81abac89c7553433420904b770ea5.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 6 shows the Fourier series reconstruction of f(x):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/d82cd9433177d69b2f5ff2b5707f543e.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 6: The original signal and its reconstruction with even half-range expansion.
    Image by the author.'
  prefs: []
  type: TYPE_NORMAL
- en: A feature of the even half-range expansion is the fact that g(x) being even,
    all bₙ coefficients (Cf. equation (10)) are 0, and thus its Fourier series is
    exclusively made of cosine terms. As a consequence, **the derivative of the Fourier
    series is zero at x=0 and x=L**. You can verify this by differentiating equation
    (1) with respect to x, with all bₙ terms set to 0.
  prefs: []
  type: TYPE_NORMAL
- en: That is what we want in a scenario where, for example, the metal bar is isolated,
    so there is no heat leakage at the extremities.
  prefs: []
  type: TYPE_NORMAL
- en: Odd half-range expansion
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'What if we created an odd function instead? This can be accomplished by pasting
    a rotated version of f(x) in the interval [-L, 0], like in Figure 7:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/cac58f7f87be27d9b27d0970f5f26c82.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 7: g(x) = -f(-x) in the range [-L, 0]. Image by the author.'
  prefs: []
  type: TYPE_NORMAL
- en: 'The Fourier integration for the odd half-range expansion of f(x) yields equations
    (11) to (13):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4257992500c5c112c321ebf34a7cfc9a.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 8 shows the Fourier series reconstruction of f(x):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/ecc6033479daaa7baca17ad6093a518b.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 8: The original signal and its reconstruction with odd half-range expansion.
    Image by the author.'
  prefs: []
  type: TYPE_NORMAL
- en: g(x) being odd, the Fourier series is made exclusively of sine terms. For this
    reason, **the Fourier series is zero at x=0 and x=L**. This property can be exploited,
    for example, when we simulate the shape of an oscillating guitar string. The string
    height is constrained to 0 at x=0 and x=L, so we would naturally model the initial
    condition with odd half-expansion.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/c47ff92b04e4ae81c760efbf312cfc67.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Rio Lecatompessy](https://unsplash.com/@riolec?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: Even quarter-range expansion
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'We can be even more creative and design a periodic function with a period of
    4L. If we want a derivative of exactly 0 at x=0 and a smooth transition, both
    in value and in derivative, at x=L, we can append a rotated copy of f(x) in the
    [L, 2L] interval and make this function even. Figure 9 shows an example:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0e329976d0bd671186deafc320c78603.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 9: g(x) = 2f(L) - f(2L+x) in the range[-2L, -L]; f(-x) in the range
    [-L, 0]; f(x) in the range [0, L]; 2f(L)-f(2L-x) in the range [L, 2L]. Image by
    the author.'
  prefs: []
  type: TYPE_NORMAL
- en: 'The Fourier integration for the even quarter-range expansion of f(x) yields
    equations (14) to (16):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/893628aca2a3a2191efaca7f032fbbdb.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 10 shows the Fourier series reconstruction of f(x):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0062394f6665466306a2def6cc747301.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 10: Original signal and Fourier series reconstruction with even quarter-range
    expansion. Image by the author.'
  prefs: []
  type: TYPE_NORMAL
- en: Although it is not visible from the figure, the derivative of the Fourier series
    reconstruction is 0 at x=0 and identical to the original signal at x=L.
  prefs: []
  type: TYPE_NORMAL
- en: Odd quarter-range expansion
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The last case we’ll consider is when we want a value of 0 at x=0 and a derivative
    of 0 at x=L. We build g(x) by appending a flipped version of f(x) in the [L, 2L]
    range and make this function odd.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/b44900427f46a7707c5309ced2212a41.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 11: g(x) = -f(x+2L) in the range[-2L, L]; -f(-x) in the range [-L, 0];
    f(x) in the range [0, L]; f(2L-x) in the range [L, 2L]. Image by the author.'
  prefs: []
  type: TYPE_NORMAL
- en: 'The Fourier integration for the odd quarter-range expansion of f(x) yields
    equations (17) to (19):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/004bf05522d972b918df942e21026196.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 12 shows the Fourier series reconstruction of f(x):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/9bb247e87c6c9c823846de1a9b6cae37.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 12: Original signal and Fourier series reconstruction with odd quarter-range
    expansion. Image by the author.'
  prefs: []
  type: TYPE_NORMAL
- en: We can see that the reconstruction goes through 0 at x=0\. The derivative is
    zero at x=L, even if the original signal derivative is not.
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'We considered the problem of finding a suitable Fourier series expansion for
    a signal f(x) defined over the finite interval [0, L]. Fourier series apply to
    periodic functions, so we had to build a periodic function that matches f(x) over
    the defined domain. We observed four methods to define the periodic function g(x).
    Each guarantees specific properties at the range boundaries:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Even half-range expansion: The Fourier series has a derivative of 0 at x=0
    and x=L'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Odd half-range expansion: The Fourier series has a value of 0 at x=0 and x=L'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Even quarter-range expansion: The Fourier series has a derivative of 0 at x=0
    and smooth value and derivative at x=L'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Odd quarter-range expansion: The Fourier series has a value of 0 at x=0 and
    a derivative of 0 at x=L'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In a future story, we will examine how heat is transferred in a thin metal bar.
    The solution involves converting the initial temperature profile to a Fourier
    series. We’ll observe that the choice for the type of Fourier series expansion
    is naturally dictated by the boundary conditions (e.g., the bar is isolated at
    x=0 and held to a fixed temperature at x=L). The seemingly arbitrary periodic
    functions we created in this post will suddenly make sense!
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs: []
  type: TYPE_NORMAL
- en: (R1) Advanced Engineering Mathematics, Erwin Kreyszig, John Wiley and Sons,
    1988
  prefs: []
  type: TYPE_NORMAL
