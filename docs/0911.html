<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Building a simple Agent with Tools and Toolkits in LangChain</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Building a simple Agent with Tools and Toolkits in LangChain</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-a-simple-agent-with-tools-and-toolkits-in-langchain-77e0f9bd1fa5?source=collection_archive---------1-----------------------#2024-04-10">https://towardsdatascience.com/building-a-simple-agent-with-tools-and-toolkits-in-langchain-77e0f9bd1fa5?source=collection_archive---------1-----------------------#2024-04-10</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="2917" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">Get familiar with the building blocks of Agents in LangChain</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@ssmaameri?source=post_page---byline--77e0f9bd1fa5--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Sami Maameri" class="l ep by dd de cx" src="../Images/9e9892fe7d3cc53ad1c4d165145878ef.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*idWYMwlRbOHeOx70A-XzMQ.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--77e0f9bd1fa5--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://medium.com/@ssmaameri?source=post_page---byline--77e0f9bd1fa5--------------------------------" rel="noopener follow">Sami Maameri</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--77e0f9bd1fa5--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">13 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Apr 10, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj lc ld ab q ee le lf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count la lb">2</span></p></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lg k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lh an ao ap id li lj lk" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep ll cn"><div class="l ae"><div class="ab cb"><div class="lm ln lo lp lq lr ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk ml"><img src="../Images/c890aaf761bb571b28a0b60b25e8fda6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XQaSfBvcMnEB4AWI"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Photo by <a class="af nc" href="https://unsplash.com/@danlefeb?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Dan LeFebvre</a> on <a class="af nc" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="b8fa" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Let’s build a simple agent in LangChain to help us understand some of the foundational concepts and building blocks for how agents work there.</p><p id="7a41" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">By keeping it simple we can get a better grasp of the foundational ideas behind these agents, allowing us to build more complex agents in the future.</p><pre class="mm mn mo mp mq nz oa ob bp oc bb bk"><span id="3122" class="od oe fq oa b bg of og l oh oi"><strong class="oa fr">Contents</strong><br/><br/><a class="af nc" href="#417f" rel="noopener ugc nofollow">What are Agents?</a><br/><br/><a class="af nc" href="#6fc2" rel="noopener ugc nofollow">Building the Agent</a><br/>- <a class="af nc" href="#8705" rel="noopener ugc nofollow">The Tools</a><br/>- <a class="af nc" href="#6004" rel="noopener ugc nofollow">The Toolkit</a><br/>- <a class="af nc" href="#1c1d" rel="noopener ugc nofollow">The LLM</a><br/>- <a class="af nc" href="#0728" rel="noopener ugc nofollow">The Prompt</a><br/><br/><a class="af nc" href="#159c" rel="noopener ugc nofollow">The Agent</a><br/><br/><a class="af nc" href="#0844" rel="noopener ugc nofollow">Testing our Agent</a><br/><br/><a class="af nc" href="#fef3" rel="noopener ugc nofollow">Observations</a><br/><br/><a class="af nc" href="#daa9" rel="noopener ugc nofollow">The Future</a><br/><br/><a class="af nc" href="#c1a5" rel="noopener ugc nofollow">Conclusion</a></span></pre></div></div></div><div class="ab cb oj ok ol om" role="separator"><span class="on by bm oo op oq"/><span class="on by bm oo op oq"/><span class="on by bm oo op"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="b889" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Want to get notified about my future posts? <a class="af nc" href="https://medium.com/@ssmaameri/subscribe" rel="noopener"><em class="or">Subscribe here</em></a></p></div></div></div><div class="ab cb oj ok ol om" role="separator"><span class="on by bm oo op oq"/><span class="on by bm oo op oq"/><span class="on by bm oo op"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="417f" class="os oe fq bf ot ou ov gq ow ox oy gt oz pa pb pc pd pe pf pg ph pi pj pk pl pm bk">What are Agents</h1><p id="0433" class="pw-post-body-paragraph nd ne fq nf b go pn nh ni gr po nk nl nm pp no np nq pq ns nt nu pr nw nx ny fj bk">The LangChain documentation actually has a pretty <a class="af nc" href="https://python.langchain.com/docs/modules/agents/" rel="noopener ugc nofollow" target="_blank">good page</a> on the high level concepts around its agents. It’s a short easy read, and definitely worth skimming through before getting started.</p><p id="1b79" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">If you lookup the definition of AI Agents, you get something along the lines of “An entity that is able to perceive its environment, act on its environment, and make intelligent decisions about how to reach a goal it has been given, as well as the ability to learn as it goes”</p><p id="90a7" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">That fits the definition of LangChain agents pretty well I would say. What makes all this possible in software is the reasoning abilities of Large Language Model’s (LLM’s). The brains of a LangChain agent are an LLM. It is the LLM that is used to reason about the best way to carry out the ask requested by a user.</p><p id="a679" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">In order to carry out its task, and operate on things and retrieve information, the agent has what are called Tool’s in LangChain, at its disposal. It is through these tools that it is able to interact with its environment.</p><p id="7370" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">The tools are basically just methods/classes the agent has access to that can do things like interact with a Stock Market index over an API, update a Google Calendar event, or run a query against a database. We can build out tools as needed, depending on the nature of tasks we are trying to carry out with the agent to fulfil.</p><p id="4a39" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">A collection of Tools in LangChain are called a Toolkit. Implementation wise, this is literally just an array of the Tools that are available for the agent. As such, the high level overview of an agent in LangChain looks something like this</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk ps"><img src="../Images/34df972c8faa9ba0de48bb3d01d91eb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hah4yA9A0rniFn2tEDyNrA.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by author</figcaption></figure><p id="61a1" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">So, at a basic level, an agent needs</p><ul class=""><li id="76e7" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny pt pu pv bk">an LLM to act as its brain, and to give it its reasoning abilities</li><li id="780b" class="nd ne fq nf b go pw nh ni gr px nk nl nm py no np nq pz ns nt nu qa nw nx ny pt pu pv bk">tools so that it can interact with the environment around it and achieve its goals</li></ul><h1 id="6fc2" class="os oe fq bf ot ou qb gq ow ox qc gt oz pa qd pc pd pe qe pg ph pi qf pk pl pm bk">Building the Agent</h1><p id="9886" class="pw-post-body-paragraph nd ne fq nf b go pn nh ni gr po nk nl nm pp no np nq pq ns nt nu pr nw nx ny fj bk">To make some of these concepts more concrete, let’s build a simple agent.</p><p id="dac9" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">We will create a Mathematics Agent that can perform a few simple mathematical operations.</p><h2 id="6ddd" class="qg oe fq bf ot qh qi qj ow qk ql qm oz nm qn qo qp nq qq qr qs nu qt qu qv qw bk">Environment setup</h2><p id="c3e1" class="pw-post-body-paragraph nd ne fq nf b go pn nh ni gr po nk nl nm pp no np nq pq ns nt nu pr nw nx ny fj bk">First lets setup our environment and script</p><pre class="mm mn mo mp mq nz oa ob bp oc bb bk"><span id="0371" class="od oe fq oa b bg of og l oh oi">mkdir simple-math-agent &amp;&amp; cd simple-math-agent<br/>touch math-agent.py<br/>python3 -m venv .venv<br/>. .venv/bin/activate</span></pre><pre class="qx nz oa ob bp oc bb bk"><span id="83e1" class="od oe fq oa b bg of og l oh oi">pip install langchain langchain_openai</span></pre><p id="67da" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Alternatively, you can also clone the code used here <a class="af nc" href="https://github.com/smaameri/simple-math-agent" rel="noopener ugc nofollow" target="_blank">from GitHub</a></p><pre class="mm mn mo mp mq nz oa ob bp oc bb bk"><span id="36ad" class="od oe fq oa b bg of og l oh oi">git clone git@github.com:smaameri/simple-math-agent.git</span></pre><p id="551a" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">or check out the code inside a <a class="af nc" href="https://colab.research.google.com/drive/1dHG7d4Iq0yuDEOWK1UaMZ7ADeTo0uAFT?usp=sharing" rel="noopener ugc nofollow" target="_blank">Google Colab</a> also.</p><h1 id="8705" class="os oe fq bf ot ou qb gq ow ox qc gt oz pa qd pc pd pe qe pg ph pi qf pk pl pm bk">The Tools</h1><p id="1cce" class="pw-post-body-paragraph nd ne fq nf b go pn nh ni gr po nk nl nm pp no np nq pq ns nt nu pr nw nx ny fj bk">The simplest place to start will be to fist define the tools for our Maths agent.</p><p id="65ed" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Let’s give it “add”, “multiply” and “square” tools, so that it can perform those operations on questions we pass to it. By keeping our tools simple we can focus on the core concepts, and build the tools ourselves, instead of relying on an existing and more complex tools like the WikipediaTool, that acts as a wrapper around the Wikipedia API, and requires us to import it from the LangChain library.</p><p id="5a01" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Again, we are not trying to do anything fancy here, just keeping it simple and putting the main building blocks of an agent together so we can understand how they work, and get our first agent up and running.</p><p id="2e61" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Let’s start with the “add” tool. The bottom up way to create a Tool in LangChain would be to extend the <strong class="nf fr">BaseTool</strong> class, set the <strong class="nf fr">name</strong> and <strong class="nf fr">description</strong> fields on the class, and implement the <strong class="nf fr">_run</strong> method. That would look like this</p><pre class="mm mn mo mp mq nz oa ob bp oc bb bk"><span id="d4bf" class="od oe fq oa b bg of og l oh oi">from langchain_core.tools import BaseTool<br/><br/>class AddTool(BaseTool):<br/>    name = "add"<br/>    description = "Adds two numbers together"<br/>    args_schema: Type[BaseModel] = AddInput<br/>    return_direct: bool = True<br/><br/>    def _run(<br/>        self, a: int, b: int, run_manager: Optional[CallbackManagerForToolRun] = None<br/>    ) -&gt; str:<br/>        return a + b</span></pre><p id="1b0c" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Notice that we need to implement the <strong class="nf fr">_run</strong> method to show what our tool does with the parameters that are passed to it.</p><p id="b5b6" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Notice also how it requires a pydantic model for the <strong class="nf fr">args_schema</strong>. We will define that here</p><pre class="mm mn mo mp mq nz oa ob bp oc bb bk"><span id="52cf" class="od oe fq oa b bg of og l oh oi">AddInput<br/>    a: int = Field(description="first number")<br/>    b: int = Field(description="second number")</span></pre><p id="53cd" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Now, LangChain does give us an easier way to define tools, then by needing to extend the <strong class="nf fr">BaseTool</strong> class each time. We can do this with the help of the <strong class="nf fr">@too</strong>l decorator. Defining the “add” tool in LangChain using the @tool decorator will look like this</p><pre class="mm mn mo mp mq nz oa ob bp oc bb bk"><span id="407a" class="od oe fq oa b bg of og l oh oi">from langchain.tools import tool<br/><br/>@tool<br/>def add(a: int, b: int) -&gt; int:<br/> “””Adds two numbers together””” # this docstring gets used as the description<br/> return a + b # the actions our tool performs</span></pre><p id="7cb7" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Much simpler right. Behind the scenes, the decorator magically uses the method provided to extend the BaseTool class, just as we did earlier. Some thing to note:</p><ul class=""><li id="7210" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny pt pu pv bk">the method name also becomes the tool name</li><li id="13cf" class="nd ne fq nf b go pw nh ni gr px nk nl nm py no np nq pz ns nt nu qa nw nx ny pt pu pv bk">the method params define the input parameters for the tool</li><li id="21bd" class="nd ne fq nf b go pw nh ni gr px nk nl nm py no np nq pz ns nt nu qa nw nx ny pt pu pv bk">the docstring gets converted into the tools description</li></ul><p id="cd9e" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">You can access these properties on the tool also</p><pre class="mm mn mo mp mq nz oa ob bp oc bb bk"><span id="b935" class="od oe fq oa b bg of og l oh oi">print(add.name) # add<br/>print(add.description) # Adds two numbers together.<br/>print(add.args) # {'a': {'title': 'A', 'type': 'integer'}, 'b': {'title': 'B', 'type': 'integer'}}</span></pre><p id="31a9" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Note that the description of a tool is very important as this is what the LLM uses to decide whether or not it is the right tool for the job. A bad description may lead to the not tool getting used when it should be, or getting used at the wrong times.</p><p id="2e97" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">With the <strong class="nf fr">add</strong> tool done, let’s move on to the definitions for our <strong class="nf fr">multiply</strong> and <strong class="nf fr">square</strong> tools.</p><pre class="mm mn mo mp mq nz oa ob bp oc bb bk"><span id="9644" class="od oe fq oa b bg of og l oh oi">@tool<br/>def multiply(a: int, b: int) -&gt; int:<br/>    """Multiply two numbers."""<br/>    return a * b<br/><br/>@tool<br/>def square(a) -&gt; int:<br/>    """Calculates the square of a number."""<br/>    a = int(a)<br/>    return a * a</span></pre><p id="86df" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">And that is it, simple as that.</p><p id="cf7e" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">So we have defined our own three <a class="af nc" href="https://python.langchain.com/docs/modules/tools/custom_tools/" rel="noopener ugc nofollow" target="_blank">custom tools</a>. A more common use case might be to use some of the already provided and existing tools in LangChain, which you can see <a class="af nc" href="https://python.langchain.com/docs/integrations/tools/" rel="noopener ugc nofollow" target="_blank">here</a>. However, at the source code level, they would all be built and defined using a similar methods as described above.</p><p id="5f01" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">And that is it as far as our Tools our concerned. Now time to combine our tools into a Toolkit.</p><h1 id="6004" class="os oe fq bf ot ou qb gq ow ox qc gt oz pa qd pc pd pe qe pg ph pi qf pk pl pm bk">The Toolkit</h1><p id="f78a" class="pw-post-body-paragraph nd ne fq nf b go pn nh ni gr po nk nl nm pp no np nq pq ns nt nu pr nw nx ny fj bk">Toolkits sound fancy, but they are actually very simple. They are <strong class="nf fr">literally</strong> just a a list of tools. We can define our toolkit as an array of tools like so</p><pre class="mm mn mo mp mq nz oa ob bp oc bb bk"><span id="736f" class="od oe fq oa b bg of og l oh oi">toolkit = [add, multiply, square]</span></pre><p id="7f50" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">And that’s it. Really straightforward, and nothing to get confused over.</p><p id="6416" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Usually Toolkits are groups of tools that are useful together, and would be helpful for agents trying to carry out certain kinds of tasks. For example an SQLToolkit might contain a tool for generating an SQL query, validating an SQL query, and executing an SQL query.</p><p id="ce9f" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">The <a class="af nc" href="https://python.langchain.com/docs/integrations/toolkits/" rel="noopener ugc nofollow" target="_blank">Integrations Toolkit</a> page on the LangChain docs has a large list of toolkits developed by the community that might be useful for you.</p><h1 id="1c1d" class="os oe fq bf ot ou qb gq ow ox qc gt oz pa qd pc pd pe qe pg ph pi qf pk pl pm bk">The LLM</h1><p id="15e3" class="pw-post-body-paragraph nd ne fq nf b go pn nh ni gr po nk nl nm pp no np nq pq ns nt nu pr nw nx ny fj bk">As mentioned above, an LLM is the brains of an agent. It decides which tools to call based on the question passed to it, what are the best next steps to take based on a tools description. It also decides when it has reached its final answer, and is ready to return that to the user.</p><p id="15d7" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Let’s setup the LLM here</p><pre class="mm mn mo mp mq nz oa ob bp oc bb bk"><span id="866c" class="od oe fq oa b bg of og l oh oi">from langchain_openai import ChatOpenAI<br/><br/>llm = ChatOpenAI(model="gpt-3.5-turbo-1106", temperature=0)</span></pre><h1 id="0728" class="os oe fq bf ot ou qb gq ow ox qc gt oz pa qd pc pd pe qe pg ph pi qf pk pl pm bk">The Prompt</h1><p id="d905" class="pw-post-body-paragraph nd ne fq nf b go pn nh ni gr po nk nl nm pp no np nq pq ns nt nu pr nw nx ny fj bk">Lastly we need a prompt to pass into our agent, so it has a general idea bout what kind of agent it is, and what sorts of tasks it should solve.</p><p id="2539" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Our agent requires a ChatPromptTemplate to work (more on that later). This is what a barebones ChatPromptTemplate looks like. The main part we care about is the system prompt, and the rest are just the default settings we are required to pass in.</p><p id="90db" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">In our prompt we have included a sample answer, showing the agent how we want it to return the answer only, and not any descriptive text along with the answer</p><pre class="mm mn mo mp mq nz oa ob bp oc bb bk"><span id="bc4a" class="od oe fq oa b bg of og l oh oi">prompt = ChatPromptTemplate.from_messages(<br/>    [<br/>        ("system", """<br/>          You are a mathematical assistant. Use your tools to answer questions.<br/>          If you do not have a tool to answer the question, say so. <br/>        <br/>          Return only the answers. e.g<br/>          Human: What is 1 + 1?<br/>          AI: 2<br/>          """),<br/>        MessagesPlaceholder("chat_history", optional=True),<br/>        ("human", "{input}"),<br/>        MessagesPlaceholder("agent_scratchpad"),<br/>    ]<br/>)</span></pre></div></div></div><div class="ab cb oj ok ol om" role="separator"><span class="on by bm oo op oq"/><span class="on by bm oo op oq"/><span class="on by bm oo op"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="56f7" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">That is it. We have setup our Tools and Toolkit, which our agent will need as part of its setup, so its knows what are the types of actions and capabilities it has at its disposal. And we have also setup the LLM and system prompt.</p><p id="bf9d" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Now for the fun part. Setting up our Agent!</p><h1 id="159c" class="os oe fq bf ot ou qb gq ow ox qc gt oz pa qd pc pd pe qe pg ph pi qf pk pl pm bk">The Agent</h1><p id="1c42" class="pw-post-body-paragraph nd ne fq nf b go pn nh ni gr po nk nl nm pp no np nq pq ns nt nu pr nw nx ny fj bk">LangChain has a <a class="af nc" href="https://python.langchain.com/docs/modules/agents/agent_types/" rel="noopener ugc nofollow" target="_blank">number of different agents types</a> that can be created, with different reasoning powers and abilities. We will be using the most capable and powerful agent currently available, the <a class="af nc" href="https://python.langchain.com/docs/modules/agents/agent_types/openai_tools/" rel="noopener ugc nofollow" target="_blank">OpenAI Tools</a> agent. As per the docs on the the OpenAI Tools agent, which uses newer OpenAI models also,</p><blockquote class="qy qz ra"><p id="c96b" class="nd ne or nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Newer OpenAI models have been fine-tuned to detect when one or more function(s) should be called and respond with the inputs that should be passed to the function(s). In an API call, you can describe functions and have the model intelligently choose to output a JSON object containing arguments to call these functions. The goal of the OpenAI tools APIs is to more reliably return valid and useful function calls than what can be done using a generic text completion or chat API.</p></blockquote><p id="96e1" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">In other words this agents is good at generating the correct structure for calling functions, and is able to understand if more than one function (tool) might be needed for our task also. This agent also has the ability to call functions (tools) with multiple input parameters, just like ours do. Some agents can only work with functions that have a single input parameter.</p><p id="f933" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">If you are familiar with <a class="af nc" href="https://platform.openai.com/docs/guides/function-calling" rel="noopener ugc nofollow" target="_blank">OpenAI’s Function</a> calling feature, where we can use the OpenAI LLM to generate the correct parameters to call a function with, the OpenAI Tools agent we are using here is leveraging some of that power in order to be able to call the correct tool, with the correct parameters.</p><p id="b9c2" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">In order to setup an agent in LangChain, we need to use one of the factory methods provided for creating the agent of our choice.</p><p id="f0b3" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">The factory method for creating an OpenAI tools agent is <strong class="nf fr">create_openai_tools_agent()</strong>. And it requires passing in the llm, tools and prompt we setup above. So let’s initialise our agent.</p><pre class="mm mn mo mp mq nz oa ob bp oc bb bk"><span id="2bf7" class="od oe fq oa b bg of og l oh oi">agent = create_openai_tools_agent(llm, toolkit, prompt)</span></pre><p id="ded0" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Finally, in order to run agents in LangChain, we cannot just call a “<em class="or">run</em>” type method on them directly. They need to be run via an AgentExecutor.</p><p id="b963" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Am bringing up the Agent Executor only here at the end as I don’t think it’s a critical concept for understanding how the agents work, and bring it up at the start with everything else would just the whole thing seem more complicated than it needs to be, as well as distract from understanding some of the other more fundamental concepts.</p><p id="a2ec" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">So, now that we are introducing it, an AgentExecutor acts as the runtime for agents in LangChain, and allow an agent to keep running until it is ready to return its final response to the user. In pseudo-code, the AgentExecutor’s are doing something along the lines of (pulled directly from <a class="af nc" href="https://python.langchain.com/docs/modules/agents/concepts/#agentexecutor" rel="noopener ugc nofollow" target="_blank">the LangChain docs</a>)</p><pre class="mm mn mo mp mq nz oa ob bp oc bb bk"><span id="bd06" class="od oe fq oa b bg of og l oh oi">next_action = agent.get_action(...)<br/>while next_action != AgentFinish:<br/>    observation = run(next_action)<br/>    next_action = agent.get_action(..., next_action, observation)<br/>return next_action</span></pre><p id="0d6e" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">So they are basically a while loop that keep’s calling the next action methods on the agent, until the agent has returned its final response.</p><p id="aac1" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">So, let us setup our agent inside the agent executor. We pass it the agent, and must also pass it the toolkit. And we are setting verbose to True so we can get an idea of what the agent is doing as it is processing our request</p><pre class="mm mn mo mp mq nz oa ob bp oc bb bk"><span id="775c" class="od oe fq oa b bg of og l oh oi">agent_executor = AgentExecutor(agent=agent, tools=toolkit, verbose=True)</span></pre><p id="af98" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">And that is it. We are now ready to pass commands to our agent</p><pre class="mm mn mo mp mq nz oa ob bp oc bb bk"><span id="1308" class="od oe fq oa b bg of og l oh oi">result = agent_executor.invoke({"input": "what is 1 + 1"})</span></pre><p id="1dad" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Let run our script, and see the agent’s output</p><pre class="mm mn mo mp mq nz oa ob bp oc bb bk"><span id="6e5f" class="od oe fq oa b bg of og l oh oi">python3 math-agent.py</span></pre><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk rb"><img src="../Images/38082f690ae8ca1409e8cac5d2270f77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*IUcFuGJ8qO4SHImQ3HPrPw.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by author</figcaption></figure><p id="ed08" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Since we have set <strong class="nf fr">verbose=True</strong> on the AgentExecutor, we can see the lines of Action our agent has taken. It has identified we should call the “<strong class="nf fr">add</strong>” tool, called the “<strong class="nf fr">add</strong>” tool with the required parameters, and returned us our result.</p><p id="4919" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">This is what the full source code looks like</p><pre class="mm mn mo mp mq nz oa ob bp oc bb bk"><span id="95cb" class="od oe fq oa b bg of og l oh oi">import os<br/><br/>from langchain.agents import AgentExecutor, create_openai_tools_agent<br/>from langchain_openai import ChatOpenAI<br/><br/>from langchain.tools import BaseTool, StructuredTool, tool<br/>from langchain_core.prompts import ChatPromptTemplate, MessagesPlaceholder<br/><br/>os.environ["OPENAI_API_KEY"] = "sk-"<br/><br/># setup the tools<br/>@tool<br/>def add(a: int, b: int) -&gt; int:<br/>    """Add two numbers."""<br/>    return a + b<br/><br/><br/>@tool<br/>def multiply(a: int, b: int) -&gt; int:<br/>    """Multiply two numbers."""<br/>    return a * b<br/><br/><br/>@tool<br/>def square(a) -&gt; int:<br/>    """Calculates the square of a number."""<br/>    a = int(a)<br/>    return a * a<br/><br/>prompt = ChatPromptTemplate.from_messages(<br/>    [<br/>        ("system", """You are a mathematical assistant.<br/>        Use your tools to answer questions. If you do not have a tool to<br/>        answer the question, say so. <br/><br/>        Return only the answers. e.g<br/>        Human: What is 1 + 1?<br/>        AI: 2<br/>        """),<br/>        MessagesPlaceholder("chat_history", optional=True),<br/>        ("human", "{input}"),<br/>        MessagesPlaceholder("agent_scratchpad"),<br/>    ]<br/>)<br/><br/># Choose the LLM that will drive the agent<br/>llm = ChatOpenAI(model="gpt-3.5-turbo-1106", temperature=0)<br/><br/># setup the toolkit<br/>toolkit = [add, multiply, square]<br/><br/># Construct the OpenAI Tools agent<br/>agent = create_openai_tools_agent(llm, toolkit, prompt)<br/><br/># Create an agent executor by passing in the agent and tools<br/>agent_executor = AgentExecutor(agent=agent, tools=toolkit, verbose=True)<br/><br/>result = agent_executor.invoke({"input": "what is 1 + 1?"})<br/><br/>print(result['output'])</span></pre><h1 id="0844" class="os oe fq bf ot ou qb gq ow ox qc gt oz pa qd pc pd pe qe pg ph pi qf pk pl pm bk">Testing our agent</h1><p id="c0cf" class="pw-post-body-paragraph nd ne fq nf b go pn nh ni gr po nk nl nm pp no np nq pq ns nt nu pr nw nx ny fj bk">Let’s shoot a few questions at our agent to see how it performs.</p><h2 id="009c" class="qg oe fq bf ot qh qi qj ow qk ql qm oz nm qn qo qp nq qq qr qs nu qt qu qv qw bk"><strong class="al">what is 5 squared?</strong></h2><p id="67f9" class="pw-post-body-paragraph nd ne fq nf b go pn nh ni gr po nk nl nm pp no np nq pq ns nt nu pr nw nx ny fj bk">Again we get the correct result, and see that it does use our <strong class="nf fr">square</strong> tool</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk rc"><img src="../Images/4da75f6cccd073be0ccf10095da58268.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pksf1RJT8ZhMeOWzjuSrzw.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by author</figcaption></figure><h2 id="cf61" class="qg oe fq bf ot qh qi qj ow qk ql qm oz nm qn qo qp nq qq qr qs nu qt qu qv qw bk">what is 5 to the power of 6?</h2><p id="c84e" class="pw-post-body-paragraph nd ne fq nf b go pn nh ni gr po nk nl nm pp no np nq pq ns nt nu pr nw nx ny fj bk">It takes an interesting course of action. It first uses the <strong class="nf fr">square</strong> tool. And then, using the result of that, tries to use the <strong class="nf fr">multiply</strong> tool a few times to get the final answer. Admittedly, the final answer, 3125, is wrong, and needs to be multiplied by 5 one more time to get the correct answer. But it is interesting to see how the agent tried to use different tools, and multiple steps to try and get to the final answer.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk rd"><img src="../Images/06605974f62a317700216b36626a3a9f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*drHVVGObrAm-EiT7bEu_lw.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by author</figcaption></figure><h2 id="6fdf" class="qg oe fq bf ot qh qi qj ow qk ql qm oz nm qn qo qp nq qq qr qs nu qt qu qv qw bk"><strong class="al">what is 1 minus 3?</strong></h2><p id="ab48" class="pw-post-body-paragraph nd ne fq nf b go pn nh ni gr po nk nl nm pp no np nq pq ns nt nu pr nw nx ny fj bk">We don’t have a minus tool. But it is smart enough to use our add tool, but set the second value to -3. Its funny and somewhat amazing sometimes how they are smart and creative like that.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk re"><img src="../Images/1c4add21cd9408cce4be6aeaa9abdd53.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RFbDogriSDQi9J_mXTyySA.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by author</figcaption></figure><h2 id="dba0" class="qg oe fq bf ot qh qi qj ow qk ql qm oz nm qn qo qp nq qq qr qs nu qt qu qv qw bk"><strong class="al">what is the square root of 64</strong></h2><p id="1c8d" class="pw-post-body-paragraph nd ne fq nf b go pn nh ni gr po nk nl nm pp no np nq pq ns nt nu pr nw nx ny fj bk">As a final test, what if we ask it to carry out a mathematical operation that is not part of our tool set? Since we have no tools for square rooting, it does not attempt to call a tool, and instead calculates the value directly using just the LLM.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk rf"><img src="../Images/670b50b68a2de3c16cf3636692a5838c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-XcM--I_tT90gzHO9TFhbQ.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by author</figcaption></figure><p id="3bfc" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Our system prompt did tell it to answer that it “does not know” if it does not have the correct tool for the job, and it did do that sometimes during testing. An improved initial system prompt could probably help resolve that, at least to some extent</p><h2 id="fef3" class="qg oe fq bf ot qh qi qj ow qk ql qm oz nm qn qo qp nq qq qr qs nu qt qu qv qw bk">Observations</h2><p id="4c5f" class="pw-post-body-paragraph nd ne fq nf b go pn nh ni gr po nk nl nm pp no np nq pq ns nt nu pr nw nx ny fj bk">Based on using the agent a bit, I noticed the following</p><ul class=""><li id="51fa" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny pt pu pv bk">when asking it direct questions which it had the tools to answer with, it was pretty consistent at using the correct tools for the job, and returning the correct answer. So, pretty reliable in that sense.</li><li id="7993" class="nd ne fq nf b go pw nh ni gr px nk nl nm py no np nq pz ns nt nu qa nw nx ny pt pu pv bk">if the question is a little complicated, for example our “5 to the power of 6” question, it does not always return the correct results.</li><li id="52cc" class="nd ne fq nf b go pw nh ni gr px nk nl nm py no np nq pz ns nt nu qa nw nx ny pt pu pv bk">it can sometimes use just the pure power of the LLM to answer our question, without invoking our tools.</li></ul><h1 id="daa9" class="os oe fq bf ot ou qb gq ow ox qc gt oz pa qd pc pd pe qe pg ph pi qf pk pl pm bk">The Future</h1><p id="35f1" class="pw-post-body-paragraph nd ne fq nf b go pn nh ni gr po nk nl nm pp no np nq pq ns nt nu pr nw nx ny fj bk">Agents, and programs that can reason from themselves, are a new paradigm in programming, and I think they are going to become a much more mainstream part of how lots of things are built. Obviously the non-deterministic (i.e not wholly predictable) nature of LLM’s means that agents results will also suffer from this, questioning how much we can rely on them for tasks where we need to be sure of the answers we have.</p><p id="d8b0" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Perhaps as the technology matures, their results can be more and more predictable, and we may develop some work arounds for this.</p><p id="bf82" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">I can also see agent type libraries and packages starting to become a thing. Similar to how we install third party libraries and packages into software, for example via the pip package manager for python, or Docker Hub for docker images, I wonder if we may start to see a library and package manager of agents start being developed, with agents developed that become very good at their specific tasks, which we can then also install as packages into out application.</p><p id="e172" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Indeed LangChain’s <a class="af nc" href="https://python.langchain.com/docs/integrations/toolkits/" rel="noopener ugc nofollow" target="_blank">library of Toolkits</a> for agents to use, listed on their Integrations page, are sets of Tools built by the community for people to use, which could be an early example of agent type libraries built by the community.</p><h1 id="c1a5" class="os oe fq bf ot ou qb gq ow ox qc gt oz pa qd pc pd pe qe pg ph pi qf pk pl pm bk">Conclusion</h1><p id="a406" class="pw-post-body-paragraph nd ne fq nf b go pn nh ni gr po nk nl nm pp no np nq pq ns nt nu pr nw nx ny fj bk">Hope this was a useful introduction into getting you started building with agents in LangChain.</p><p id="ad25" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Remember, agents are basically just a brain (the LLM), and a bunch of tools, which they can use to get stuff done in the world around us.</p><p id="8046" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Happy hacking!</p></div></div></div><div class="ab cb oj ok ol om" role="separator"><span class="on by bm oo op oq"/><span class="on by bm oo op oq"/><span class="on by bm oo op"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="df4d" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><em class="or">If you enjoyed the article, and would like to stay up to date on future articles I release about building things with LangChain and AI tools, do </em><a class="af nc" href="https://medium.com/@ssmaameri/subscribe" rel="noopener"><em class="or">subscribe here</em></a><em class="or"> to be notified by email when they come out</em></p></div></div></div></div>    
</body>
</html>