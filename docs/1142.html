<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Text to Knowledge Graph Made Easy with Graph Maker</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Text to Knowledge Graph Made Easy with Graph Maker</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/text-to-knowledge-graph-made-easy-with-graph-maker-f3f890c0dbe8?source=collection_archive---------0-----------------------#2024-05-07">https://towardsdatascience.com/text-to-knowledge-graph-made-easy-with-graph-maker-f3f890c0dbe8?source=collection_archive---------0-----------------------#2024-05-07</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="9edb" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">An open-source library for building knowledge graphs from text corpus using open-source LLMs like Llama 3 and Mixtral.</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@rahul.nyk?source=post_page---byline--f3f890c0dbe8--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Rahul Nayak" class="l ep by dd de cx" src="../Images/9f8aa2f9af4e02b31c114222756489e5.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*NzMhL3DK3bfRupgYc8QsAw.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--f3f890c0dbe8--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://medium.com/@rahul.nyk?source=post_page---byline--f3f890c0dbe8--------------------------------" rel="noopener follow">Rahul Nayak</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--f3f890c0dbe8--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">11 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">May 7, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj lc ld ab q ee le lf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count la lb">15</span></p></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lg k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lh an ao ap id li lj lk" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep ll cn"><div class="l ae"><div class="ab cb"><div class="lm ln lo lp lq lr ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div></div></div><div class="mj bh"><figure class="mk ml mm mn mo mj bh paragraph-image"><img src="../Images/f16f965b89f5a55a880765fbab232f08.png" data-original-src="https://miro.medium.com/v2/resize:fit:4800/format:webp/1*5VFKT7FPjzE_MkQMq3NXfA.png"/><figcaption class="mq mr ms mt mu mv mw bf b bg z dx">Image generated by the Author using Adobe Photoshop</figcaption></figure></div><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="d826" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk nt"><span class="l nu nv nw bo nx ny nz oa ob ed">In</span> this article, I will share a Python library — the Graph Maker — that can create a Knowledge Graph from a corpus of text as per a given Ontology. The Graph Maker uses open-source LLMs like Llama3, Mistral, Mixtral or Gemma to extract the KG.</p><p id="46de" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">We will go through the basics of ‘Why’ and ‘What’ of the Graph Maker, a brief recap of the previous article, and how the current approach addresses some of its challenges. I will share the GitHub repository at the end of this article.</p><h1 id="f112" class="oc od fq bf oe of og gq oh oi oj gt ok ol om on oo op oq or os ot ou ov ow ox bk">Introduction</h1><p id="2d13" class="pw-post-body-paragraph mx my fq mz b go oy nb nc gr oz ne nf ng pa ni nj nk pb nm nn no pc nq nr ns fj bk">This article is a sequel to the article I wrote a few months ago about how to convert any text into a Graph.</p><div class="pd pe pf pg ph pi"><a rel="noopener follow" target="_blank" href="/how-to-convert-any-text-into-a-graph-of-concepts-110844f22a1a?source=post_page-----f3f890c0dbe8--------------------------------"><div class="pj ab ig"><div class="pk ab co cb pl pm"><h2 class="bf fr hw z io pn iq ir po it iv fp bk">How to Convert Any Text Into a Graph of Concepts</h2><div class="pp l"><h3 class="bf b hw z io pn iq ir po it iv dx">A method to convert any text corpus into a Knowledge Graph using Mistral 7B.</h3></div><div class="pq l"><p class="bf b dy z io pn iq ir po it iv dx">towardsdatascience.com</p></div></div><div class="pr l"><div class="ps l pt pu pv pr pw lr pi"/></div></div></a></div><p id="43af" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">The article received an overwhelming response. The GitHub repository shared in the article has more than 180 Forks and more than 900 Stars. The article itself was read by more than 80K readers on the Medium. Recently the article was attributed in the following paper published by Prof Markus J. Buehler at MIT.</p><div class="pd pe pf pg ph pi"><a href="https://arxiv.org/abs/2403.11996?source=post_page-----f3f890c0dbe8--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="pj ab ig"><div class="pk ab co cb pl pm"><h2 class="bf fr hw z io pn iq ir po it iv fp bk">Accelerating Scientific Discovery with Generative Knowledge Extraction, Graph-Based Representation…</h2><div class="pp l"><h3 class="bf b hw z io pn iq ir po it iv dx">Leveraging generative Artificial Intelligence (AI), we have transformed a dataset comprising 1,000 scientific papers…</h3></div><div class="pq l"><p class="bf b dy z io pn iq ir po it iv dx">arxiv.org</p></div></div><div class="pr l"><div class="px l pt pu pv pr pw lr pi"/></div></div></a></div><p id="fabc" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">This is a fascinating paper that demonstrates the gigantic potential of Knowledge Graphs in the era of AI. It demonstrates how KGs can be used, not only to retrieve knowledge but also to discover new knowledge. Here is one of my favourite excerpts from this paper.</p><blockquote class="py"><p id="40d5" class="pz qa fq bf qb qc qd qe qf qg qh ns dx">“For instance, we will show how this approach can relate seemingly disparate concepts such as Beethoven’s 9th symphony with bio-inspired materials science”</p></blockquote><p id="8467" class="pw-post-body-paragraph mx my fq mz b go qi nb nc gr qj ne nf ng qk ni nj nk ql nm nn no qm nq nr ns fj bk">These developments are a big reaffirmation of the ideas I presented in the previous article and encouraged me to develop the ideas further.</p><p id="d5c3" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">I also received numerous feedback from fellow techies about the challenges they encountered while using the repository, and suggestions for improving the idea. I incorporated some of these suggestions into a new Python package I share here.</p><p id="2b18" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">Before we discuss the working of the package — The Graph Maker — let us discuss the ‘Why’ and the ‘What’ of it.</p><h1 id="1170" class="oc od fq bf oe of og gq oh oi oj gt ok ol om on oo op oq or os ot ou ov ow ox bk">A Brief Recap</h1><p id="3f3a" class="pw-post-body-paragraph mx my fq mz b go oy nb nc gr oz ne nf ng pa ni nj nk pb nm nn no pc nq nr ns fj bk">We should probably start with ‘Why Graphs’. However, We discussed this briefly in my <a class="af qn" href="https://medium.com/towards-data-science/how-to-convert-any-text-into-a-graph-of-concepts-110844f22a1a" rel="noopener">previous article</a>. Feel free to hop onto that article for a refresher. However, let us briefly discuss the key concepts that are relevant to our current discussion here.</p><p id="7393" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk"><strong class="mz fr">TL;DR this section if you are already well versed in the lore of Knowledge Graphs.</strong></p><p id="842b" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">Here is an illustration that sums up the idea of Knowledge Graphs neatly.</p><figure class="mk ml mm mn mo mj mt mu paragraph-image"><div role="button" tabindex="0" class="qp qq ed qr bh qs"><div class="mt mu qo"><img src="../Images/59d71971200611f5a682adfa61e54a89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Y-Xg4XeFLdhq4ketjIKbw.png"/></div></div><figcaption class="mq mr ms mt mu mv mw bf b bg z dx">Source: <a class="af qn" href="https://arxiv.org/abs/2403.11996" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/2403.11996</a></figcaption></figure><p id="0366" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">To create a KG, we need two pieces of information.</p><ol class=""><li id="9d36" class="mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns qt qu qv bk"><strong class="mz fr">Knowledge Base</strong>: This can be a corpus of text, a code base, a collection of articles, etc.</li><li id="dc99" class="mx my fq mz b go qw nb nc gr qx ne nf ng qy ni nj nk qz nm nn no ra nq nr ns qt qu qv bk"><strong class="mz fr">Ontology</strong>: The categories of the entities, and the types of their relationships we care about. I am probably oversimplifying the definition of ontology here but it works for our purpose.</li></ol><p id="72ff" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">Here is a simple ontology</p><p id="d680" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk"><strong class="mz fr">Entities</strong>: <em class="rb">Person, Place</em><br/><strong class="mz fr">Relationships: </strong><br/><em class="rb">Person —</em> related to → <em class="rb">Person</em><br/><em class="rb">Person</em> — lives in → <em class="rb">Place<br/>Person</em> — visits → <em class="rb">Place</em></p><p id="30be" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">Given these two pieces of information, we can build a KG from a text that mentions people and places. However, let’s say our knowledge base is about a clinical study of prescription drugs and their interactions. We might use a different ontology where Compounds, Usage, Effects, Reactions etc may form our ontology.</p><p id="d518" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">In the previous article, we discussed <a class="af qn" rel="noopener" target="_blank" href="/how-to-convert-any-text-into-a-graph-of-concepts-110844f22a1a"><strong class="mz fr">How we can extract a Knowledge Graph using an LLM, without supplying it with an ontology</strong></a>. The idea was to let the LLM discover the ontology best suited for the given corpus of text by itself.</p><p id="27b0" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">Although this approach lacks the rigour of the traditional methods of generating KGs, it has its merits. It can generate KGs with unstructured data more easily than traditional methods. The KGs that it generates are, in some sense, also unstructured. However, they are easier to build and are richer in information. They are well suited for GRAG (Graph Retrieval Augmented Generation) like applications.</p><h1 id="a05e" class="oc od fq bf oe of og gq oh oi oj gt ok ol om on oo op oq or os ot ou ov ow ox bk">Why The Graph Maker?</h1><p id="4538" class="pw-post-body-paragraph mx my fq mz b go oy nb nc gr oz ne nf ng pa ni nj nk pb nm nn no pc nq nr ns fj bk">Let me list a few challenges and observations I received in the feedback for my previous article. It will help us understand the challenges in creating KGs with LLMs. Let us use the Wikipedia summary of the <strong class="mz fr">Lord of the Rings </strong>books. One cant not love the Lord of the Rings after all!</p><h2 id="608f" class="rc od fq bf oe rd re rf oh rg rh ri ok ng rj rk rl nk rm rn ro no rp rq rr rs bk">Meaningful Entities</h2><p id="2574" class="pw-post-body-paragraph mx my fq mz b go oy nb nc gr oz ne nf ng pa ni nj nk pb nm nn no pc nq nr ns fj bk">Given a free run, the entities that the LLM extracts can be too diverse in their categories. It mistakes by marking abstract concepts as entities. For example in the text “Bilbo Baggins celebrates his birthday and leaves the Ring to Frodo”, the LLM may extract “Bilbo Baggins celebrates his birthday” or “Celebrates his birthday” as ‘Action’. But it may be more useful if it extracts “Birthday” as an ‘Event’.</p><h2 id="3a63" class="rc od fq bf oe rd re rf oh rg rh ri ok ng rj rk rl nk rm rn ro no rp rq rr rs bk"><strong class="al">Consistent Entities</strong></h2><p id="d4f4" class="pw-post-body-paragraph mx my fq mz b go oy nb nc gr oz ne nf ng pa ni nj nk pb nm nn no pc nq nr ns fj bk">It can also mistake marking the same entity differently in different contexts. For example:</p><p id="eeac" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk"><strong class="mz fr">‘<em class="rb">Sauron’</em></strong>, <strong class="mz fr">‘<em class="rb">the Dark Lord Sauron’</em></strong><em class="rb"> </em>and<em class="rb"> </em><strong class="mz fr"><em class="rb">‘the Dark Lord’</em></strong><em class="rb"> </em>Should not be extracted as different entities. Or if they are extracted as different entities, they should be connected with an equivalence relationship.</p><h2 id="0c1a" class="rc od fq bf oe rd re rf oh rg rh ri ok ng rj rk rl nk rm rn ro no rp rq rr rs bk"><strong class="al">Resilience in parsing</strong></h2><p id="da2e" class="pw-post-body-paragraph mx my fq mz b go oy nb nc gr oz ne nf ng pa ni nj nk pb nm nn no pc nq nr ns fj bk">The output of the LLMs is, by nature, indeterministic. To extract the KG from a large document, we must split the corpus into smaller text chunks and then generate subgraphs for every chunk. To build a consistent graph, the LLM must output JSON objects as per the given schema consistently for every subgraph. Missing even one may affect the connectivity of the entire graph adversely.</p><p id="c9cf" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">Although LLMs are getting better at responding with well-formatted JSON objects, It is still far from perfect. LLMs with limited context windows may also generate incomplete responses.</p><h2 id="c2de" class="rc od fq bf oe rd re rf oh rg rh ri ok ng rj rk rl nk rm rn ro no rp rq rr rs bk"><strong class="al">Categorisation of the Entities</strong></h2><p id="981b" class="pw-post-body-paragraph mx my fq mz b go oy nb nc gr oz ne nf ng pa ni nj nk pb nm nn no pc nq nr ns fj bk">LLMs can error generously when recognising entities. This is a bigger problem when the context is domain-specific, or when the entities are not named in standard English. NER models can do better at that, but they too are limited to the data they are trained on. Moreover, they can’t understand the relations between the entities.</p><p id="9889" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">To coerce an LLM to be consistent with categories is an art in prompt engineering.</p><h2 id="a72f" class="rc od fq bf oe rd re rf oh rg rh ri ok ng rj rk rl nk rm rn ro no rp rq rr rs bk"><strong class="al">Implied relations</strong></h2><p id="c713" class="pw-post-body-paragraph mx my fq mz b go oy nb nc gr oz ne nf ng pa ni nj nk pb nm nn no pc nq nr ns fj bk">Relations can be explicitly mentioned, or implied by the context. For example:</p><p id="0630" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">“Bilbo Baggins celebrates his birthday and leaves the Ring to Frodo” implies the relationships:<br/><em class="rb">Bilbo Baggins </em>→ Owner → <em class="rb">Ring</em><br/><em class="rb">Bilbo Baggins </em>→ heir → <em class="rb">Frodo</em><br/><em class="rb">Frodo</em> → Owner → <em class="rb">Ring</em></p><p id="5d3e" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">Here I think LLMs at some point in time will become better than any traditional method of extracting relationships. But as of now, this is a challenge that needs clever prompt engineering.</p></div></div></div><div class="ab cb rt ru rv rw" role="separator"><span class="rx by bm ry rz sa"/><span class="rx by bm ry rz sa"/><span class="rx by bm ry rz"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="6f5d" class="oc od fq bf oe of sb gq oh oi sc gt ok ol sd on oo op se or os ot sf ov ow ox bk">The Graph Maker</h1><p id="4345" class="pw-post-body-paragraph mx my fq mz b go oy nb nc gr oz ne nf ng pa ni nj nk pb nm nn no pc nq nr ns fj bk">The graph maker library I share here improves upon the previous approach by travelling halfway between the rigour and the ease — halfway between the structure and the lack of it. It does remarkably better than the previous approach I discussed on most of the above challenges.</p><p id="8492" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">As opposed to the previous approach, where the LLM is free to discover the ontology by itself, the graph maker tries to coerce the LLM to use a user-defined ontology.</p><p id="2318" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">We can install the knowledge graph maker library with a simple pip command</p><pre class="mk ml mm mn mo sg sh si bp sj bb bk"><span id="5597" class="sk od fq sh b bg sl sm l sn so">pip install knowledge-graph-maker</span></pre><div class="pd pe pf pg ph pi"><a href="https://pypi.org/project/knowledge-graph-maker/?source=post_page-----f3f890c0dbe8--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="pj ab ig"><div class="pk ab co cb pl pm"><h2 class="bf fr hw z io pn iq ir po it iv fp bk">knowledge-graph-maker</h2><div class="pp l"><h3 class="bf b hw z io pn iq ir po it iv dx">Create a knowledge graph out of any text using a given ontology</h3></div><div class="pq l"><p class="bf b dy z io pn iq ir po it iv dx">pypi.org</p></div></div><div class="pr l"><div class="sp l pt pu pv pr pw lr pi"/></div></div></a></div><p id="0432" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">Here is how it works in 5 easy steps.</p><blockquote class="sq sr ss"><p id="698f" class="mx my rb mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">These steps are coded in a notebook that I share at the end of this article.</p></blockquote><h2 id="07b1" class="rc od fq bf oe rd re rf oh rg rh ri ok ng rj rk rl nk rm rn ro no rp rq rr rs bk">1. Define the Ontology of your Graph</h2><p id="4463" class="pw-post-body-paragraph mx my fq mz b go oy nb nc gr oz ne nf ng pa ni nj nk pb nm nn no pc nq nr ns fj bk">The library understands the following schema for the Ontology. Behind the scenes, ontology is a pydantic model.</p><pre class="mk ml mm mn mo sg sh si bp sj bb bk"><span id="bc21" class="sk od fq sh b bg sl sm l sn so">ontology = Ontology(<br/># labels of the entities to be extracted. Can be a string or an object, like the following.<br/>labels=[<br/>{"Person": "Person name without any adjectives, Remember a person may be referenced by their name or using a pronoun"},<br/>{"Object": "Do not add the definite article 'the' in the object name"},<br/>{"Event": "Event event involving multiple people. Do not include qualifiers or verbs like gives, leaves, works etc."},<br/>"Place",<br/>"Document",<br/>"Organisation",<br/>"Action",<br/>{"Miscellaneous": "Any important concept can not be categorised with any other given label"},<br/>],<br/># Relationships that are important for your application.<br/># These are more like instructions for the LLM to nudge it to focus on specific relationships.<br/># There is no guarantee that only these relationships will be extracted, but some models do a good job overall at sticking to these relations.<br/>relationships=[<br/>"Relation between any pair of Entities",<br/>],<br/>)</span></pre><p id="0fec" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">I have tuned the prompts to yield results that are consistent with the given ontology. I think it does a pretty good job at it. However, it is still not 100% accurate. The accuracy depends on the model we choose to generate the graph, the application, the ontology, and the quality of the data.</p><h2 id="df9d" class="rc od fq bf oe rd re rf oh rg rh ri ok ng rj rk rl nk rm rn ro no rp rq rr rs bk">2. Split the text into chunks.</h2><p id="e996" class="pw-post-body-paragraph mx my fq mz b go oy nb nc gr oz ne nf ng pa ni nj nk pb nm nn no pc nq nr ns fj bk">We can use as large a corpus of text as we want to create large knowledge graphs. However, LLMs have a finite context window right now. So we need to chunk the text appropriately and create the graph one chunk at a time. The chunk size that we should use depends on the model context window. The prompts that are used in this project eat up around 500 tokens. The rest of the context can be divided into input text and output graph. In my experience, smaller chunks of 200 to 500 tokens generate a more detailed graph.</p><h2 id="5209" class="rc od fq bf oe rd re rf oh rg rh ri ok ng rj rk rl nk rm rn ro no rp rq rr rs bk">3. Convert these chunks into Documents.</h2><p id="827d" class="pw-post-body-paragraph mx my fq mz b go oy nb nc gr oz ne nf ng pa ni nj nk pb nm nn no pc nq nr ns fj bk">The document is a pydantic model with the following schema</p><pre class="mk ml mm mn mo sg sh si bp sj bb bk"><span id="c1af" class="sk od fq sh b bg sl sm l sn so">## Pydantic document model<br/>class Document(BaseModel):<br/>  text: str<br/>  metadata: dict</span></pre><p id="f12c" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">The metadata we add to the document here is tagged to every relation that is extracted out of the document.</p><p id="d9cd" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">We can add the context of the relation, for example, the page number, chapter, the name of the article, etc. into the metadata. More often than not, Each node pairs have multiple relations with each other across multiple documents. The metadata helps contextualise these relationships.</p><h2 id="6143" class="rc od fq bf oe rd re rf oh rg rh ri ok ng rj rk rl nk rm rn ro no rp rq rr rs bk">4. Run the Graph Maker.</h2><p id="9880" class="pw-post-body-paragraph mx my fq mz b go oy nb nc gr oz ne nf ng pa ni nj nk pb nm nn no pc nq nr ns fj bk">The Graph Maker directly takes a list of documents and iterates over each of them to create one subgraph per document. The final output is the complete graph of all the documents.</p><p id="29e2" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">Here is a simple example of how to achieve this.</p><pre class="mk ml mm mn mo sg sh si bp sj bb bk"><span id="4cfd" class="sk od fq sh b bg sl sm l sn so"><br/>from knowledge_graph_maker import GraphMaker, Ontology, GroqClient<br/><br/>## -&gt; Select a groq supported model<br/>model = "mixtral-8x7b-32768"<br/># model ="llama3–8b-8192"<br/># model = "llama3–70b-8192"<br/># model="gemma-7b-it" ## This is probably the fastest of all models, though a tad inaccurate.<br/><br/>## -&gt; Initiate the Groq Client.<br/>llm = GroqClient(model=model, temperature=0.1, top_p=0.5)<br/>graph_maker = GraphMaker(ontology=ontology, llm_client=llm, verbose=False)<br/><br/>## -&gt; Create a graph out of a list of Documents.<br/>graph = graph_maker.from_documents(docs)<br/>## result: a list of Edges.<br/><br/>print("Total number of Edges", len(graph))<br/>## 1503</span></pre><p id="420a" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">The Graph Makers run each document through the LLM and parse the response to create the complete graph. The final graph is as a list of edges, where every edge is a pydantic model like the following.</p><pre class="mk ml mm mn mo sg sh si bp sj bb bk"><span id="655b" class="sk od fq sh b bg sl sm l sn so">class Node(BaseModel):<br/>  label: str<br/>  name: str<br/> <br/>class Edge(BaseModel):<br/>  node_1: Node<br/>  node_2: Node<br/>  relationship: str<br/>  metadata: dict = {}<br/>  order: Union[int, None] = None</span></pre><p id="47bc" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">I have tuned the prompts so they generate fairly consistent JSONs now. In case the JSON response fails to parse, the graph maker also tries to manually split the JSON string into multiple strings of edges and then tries to salvage whatever it can.</p><h2 id="e98c" class="rc od fq bf oe rd re rf oh rg rh ri ok ng rj rk rl nk rm rn ro no rp rq rr rs bk">5. Save to Neo4j</h2><p id="4d6f" class="pw-post-body-paragraph mx my fq mz b go oy nb nc gr oz ne nf ng pa ni nj nk pb nm nn no pc nq nr ns fj bk">We can save the model to Neo4j either to create an RAG application, run Network algorithms, or maybe just visualise the graph using <a class="af qn" href="https://neo4j.com/product/bloom/" rel="noopener ugc nofollow" target="_blank">the Bloom</a></p><pre class="mk ml mm mn mo sg sh si bp sj bb bk"><span id="8130" class="sk od fq sh b bg sl sm l sn so">from knowledge_graph_maker import Neo4jGraphModel<br/>create_indices = False<br/>neo4j_graph = Neo4jGraphModel(edges=graph, create_indices=create_indices)<br/>neo4j_graph.save()</span></pre><p id="feb3" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">Each edge of the graph is saved to the database as a transaction. If you are running this code for the first time, then set the `create_indices` to true. This prepares the database by setting up the uniqueness constraints on the nodes.</p><p id="91bb" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk"><strong class="mz fr"><em class="rb">5.1 Visualise, just for fun if nothing else<br/></em></strong>In the previous article, we visualised the graph using networkx and pyvis libraries. Here, because we are already saving the graph to Neo4J, we can leverage Bloom directly to visualise the graph.</p><p id="a442" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">To avoid repeating ourselves, let us generate a different visualisation from what we did in the previous article.</p><p id="6c57" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">Let’s say we like to see how the relations between the characters evolve through the book.</p><p id="905c" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">We can do this by tracking how the edges are added to the graph incrementally while the graph maker traverses through the book. To enable this, the Edge model has an attribute called ‘order’. This attribute can be used to add a temporal or chronological dimension to the graph.</p><p id="8a2b" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">In our example, the graph maker automatically adds the sequence number in which a particular text chunk occurs in the document list, to every edge it extracts from that chunk. So to see how the relations between the characters evolve, we just have to cross section the graph by the order of the edges.</p><p id="7d0c" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">Here is an animation of these cross-sections.</p></div></div><div class="mj"><div class="ab cb"><div class="lm st ln su lo sv cf sw cg sx ci bh"><figure class="mk ml mm mn mo mj sz ta paragraph-image"><div role="button" tabindex="0" class="qp qq ed qr bh qs"><div class="mt mu sy"><img src="../Images/ef0062beb0ec37c82d0bcaa3403679f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*hewFk9Tb7PfW1hag8M-i7w.gif"/></div></div><figcaption class="mq mr ms mt mu mv mw bf b bg z dx">Animation generated by the Author</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="9f86" class="oc od fq bf oe of og gq oh oi oj gt ok ol om on oo op oq or os ot ou ov ow ox bk">Graph and RAG</h1><p id="5203" class="pw-post-body-paragraph mx my fq mz b go oy nb nc gr oz ne nf ng pa ni nj nk pb nm nn no pc nq nr ns fj bk">The best application of this kind of KG is probably in RAG. There are umpteen articles on Medium on how to augment your RAG applications with Graphs.</p><p id="0eb4" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">Essentially Graphs offer a plethora of different ways to retrieve knowledge. Depending on how we design the Graph and our application, some of these techniques can be more powerful than simple semantic search.</p><p id="b93f" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">At the very basic, we can add embedding vectors into our nodes and relationships, and run a semantic search against the vector index for retrieval. However, I feel the real power of the Graphs for RAG applications is when we mix Cypher queries and Network algorithms with Semantic Search.</p><p id="a885" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">I have been exploring some of these techniques myself. I am hoping to write about them in my next article.</p><h1 id="2ff1" class="oc od fq bf oe of og gq oh oi oj gt ok ol om on oo op oq or os ot ou ov ow ox bk">The Code</h1><p id="3471" class="pw-post-body-paragraph mx my fq mz b go oy nb nc gr oz ne nf ng pa ni nj nk pb nm nn no pc nq nr ns fj bk">Here is the GitHub Repository. Please feel free to take it for a spin. I have also included an example Python notebook in the repository that can help you get started quickly.</p><blockquote class="sq sr ss"><p id="0cb9" class="mx my rb mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">Please note that you will need to add your <a class="af qn" href="https://console.groq.com/keys" rel="noopener ugc nofollow" target="_blank">GROQ credentials</a> in the <strong class="mz fr"><em class="fq">.env</em></strong> file before you can get started.</p></blockquote><div class="pd pe pf pg ph pi"><a href="https://github.com/rahulnyk/graph_maker?source=post_page-----f3f890c0dbe8--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="pj ab ig"><div class="pk ab co cb pl pm"><h2 class="bf fr hw z io pn iq ir po it iv fp bk">GitHub - rahulnyk/graph_maker</h2><div class="pp l"><h3 class="bf b hw z io pn iq ir po it iv dx">Contribute to rahulnyk/graph_maker development by creating an account on GitHub.</h3></div><div class="pq l"><p class="bf b dy z io pn iq ir po it iv dx">github.com</p></div></div><div class="pr l"><div class="tb l pt pu pv pr pw lr pi"/></div></div></a></div><p id="8431" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">Initially, I developed this codebase for a few of my pet projects. I feel it can be helpful for many more applications. If you use this library for your applications, please share it with me. I would love to learn about your use cases.</p><p id="9b82" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">Also if you feel you can contribute to this open source project, please do so and make it your own.</p><p id="27ed" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">I hope you find the graph maker useful. Thanks for reading.</p></div></div></div><div class="ab cb rt ru rv rw" role="separator"><span class="rx by bm ry rz sa"/><span class="rx by bm ry rz sa"/><span class="rx by bm ry rz"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="8e62" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">I am a learner of architecture (not the buildings… the tech kind). In the past, I have worked with Semiconductor modelling, Digital circuit design, Electronic Interface modelling, and the Internet of Things.</p><p id="f765" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">Currently, Data and Consumer Analytics @Walmart Keeps me busy.</p><p id="b124" class="pw-post-body-paragraph mx my fq mz b go na nb nc gr nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns fj bk">Thanks</p></div></div></div></div>    
</body>
</html>