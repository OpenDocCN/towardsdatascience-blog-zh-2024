<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>LLM Agents Demystified</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>LLM Agents Demystified</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/llm-agents-demystified-8e2a62c185fa?source=collection_archive---------1-----------------------#2024-07-14">https://towardsdatascience.com/llm-agents-demystified-8e2a62c185fa?source=collection_archive---------1-----------------------#2024-07-14</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="35c1" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">Hands-on ReAct agent implementation with AdalFlow library</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://liyin2015.medium.com/?source=post_page---byline--8e2a62c185fa--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Li Yin" class="l ep by dd de cx" src="../Images/ef856165bfb90c952ed7d16da42e28ee.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*_vXMnU_XfxG1DshMPuCGXg@2x.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--8e2a62c185fa--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://liyin2015.medium.com/?source=post_page---byline--8e2a62c185fa--------------------------------" rel="noopener follow">Li Yin</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--8e2a62c185fa--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">14 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Jul 14, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj lc ld ab q ee le lf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count la lb">1</span></p></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lg k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lh an ao ap id li lj lk" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep ll cn"><div class="l ae"><div class="ab cb"><div class="lm ln lo lp lq lr ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div></div></div><div class="mj"><div class="ab cb"><div class="lm mk ln ml lo mm cf mn cg mo ci bh"><figure class="ms mt mu mv mw mj mx my paragraph-image"><div role="button" tabindex="0" class="mz na ed nb bh nc"><div class="mp mq mr"><img src="../Images/377c1a54d2816cd3209bda5a881ca73e.png" data-original-src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*hzFJZvrGG0dEJ9u5lmMIPA.jpeg"/></div></div><figcaption class="ne nf ng mp mq nh ni bf b bg z dx"><a class="af nj" href="https://unsplash.com/photos/an-abstract-image-of-a-sphere-with-dots-and-lines-nGoCBxiaRO0" rel="noopener ugc nofollow" target="_blank">Image source</a>, credits to <a class="af nj" href="https://unsplash.com/@growtika" rel="noopener ugc nofollow" target="_blank">Growtika</a></figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="6132" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">AdalFlow library: <a class="af nj" href="https://github.com/SylphAI-Inc/AdalFlow" rel="noopener ugc nofollow" target="_blank">https://github.com/SylphAI-Inc/AdalFlow</a><br/><a class="af nj" href="https://colab.research.google.com/drive/1mpocvG8lPyW1ISOK7SJ4bCt9KmQCP0SJ?usp=sharing" rel="noopener ugc nofollow" target="_blank"><strong class="nm fr">Colab notebook</strong></a></p><p id="ac41" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk"><em class="og">“An autonomous agent is a system situated within and a part of an environment that senses that environment and acts on it, over time, in pursuit of its own agenda and so as to effect what it senses in the future.”</em></p><p id="707e" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk"><em class="og">— Franklin and Graesser (1997)</em></p><p id="d0d6" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">Alongside the well-known RAGs, agents <a class="af nj" href="https://lightrag.sylph.ai/tutorials/agent.html#id3" rel="noopener ugc nofollow" target="_blank">[1]</a> are another popular family of LLM applications. What makes agents stand out is their ability to reason, plan, and act via accessible tools. When it comes to implementation, AdalFlow has simplified it down to a generator that can use tools, taking multiple steps (sequential or parallel) to complete a user query.</p><h1 id="e87d" class="oh oi fq bf oj ok ol gq om on oo gt op oq or os ot ou ov ow ox oy oz pa pb pc bk">What is ReAct Agent?</h1><p id="b0f0" class="pw-post-body-paragraph nk nl fq nm b go pd no np gr pe nr ns nt pf nv nw nx pg nz oa ob ph od oe of fj bk">We will first introduce ReAct <a class="af nj" href="https://lightrag.sylph.ai/tutorials/agent.html#id4" rel="noopener ugc nofollow" target="_blank">[2]</a>, a general paradigm for building agents with a sequential of interleaving thought, action, and observation steps.</p><ul class=""><li id="69ff" class="nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of pi pj pk bk"><strong class="nm fr">Thought</strong>: The reasoning behind taking an action.</li><li id="6fd2" class="nk nl fq nm b go pl no np gr pm nr ns nt pn nv nw nx po nz oa ob pp od oe of pi pj pk bk"><strong class="nm fr">Action</strong>: The action to take from a predefined set of actions. In particular, these are the tools/functional tools we have introduced in <a class="af nj" href="https://lightrag.sylph.ai/tutorials/tool_helper.html" rel="noopener ugc nofollow" target="_blank">tools</a>.</li><li id="2978" class="nk nl fq nm b go pl no np gr pm nr ns nt pn nv nw nx po nz oa ob pp od oe of pi pj pk bk"><strong class="nm fr">Observation</strong>: The simplest scenario is the execution result of the action in string format. To be more robust, this can be defined in any way that provides the right amount of execution information for the LLM to plan the next step.</li></ul><h1 id="8f1b" class="oh oi fq bf oj ok ol gq om on oo gt op oq or os ot ou ov ow ox oy oz pa pb pc bk">Prompt and Data Models</h1><p id="9373" class="pw-post-body-paragraph nk nl fq nm b go pd no np gr pe nr ns nt pf nv nw nx pg nz oa ob ph od oe of fj bk"><code class="cx pq pr ps pt b"><a class="af nj" href="https://lightrag.sylph.ai/apis/components/components.agent.react.html#components.agent.react.DEFAULT_REACT_AGENT_SYSTEM_PROMPT" rel="noopener ugc nofollow" target="_blank"><strong class="nm fr">DEFAULT_REACT_AGENT_SYSTEM_PROMPT</strong></a></code> is the default prompt for React agent’s LLM planner. We can categorize the prompt template into four parts:</p><ol class=""><li id="f48f" class="nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of pu pj pk bk">Task description</li></ol><p id="e47e" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">This part is the overall role setup and task description for the agent.</p><pre class="ms mt mu mv mw pv pt pw bp px bb bk"><span id="ec3b" class="py oi fq pt b bg pz qa l qb qc">task_desc = r"""You are a helpful assistant.<br/>Answer the user's query using the tools provided below with minimal steps and maximum accuracy.<br/>Each step you will read the previous Thought, Action, and Observation(execution result of the action) and then provide the next Thought and Action."""</span></pre><p id="088c" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">2. Tools, output format, and example</p><p id="031d" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">This part of the template is exactly the same as how we were calling functions in the <a class="af nj" href="https://lightrag.sylph.ai/tutorials/tool_helper.html" rel="noopener ugc nofollow" target="_blank">tools</a>. The <code class="cx pq pr ps pt b">output_format_str</code> is generated by <code class="cx pq pr ps pt b">FunctionExpression</code> via <code class="cx pq pr ps pt b">JsonOutputParser</code>. It includes the actual output format and examples of a list of <code class="cx pq pr ps pt b">FunctionExpression</code> instances. We use <code class="cx pq pr ps pt b">thought</code> and <code class="cx pq pr ps pt b">action</code> fields of the <code class="cx pq pr ps pt b">FunctionExpression</code> as the agent’s response.</p><pre class="ms mt mu mv mw pv pt pw bp px bb bk"><span id="efd3" class="py oi fq pt b bg pz qa l qb qc">tools = r"""{% if tools %}<br/>&lt;TOOLS&gt;<br/>{% for tool in tools %}<br/>{{ loop.index }}.<br/>{{tool}}<br/>------------------------<br/>{% endfor %}<br/>&lt;/TOOLS&gt;<br/>{% endif %}<br/>{{output_format_str}}"""</span></pre><p id="9fad" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">3. Task specification to teach the planner how to “think”.</p><p id="5336" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">We provide more detailed instruction to ensure the agent will always end with ‘finish’ action to complete the task. Additionally, we teach it how to handle simple queries and complex queries.</p><ul class=""><li id="f342" class="nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of pi pj pk bk">For simple queries, we instruct the agent to finish with as few steps as possible.</li><li id="8fa6" class="nk nl fq nm b go pl no np gr pm nr ns nt pn nv nw nx po nz oa ob pp od oe of pi pj pk bk">For complex queries, we teach the agent a ‘divide-and-conquer’ strategy to solve the query step by step.</li></ul><pre class="ms mt mu mv mw pv pt pw bp px bb bk"><span id="c809" class="py oi fq pt b bg pz qa l qb qc">task_spec = r"""&lt;TASK_SPEC&gt;<br/>- For simple queries: Directly call the ``finish`` action and provide the answer.<br/>- For complex queries:<br/>   - Step 1: Read the user query and potentially divide it into subqueries. And get started with the first subquery.<br/>   - Call one available tool at a time to solve each subquery/subquestion. \<br/>   - At step 'finish', join all subqueries answers and finish the task.<br/>Remember:<br/>- Action must call one of the above tools with name. It can not be empty.<br/>- You will always end with 'finish' action to finish the task. The answer can be the final answer or failure message.<br/>&lt;/TASK_SPEC&gt;"""</span></pre><p id="a1d3" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">We put all these three parts together to be within the <code class="cx pq pr ps pt b">&lt;SYS&gt;&lt;/SYS&gt;</code> tag.</p><p id="f43a" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">4. Agent step history.</p><p id="6029" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">We use <code class="cx pq pr ps pt b"><a class="af nj" href="https://lightrag.sylph.ai/apis/core/core.types.html#core.types.StepOutput" rel="noopener ugc nofollow" target="_blank"><strong class="nm fr">StepOutput</strong></a></code> to record the agent’s step history, including:</p><ul class=""><li id="826a" class="nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of pi pj pk bk"><code class="cx pq pr ps pt b">action</code>: This will be the <code class="cx pq pr ps pt b">FunctionExpression</code> instance predicted by the agent.</li><li id="6632" class="nk nl fq nm b go pl no np gr pm nr ns nt pn nv nw nx po nz oa ob pp od oe of pi pj pk bk"><code class="cx pq pr ps pt b">observation</code>: The execution result of the action.</li></ul><p id="16f3" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">In particular, we format the steps history after the user query as follows:</p><pre class="ms mt mu mv mw pv pt pw bp px bb bk"><span id="7a13" class="py oi fq pt b bg pz qa l qb qc">step_history = r"""User query:<br/>{{ input_str }}<br/>{# Step History #}<br/>{% if step_history %}<br/>&lt;STEPS&gt;<br/>{% for history in step_history %}<br/>Step {{ loop.index }}.<br/>"Thought": "{{history.action.thought}}",<br/>"Action": "{{history.action.action}}",<br/>"Observation": "{{history.observation}}"<br/>------------------------<br/>{% endfor %}<br/>&lt;/STEPS&gt;<br/>{% endif %}<br/>You:"""</span></pre><h1 id="411a" class="oh oi fq bf oj ok ol gq om on oo gt op oq or os ot ou ov ow ox oy oz pa pb pc bk">Tools</h1><p id="da4d" class="pw-post-body-paragraph nk nl fq nm b go pd no np gr pe nr ns nt pf nv nw nx pg nz oa ob ph od oe of fj bk">In addition to the tools provided by users, by default, we add a new tool named <code class="cx pq pr ps pt b">finish</code> to allow the agent to stop and return the final answer.</p><pre class="ms mt mu mv mw pv pt pw bp px bb bk"><span id="078e" class="py oi fq pt b bg pz qa l qb qc">def finish(answer: str) -&gt; str:<br/>   """Finish the task with answer."""<br/>   return answer</span></pre><p id="edc8" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">Simply returning a string might not fit all scenarios, and we might consider allowing users to define their own finish function in the future for more complex cases.</p><p id="196c" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">Additionally, since the provided tools cannot always solve user queries, we allow users to configure if an LLM model should be used to solve a subquery via the <code class="cx pq pr ps pt b">add_llm_as_fallback</code> parameter. This LLM will use the same model client and model arguments as the agent’s planner. Here is our code to specify the fallback LLM tool:</p><pre class="ms mt mu mv mw pv pt pw bp px bb bk"><span id="5ede" class="py oi fq pt b bg pz qa l qb qc">_additional_llm_tool = (<br/>   Generator(model_client=model_client, model_kwargs=model_kwargs)<br/>   if self.add_llm_as_fallback<br/>   else None<br/>)<br/><br/>def llm_tool(input: str) -&gt; str:<br/>   """I answer any input query with llm's world knowledge. Use me as a fallback tool or when the query is simple."""<br/>   # use the generator to answer the query<br/>   try:<br/>         output: GeneratorOutput = _additional_llm_tool(<br/>            prompt_kwargs={"input_str": input}<br/>         )<br/>         response = output.data if output else None<br/>         return response<br/>   except Exception as e:<br/>         log.error(f"Error using the generator: {e}")<br/>         print(f"Error using the generator: {e}")<br/>   return None</span></pre><h1 id="cd7d" class="oh oi fq bf oj ok ol gq om on oo gt op oq or os ot ou ov ow ox oy oz pa pb pc bk">React Agent</h1><p id="94dc" class="pw-post-body-paragraph nk nl fq nm b go pd no np gr pe nr ns nt pf nv nw nx pg nz oa ob ph od oe of fj bk">We define the class <code class="cx pq pr ps pt b"><a class="af nj" href="https://lightrag.sylph.ai/apis/components/components.agent.react.html#components.agent.react.ReActAgent" rel="noopener ugc nofollow" target="_blank"><strong class="nm fr">ReActAgent</strong></a></code> to put everything together. It will orchestrate two components:</p><ul class=""><li id="0597" class="nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of pi pj pk bk"><code class="cx pq pr ps pt b">planner</code>: A <code class="cx pq pr ps pt b">Generator</code> that works with a <code class="cx pq pr ps pt b">JsonOutputParser</code> to parse the output format and examples of the function calls using <code class="cx pq pr ps pt b">FunctionExpression</code>.</li><li id="f5a8" class="nk nl fq nm b go pl no np gr pm nr ns nt pn nv nw nx po nz oa ob pp od oe of pi pj pk bk"><code class="cx pq pr ps pt b">ToolManager</code>: Manages a given list of tools, the finish function, and the LLM tool. It is responsible for parsing and executing the functions.</li></ul><p id="d0e0" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">Additionally, it manages step_history as a list of <code class="cx pq pr ps pt b">StepOutput</code> instances for the agent’s internal state.</p><figure class="ms mt mu mv mw mj mp mq paragraph-image"><div role="button" tabindex="0" class="mz na ed nb bh nc"><div class="mp mq qd"><img src="../Images/f1e51b6cfadc9c78c5729ddecc0c5b9d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UZgNx35MrztGaFiNBv3vrw.png"/></div></div></figure><p id="39f2" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">Prompt the agent with an input query and process the steps to generate a response.</p></div></div></div><div class="ab cb qe qf qg qh" role="separator"><span class="qi by bm qj qk ql"/><span class="qi by bm qj qk ql"/><span class="qi by bm qj qk"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="b431" class="oh oi fq bf oj ok qm gq om on qn gt op oq qo os ot ou qp ow ox oy qq pa pb pc bk">Agent In Action</h1><p id="7d60" class="pw-post-body-paragraph nk nl fq nm b go pd no np gr pe nr ns nt pf nv nw nx pg nz oa ob ph od oe of fj bk">We will set up two sets of models, llama3–70b-8192 by Groq and gpt-3.5-turbo by OpenAI, to test two queries. For comparison, we will compare these with a vanilla LLM response without using the agent. Here are the code snippets:</p><pre class="ms mt mu mv mw pv pt pw bp px bb bk"><span id="e232" class="py oi fq pt b bg pz qa l qb qc">from lightrag.components.agent import ReActAgent<br/>from lightrag.core import Generator, ModelClientType, ModelClient<br/>from lightrag.utils import setup_env<br/><br/>setup_env()<br/><br/># Define tools<br/>def multiply(a: int, b: int) -&gt; int:<br/>   """<br/>   Multiply two numbers.<br/>   """<br/>   return a * b<br/>def add(a: int, b: int) -&gt; int:<br/>   """<br/>   Add two numbers.<br/>   """<br/>   return a + b<br/>def divide(a: float, b: float) -&gt; float:<br/>   """<br/>   Divide two numbers.<br/>   """<br/>   return float(a) / b<br/>llama3_model_kwargs = {<br/>   "model": "llama3-70b-8192",  # llama3 70b works better than 8b here.<br/>   "temperature": 0.0,<br/>}<br/>gpt_model_kwargs = {<br/>   "model": "gpt-3.5-turbo",<br/>   "temperature": 0.0,<br/>}<br/><br/>def test_react_agent(model_client: ModelClient, model_kwargs: dict):<br/>   tools = [multiply, add, divide]<br/>   queries = [<br/>      "What is the capital of France? and what is 465 times 321 then add 95297 and then divide by 13.2?",<br/>      "Give me 5 words rhyming with cool, and make a 4-sentence poem using them",<br/>   ]<br/>   # define a generator without tools for comparison<br/>   generator = Generator(<br/>      model_client=model_client,<br/>      model_kwargs=model_kwargs,<br/>   )<br/>   react = ReActAgent(<br/>      max_steps=6,<br/>      add_llm_as_fallback=True,<br/>      tools=tools,<br/>      model_client=model_client,<br/>      model_kwargs=model_kwargs,<br/>   )<br/>   # print(react)<br/>   for query in queries:<br/>      print(f"Query: {query}")<br/>      agent_response = react.call(query)<br/>      llm_response = generator.call(prompt_kwargs={"input_str": query})<br/>      print(f"Agent response: {agent_response}")<br/>      print(f"LLM response: {llm_response}")<br/>      print("")</span></pre><p id="11aa" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">The structure of React, including the initialization arguments and two major components: <code class="cx pq pr ps pt b">tool_manager</code> and <code class="cx pq pr ps pt b">planner</code>, is shown below.</p><pre class="ms mt mu mv mw pv pt pw bp px bb bk"><span id="8e64" class="py oi fq pt b bg pz qa l qb qc">ReActAgent(<br/>   max_steps=6, add_llm_as_fallback=True,<br/>   (tool_manager): ToolManager(Tools: [FunctionTool(fn: , async: False, definition: FunctionDefinition(func_name='multiply', func_desc='multiply(a: int, b: int) -&gt; int\n\n    Multiply two numbers.\n    ', func_parameters={'type': 'object', 'properties': {'a': {'type': 'int'}, 'b': {'type': 'int'}}, 'required': ['a', 'b']})), FunctionTool(fn: , async: False, definition: FunctionDefinition(func_name='add', func_desc='add(a: int, b: int) -&gt; int\n\n    Add two numbers.\n    ', func_parameters={'type': 'object', 'properties': {'a': {'type': 'int'}, 'b': {'type': 'int'}}, 'required': ['a', 'b']})), FunctionTool(fn: , async: False, definition: FunctionDefinition(func_name='divide', func_desc='divide(a: float, b: float) -&gt; float\n\n    Divide two numbers.\n    ', func_parameters={'type': 'object', 'properties': {'a': {'type': 'float'}, 'b': {'type': 'float'}}, 'required': ['a', 'b']})), FunctionTool(fn: .llm_tool at 0x11384b740&gt;, async: False, definition: FunctionDefinition(func_name='llm_tool', func_desc="llm_tool(input: str) -&gt; str\nI answer any input query with llm's world knowledge. Use me as a fallback tool or when the query is simple.", func_parameters={'type': 'object', 'properties': {'input': {'type': 'str'}}, 'required': ['input']})), FunctionTool(fn: .finish at 0x11382fa60&gt;, async: False, definition: FunctionDefinition(func_name='finish', func_desc='finish(answer: str) -&gt; str\nFinish the task with answer.', func_parameters={'type': 'object', 'properties': {'answer': {'type': 'str'}}, 'required': ['answer']}))], Additional Context: {})<br/>   (planner): Generator(<br/>      model_kwargs={'model': 'llama3-70b-8192', 'temperature': 0.0},<br/>      (prompt): Prompt(<br/>         template: <br/>         {# role/task description #}<br/>         You are a helpful assistant.<br/>         Answer the user's query using the tools provided below with minimal steps and maximum accuracy.<br/>         {# REACT instructions #}<br/>         Each step you will read the previous Thought, Action, and Observation(execution result of the action) and then provide the next Thought and Action.<br/>         {# Tools #}<br/>         {% if tools %}<br/>         <br/>         You available tools are:<br/>         {# tools #}<br/>         {% for tool in tools %}<br/>         {{ loop.index }}.<br/>         {{tool}}<br/>         ------------------------<br/>         {% endfor %}<br/>         <br/>         {% endif %}<br/>         {# output format and examples #}<br/>         <br/>         {{output_format_str}}<br/>         <br/>         <br/>         {# Task specification to teach the agent how to think using 'divide and conquer' strategy #}<br/>         - For simple queries: Directly call the ``finish`` action and provide the answer.<br/>         - For complex queries:<br/>            - Step 1: Read the user query and potentially divide it into subqueries. And get started with the first subquery.<br/>            - Call one available tool at a time to solve each subquery/subquestion. \<br/>            - At step 'finish', join all subqueries answers and finish the task.<br/>         Remember:<br/>         - Action must call one of the above tools with name. It can not be empty.<br/>         - You will always end with 'finish' action to finish the task. The answer can be the final answer or failure message.<br/>         <br/>         <br/>         -----------------<br/>         User query:<br/>         {{ input_str }}<br/>         {# Step History #}<br/>         {% if step_history %}<br/>         <br/>         {% for history in step_history %}<br/>         Step {{ loop.index }}.<br/>         "Thought": "{{history.action.thought}}",<br/>         "Action": "{{history.action.action}}",<br/>         "Observation": "{{history.observation}}"<br/>         ------------------------<br/>         {% endfor %}<br/>         <br/>         {% endif %}<br/>         You:, prompt_kwargs: {'tools': ['func_name: multiply\nfunc_desc: "multiply(a: int, b: int) -&gt; int\\n\\n    Multiply two numbers.\\n    "\nfunc_parameters:\n  type: object\n  properties:\n    a:\n      type: int\n    b:\n      type: int\n  required:\n  - a\n  - b\n', 'func_name: add\nfunc_desc: "add(a: int, b: int) -&gt; int\\n\\n    Add two numbers.\\n    "\nfunc_parameters:\n  type: object\n  properties:\n    a:\n      type: int\n    b:\n      type: int\n  required:\n  - a\n  - b\n', 'func_name: divide\nfunc_desc: "divide(a: float, b: float) -&gt; float\\n\\n    Divide two numbers.\\n    "\nfunc_parameters:\n  type: object\n  properties:\n    a:\n      type: float\n    b:\n      type: float\n  required:\n  - a\n  - b\n', "func_name: llm_tool\nfunc_desc: 'llm_tool(input: str) -&gt; str\n\n  I answer any input query with llm''s world knowledge. Use me as a fallback tool\n  or when the query is simple.'\nfunc_parameters:\n  type: object\n  properties:\n    input:\n      type: str\n  required:\n  - input\n", "func_name: finish\nfunc_desc: 'finish(answer: str) -&gt; str\n\n  Finish the task with answer.'\nfunc_parameters:\n  type: object\n  properties:\n    answer:\n      type: str\n  required:\n  - answer\n"], 'output_format_str': 'Your output should be formatted as a standard JSON instance with the following schema:\n```\n{\n    "thought": "Why the function is called (Optional[str]) (optional)",\n    "action": "FuncName() Valid function call expression. Example: \\"FuncName(a=1, b=2)\\" Follow the data type specified in the function parameters.e.g. for Type object with x,y properties, use \\"ObjectType(x=1, y=2) (str) (required)"\n}\n```\nExamples:\n```\n{\n    "thought": "I have finished the task.",\n    "action": "finish(answer=\\"final answer: \'answer\'\\")"\n}\n________\n```\n-Make sure to always enclose the JSON output in triple backticks (```). Please do not add anything other than valid JSON output!\n-Use double quotes for the keys and string values.\n-DO NOT mistaken the "properties" and "type" in the schema as the actual fields in the JSON output.\n-Follow the JSON formatting conventions.'}, prompt_variables: ['input_str', 'tools', 'step_history', 'output_format_str']<br/>      )<br/>      (model_client): GroqAPIClient()<br/>      (output_processors): JsonOutputParser(<br/>         data_class=FunctionExpression, examples=[FunctionExpression(thought='I have finished the task.', action='finish(answer="final answer: \'answer\'")')], exclude_fields=None, return_data_class=True<br/>         (output_format_prompt): Prompt(<br/>         template: Your output should be formatted as a standard JSON instance with the following schema:<br/>         ```<br/>         {{schema}}<br/>         ```<br/>         {% if example %}<br/>         Examples:<br/>         ```<br/>         {{example}}<br/>         ```<br/>         {% endif %}<br/>         -Make sure to always enclose the JSON output in triple backticks (```). Please do not add anything other than valid JSON output!<br/>         -Use double quotes for the keys and string values.<br/>         -DO NOT mistaken the "properties" and "type" in the schema as the actual fields in the JSON output.<br/>         -Follow the JSON formatting conventions., prompt_variables: ['example', 'schema']<br/>         )<br/>         (output_processors): JsonParser()<br/>      )<br/>   )<br/>)</span></pre><p id="f9b1" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">Now, let’s run the test function to see the agent in action.</p><pre class="ms mt mu mv mw pv pt pw bp px bb bk"><span id="d90e" class="py oi fq pt b bg pz qa l qb qc">test_react_agent(ModelClientType.GROQ(), llama3_model_kwargs)<br/>test_react_agent(ModelClientType.OPENAI(), gpt_model_kwargs)</span></pre><p id="24f9" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">Our agent will show the core steps for developers via colored printout, including input_query, steps, and the final answer. The printout of the first query with llama3 is shown below (without the color here):</p><figure class="ms mt mu mv mw mj mp mq paragraph-image"><div role="button" tabindex="0" class="mz na ed nb bh nc"><div class="mp mq qr"><img src="../Images/2ee8fc221d212043565747fa5e693db2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u90mg6xdp1TOqnebsgU_aw.png"/></div></div></figure><pre class="ms mt mu mv mw pv pt pw bp px bb bk"><span id="1cb7" class="py oi fq pt b bg pz qa l qb qc">2024-07-10 16:48:47 - [react.py:287:call] - input_query: What is the capital of France? and what is 465 times 321 then add 95297 and then divide by 13.2<br/><br/>2024-07-10 16:48:48 - [react.py:266:_run_one_step] - Step 1:<br/>StepOutput(step=1, action=FunctionExpression(thought="Let's break down the query into subqueries and start with the first one.", action='llm_tool(input="What is the capital of France?")'), function=Function(thought=None, name='llm_tool', args=[], kwargs={'input': 'What is the capital of France?'}), observation='The capital of France is Paris!')<br/>_______<br/>2024-07-10 16:48:49 - [react.py:266:_run_one_step] - Step 2:<br/>StepOutput(step=2, action=FunctionExpression(thought="Now, let's move on to the second subquery.", action='multiply(a=465, b=321)'), function=Function(thought=None, name='multiply', args=[], kwargs={'a': 465, 'b': 321}), observation=149265)<br/>_______<br/>2024-07-10 16:48:49 - [react.py:266:_run_one_step] - Step 3:<br/>StepOutput(step=3, action=FunctionExpression(thought="Now, let's add 95297 to the result.", action='add(a=149265, b=95297)'), function=Function(thought=None, name='add', args=[], kwargs={'a': 149265, 'b': 95297}), observation=244562)<br/>_______<br/>2024-07-10 16:48:50 - [react.py:266:_run_one_step] - Step 4:<br/>StepOutput(step=4, action=FunctionExpression(thought="Now, let's divide the result by 13.2.", action='divide(a=244562, b=13.2)'), function=Function(thought=None, name='divide', args=[], kwargs={'a': 244562, 'b': 13.2}), observation=18527.424242424244)<br/>_______<br/>2024-07-10 16:48:50 - [react.py:266:_run_one_step] - Step 5:<br/>StepOutput(step=5, action=FunctionExpression(thought="Now, let's combine the answers of both subqueries.", action='finish(answer="The capital of France is Paris! and the result of the mathematical operation is 18527.424242424244.")'), function=Function(thought=None, name='finish', args=[], kwargs={'answer': 'The capital of France is Paris! and the result of the mathematical operation is 18527.424242424244.'}), observation='The capital of France is Paris! and the result of the mathematical operation is 18527.424242424244.')<br/>_______<br/>2024-07-10 16:48:50 - [react.py:301:call] - answer:<br/>The capital of France is Paris! and the result of the mathematical operation is 18527.424242424244.</span></pre><p id="a5f8" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">For the second query, the printout:</p><pre class="ms mt mu mv mw pv pt pw bp px bb bk"><span id="2298" class="py oi fq pt b bg pz qa l qb qc">2024-07-10 16:48:51 - [react.py:287:call] - input_query: Give me 5 words rhyming with cool, and make a 4-sentence poem using them<br/>2024-07-10 16:48:52 - [react.py:266:_run_one_step] - Step 1:<br/>StepOutput(step=1, action=FunctionExpression(thought="I need to find 5 words that rhyme with 'cool'.", action='llm_tool(input="What are 5 words that rhyme with \'cool\'?")'), function=Function(thought=None, name='llm_tool', args=[], kwargs={'input': "What are 5 words that rhyme with 'cool'?"}), observation='Here are 5 words that rhyme with "cool":\n\n1. Rule\n2. Tool\n3. Fool\n4. Pool\n5. School')<br/>_______<br/>2024-07-10 16:49:00 - [react.py:266:_run_one_step] - Step 2:<br/>StepOutput(step=2, action=FunctionExpression(thought='Now that I have the rhyming words, I need to create a 4-sentence poem using them.', action='llm_tool(input="Create a 4-sentence poem using the words \'rule\', \'tool\', \'fool\', \'pool\', and \'school\'.")'), function=Function(thought=None, name='llm_tool', args=[], kwargs={'input': "Create a 4-sentence poem using the words 'rule', 'tool', 'fool', 'pool', and 'school'."}), observation="Here is a 4-sentence poem using the words 'rule', 'tool', 'fool', 'pool', and 'school':\n\nIn the classroom, we learn to rule,\nWith a pencil as our trusty tool.\nBut if we're not careful, we can be a fool,\nAnd end up swimming in the school pool.")<br/>_______<br/>2024-07-10 16:49:12 - [react.py:266:_run_one_step] - Step 3:<br/>StepOutput(step=3, action=FunctionExpression(thought='I have the poem, now I need to finish the task.', action='finish(answer="Here are 5 words that rhyme with \'cool\': rule, tool, fool, pool, school. Here is a 4-sentence poem using the words: In the classroom, we learn to rule, With a pencil as our trusty tool. But if we\'re not careful, we can be a fool, And end up swimming in the school pool.")'), function=Function(thought=None, name='finish', args=[], kwargs={'answer': "Here are 5 words that rhyme with 'cool': rule, tool, fool, pool, school. Here is a 4-sentence poem using the words: In the classroom, we learn to rule, With a pencil as our trusty tool. But if we're not careful, we can be a fool, And end up swimming in the school pool."}), observation="Here are 5 words that rhyme with 'cool': rule, tool, fool, pool, school. Here is a 4-sentence poem using the words: In the classroom, we learn to rule, With a pencil as our trusty tool. But if we're not careful, we can be a fool, And end up swimming in the school pool.")<br/>_______<br/>2024-07-10 16:49:12 - [react.py:301:call] - answer:<br/>Here are 5 words that rhyme with 'cool': rule, tool, fool, pool, school. Here is a 4-sentence poem using the words: In the classroom, we learn to rule, With a pencil as our trusty tool. But if we're not careful, we can be a fool, And end up swimming in the school pool.</span></pre><p id="3662" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">The comparison between the agent and the vanilla LLM response is shown below:</p><pre class="ms mt mu mv mw pv pt pw bp px bb bk"><span id="7c77" class="py oi fq pt b bg pz qa l qb qc">Answer with agent: The capital of France is Paris! and the result of the mathematical operation is 18527.424242424244.<br/>Answer without agent: GeneratorOutput(data="I'd be happy to help you with that!\n\nThe capital of France is Paris.\n\nNow, let's tackle the math problem:\n\n1. 465 × 321 = 149,485\n2. Add 95,297 to that result: 149,485 + 95,297 = 244,782\n3. Divide the result by 13.2: 244,782 ÷ 13.2 = 18,544.09\n\nSo, the answer is 18,544.09!", error=None, usage=None, raw_response="I'd be happy to help you with that!\n\nThe capital of France is Paris.\n\nNow, let's tackle the math problem:\n\n1. 465 × 321 = 149,485\n2. Add 95,297 to that result: 149,485 + 95,297 = 244,782\n3. Divide the result by 13.2: 244,782 ÷ 13.2 = 18,544.09\n\nSo, the answer is 18,544.09!", metadata=None)</span></pre><p id="4205" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">For the second query, the comparison is shown below:</p><pre class="ms mt mu mv mw pv pt pw bp px bb bk"><span id="119f" class="py oi fq pt b bg pz qa l qb qc">Answer with agent: Here are 5 words that rhyme with 'cool': rule, tool, fool, pool, school. Here is a 4-sentence poem using the words: In the classroom, we learn to rule, With a pencil as our trusty tool. But if we're not careful, we can be a fool, And end up swimming in the school pool.<br/>Answer without agent: GeneratorOutput(data='Here are 5 words that rhyme with "cool":\n\n1. rule\n2. tool\n3. fool\n4. pool\n5. school\n\nAnd here\'s a 4-sentence poem using these words:\n\nIn the summer heat, I like to be cool,\nFollowing the rule, I take a dip in the pool.\nI\'m not a fool, I know just what to do,\nI grab my tool and head back to school.', error=None, usage=None, raw_response='Here are 5 words that rhyme with "cool":\n\n1. rule\n2. tool\n3. fool\n4. pool\n5. school\n\nAnd here\'s a 4-sentence poem using these words:\n\nIn the summer heat, I like to be cool,\nFollowing the rule, I take a dip in the pool.\nI\'m not a fool, I know just what to do,\nI grab my tool and head back to school.', metadata=None)</span></pre><p id="969e" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">The ReAct agent is particularly helpful for answering queries that require capabilities like computation or more complicated reasoning and planning. However, using it on general queries might be an overkill, as it might take more steps than necessary to answer the query.</p><h1 id="ea19" class="oh oi fq bf oj ok ol gq om on oo gt op oq or os ot ou ov ow ox oy oz pa pb pc bk">Customization</h1><p id="30c3" class="pw-post-body-paragraph nk nl fq nm b go pd no np gr pe nr ns nt pf nv nw nx pg nz oa ob ph od oe of fj bk"><strong class="nm fr">Template</strong></p><p id="19ac" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">The first thing you want to customize is the template itself. You can do this by passing your own template to the agent’s constructor. We suggest you to modify our default template: <code class="cx pq pr ps pt b"><a class="af nj" href="https://lightrag.sylph.ai/apis/components/components.agent.react.html#components.agent.react.DEFAULT_REACT_AGENT_SYSTEM_PROMPT" rel="noopener ugc nofollow" target="_blank"><strong class="nm fr">DEFAULT_REACT_AGENT_SYSTEM_PROMPT</strong></a></code>.</p><p id="9ead" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk"><strong class="nm fr">Examples for Better Output Format</strong></p><p id="3ff2" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">Secondly, the <code class="cx pq pr ps pt b">examples</code> in the constructor allow you to provide more examples to enforce the correct output format. For instance, if we want it to learn how to correctly call multiply, we can pass in a list of <code class="cx pq pr ps pt b">FunctionExpression</code> instances with the correct format. Classmethod <code class="cx pq pr ps pt b">from_function</code> can be used to create a <code class="cx pq pr ps pt b">FunctionExpression</code> instance from a function and its arguments.</p><pre class="ms mt mu mv mw pv pt pw bp px bb bk"><span id="2c69" class="py oi fq pt b bg pz qa l qb qc">from lightrag.core.types import FunctionExpression</span></pre><pre class="qs pv pt qt qu ay qv bk"><span id="0a6f" class="qw oi fq pt b hw qx qy l im qc"># generate an example of calling multiply with key-word arguments<br/>example_using_multiply = FunctionExpression.from_function(<br/>     func=multiply,<br/>     thought="Now, let's multiply two numbers.",<br/>     a=3,<br/>     b=4,<br/> )<br/>examples = [example_using_multiply]</span><span id="c80b" class="qw oi fq pt b hw qz qy l im qc"># pass it to the agent</span></pre><p id="8578" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">We can visualize how this is passed to the planner prompt via:</p><pre class="ms mt mu mv mw pv pt pw bp px bb bk"><span id="ad09" class="py oi fq pt b bg pz qa l qb qc">react.planner.print_prompt()</span></pre><p id="006b" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">The above example will be formated as:</p><pre class="ms mt mu mv mw pv pt pw bp px bb bk"><span id="51c1" class="py oi fq pt b bg pz qa l qb qc">&lt;OUTPUT_FORMAT&gt;<br/>Your output should be formatted as a standard JSON instance with the following schema:<br/>```<br/>{<br/>   "thought": "Why the function is called (Optional[str]) (optional)",<br/>   "action": "FuncName(&lt;kwargs&gt;) Valid function call expression. Example: \"FuncName(a=1, b=2)\" Follow the data type specified in the function parameters.e.g. for Type object with x,y properties, use \"ObjectType(x=1, y=2) (str) (required)"<br/>}<br/>```<br/>Examples:<br/>```<br/>{<br/>   "thought": "Now, let's multiply two numbers.",<br/>   "action": "multiply(a=3, b=4)"<br/>}<br/>________<br/>{<br/>   "thought": "I have finished the task.",<br/>   "action": "finish(answer=\"final answer: 'answer'\")"<br/>}<br/>________<br/>```<br/>-Make sure to always enclose the JSON output in triple backticks (```). Please do not add anything other than valid JSON output!<br/>-Use double quotes for the keys and string values.<br/>-DO NOT mistaken the "properties" and "type" in the schema as the actual fields in the JSON output.<br/>-Follow the JSON formatting conventions.<br/>&lt;/OUTPUT_FORMAT&gt;</span></pre><p id="8b39" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk"><strong class="nm fr">Subclass ReActAgent</strong></p><p id="a2b2" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk">If you want to customize the agent further, you can subclass the <code class="cx pq pr ps pt b"><a class="af nj" href="https://lightrag.sylph.ai/apis/components/components.agent.react.html#components.agent.react.ReActAgent" rel="noopener ugc nofollow" target="_blank"><strong class="nm fr">ReActAgent</strong></a></code> and override the methods you want to change.</p><h1 id="5a02" class="oh oi fq bf oj ok ol gq om on oo gt op oq or os ot ou ov ow ox oy oz pa pb pc bk">References</h1><p id="d575" class="pw-post-body-paragraph nk nl fq nm b go pd no np gr pe nr ns nt pf nv nw nx pg nz oa ob ph od oe of fj bk">[1] A survey on large language model based autonomous agents: <a class="af nj" href="https://github.com/Paitesanshi/LLM-Agent-Survey" rel="noopener ugc nofollow" target="_blank">Paitesanshi/LLM-Agent-Survey</a></p><p id="b725" class="pw-post-body-paragraph nk nl fq nm b go nn no np gr nq nr ns nt nu nv nw nx ny nz oa ob oc od oe of fj bk"><strong class="nm fr">[</strong><a class="af nj" href="https://lightrag.sylph.ai/tutorials/agent.html#id2" rel="noopener ugc nofollow" target="_blank"><strong class="nm fr">2</strong></a><strong class="nm fr">] </strong>ReAct: <a class="af nj" href="https://arxiv.org/abs/2210.03629" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/abs/2210.03629</a></p><h1 id="db90" class="oh oi fq bf oj ok ol gq om on oo gt op oq or os ot ou ov ow ox oy oz pa pb pc bk">API references</h1><ul class=""><li id="ce2e" class="nk nl fq nm b go pd no np gr pe nr ns nt pf nv nw nx pg nz oa ob ph od oe of pi pj pk bk"><code class="cx pq pr ps pt b"><a class="af nj" href="https://lightrag.sylph.ai/apis/components/components.agent.react.html#components.agent.react.ReActAgent" rel="noopener ugc nofollow" target="_blank"><strong class="nm fr">components.agent.react.ReActAgent</strong></a></code></li><li id="92a2" class="nk nl fq nm b go pl no np gr pm nr ns nt pn nv nw nx po nz oa ob pp od oe of pi pj pk bk"><code class="cx pq pr ps pt b"><a class="af nj" href="https://lightrag.sylph.ai/apis/core/core.types.html#core.types.StepOutput" rel="noopener ugc nofollow" target="_blank"><strong class="nm fr">core.types.StepOutput</strong></a></code></li><li id="7cb2" class="nk nl fq nm b go pl no np gr pm nr ns nt pn nv nw nx po nz oa ob pp od oe of pi pj pk bk"><code class="cx pq pr ps pt b"><a class="af nj" href="https://lightrag.sylph.ai/apis/components/components.agent.react.html#components.agent.react.DEFAULT_REACT_AGENT_SYSTEM_PROMPT" rel="noopener ugc nofollow" target="_blank"><strong class="nm fr">components.agent.react.DEFAULT_REACT_AGENT_SYSTEM_PROMPT</strong></a></code></li></ul></div></div></div></div>    
</body>
</html>