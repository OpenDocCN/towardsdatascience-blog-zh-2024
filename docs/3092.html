<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Measuring Cross-Product Adoption Using dbt_set_similarity</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Measuring Cross-Product Adoption Using dbt_set_similarity</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/measuring-cross-product-adoption-using-dbt-set-similarity-fdf7c1f88bc2?source=collection_archive---------1-----------------------#2024-12-28">https://towardsdatascience.com/measuring-cross-product-adoption-using-dbt-set-similarity-fdf7c1f88bc2?source=collection_archive---------1-----------------------#2024-12-28</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="9c74" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">Enhancing cross-product insights within dbt workflows</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@senick.matthew?source=post_page---byline--fdf7c1f88bc2--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Matthew Senick" class="l ep by dd de cx" src="../Images/8415150b912990541bf3b53c112c7cef.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*XBavtmDNCtHolAbOicmdIg.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--fdf7c1f88bc2--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://medium.com/@senick.matthew?source=post_page---byline--fdf7c1f88bc2--------------------------------" rel="noopener follow">Matthew Senick</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--fdf7c1f88bc2--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">5 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Dec 28, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj la lb ab q ee lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lf k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lg an ao ap id lh li lj" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep lk cn"><div class="l ae"><div class="ab cb"><div class="ll lm ln lo lp lq ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><h1 id="65cb" class="mi mj fq bf mk ml mm gq mn mo mp gt mq mr ms mt mu mv mw mx my mz na nb nc nd bk">Introduction</h1><p id="f340" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">For multi-product companies, one critical metric is often what is called “cross-product adoption”. (i.e. understanding how users engage with multiple offerings in a given product portfolio)</p><p id="0238" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">One measure suggested to calculate cross-product or cross-feature usage in the popular book <em class="of">Hacking Growth </em>[1] is the <strong class="ng fr">Jaccard Index</strong>. Traditionally used to measure the similarity between two sets, the Jaccard Index can also serve as a powerful tool for assessing product adoption patterns. It does this by quantifying the overlap in users between products, from which one can identify cross-product synergies and growth opportunities.</p><p id="0dcd" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">The dbt package <strong class="ng fr">dbt_set_similarity</strong> is designed to simplify the calculation of set similarity metrics directly within an analytics workflow. This package provides a method to calculate the Jaccard Indices within SQL transformational layers.</p><p id="5117" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">To import this package into your dbt project, add the following to the <code class="cx og oh oi oj b">packages.yml</code> file. We will also need dbt_utils for the purposes of this articles example. Run a <code class="cx og oh oi oj b">dbt deps</code> command within your project to install the package.</p><pre class="ok ol om on oo op oj oq bp or bb bk"><span id="61db" class="os mj fq oj b bg ot ou l ov ow">packages:<br/>  - package: Matts52/dbt_set_similarity<br/>    version: 0.1.1<br/>  - package: dbt-labs/dbt_utils<br/>    version: 1.3.0</span></pre><h1 id="924f" class="mi mj fq bf mk ml mm gq mn mo mp gt mq mr ms mt mu mv mw mx my mz na nb nc nd bk">The Jaccard Index</h1><p id="e382" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">The Jaccard Index, also known as the Jaccard Similarity Coefficient, is a metric used to measure the similarity between two sets. It is defined as the size of the intersection of the sets divided by the size of their union.</p><p id="be4c" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">Mathematically, it can be expressed as:</p><figure class="ok ol om on oo pa ox oy paragraph-image"><div class="ox oy oz"><img src="../Images/b852489e4adafbcf4e5142059b2563f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1336/format:webp/1*7nspAuXVaxEA7yepEUKKHQ.png"/></div><figcaption class="pc pd pe ox oy pf pg bf b bg z dx">The Jaccard Index represents the “Intersection” over the “Union” of two sets (image by author)</figcaption></figure><p id="6563" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">Where:</p><ul class=""><li id="1977" class="ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz ph pi pj bk"><em class="of">A</em> and<em class="of"> B</em> are two sets (ex. users of product A and product B)</li><li id="8c95" class="ne nf fq ng b go pk ni nj gr pl nl nm nn pm np nq nr pn nt nu nv po nx ny nz ph pi pj bk">The numerator represents the number of elements in both sets</li><li id="4428" class="ne nf fq ng b go pk ni nj gr pl nl nm nn pm np nq nr pn nt nu nv po nx ny nz ph pi pj bk">The denominator represents the total number of distinct elements across both sets</li></ul><figure class="ok ol om on oo pa ox oy paragraph-image"><div role="button" tabindex="0" class="pq pr ed ps bh pt"><div class="ox oy pp"><img src="../Images/a162cf1562e9ce0ccb3f78452c055ad4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XoRwPyl3RBFyRnYndutG7g.png"/></div></div><figcaption class="pc pd pe ox oy pf pg bf b bg z dx">(image by author)</figcaption></figure><p id="90a6" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">The Jaccard Index is particularly useful in the context of cross-product adoption because:</p><ul class=""><li id="f6b7" class="ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz ph pi pj bk">It focuses on the overlap between two sets, making it ideal for understanding shared user bases</li><li id="241a" class="ne nf fq ng b go pk ni nj gr pl nl nm nn pm np nq nr pn nt nu nv po nx ny nz ph pi pj bk">It accounts for differences in the total size of the sets, ensuring that results are proportional and not skewed by outliers</li></ul><p id="8676" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">For example:</p><ul class=""><li id="b263" class="ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz ph pi pj bk">If 100 users adopt Product A and 50 adopt Product B, with 25 users adopting both, the Jaccard Index is 25 / (100 + 50 — 25) = 0.2, indicating a 20% overlap between the two user bases by the Jaccard Index.</li></ul><h1 id="4a7b" class="mi mj fq bf mk ml mm gq mn mo mp gt mq mr ms mt mu mv mw mx my mz na nb nc nd bk">Example Data</h1><p id="d09e" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">The example dataset we will be using is a fictional SaaS company which offers storage space as a product for consumers. This company provides two distinct storage products: document storage (<em class="of">doc_storage</em>) and photo storage (<em class="of">photo_storage</em>). These are either true, indicating the product has been adopted, or false, indicating the product has not been adopted.</p><p id="102a" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">Additionally, the demographics (<em class="of">user_category</em>) that this company serves are either tech enthusiasts or homeowners.</p><figure class="ok ol om on oo pa"><div class="pu io l ed"><div class="pv pw l"/></div></figure><p id="c073" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">For the sake of this example, we will read this csv file in as a “seed” model named <code class="cx og oh oi oj b">seed_example</code> within the dbt project.</p><h1 id="36c7" class="mi mj fq bf mk ml mm gq mn mo mp gt mq mr ms mt mu mv mw mx my mz na nb nc nd bk">Simple Cross-Product Adoption</h1><p id="28cb" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">Now, let’s say we want to calculate the jaccard index (cross-adoption) between our document storage and photo storage products. First, we need to create an array (list) of the users who have the document storage product, alongside an array of the users who have the photo storage product. In the second cte, we apply the <code class="cx og oh oi oj b">jaccard_coef</code> function from the <code class="cx og oh oi oj b">dbt_set_similarity</code> package to help us easily compute the jaccard coefficient between the two arrays of user id’s.</p><pre class="ok ol om on oo op oj oq bp or bb bk"><span id="fe23" class="os mj fq oj b bg ot ou l ov ow">with product_users as (<br/>    select<br/>        array_agg(user_id) filter (where doc_storage = true)<br/>            as doc_storage_users,<br/>        array_agg(user_id) filter (where photo_storage = true)<br/>            as photo_storage_users<br/>    from {{ ref('seed_example') }}<br/>)<br/><br/>select<br/>    doc_storage_users,<br/>    photo_storage_users,<br/>    {{<br/>        dbt_set_similarity.jaccard_coef(<br/>            'doc_storage_users',<br/>            'photo_storage_users'<br/>        )<br/>    }} as cross_product_jaccard_coef<br/>from product_users</span></pre><figure class="ok ol om on oo pa ox oy paragraph-image"><div role="button" tabindex="0" class="pq pr ed ps bh pt"><div class="ox oy px"><img src="../Images/529e9b291bf1faf07a77a46845db4c94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9ohrV83qDmnPS9gtCxFaHw.png"/></div></div><figcaption class="pc pd pe ox oy pf pg bf b bg z dx">Output from the above dbt model (image by author)</figcaption></figure><p id="c101" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">As we can interpret, <strong class="ng fr">it seems that just over half (60%) of users who have adopted either of products, have adopted both.</strong> We can graphically verify our result by placing the user id sets into a Venn diagram, where we see three users have adopted both products, amongst five total users: 3/5 = 0.6.</p><figure class="ok ol om on oo pa ox oy paragraph-image"><div role="button" tabindex="0" class="pq pr ed ps bh pt"><div class="ox oy py"><img src="../Images/3c4bc717a8204033fd7e53e5b3fac24b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*chZ_gMY8bQNRC6hcWNJx8g.png"/></div></div><figcaption class="pc pd pe ox oy pf pg bf b bg z dx">What the collection of user id’s and product adoption would look like, verifying our result (image by author)</figcaption></figure><h1 id="9ca5" class="mi mj fq bf mk ml mm gq mn mo mp gt mq mr ms mt mu mv mw mx my mz na nb nc nd bk">Segmented Cross-Product Adoption</h1><p id="fb63" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">Using the <code class="cx og oh oi oj b">dbt_set_similarity</code> package, creating segmented jaccard indices for our different user categories should be fairly natural. We will follow the same pattern as before, however, we will simply group our aggregations on the user category.</p><pre class="ok ol om on oo op oj oq bp or bb bk"><span id="452d" class="os mj fq oj b bg ot ou l ov ow">with product_users as (<br/>    select<br/>        user_category,<br/>        array_agg(user_id) filter (where doc_storage = true)<br/>            as doc_storage_users,<br/>        array_agg(user_id) filter (where photo_storage = true)<br/>            as photo_storage_users<br/>    from {{ ref('seed_example') }}<br/>    group by user_category<br/>)<br/><br/>select<br/>    user_category,<br/>    doc_storage_users,<br/>    photo_storage_users,<br/>    {{<br/>        dbt_set_similarity.jaccard_coef(<br/>            'doc_storage_users',<br/>            'photo_storage_users'<br/>        )<br/>    }} as cross_product_jaccard_coef<br/>from product_users</span></pre><figure class="ok ol om on oo pa ox oy paragraph-image"><div role="button" tabindex="0" class="pq pr ed ps bh pt"><div class="ox oy pz"><img src="../Images/17ee449e92cd117d800aa2f482a6bba5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5_KfI67DNqEamW7xLtectQ.png"/></div></div><figcaption class="pc pd pe ox oy pf pg bf b bg z dx">Output from the above dbt model (image by author)</figcaption></figure><p id="85a7" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">From the output, cross-product adoption is higher amongst homeowners, when considering jaccard indices. As shown above, all homeowners who have adopted one of the product, have adopted both. Meanwhile, only one-third of the tech enthusiasts who have adopted one product have adopted both products. Thus, in our very small dataset, cross-product adoption is higher amongst homeowners as opposed to tech enthusiasts.</p><p id="aabc" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">We can graphically verify the output by again creating Venn diagram:</p><figure class="ok ol om on oo pa ox oy paragraph-image"><div role="button" tabindex="0" class="pq pr ed ps bh pt"><div class="ox oy qa"><img src="../Images/19568107b9ad9d3a3154ca096d7158ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mFr4jOFZpY14wVINeXfYaw.png"/></div></div><figcaption class="pc pd pe ox oy pf pg bf b bg z dx">Venn diagrams split by the two segments (image by author)</figcaption></figure><h1 id="ffb5" class="mi mj fq bf mk ml mm gq mn mo mp gt mq mr ms mt mu mv mw mx my mz na nb nc nd bk">Conclusion</h1><p id="cde9" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk"><strong class="ng fr">dbt_set_similarity</strong> provides a straightforward and efficient way to calculate cross-product adoption metrics such as the Jaccard Index directly within a dbt workflow. By applying this method, <strong class="ng fr">multi-product companies can gain valuable insights into user behavior and adoption patterns across their product portfolio</strong>. In our example, we demonstrated the calculation of overall cross-product adoption as well as segmented adoption for distinct user categories.</p><p id="8425" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">Using the package for cross-product adoption is simply one straightforward application. In reality, there exists countless other potential applications of this technique, for example:</p><ul class=""><li id="1956" class="ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz ph pi pj bk">Feature usage analysis</li><li id="4b38" class="ne nf fq ng b go pk ni nj gr pl nl nm nn pm np nq nr pn nt nu nv po nx ny nz ph pi pj bk">Marketing campaign impact analysis</li><li id="332a" class="ne nf fq ng b go pk ni nj gr pl nl nm nn pm np nq nr pn nt nu nv po nx ny nz ph pi pj bk">Support analysis</li></ul><p id="032b" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">Additionally, <strong class="ng fr">this style of analysis is certainly not limited to just SaaS</strong>, but can apply to virtually any industry. Happy Jaccard-ing!</p><h2 id="473e" class="qb mj fq bf mk qc qd qe mn qf qg qh mq nn qi qj qk nr ql qm qn nv qo qp qq qr bk">References</h2><p id="1c13" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">[1] Sean Ellis and Morgan Brown, <a class="af qs" href="https://www.amazon.ca/Hacking-Growth-Fastest-Growing-Companies-Breakout/dp/045149721X" rel="noopener ugc nofollow" target="_blank">Hacking Growth</a> (2017)</p><h2 id="1156" class="qb mj fq bf mk qc qd qe mn qf qg qh mq nn qi qj qk nr ql qm qn nv qo qp qq qr bk">Resources</h2><p id="4100" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk"><a class="af qs" href="https://hub.getdbt.com/Matts52/dbt_set_similarity/latest/" rel="noopener ugc nofollow" target="_blank">dbt package hub</a></p></div></div></div></div>    
</body>
</html>