<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Graphcast: How to Get Things Done</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Graphcast: How to Get Things Done</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/graphcast-how-to-get-things-done-f2fd5630c5fb?source=collection_archive---------0-----------------------#2024-01-29">https://towardsdatascience.com/graphcast-how-to-get-things-done-f2fd5630c5fb?source=collection_archive---------0-----------------------#2024-01-29</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="ff02" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">A guide on how to make predictions using Google’s latest tool, from fetching data to formatting and so much more.</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://abhinavyesss.medium.com/?source=post_page---byline--f2fd5630c5fb--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Abhinav Kumar" class="l ep by dd de cx" src="../Images/96f52cd59bc0dcfc91a500c965c0d5a2.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*EMiL6hBZIjzG2nJTrTjmJw.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--f2fd5630c5fb--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://abhinavyesss.medium.com/?source=post_page---byline--f2fd5630c5fb--------------------------------" rel="noopener follow">Abhinav Kumar</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--f2fd5630c5fb--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">14 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Jan 29, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj lc ld ab q ee le lf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count la lb">5</span></p></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lg k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lh an ao ap id li lj lk" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep ll cn"><div class="l ae"><div class="ab cb"><div class="lm ln lo lp lq lr ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk ml"><img src="../Images/588d8016408891c86301bee99f160e65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*HtzHRdrmHpMiD6EU"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Photo by <a class="af nc" href="https://unsplash.com/@noaa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">NOAA</a> on <a class="af nc" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="8628" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Weather prediction is a very complex problem to solve. Numerical Weather Predictions (NWP) models, Weather Research and Forecasting (WRF) models, have been used to solve the problem, however, the accuracy and precision sometimes are found to be lacking.</p><p id="5b67" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Being the complex problem it is, it has attracted interest and the pursuit of solutions from data scientists to data science enthusiasts to meteorological engineers. Solutions have been found, however consistency and uniformity has not. The solution varies from area to area, from mountain to plateau, from swamps to tundra. From my own personal experience and I am sure from others’ experiences too, weather prediction has been found to be a tough cookie to crack. Quoting a certain shrimp billionaire:</p><blockquote class="nz oa ob"><p id="0619" class="nd ne oc nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">It is like a box of chocolates, you never know what you’re gonna get.</p></blockquote><p id="2ad1" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Recently, Deepmind released a new tool: <a class="af nc" href="https://deepmind.google/discover/blog/graphcast-ai-model-for-faster-and-more-accurate-global-weather-forecasting/" rel="noopener ugc nofollow" target="_blank"><strong class="nf fr">Graphcast, an AI model for faster and more accurate global weather forecasting</strong></a>, taking a shot at making this particular bag of chocolates tastier and more efficient. On a Google TPU v4 machine, using Graphcast, one can fetch predictions at a 0.25 degree spatial resolution in less than a minute. It solves a lot of issues one might face when predicting using conventional methods:</p><ul class=""><li id="d241" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny od oe of bk">predictions are generated for all coordinates all at once,</li><li id="7bbe" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">editing the logic depending on the coordinate is now redundant,</li><li id="8d16" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">mind boggling efficiency and response time.</li></ul><p id="75e6" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">What isn’t so mind boggling is the data preparation required to fetch predictions using the aforementioned tool.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk ol"><img src="../Images/375e9e1395130580aa5d391c57e3527e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Y0NODTTKcl4QsCn2"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Photo by <a class="af nc" href="https://unsplash.com/@_alikokab_?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ali Kokab</a> on <a class="af nc" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="7b08" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">However, worry not, I shall be your knight in a dark and gloomy armor and explain, in this article, the steps required to prepare and format data and finally, fetch predictions using Graphcast.</p><p id="01b8" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><strong class="nf fr">Note</strong>: The usage of the word “AI” nowadays reminds me very much of how “quantum” is used in Marvel movies.</p></div></div></div><div class="ab cb om on oo op" role="separator"><span class="oq by bm or os ot"/><span class="oq by bm or os ot"/><span class="oq by bm or os"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="737b" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Getting the predictions is a process which can be divided into the below sections:</p><ol class=""><li id="10d0" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny ou oe of bk">Fetching the input data.</li><li id="5e9c" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny ou oe of bk">Creating the targets.</li><li id="4e57" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny ou oe of bk">Creating the forcing data.</li><li id="2676" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny ou oe of bk">Processing and formatting the data into a suitable format.</li><li id="fd61" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny ou oe of bk">Bringing them all together and making predictions.</li></ol><p id="918b" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Graphcast states that using the current weather data and the data from 6 hours ago, one can make predictions 6 hours into the future. Taking an example to put it simply:</p><ul class=""><li id="764f" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny od oe of bk"><strong class="nf fr">if predictions are required for</strong>: 2024–01–01 18:00,</li><li id="cf40" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk"><strong class="nf fr">then input data to be put forth</strong>: 2024–01–01 12:00 &amp; 2024–01–01 06:00.</li></ul><p id="a11b" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">It is important to note that <strong class="nf fr">2024–01–01 18:00 will be the first prediction fetched</strong>. Graphcast can additionally fetch data for 10 days, with a 6 hour gap between each prediction. So, the other timestamps for which predictions can be fetched are:</p><ul class=""><li id="3866" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny od oe of bk">2024–01–02 00:00, 06:00, 12:00, 18:00,</li><li id="a9a4" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">2024–01–03 00:00, 06:00 and similarly till,</li><li id="93f1" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">2024–01–10 06:00, 12:00.</li></ul><p id="a0d6" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">To summarize, <strong class="nf fr">data for 40 timestamps</strong> <strong class="nf fr">can be predicted</strong> <strong class="nf fr">using the input of two timestamps</strong>.</p></div></div></div><div class="ab cb om on oo op" role="separator"><span class="oq by bm or os ot"/><span class="oq by bm or os ot"/><span class="oq by bm or os"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="179c" class="ov ow fq bf ox oy oz gq pa pb pc gt pd pe pf pg ph pi pj pk pl pm pn po pp pq bk">Assumptions and important parameters</h1><p id="d18c" class="pw-post-body-paragraph nd ne fq nf b go pr nh ni gr ps nk nl nm pt no np nq pu ns nt nu pv nw nx ny fj bk">For the code I will present in this article, I have assigned the following values to certain parameters that dictate how fast you can get the predictions and the memory used.</p><ul class=""><li id="0202" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny od oe of bk"><strong class="nf fr">Input timestamp</strong>: 2024–01–01 6:00, 12:00.</li><li id="ad57" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk"><strong class="nf fr">First prediction timestamp</strong>: 2024–01–01 18:00.</li><li id="0573" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk"><strong class="nf fr">Number of predictions</strong>: 4.</li><li id="d4d5" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk"><strong class="nf fr">Spatial resolution</strong>: 1 degree.</li><li id="04eb" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk"><strong class="nf fr">Pressure levels</strong>: 13.</li></ul><p id="5130" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Below is the code for importing the required packages, initializing arrays for fields required for input and prediction purposes and other variables that will come in handy.</p><pre class="mm mn mo mp mq pw px py bp pz bb bk"><span id="3fc9" class="qa ow fq px b bg qb qc l qd qe">import cdsapi<br/>import datetime<br/>import functools<br/>from graphcast import autoregressive, casting, checkpoint, data_utils as du, graphcast, normalization, rollout<br/>import haiku as hk<br/>import isodate<br/>import jax<br/>import math<br/>import numpy as np<br/>import pandas as pd<br/>from pysolar.radiation import get_radiation_direct<br/>from pysolar.solar import get_altitude<br/>import pytz<br/>import scipy<br/>from typing import Dict<br/>import xarray<br/><br/>client = cdsapi.Client() # Making a connection to CDS, to fetch data.<br/><br/># The fields to be fetched from the single-level source.<br/>singlelevelfields = [<br/>                        '10m_u_component_of_wind',<br/>                        '10m_v_component_of_wind',<br/>                        '2m_temperature',<br/>                        'geopotential',<br/>                        'land_sea_mask',<br/>                        'mean_sea_level_pressure',<br/>                        'toa_incident_solar_radiation',<br/>                        'total_precipitation'<br/>                    ]<br/><br/># The fields to be fetched from the pressure-level source.<br/>pressurelevelfields = [<br/>                        'u_component_of_wind',<br/>                        'v_component_of_wind',<br/>                        'geopotential',<br/>                        'specific_humidity',<br/>                        'temperature',<br/>                        'vertical_velocity'<br/>                    ]<br/><br/># The 13 pressure levels.<br/>pressure_levels = [50, 100, 150, 200, 250, 300, 400, 500, 600, 700, 850, 925, 1000]<br/><br/># Initializing other required constants.<br/>pi = math.pi<br/>gap = 6 # There is a gap of 6 hours between each graphcast prediction.<br/>predictions_steps = 4 # Predicting for 4 timestamps.<br/>watts_to_joules = 3600<br/>first_prediction = datetime.datetime(2024, 1, 1, 18, 0) # Timestamp of the first prediction.<br/>lat_range = range(-180, 181, 1) # Latitude range.<br/>lon_range = range(0, 360, 1) # Longitude range.<br/><br/># A utility function used for ease of coding.<br/># Converting the variable to a datetime object.<br/>def toDatetime(dt) -&gt; datetime.datetime:<br/>    if isinstance(dt, datetime.date) and isinstance(dt, datetime.datetime):<br/>        return dt<br/>    <br/>    elif isinstance(dt, datetime.date) and not isinstance(dt, datetime.datetime):<br/>        return datetime.datetime.combine(dt, datetime.datetime.min.time())<br/>    <br/>    elif isinstance(dt, str):<br/>        if 'T' in dt:<br/>            return isodate.parse_datetime(dt)<br/>        else:<br/>            return datetime.datetime.combine(isodate.parse_date(dt), datetime.datetime.min.time())</span></pre></div></div></div><div class="ab cb om on oo op" role="separator"><span class="oq by bm or os ot"/><span class="oq by bm or os ot"/><span class="oq by bm or os"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="843f" class="ov ow fq bf ox oy oz gq pa pb pc gt pd pe pf pg ph pi pj pk pl pm pn po pp pq bk">Inputs</h1><p id="467b" class="pw-post-body-paragraph nd ne fq nf b go pr nh ni gr ps nk nl nm pt no np nq pu ns nt nu pv nw nx ny fj bk">When it comes to machine learning, in order to get some predictions, you have to give the ML model some data using which it spits out a prediction. For example, when predicting whether a person is Batman, the input data might be:</p><ul class=""><li id="f10a" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny od oe of bk">How much sleep do they get?</li><li id="add8" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">Do they have a tan line on their face?</li><li id="2840" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">Do they sleep during early morning meetings?</li><li id="1c1a" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">How much is their net worth?</li></ul><p id="f366" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Similarly, Graphcast too takes certain inputs, which we obtain from <a class="af nc" href="https://cds.climate.copernicus.eu/cdsapp#!/home" rel="noopener ugc nofollow" target="_blank"><strong class="nf fr">CDS</strong></a>, using its python library: <a class="af nc" href="https://pypi.org/project/cdsapi/" rel="noopener ugc nofollow" target="_blank"><strong class="nf fr">cdsapi</strong></a>. Currently, the data publisher <a class="af nc" href="https://publications.copernicus.org/for_authors/licence_and_copyright.html" rel="noopener ugc nofollow" target="_blank"><strong class="nf fr">uses the Creative Commons Attribution 4.0 License</strong></a>, which means that anyone can copy, distribute, transmit, and adapt the work as long as the original author is given credit.</p><p id="20ff" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">However, authentication is required before making requests to fetch data using cdsapi, the <a class="af nc" href="https://cds.climate.copernicus.eu/api-how-to" rel="noopener ugc nofollow" target="_blank"><strong class="nf fr">instructions for which are provided</strong></a> by CDS and is pretty straightforward.</p><p id="7ab2" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Assuming you are now CDS-approved, inputs can be created, which involves the following steps:</p><ol class=""><li id="9ec2" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny ou oe of bk"><strong class="nf fr">Getting the single-level values</strong>: These are dependent on the <strong class="nf fr"><em class="oc">coordinates</em></strong> and <strong class="nf fr"><em class="oc">time</em></strong>. One of the input fields required is <strong class="nf fr"><em class="oc">total_precipitation_6hr</em></strong>.<em class="oc"> </em>As the name suggests, it is the cumulation of the previous 6 hours of rainfall from that particular timestamp. Hence, instead of getting the values for just the two input timestamps, we have to get values for timestamps ranging from, in our case: <strong class="nf fr">2024–01–01 00:00 to 12:00</strong>.</li><li id="247c" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny ou oe of bk"><strong class="nf fr">Getting the pressure-level values</strong>: In addition to being dependent on the <strong class="nf fr"><em class="oc">coordinates</em></strong>, they also depend on the <strong class="nf fr"><em class="oc">pressure-level</em></strong>. Hence, when requesting data, we mention the pressure levels we need the data for. In this case, we get values for the two input timestamps only.</li><li id="64ed" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny ou oe of bk"><strong class="nf fr">Merging the single and pressure values</strong>: An inner-merge operation is carried out on the aforementioned data on the basis of <strong class="nf fr"><em class="oc">time</em></strong>, <strong class="nf fr"><em class="oc">latitude</em></strong> and <strong class="nf fr"><em class="oc">longitude</em></strong>.</li><li id="7a8a" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny ou oe of bk"><strong class="nf fr">Integrating year and day progress</strong>: In addition to the single and pressure fields, four more fields need to be added to the input data: <strong class="nf fr"><em class="oc">year_progress_sin</em></strong>, <strong class="nf fr"><em class="oc">year_progress_cos</em></strong>, <strong class="nf fr"><em class="oc">day_progress_sin</em></strong> and <strong class="nf fr"><em class="oc">day_progress_cos</em></strong>. This can be done using functions provided by the <a class="af nc" href="https://github.com/google-deepmind/graphcast?tab=readme-ov-file" rel="noopener ugc nofollow" target="_blank"><strong class="nf fr">graphcast</strong></a> package.</li></ol><p id="fe72" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Other small steps include:</p><ul class=""><li id="00f7" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny od oe of bk">Renaming the columns after they are fetched from CDS because CDS outputs a shortened form of the weather variables.</li><li id="cc9f" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">Renaming <strong class="nf fr"><em class="oc">geopotential </em></strong>variable to <strong class="nf fr"><em class="oc">geopotential_at_surface </em></strong>for the single-level data, since pressure-level has the same field name.</li><li id="becb" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">Using <a class="af nc" href="https://docs.python.org/3/library/math.html" rel="noopener ugc nofollow" target="_blank"><strong class="nf fr">math</strong></a><strong class="nf fr"> </strong>functions to calculate the sin and cos values after the <strong class="nf fr"><em class="oc">progress </em></strong>value is obtained from graphcast.</li><li id="499f" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">Renaming <strong class="nf fr"><em class="oc">latitude </em></strong>to <strong class="nf fr"><em class="oc">lat</em></strong>, <strong class="nf fr"><em class="oc">longitude </em></strong>to <strong class="nf fr"><em class="oc">lon </em></strong>and introducing another index: <strong class="nf fr"><em class="oc">batch</em></strong>, which is assigned the value 0.</li></ul><p id="3fcf" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">The code for creating the input data is as follows.</p><pre class="mm mn mo mp mq pw px py bp pz bb bk"><span id="7725" class="qa ow fq px b bg qb qc l qd qe"># Getting the single and pressure level values.<br/>def getSingleAndPressureValues():<br/>    <br/>    client.retrieve(<br/>        'reanalysis-era5-single-levels',<br/>        {<br/>            'product_type': 'reanalysis',<br/>            'variable': singlelevelfields,<br/>            'grid': '1.0/1.0',<br/>            'year': [2024],<br/>            'month': [1],<br/>            'day': [1],<br/>            'time': ['00:00', '01:00', '02:00', '03:00', '04:00', '05:00', '06:00', '07:00', '08:00', '09:00', '10:00', '11:00', '12:00'],<br/>            'format': 'netcdf'<br/>        },<br/>        'single-level.nc'<br/>    )<br/>    singlelevel = xarray.open_dataset('single-level.nc', engine = scipy.__name__).to_dataframe()<br/>    singlelevel = singlelevel.rename(columns = {col:singlelevelfields[ind] for ind, col in enumerate(singlelevel.columns.values.tolist())})<br/>    singlelevel = singlelevel.rename(columns = {'geopotential': 'geopotential_at_surface'})<br/><br/>    # Calculating the sum of the last 6 hours of rainfall.<br/>    singlelevel = singlelevel.sort_index()<br/>    singlelevel['total_precipitation_6hr'] = singlelevel.groupby(level=[0, 1])['total_precipitation'].rolling(window = 6, min_periods = 1).sum().reset_index(level=[0, 1], drop=True)<br/>    singlelevel.pop('total_precipitation')<br/>    <br/>    client.retrieve(<br/>        'reanalysis-era5-pressure-levels',<br/>        {<br/>            'product_type': 'reanalysis',<br/>            'variable': pressurelevelfields,<br/>            'grid': '1.0/1.0',<br/>            'year': [2024],<br/>            'month': [1],<br/>            'day': [1],<br/>            'time': ['06:00', '12:00'],<br/>            'pressure_level': pressure_levels,<br/>            'format': 'netcdf'<br/>        },<br/>        'pressure-level.nc'<br/>    )<br/>    pressurelevel = xarray.open_dataset('pressure-level.nc', engine = scipy.__name__).to_dataframe()<br/>    pressurelevel = pressurelevel.rename(columns = {col:pressurelevelfields[ind] for ind, col in enumerate(pressurelevel.columns.values.tolist())})<br/><br/>    return singlelevel, pressurelevel<br/><br/># Adding sin and cos of the year progress.<br/>def addYearProgress(secs, data):<br/><br/>    progress = du.get_year_progress(secs)<br/>    data['year_progress_sin'] = math.sin(2 * pi * progress)<br/>    data['year_progress_cos'] = math.cos(2 * pi * progress)<br/><br/>    return data<br/><br/># Adding sin and cos of the day progress.<br/>def addDayProgress(secs, lon:str, data:pd.DataFrame):<br/><br/>    lons = data.index.get_level_values(lon).unique()<br/>    progress:np.ndarray = du.get_day_progress(secs, np.array(lons))<br/>    prxlon = {lon:prog for lon, prog in list(zip(list(lons), progress.tolist()))}<br/>    data['day_progress_sin'] = data.index.get_level_values(lon).map(lambda x: math.sin(2 * pi * prxlon[x]))<br/>    data['day_progress_cos'] = data.index.get_level_values(lon).map(lambda x: math.cos(2 * pi * prxlon[x]))<br/>    <br/>    return data<br/><br/># Adding day and year progress.<br/>def integrateProgress(data:pd.DataFrame):<br/>        <br/>    for dt in data.index.get_level_values('time').unique():<br/>        seconds_since_epoch = toDatetime(dt).timestamp()<br/>        data = addYearProgress(seconds_since_epoch, data)<br/>        data = addDayProgress(seconds_since_epoch, 'longitude' if 'longitude' in data.index.names else 'lon', data)<br/><br/>    return data<br/><br/># Adding batch field and renaming some others.<br/>def formatData(data:pd.DataFrame) -&gt; pd.DataFrame:<br/>        <br/>    data = data.rename_axis(index = {'latitude': 'lat', 'longitude': 'lon'})<br/>    if 'batch' not in data.index.names:<br/>        data['batch'] = 0<br/>        data = data.set_index('batch', append = True)<br/>    <br/>    return data<br/><br/>if __name__ == '__main__':<br/><br/>    values:Dict[str, xarray.Dataset] = {}<br/>    <br/>    single, pressure = getSingleAndPressureValues()<br/>    values['inputs'] = pd.merge(pressure, single, left_index = True, right_index = True, how = 'inner')<br/>    values['inputs'] = integrateProgress(values['inputs'])<br/>    values['inputs'] = formatData(values['inputs'])</span></pre></div></div></div><div class="ab cb om on oo op" role="separator"><span class="oq by bm or os ot"/><span class="oq by bm or os ot"/><span class="oq by bm or os"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="70a9" class="ov ow fq bf ox oy oz gq pa pb pc gt pd pe pf pg ph pi pj pk pl pm pn po pp pq bk">Targets</h1><p id="0658" class="pw-post-body-paragraph nd ne fq nf b go pr nh ni gr ps nk nl nm pt no np nq pu ns nt nu pv nw nx ny fj bk">There are 11 prediction fields:</p><ul class=""><li id="1e2a" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny od oe of bk">u_component_of_wind,</li><li id="4f43" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">v_component_of_wind,</li><li id="eb67" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">geopotential,</li><li id="f4a2" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">specific_humidity,</li><li id="1900" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">temperature,</li><li id="6950" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">vertical_velocity,</li><li id="0726" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">10m_u_component_of_wind,</li><li id="fa5c" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">10m_v_component_of_wind,</li><li id="5265" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">2m_temperature,</li><li id="2d67" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">mean_sea_level_pressure,</li><li id="88bc" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">total_precipitation.</li></ul><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qf"><img src="../Images/812a9485ce1659178f38f686944419c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4RIaVPBnVJ1kyHnK"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Photo by <a class="af nc" href="https://unsplash.com/@jrarce?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ricardo Arce</a> on <a class="af nc" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="a23e" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">The targets one passes is essentially an empty xarray for all the prediction fields at:</p><ul class=""><li id="8fcc" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny od oe of bk">every <strong class="nf fr"><em class="oc">coordinate</em></strong>,</li><li id="d231" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">prediction <strong class="nf fr"><em class="oc">timestamps </em></strong>and</li><li id="ead7" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk"><strong class="nf fr"><em class="oc">pressure level</em></strong>.</li></ul><p id="a3d7" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">The code to do so, is shared below.</p><pre class="mm mn mo mp mq pw px py bp pz bb bk"><span id="b13c" class="qa ow fq px b bg qb qc l qd qe"># Includes the packages imported and constants assigned.<br/># The functions created for the inputs also go here.<br/><br/>predictionFields = [<br/>                        'u_component_of_wind',<br/>                        'v_component_of_wind',<br/>                        'geopotential',<br/>                        'specific_humidity',<br/>                        'temperature',<br/>                        'vertical_velocity',<br/>                        '10m_u_component_of_wind',<br/>                        '10m_v_component_of_wind',<br/>                        '2m_temperature',<br/>                        'mean_sea_level_pressure',<br/>                        'total_precipitation_6hr'<br/>                    ]<br/><br/># Creating an array full of nan values.<br/>def nans(*args) -&gt; list:<br/>    return np.full((args), np.nan)<br/><br/># Adding or subtracting time.<br/>def deltaTime(dt, **delta) -&gt; datetime.datetime:<br/>    return dt + datetime.timedelta(**delta)<br/><br/>def getTargets(dt, data:pd.DataFrame):<br/>    <br/>    # Creating an array consisting of unique values of each index.<br/>    lat, lon, levels, batch = sorted(data.index.get_level_values('lat').unique().tolist()), sorted(data.index.get_level_values('lon').unique().tolist()), sorted(data.index.get_level_values('level').unique().tolist()), data.index.get_level_values('batch').unique().tolist()<br/>    time = [deltaTime(dt, hours = days * gap) for days in range(4)]<br/><br/>    # Creating an empty dataset using latitude, longitude, the pressure levels and each prediction timestamp.<br/>    target = xarray.Dataset({field: (['lat', 'lon', 'level', 'time'], nans(len(lat), len(lon), len(levels), len(time))) for field in predictionFields}, coords = {'lat': lat, 'lon': lon, 'level': levels, 'time': time, 'batch': batch})<br/><br/>    return target.to_dataframe()<br/><br/>if __name__ == '__main__':<br/><br/>    # The code for creating inputs will be here.<br/><br/>    values['targets'] = getTargets(first_prediction, values['inputs'])</span></pre></div></div></div><div class="ab cb om on oo op" role="separator"><span class="oq by bm or os ot"/><span class="oq by bm or os ot"/><span class="oq by bm or os"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="f0e4" class="ov ow fq bf ox oy oz gq pa pb pc gt pd pe pf pg ph pi pj pk pl pm pn po pp pq bk">Forcings</h1><p id="bc60" class="pw-post-body-paragraph nd ne fq nf b go pr nh ni gr ps nk nl nm pt no np nq pu ns nt nu pv nw nx ny fj bk">As was the case with the <strong class="nf fr">targets</strong>, <strong class="nf fr">forcings </strong>too contains values for every coordinate and prediction timestamp <strong class="nf fr">but not the pressure level</strong>. The fields in <strong class="nf fr">forcings </strong>are:</p><ul class=""><li id="62d7" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny od oe of bk">total_incident_solar_radiation,</li><li id="82db" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">year_progress_sin,</li><li id="23b3" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">year_progress_cos,</li><li id="ffa7" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">day_progress_sin,</li><li id="5407" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">day_progress_cos.</li></ul><p id="a463" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">It is important to note that the above values are <strong class="nf fr">assigned wrt the prediction timestamp</strong>. As was the case when processing the <strong class="nf fr">inputs</strong>, <strong class="nf fr"><em class="oc">year</em> </strong>and<strong class="nf fr"> <em class="oc">day progress</em></strong> depends only on the timestamp and the <strong class="nf fr"><em class="oc">solar radiation</em></strong> was fetched from the single-level source. However, since one is making predictions, i.e., getting values for the future, the solar values, in the case of <strong class="nf fr">forcings</strong>, will not be available in the CDS dataset. For this we simulate the solar radiation values using the <a class="af nc" href="https://pypi.org/project/pysolar/" rel="noopener ugc nofollow" target="_blank"><strong class="nf fr">pysolar</strong></a> library.</p><pre class="mm mn mo mp mq pw px py bp pz bb bk"><span id="b3d9" class="qa ow fq px b bg qb qc l qd qe"># Includes the packages imported and constants assigned.<br/># The functions created for the inputs and targets also go here.<br/><br/># Adding a timezone to datetime.datetime variables.<br/>def addTimezone(dt, tz = pytz.UTC) -&gt; datetime.datetime:<br/>    dt = toDatetime(dt)<br/>    if dt.tzinfo == None:<br/>        return pytz.UTC.localize(dt).astimezone(tz)<br/>    else:<br/>        return dt.astimezone(tz)<br/><br/># Getting the solar radiation value wrt longitude, latitude and timestamp.<br/>def getSolarRadiation(longitude, latitude, dt):<br/>        <br/>    altitude_degrees = get_altitude(latitude, longitude, addTimezone(dt))<br/>    solar_radiation = get_radiation_direct(dt, altitude_degrees) if altitude_degrees &gt; 0 else 0<br/><br/>    return solar_radiation * watts_to_joules<br/><br/># Calculating the solar radiation values for timestamps to be predicted.<br/>def integrateSolarRadiation(data:pd.DataFrame):<br/>    <br/>    dates = list(data.index.get_level_values('time').unique())<br/>    coords = [[lat, lon] for lat in lat_range for lon in lon_range]<br/>    values = []<br/>    <br/>    # For each data, getting the solar radiation value at a particular coordinate.<br/>    for dt in dates:<br/>        values.extend(list(map(lambda coord:{'time': dt, 'lon': coord[1], 'lat': coord[0], 'toa_incident_solar_radiation': getSolarRadiation(coord[1], coord[0], dt)}, coords)))<br/>  <br/>    # Setting indices.<br/>    values = pd.DataFrame(values).set_index(keys = ['lat', 'lon', 'time'])<br/>      <br/>    # The forcings dataset will now contain the solar radiation values.<br/>    return pd.merge(data, values, left_index = True, right_index = True, how = 'inner')<br/><br/>def getForcings(data:pd.DataFrame):<br/>  <br/>    # Since forcings data does not contain batch as an index, it is dropped.<br/>    # So are all the columns, since forcings data only has 5, which will be created.<br/>    forcingdf = data.reset_index(level = 'level', drop = True).drop(labels = predictionFields, axis = 1)<br/>    <br/>    # Keeping only the unique indices.<br/>    forcingdf = pd.DataFrame(index = forcingdf.index.drop_duplicates(keep = 'first'))<br/><br/>    # Adding the sin and cos of day and year progress.<br/>    # Functions are included in the creation of inputs data section.<br/>    forcingdf = integrateProgress(forcingdf)<br/><br/>    # Integrating the solar radiation values.<br/>    forcingdf = integrateSolarRadiation(forcingdf)<br/><br/>    return forcingdf<br/><br/>if __name__ == '__main__':<br/><br/>    # The code for creating inputs and targets will be here.<br/><br/>    values['forcings'] = getForcings(values['targets'])</span></pre></div></div></div><div class="ab cb om on oo op" role="separator"><span class="oq by bm or os ot"/><span class="oq by bm or os ot"/><span class="oq by bm or os"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="53fe" class="ov ow fq bf ox oy oz gq pa pb pc gt pd pe pf pg ph pi pj pk pl pm pn po pp pq bk">Post-processing the inputs, targets and forcings</h1><p id="d407" class="pw-post-body-paragraph nd ne fq nf b go pr nh ni gr ps nk nl nm pt no np nq pu ns nt nu pv nw nx ny fj bk">Now that the three pillars of Graphcast is created, we enter the home stretch. Like in a NBA final, having won 3 games, we now proceed to the nittiest grittiest part, to get it done.</p><p id="9f67" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Like Kobe Bryant once said,</p><blockquote class="nz oa ob"><p id="6241" class="nd ne oc nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Job’s not over yet.</p></blockquote><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qg"><img src="../Images/e70074bb06ef6d6bd94183c390f84b2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0riG7Rmxb3f6tbjm"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Photo by <a class="af nc" href="https://unsplash.com/@thevoncomplex?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Mike Von</a> on <a class="af nc" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="ae29" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">When it comes to an xarray, there are two main types of data:</p><ul class=""><li id="94cb" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny od oe of bk">Coordinates, the indices: <strong class="nf fr"><em class="oc">lat</em></strong>, <strong class="nf fr"><em class="oc">lon</em></strong>, <strong class="nf fr"><em class="oc">time</em></strong>….. and</li><li id="54f6" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">Data variables, the columns: <strong class="nf fr"><em class="oc">land_sea_mask</em></strong>, <strong class="nf fr"><em class="oc">geopotential</em></strong> et cetera.</li></ul><p id="27ea" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Every value that a data variable contains, has certain coordinates assigned to it. The coordinates are those on which the value of the data variable depends on. Taking an example out of our own data,</p><ul class=""><li id="fd59" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny od oe of bk"><strong class="nf fr"><em class="oc">land_sea_mask </em></strong>depends solely on the <strong class="nf fr"><em class="oc">latitude </em></strong>and <strong class="nf fr"><em class="oc">longitude</em></strong>, which are its coordinates.</li><li id="ff79" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk"><strong class="nf fr"><em class="oc">geopotential</em></strong>’s coordinates are <strong class="nf fr"><em class="oc">batch</em></strong>, <strong class="nf fr"><em class="oc">latitude</em></strong>, <strong class="nf fr"><em class="oc">longitude</em></strong>, <strong class="nf fr"><em class="oc">time </em></strong>and <strong class="nf fr"><em class="oc">pressure level</em></strong>.</li><li id="9e51" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">In a stark contrast, but while making sense, the coordinates of <strong class="nf fr"><em class="oc">geopotential_at_surface </em></strong>are <strong class="nf fr"><em class="oc">latitude </em></strong>and <strong class="nf fr"><em class="oc">longitude</em></strong>.</li></ul><p id="780d" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Hence, before we proceed to predicting the weather, we make sure each data variable is assigned to its right coordinates, the code for which is presented below.</p><pre class="mm mn mo mp mq pw px py bp pz bb bk"><span id="2510" class="qa ow fq px b bg qb qc l qd qe"># Includes the packages imported and constants assigned.<br/># The functions created for the inputs, targets and forcings also go here.<br/><br/># A dictionary created, containing each coordinate a data variable requires.<br/>class AssignCoordinates:<br/>    <br/>    coordinates = {<br/>                    '2m_temperature': ['batch', 'lon', 'lat', 'time'],<br/>                    'mean_sea_level_pressure': ['batch', 'lon', 'lat', 'time'],<br/>                    '10m_v_component_of_wind': ['batch', 'lon', 'lat', 'time'],<br/>                    '10m_u_component_of_wind': ['batch', 'lon', 'lat', 'time'],<br/>                    'total_precipitation_6hr': ['batch', 'lon', 'lat', 'time'],<br/>                    'temperature': ['batch', 'lon', 'lat', 'level', 'time'],<br/>                    'geopotential': ['batch', 'lon', 'lat', 'level', 'time'],<br/>                    'u_component_of_wind': ['batch', 'lon', 'lat', 'level', 'time'],<br/>                    'v_component_of_wind': ['batch', 'lon', 'lat', 'level', 'time'],<br/>                    'vertical_velocity': ['batch', 'lon', 'lat', 'level', 'time'],<br/>                    'specific_humidity': ['batch', 'lon', 'lat', 'level', 'time'],<br/>                    'toa_incident_solar_radiation': ['batch', 'lon', 'lat', 'time'],<br/>                    'year_progress_cos': ['batch', 'time'],<br/>                    'year_progress_sin': ['batch', 'time'],<br/>                    'day_progress_cos': ['batch', 'lon', 'time'],<br/>                    'day_progress_sin': ['batch', 'lon', 'time'],<br/>                    'geopotential_at_surface': ['lon', 'lat'],<br/>                    'land_sea_mask': ['lon', 'lat'],<br/>                }<br/><br/>def modifyCoordinates(data:xarray.Dataset):<br/>    <br/>    # Parsing through each data variable and removing unneeded indices.<br/>    for var in list(data.data_vars):<br/>        varArray:xarray.DataArray = data[var]<br/>        nonIndices = list(set(list(varArray.coords)).difference(set(AssignCoordinates.coordinates[var])))<br/>        data[var] = varArray.isel(**{coord: 0 for coord in nonIndices})<br/>    data = data.drop_vars('batch')<br/><br/>    return data<br/><br/>def makeXarray(data:pd.DataFrame) -&gt; xarray.Dataset:<br/>    <br/>    # Converting to xarray.<br/>    data = data.to_xarray()<br/>    data = modifyCoordinates(data)<br/><br/>    return data<br/><br/>if __name__ == '__main__':<br/><br/>    # The code for creating inputs, targets and forcings will be here.<br/><br/>    values = {value:makeXarray(values[value]) for value in values}</span></pre></div></div></div><div class="ab cb om on oo op" role="separator"><span class="oq by bm or os ot"/><span class="oq by bm or os ot"/><span class="oq by bm or os"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="7028" class="ov ow fq bf ox oy oz gq pa pb pc gt pd pe pf pg ph pi pj pk pl pm pn po pp pq bk">Predictions using Graphcast</h1><p id="13cc" class="pw-post-body-paragraph nd ne fq nf b go pr nh ni gr ps nk nl nm pt no np nq pu ns nt nu pv nw nx ny fj bk">Having calculated, processed and assembled the <strong class="nf fr">inputs</strong>, <strong class="nf fr">targets </strong>and <strong class="nf fr">forcings</strong>, it is now time to make <strong class="nf fr">predictions</strong>.</p><p id="5300" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">We now require the model weights and normalization statistics files, which are <a class="af nc" href="https://console.cloud.google.com/storage/browser/dm_graphcast;tab=objects?prefix=&amp;forceOnObjectsSortingFiltering=false" rel="noopener ugc nofollow" target="_blank"><strong class="nf fr">provided by Deepmind</strong></a>.</p><p id="7542" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">The files to be downloaded are:</p><ul class=""><li id="d981" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny od oe of bk">stats/diffs_stddev_by_level.nc,</li><li id="b8ba" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">stats/stddev_by_level.nc,</li><li id="befe" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">stats/mean_by_level.nc and</li><li id="48ce" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">params/GraphCast_small — ERA5 1979–2015 — resolution 1.0 — pressure levels 13 — mesh 2to5 — precipitation input and output.npz.</li></ul><p id="2a1f" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">The relative paths of the aforementioned files wrt the prediction file is depicted below. It is <strong class="nf fr">important to maintain the structure </strong>so that the required files can be imported and read successfully.</p><pre class="mm mn mo mp mq pw px py bp pz bb bk"><span id="1ada" class="qa ow fq px b bg qb qc l qd qe">.<br/>├── prediction.py<br/>├── model<br/>    ├── params<br/>        ├── GraphCast_small - ERA5 1979-2015 - resolution 1.0 - pressure levels 13 - mesh 2to5 - precipitation input and output.npz<br/>    ├── stats<br/>        ├── diffs_stddev_by_level.nc<br/>        ├── mean_by_level.nc<br/>        ├── stddev_by_level.nc</span></pre><p id="156a" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">With the <a class="af nc" href="https://colab.research.google.com/drive/1X9WcRis_PC_DyuHYIiUwKWCAIr8T-4Pd#scrollTo=Sd99tPA3TBa4" rel="noopener ugc nofollow" target="_blank"><strong class="nf fr">prediction code being provided by Deepmind</strong></a>, all the above functions culminate with the predictions being made using the snippet below.</p><pre class="mm mn mo mp mq pw px py bp pz bb bk"><span id="b749" class="qa ow fq px b bg qb qc l qd qe"># Includes the packages imported and constants assigned.<br/># The functions created for the inputs, targets and forcings also go here.<br/><br/>with open(r'model/params/GraphCast_small - ERA5 1979-2015 - resolution 1.0 - pressure levels 13 - mesh 2to5 - precipitation input and output.npz', 'rb') as model:<br/>    ckpt = checkpoint.load(model, graphcast.CheckPoint)<br/>    params = ckpt.params<br/>    state = {}<br/>    model_config = ckpt.model_config<br/>    task_config = ckpt.task_config<br/><br/>with open(r'model/stats/diffs_stddev_by_level.nc', 'rb') as f:<br/>    diffs_stddev_by_level = xarray.load_dataset(f).compute()<br/><br/>with open(r'model/stats/mean_by_level.nc', 'rb') as f:<br/>    mean_by_level = xarray.load_dataset(f).compute()<br/><br/>with open(r'model/stats/stddev_by_level.nc', 'rb') as f:<br/>    stddev_by_level = xarray.load_dataset(f).compute()<br/>    <br/>def construct_wrapped_graphcast(model_config:graphcast.ModelConfig, task_config:graphcast.TaskConfig):<br/>    predictor = graphcast.GraphCast(model_config, task_config)<br/>    predictor = casting.Bfloat16Cast(predictor)<br/>    predictor = normalization.InputsAndResiduals(predictor, diffs_stddev_by_level = diffs_stddev_by_level, mean_by_level = mean_by_level, stddev_by_level = stddev_by_level)<br/>    predictor = autoregressive.Predictor(predictor, gradient_checkpointing = True)<br/>    return predictor<br/><br/>@hk.transform_with_state<br/>def run_forward(model_config, task_config, inputs, targets_template, forcings):<br/>    predictor = construct_wrapped_graphcast(model_config, task_config)<br/>    return predictor(inputs, targets_template = targets_template, forcings = forcings)<br/><br/>def with_configs(fn):<br/>    return functools.partial(fn, model_config = model_config, task_config = task_config)<br/><br/>def with_params(fn):<br/>    return functools.partial(fn, params = params, state = state)<br/><br/>def drop_state(fn):<br/>    return lambda **kw: fn(**kw)[0]<br/><br/>run_forward_jitted = drop_state(with_params(jax.jit(with_configs(run_forward.apply))))<br/><br/>class Predictor:<br/><br/>    @classmethod<br/>    def predict(cls, inputs, targets, forcings) -&gt; xarray.Dataset:<br/>        predictions = rollout.chunked_prediction(run_forward_jitted, rng = jax.random.PRNGKey(0), inputs = inputs, targets_template = targets, forcings = forcings)<br/>        return predictions<br/><br/>if __name__ == '__main__':<br/><br/>    # The code for creating inputs, targets, forcings &amp; processing will be here.<br/><br/>    predictions = Predictor.predict(values['inputs'], values['targets'], values['forcings'])<br/>    predictions.to_dataframe().to_csv('predictions.csv', sep = ',')</span></pre></div></div></div><div class="ab cb om on oo op" role="separator"><span class="oq by bm or os ot"/><span class="oq by bm or os ot"/><span class="oq by bm or os"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="6c4a" class="ov ow fq bf ox oy oz gq pa pb pc gt pd pe pf pg ph pi pj pk pl pm pn po pp pq bk">Conclusion</h1><p id="7b97" class="pw-post-body-paragraph nd ne fq nf b go pr nh ni gr ps nk nl nm pt no np nq pu ns nt nu pv nw nx ny fj bk">Above, I have provided the code for each process that will be undertaken:</p><ul class=""><li id="5b54" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny od oe of bk">creating the inputs, targets and forcings,</li><li id="7926" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">processing the above data to a viable format and then finally</li><li id="4e48" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">bringing them together and making predictions.</li></ul><p id="1087" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">While executing, it is important to bring all the processes together for a seamless implementation.</p><p id="11ef" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">For simplicity, I have <a class="af nc" href="https://github.com/abhinavyesss/graphcast-predict" rel="noopener ugc nofollow" target="_blank"><strong class="nf fr">uploaded the code</strong></a> along with the docker image and container files, which can be used to create an environment to execute the prediction program.</p><p id="356b" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">In the universe of weather prediction, we currently have contributors like Accuweather, IBM, multiple meteomatics models. Graphcast proves to be an interesting and in many cases, a more efficient addition to this collection. However it also has some attributes that are far from optimal. In a rare moment of thought, I came up with the following insights:</p><ul class=""><li id="321b" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny od oe of bk">Graphcast is far more efficient and faster compared to other weather prediction services, fetching predictions for the whole world in a matter of minutes.</li><li id="3fc1" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">This makes making hundreds of calls for hundreds of geographies using APIs redundant.</li><li id="ed20" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">However to do the above in minutes, one needs to have a very powerful machine, either a Google TPU v4 or better. That is something that isn’t readily available. Even if one chooses to make use of a VM from AWS or Google or Azure, the costs can rack up.</li><li id="f2af" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">Currently, there are no provisions to use data for a small geography or a subset of coordinates and get predictions for the same. Data for all the coordinates is always required.</li><li id="68d2" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk">CDS provides data with a 5 day latency period, which means at ‘x’ date, CDS can provide data only till ‘x-5’ date. This makes future weather prediction a little complicated since one has to cover the latency period before predictions can be made for the future.</li></ul><p id="8804" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">It is important to note that Graphcast is a fairly new addition to the weather prediction scene, changes and additions will definitely be made to improve the ease of access and usability. Given the lead they have wrt efficiency and performance, they are sure to capitalize on it.</p></div></div></div><div class="ab cb om on oo op" role="separator"><span class="oq by bm or os ot"/><span class="oq by bm or os ot"/><span class="oq by bm or os"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="de72" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Resources:</p><ul class=""><li id="dc48" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny od oe of bk"><a class="af nc" href="https://colab.research.google.com/drive/1X9WcRis_PC_DyuHYIiUwKWCAIr8T-4Pd#scrollTo=Sd99tPA3TBa4" rel="noopener ugc nofollow" target="_blank"><strong class="nf fr">Graphcast demo code</strong></a><strong class="nf fr">.</strong></li><li id="186a" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk"><a class="af nc" href="https://console.cloud.google.com/storage/browser/dm_graphcast" rel="noopener ugc nofollow" target="_blank"><strong class="nf fr">Model weights and stats files</strong></a>.</li><li id="06ff" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk"><a class="af nc" href="https://storage.googleapis.com/deepmind-media/DeepMind.com/Blog/graphcast-ai-model-for-faster-and-more-accurate-global-weather-forecasting/Learning_skillful_medium-range_global_weather_forecasting.pdf" rel="noopener ugc nofollow" target="_blank"><strong class="nf fr">The paper</strong></a>.</li><li id="3865" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk"><a class="af nc" href="https://deepmind.google/discover/blog/graphcast-ai-model-for-faster-and-more-accurate-global-weather-forecasting/" rel="noopener ugc nofollow" target="_blank"><strong class="nf fr">The article</strong></a>.</li><li id="05c9" class="nd ne fq nf b go og nh ni gr oh nk nl nm oi no np nq oj ns nt nu ok nw nx ny od oe of bk"><a class="af nc" href="https://cds.climate.copernicus.eu/#!/home" rel="noopener ugc nofollow" target="_blank"><strong class="nf fr">CDS</strong></a>.</li></ul></div></div></div><div class="ab cb om on oo op" role="separator"><span class="oq by bm or os ot"/><span class="oq by bm or os ot"/><span class="oq by bm or os"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="ecdf" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Best of luck on your journey in data science and thank you for reading :)</p></div></div></div></div>    
</body>
</html>