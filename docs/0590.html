<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Making Causal Discovery work in real-world business settings</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Making Causal Discovery work in real-world business settings</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/making-causal-discovery-work-in-real-world-business-settings-80e80c5f66b8?source=collection_archive---------1-----------------------#2024-03-04">https://towardsdatascience.com/making-causal-discovery-work-in-real-world-business-settings-80e80c5f66b8?source=collection_archive---------1-----------------------#2024-03-04</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="9692" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">Causal AI, exploring the integration of causal reasoning into machine learning</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@raz1470?source=post_page---byline--80e80c5f66b8--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Ryan O'Sullivan" class="l ep by dd de cx" src="../Images/7cd161d38d67d2c0b7da2d8f3e7d33fe.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*tAw1S072P0f0sUswKPN6VQ.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--80e80c5f66b8--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://medium.com/@raz1470?source=post_page---byline--80e80c5f66b8--------------------------------" rel="noopener follow">Ryan O'Sullivan</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--80e80c5f66b8--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">10 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Mar 4, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj lc ld ab q ee le lf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count la lb">5</span></p></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lg k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lh an ao ap id li lj lk" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep ll cn"><div class="l ae"><div class="ab cb"><div class="lm ln lo lp lq lr ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk ml"><img src="../Images/f05a4aa4db90cf22a2acbe769fe06153.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*699L_w-Mk16AMSR1"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Photo by <a class="af nc" href="https://unsplash.com/@ellladee?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">N.</a> on <a class="af nc" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="8249" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">What is this series of articles about?</h1><p id="d31a" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">Welcome to my series on Causal AI, where we will explore the integration of causal reasoning into machine learning models. Expect to explore a number of practical applications across different business contexts.</p><p id="3cd8" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">In the first article we explored <em class="pa">using Causal Graphs to answer causal questions</em>. This time round we will delve into <em class="pa">making Causal Discovery work in real-world business settings</em>.</p><p id="6400" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">If you missed the first article on Causal Graphs, check it out here:</p><div class="pb pc pd pe pf pg"><a href="https://medium.com/@raz1470/using-causal-graphs-to-answer-causal-questions-5fd1dd82fa90?source=post_page-----80e80c5f66b8--------------------------------" rel="noopener follow" target="_blank"><div class="ph ab ig"><div class="pi ab co cb pj pk"><h2 class="bf fr hw z io pl iq ir pm it iv fp bk">Using Causal Graphs to answer causal questions</h2><div class="pn l"><h3 class="bf b hw z io pl iq ir pm it iv dx">This article gives a practical introduction to the potential of causal graphs.</h3></div><div class="po l"><p class="bf b dy z io pl iq ir pm it iv dx">medium.com</p></div></div><div class="pp l"><div class="pq l pr ps pt pp pu lr pg"/></div></div></a></div><h1 id="3c9f" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk"><strong class="al">Introduction</strong></h1><p id="c16b" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">This article aims to help you navigate the world of causal discovery.</p><p id="001d" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk"><strong class="ob fr">It is aimed at anyone who wants to understand more about:</strong></p><ul class=""><li id="4a59" class="nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou pv pw px bk">What causal discovery is, including what assumptions it makes.</li><li id="51aa" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk">A deep dive into conditional independence tests, the building blocks of causal discovery.</li><li id="1a0a" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk">An overview of the PC algorithm, a popular causal discovery algorithm.</li><li id="4eb8" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk">A worked case study in Python illustrating how to apply the PC algorithm.</li><li id="377a" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk">Guidance on making causal discovery work in real-world business settings.</li></ul><p id="07f2" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">The full notebook can be found here:</p><div class="pb pc pd pe pf pg"><a href="https://github.com/raz1470/causal_ai/blob/main/notebooks/making%20causal%20discovery%20work%20in%20real%20world%20business%20settings.ipynb?source=post_page-----80e80c5f66b8--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="ph ab ig"><div class="pi ab co cb pj pk"><h2 class="bf fr hw z io pl iq ir pm it iv fp bk">causal_ai/notebooks/making causal discovery work in real world business settings.ipynb at main ·…</h2><div class="pn l"><h3 class="bf b hw z io pl iq ir pm it iv dx">This project introduces Causal AI and how it can drive business value. - causal_ai/notebooks/making causal discovery…</h3></div><div class="po l"><p class="bf b dy z io pl iq ir pm it iv dx">github.com</p></div></div><div class="pp l"><div class="qd l pr ps pt pp pu lr pg"/></div></div></a></div><h1 id="4293" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">What is Causal Discovery?</h1><p id="6a1e" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">In my last article, I covered how causal graphs could be used to answer causal questions.</p><p id="608e" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Often referred to as a DAG (directed acyclic graph), a causal graph contains nodes and edges — Edges link nodes that causally related.</p><p id="4175" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">There are two ways to determine a causal graph:</p><ul class=""><li id="0124" class="nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou pv pw px bk">Expert domain knowledge</li><li id="34d8" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk">Causal discovery algorithms</li></ul><p id="05a5" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">We don’t always have the expert domain knowledge to determine a causal graph. In this notebook we will explore how to take observational data and determine the causal graph using causal discovery algorithms.</p><h1 id="755c" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Algorithms</h1><p id="4b7f" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">Causal discovery is a heavily researched area in academia with four groups of methods proposed:</p><p id="6ee9" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">It isn’t clear from currently available research which method is best. One of the challenges in answering this question is the lack of realistic ground truth benchmark datasets.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qe"><img src="../Images/3a67ca0bfe5871399e38649c64eb6e00.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eEeXupC5Vo38QUE5TwBmRQ.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by author</figcaption></figure><p id="1957" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">In this blog we are going to focus on understanding the PC algorithm, a constraint-based method that uses conditional independence tests.</p><h1 id="ce29" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Assumptions</h1><p id="1fe6" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">Before we introduce the PC algorithm, let’s cover the key assumptions made by causal discovery algorithms:</p><ol class=""><li id="2ef8" class="nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou qf pw px bk"><strong class="ob fr">Causal Markov Condition:</strong> Each variable is conditionally independent of its non-descendants, given its direct causes. This tells us that if we know the causes of a variable, we don’t gain any additional power by knowing the variables that are not directly influenced by those causes. This fundamental assumption simplifies the modelling of causal relationships enabling us to make causal inferences.</li><li id="fc6e" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou qf pw px bk"><strong class="ob fr">Causal Faithfulness:</strong> If statistical independence holds in the data, then there is no direct causal relationships between the corresponding variables. Testing this assumption is challenging and violations may indicate model misspecification or missing variables.</li><li id="6eac" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou qf pw px bk"><strong class="ob fr">Causal Sufficiency:</strong> Are the variables included sufficient to make causal claims about the variables of interest? In other words, we need all confounders of the variables included to be observed. Testing this assumption involves sensitivity analysis which assesses the impact of potentially unobserved confounders.</li><li id="5d7f" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou qf pw px bk"><strong class="ob fr">Acyclicity:</strong> No cycles in the graph.</li></ol><p id="bc78" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">In practice, while these assumptions are necessary for causal discovery, they are often treated as assumptions rather than directly tested.</p><p id="4839" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Even with making these assumptions, we can end up with a Markov equivalence class. We have a Markov equivalence class when we have multiple causal graphs each as likely as each other.</p><h1 id="3915" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Conditional Independence tests</h1><p id="d265" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">Conditional independence tests are the building blocks of causal discovery and are used by the PC algorithm (which we will cover shortly).</p><p id="6821" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Let’s start by understanding independence. Independence between two variables implies that knowing the value of one variable provides no information about the value of the other. In this case, it is fairly safe to assume that neither directly causes the other. However, if two variables aren’t independent, it would be wrong to blindly assume causation.</p><p id="4070" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Conditional independence tests can be used to determine whether two variables are independent of each other given the presence of one or more other variables. If two variables are conditionally independent, we can then infer that they are not causally related.</p><p id="d858" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">The Fisher’s exact test can be used to determine if there is a significant association between two variables whilst controlling for the effects of one or more additional variables (use the additional variables to split the data into subsets, the test can then be applied to each subset of data). The null hypothesis assumes that there is no association between the two variables of interest. A p-value can then be calculated and if it is below 0.05 the null hypothesis will be rejected suggesting that there is significant association between the variables.</p><h1 id="573c" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Identifying spurious correlations</h1><p id="152e" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">We can use an example of a spurious correlation to illustrate how to use conditional independence tests.</p><p id="762c" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Two variables have a spurious correlation when they have a common cause e.g. High temperatures increasing the number of ice cream sales and shark attacks.</p><pre class="mm mn mo mp mq qg qh qi bp qj bb bk"><span id="f131" class="qk ne fq qh b bg ql qm l qn qo">np.random.seed(999)<br/><br/># Create dataset with spurious correlation<br/>temperature = np.random.normal(loc=0, scale=1, size=1000)<br/>ice_cream_sales = 2.5 * temperature + np.random.normal(loc=0, scale=1, size=1000)<br/>shark_attacks = 0.5 * temperature + np.random.normal(loc=0, scale=1, size=1000)<br/>df_spurious = pd.DataFrame(data=dict(temperature=temperature, ice_cream_sales=ice_cream_sales, shark_attacks=shark_attacks))<br/><br/># Pairplot<br/>sns.pairplot(df_spurious, corner=True)</span></pre><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qp"><img src="../Images/f544381e6bb7d26d0958df2b2aee2515.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7XALFPFAiS5oxTXtPeBqxA.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by author</figcaption></figure><pre class="mm mn mo mp mq qg qh qi bp qj bb bk"><span id="dc86" class="qk ne fq qh b bg ql qm l qn qo"># Create node lookup variables<br/>node_lookup = {0: 'Temperature',<br/>               1: 'Ice cream sales',<br/>               2: 'Shark attacks'                                                                          <br/> }<br/><br/>total_nodes = len(node_lookup)<br/><br/># Create adjacency matrix - this is the base for our graph<br/>graph_actual = np.zeros((total_nodes, total_nodes))<br/><br/># Create graph using expert domain knowledge<br/>graph_actual[0, 1] = 1.0 # Temperature -&gt; Ice cream sales<br/>graph_actual[0, 2] = 1.0 # Temperature -&gt; Shark attacks<br/>     <br/>plot_graph(input_graph=graph_actual, node_lookup=node_lookup)</span></pre><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk qq"><img src="../Images/8012d363828cd7ea22e2d474b5c29f9b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1238/format:webp/1*SttkPqZEyw9a_U_a58ZG5A.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by author</figcaption></figure><p id="c0d8" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">The following conditional independence tests can be used to determine the causal graph:</p><pre class="mm mn mo mp mq qg qh qi bp qj bb bk"><span id="6d47" class="qk ne fq qh b bg ql qm l qn qo"># Run first conditional independence test<br/>test_id_1 = round(gcm.independence_test(ice_cream_sales, shark_attacks, conditioned_on=temperature), 2)<br/><br/># Run second conditional independence test<br/>test_id_2 = round(gcm.independence_test(ice_cream_sales, temperature, conditioned_on=shark_attacks), 2)<br/><br/># Run third conditional independence test<br/>test_id_3 = round(gcm.independence_test(shark_attacks, temperature, conditioned_on=ice_cream_sales), 2)</span></pre><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qr"><img src="../Images/a85b275df7ee00a835fef623cdb5687f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*18-WqMSt8oPBVOTwJK0qNw.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by author</figcaption></figure><p id="d323" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Although we don’t know the direction of the relationships, we can correctly infer that temperature is causally related to both ice cream sales and shark attacks.</p><h1 id="a638" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">PC algorithm</h1><p id="75c1" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">The PC algorithm (named after its inventors Peter and Clark) is a constraint-based causal discovery algorithm that uses conditional independence tests.</p><p id="492b" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">It can be summarised into 2 main steps:</p><ol class=""><li id="a2bc" class="nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou qf pw px bk">It starts with a fully connected graph and then uses conditional independence tests to remove edges and identify the undirected causal graph (nodes linked but with no direction).</li><li id="f842" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou qf pw px bk">It then (partially) directs the edges using various orientation tricks.</li></ol><p id="2da0" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">We can use the previous spurious correlation example to illustrate the first step:</p><ul class=""><li id="faea" class="nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou pv pw px bk">Start with a fully connected graph</li><li id="8052" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk">Test ID 1: Accept the null hypothesis and delete edge, no causal link between ice cream sales and shark attacks</li><li id="9967" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk">Test ID 2: Reject the null hypothesis and keep the edge, causal link between ice cream sales and temperature</li><li id="d0d3" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk">Test ID 3: Reject the null hypothesis and keep the edge, causal link between shark attacks and ice cream sales</li></ul><h1 id="63a7" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Evaluating results</h1><p id="4004" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">One of the key challenges in causal discovery is evaluating the results. If we knew the causal graph, we wouldn’t need to apply a causal discovery algorithm! However, we can create synthetic datasets to evaluate how well causal discovery algorithms perform.</p><p id="cc7a" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">There are several metrics we can use to evaluate causal discovery algorithms:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk qs"><img src="../Images/f5865fe263ed76a07bffd2b393348ee6.png" data-original-src="https://miro.medium.com/v2/resize:fit:940/format:webp/1*lNZ-zlCHISUAgB_OvaM8_A.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by author</figcaption></figure><ul class=""><li id="9c62" class="nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou pv pw px bk"><em class="pa">True positives: Identify causal link correctly</em></li><li id="7cb6" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk"><em class="pa">False positives: Identify causal link incorrectly</em></li><li id="5f94" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk"><em class="pa">True negatives: Correctly identify no causal link</em></li><li id="2f18" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk"><em class="pa">False negatives: Incorrectly identify no causal link</em></li><li id="1e8d" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk"><em class="pa">Reversed edges: Identify causal link correctly but in the wrong direction</em></li></ul><p id="dbbf" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">We want a high number of True positives, but this should not be at the expense of a high number of False positives (as when we come to build an SCM, wrong causal links can be very damaging). Therefore GScore seems to capture this well whilst giving an interpretable ratio between 0 and 1.</p><h1 id="0f52" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Call Centre case study</h1><p id="26c7" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">We will revisit the call centre case study from my previous article. First of all, we determine the causal graph (to be used as ground truth) and then use our knowledge of the data-generating process to create some samples.</p><p id="494b" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">The ground truth causal graph and generated samples will enable us to evaluate the PC algorithm.</p><pre class="mm mn mo mp mq qg qh qi bp qj bb bk"><span id="421f" class="qk ne fq qh b bg ql qm l qn qo"># Create node lookup for channels<br/>node_lookup = {0: 'Demand',<br/>               1: 'Call waiting time',<br/>               2: 'Call abandoned', <br/>               3: 'Reported problems',                   <br/>               4: 'Discount sent',<br/>               5: 'Churn'                                                                             <br/> }<br/><br/>total_nodes = len(node_lookup)<br/><br/># Create adjacency matrix - this is the base for our graph<br/>graph_actual = np.zeros((total_nodes, total_nodes))<br/><br/># Create graph using expert domain knowledge<br/>graph_actual[0, 1] = 1.0 # Demand -&gt; Call waiting time<br/>graph_actual[0, 2] = 1.0 # Demand -&gt; Call abandoned<br/>graph_actual[0, 3] = 1.0 # Demand -&gt; Reported problems<br/>graph_actual[1, 2] = 1.0 # Call waiting time -&gt; Call abandoned<br/>graph_actual[1, 5] = 1.0 # Call waiting time -&gt; Churn<br/>graph_actual[2, 3] = 1.0 # Call abandoned -&gt; Reported problems<br/>graph_actual[2, 5] = 1.0 # Call abandoned -&gt; Churn<br/>graph_actual[3, 4] = 1.0 # Reported problems -&gt; Discount sent<br/>graph_actual[3, 5] = 1.0 # Reported problems -&gt; Churn<br/>graph_actual[4, 5] = 1.0 # Discount sent -&gt; Churn<br/><br/>plot_graph(input_graph=graph_actual, node_lookup=node_lookup)</span></pre><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qt"><img src="../Images/7f87d73da2c5be5e5e94137445c52f12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ByZGiTHpX5bx0fkcuItMpg.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by author</figcaption></figure><pre class="mm mn mo mp mq qg qh qi bp qj bb bk"><span id="7105" class="qk ne fq qh b bg ql qm l qn qo">def data_generator(max_call_waiting, inbound_calls, call_reduction):<br/>    '''<br/>     A data generating function that has the flexibility to reduce the value of node 0 (Call waiting time) - this enables us to calculate ground truth counterfactuals<br/><br/>    Args:<br/>        max_call_waiting (int): Maximum call waiting time in seconds<br/>        inbound_calls (int): Total number of inbound calls (observations in data)<br/>        call_reduction (float): Reduction to apply to call waiting time<br/><br/>    Returns:<br/>        DataFrame: Generated data<br/>    '''<br/>    <br/>    df = pd.DataFrame(columns=node_lookup.values())<br/><br/>    df[node_lookup[0]] = np.random.randint(low=10, high=max_call_waiting, size=(inbound_calls)) # Demand<br/>    df[node_lookup[1]] = (df[node_lookup[0]] * 0.5) * (call_reduction) + np.random.normal(loc=0, scale=40, size=inbound_calls) # Call waiting time<br/>    df[node_lookup[2]] = (df[node_lookup[1]] * 0.5) + (df[node_lookup[0]] * 0.2) + np.random.normal(loc=0, scale=30, size=inbound_calls) # Call abandoned<br/>    df[node_lookup[3]] = (df[node_lookup[2]] * 0.6) + (df[node_lookup[0]] * 0.3) + np.random.normal(loc=0, scale=20, size=inbound_calls) # Reported problems<br/>    df[node_lookup[4]] = (df[node_lookup[3]] * 0.7) + np.random.normal(loc=0, scale=10, size=inbound_calls) # Discount sent<br/>    df[node_lookup[5]] = (0.10 * df[node_lookup[1]] ) + (0.30 * df[node_lookup[2]]) + (0.15 * df[node_lookup[3]]) + (-0.20 * df[node_lookup[4]]) # Churn<br/><br/>    return df<br/><br/># Generate data<br/>np.random.seed(999)<br/>df = data_generator(max_call_waiting=600, inbound_calls=10000, call_reduction=1.00)<br/><br/># Pairplot<br/>sns.pairplot(df, corner=True)</span></pre><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qu"><img src="../Images/c1a355767929b4851297ba48e8f2fb1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*trDtRm4ZGsMKTk08LJ8nGg.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by author</figcaption></figure><h1 id="a63d" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Applying the PC algorithm</h1><p id="b4ec" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">The Python package gCastle has several causal discovery algorithms implemented, including the PC algorithm:</p><div class="pb pc pd pe pf pg"><a href="https://github.com/huawei-noah/trustworthyAI/tree/master/gcastle?source=post_page-----80e80c5f66b8--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="ph ab ig"><div class="pi ab co cb pj pk"><h2 class="bf fr hw z io pl iq ir pm it iv fp bk">trustworthyAI/gcastle at master · huawei-noah/trustworthyAI</h2><div class="pn l"><h3 class="bf b hw z io pl iq ir pm it iv dx">Trustworthy AI related projects. Contribute to huawei-noah/trustworthyAI development by creating an account on GitHub.</h3></div><div class="po l"><p class="bf b dy z io pl iq ir pm it iv dx">github.com</p></div></div><div class="pp l"><div class="qv l pr ps pt pp pu lr pg"/></div></div></a></div><p id="81f5" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">When we feed the algorithm our samples we receive back the learned causal graph (in the form of an adjacency matrix).</p><pre class="mm mn mo mp mq qg qh qi bp qj bb bk"><span id="d6b4" class="qk ne fq qh b bg ql qm l qn qo"># Apply PC method to learn graph<br/>pc = PC(variant='stable')<br/>pc.learn(df)<br/>graph_pred = pc.causal_matrix<br/><br/>graph_pred</span></pre><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk qw"><img src="../Images/05a6f4f3f1d28011a50f0e7f11811d18.png" data-original-src="https://miro.medium.com/v2/resize:fit:418/format:webp/1*atfBYAfLp8A5q4KQjdEzNQ.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by author</figcaption></figure><p id="91be" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">gCastle also has several evaluation metrics available, including gScore. The GScore of our learned graph is 0! Why has it done so poorly?</p><pre class="mm mn mo mp mq qg qh qi bp qj bb bk"><span id="8498" class="qk ne fq qh b bg ql qm l qn qo"># GScore<br/>metrics = MetricsDAG(<br/>    B_est=graph_pred, <br/>    B_true=graph_actual)<br/>metrics.metrics['gscore']</span></pre><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk qx"><img src="../Images/cff9208e806a15803a1eb51b797ab5d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:78/format:webp/1*C93U95pTIlBzJ2N-Qom1EA.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by author</figcaption></figure><p id="b945" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">On closer inspection of the learned graph, we can see that it correctly identified the undirected graph and then struggled to orient the edges.</p><pre class="mm mn mo mp mq qg qh qi bp qj bb bk"><span id="898c" class="qk ne fq qh b bg ql qm l qn qo">plot_graph(input_graph=graph_pred, node_lookup=node_lookup)</span></pre><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qt"><img src="../Images/fab02cea93344a2bae808a12a80c12e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*miIrtm1ODygknMtpe-o_OA.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by author</figcaption></figure><h1 id="ce8a" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Evaluating the undirected graph</h1><p id="b001" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">To build on the learning from applying the PC algorithm, we can use gCastle to extract the undirected causal graph that was learned.</p><pre class="mm mn mo mp mq qg qh qi bp qj bb bk"><span id="80d9" class="qk ne fq qh b bg ql qm l qn qo"># Apply PC method to learn skeleton<br/>skeleton_pred, sep_set = find_skeleton(df.to_numpy(), 0.05, 'fisherz')<br/><br/>skeleton_pred</span></pre><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk qy"><img src="../Images/c062b2429c96d525e3003542879584f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:466/format:webp/1*JC4l5Ckx-ioy1eey0EAlVQ.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by author</figcaption></figure><p id="0c12" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">If we transform our ground truth graph into an undirected adjacency matrix, we can then use it to calculate the Gscore of the undirected graph.</p><pre class="mm mn mo mp mq qg qh qi bp qj bb bk"><span id="273e" class="qk ne fq qh b bg ql qm l qn qo"># Transform the ground truth graph into an undirected adjacency matrix<br/>skeleton_actual = graph_actual + graph_actual.T<br/>skeleton_actual = np.where(skeleton_actual &gt; 0, 1, 0)</span></pre><p id="c4d7" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Using the learned undirected causal graph we get a GScore of 1.00.</p><pre class="mm mn mo mp mq qg qh qi bp qj bb bk"><span id="db4e" class="qk ne fq qh b bg ql qm l qn qo"># GScore<br/>metrics = MetricsDAG(<br/>    B_est=skeleton_pred, <br/>    B_true=skeleton_actual)<br/>metrics.metrics['gscore']</span></pre><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk qz"><img src="../Images/d21aa0f78e089638117ec5e5ef87362a.png" data-original-src="https://miro.medium.com/v2/resize:fit:82/format:webp/1*tIekXz_-nbsvsqXd7fpNPg.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by author</figcaption></figure><p id="9097" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">We have accurately learned an undirected graph — could we use expert domain knowledge to direct the edges? The answer to this will vary across different use cases, but it is a reasonable strategy.</p><pre class="mm mn mo mp mq qg qh qi bp qj bb bk"><span id="5f8a" class="qk ne fq qh b bg ql qm l qn qo">plot_graph(input_graph=skeleton_pred, node_lookup=node_lookup)</span></pre><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qt"><img src="../Images/8f7cc6d5bee46dbbbec62b82a6aa8c2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8vF4rKikptG423uQnzJ2ZQ.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by author</figcaption></figure><h1 id="8412" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Making Causal Discovery work in real-world business settings</h1><p id="99e9" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk"><strong class="ob fr">We need to start seeing causal discovery as an essential EDA step in any causal inference project:</strong></p><ul class=""><li id="6868" class="nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou pv pw px bk"><em class="pa">However, we also need to be transparent about its limitations.</em></li><li id="fd40" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk"><em class="pa">Causal discovery is a tool that needs complementing with expert domain knowledge.</em></li></ul><p id="d183" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk"><strong class="ob fr">Be pragmatic with the assumptions:</strong></p><ul class=""><li id="40d6" class="nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou pv pw px bk"><em class="pa">Can we ever expect to observe all confounders? Probably not. However, with the correct domain knowledge and extensive data gathering, it is feasible that we could observe all the key confounders.</em></li></ul><p id="1cea" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk"><strong class="ob fr">Pick an algorithm where we can apply constraints to incorporate expert domain knowledge — gCastle allows us to apply constraints to the PC algorithm:</strong></p><ul class=""><li id="ea5a" class="nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou pv pw px bk"><em class="pa">Initially work on identifying the undirected causal graph and then share this output with domain experts and use them to help orient the graph.</em></li></ul><p id="de7e" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk"><strong class="ob fr">Be cautious when using proxy variables and consider enforcing constraints on relationships we strongly believe exist:</strong></p><ul class=""><li id="1e3d" class="nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou pv pw px bk"><em class="pa">For example, if include Google trends data as a proxy for product demand, we may need to enforce constraints in terms of this driving sales.</em></li></ul><h1 id="e06c" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Future work</h1><ul class=""><li id="fce9" class="nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou pv pw px bk">What if we have non-linear relationships? Can the PC algorithm handle this?</li><li id="d523" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk">What happens if we have unobserved confounders? Can the FCI algorithm deal with this situation effectively?</li><li id="4efb" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk">How do constraint-based, score-based, functional-based and gradient-based methods compare?</li></ul></div></div></div><div class="ab cb ra rb rc rd" role="separator"><span class="re by bm rf rg rh"/><span class="re by bm rf rg rh"/><span class="re by bm rf rg"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="d61c" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Follow me if you want to continue this journey into Causal AI — In the next article we will understand how Double Machine Learning can help de-bias treatment effects.</p></div></div></div></div>    
</body>
</html>