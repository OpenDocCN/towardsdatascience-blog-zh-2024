<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Label Studio Customized Backend for Semiautomatic Image Segmentation Labeling</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Label Studio Customized Backend for Semiautomatic Image Segmentation Labeling</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/label-studio-customized-backend-for-semiautomatic-image-segmentation-labeling-324c2310d756?source=collection_archive---------6-----------------------#2024-04-20">https://towardsdatascience.com/label-studio-customized-backend-for-semiautomatic-image-segmentation-labeling-324c2310d756?source=collection_archive---------6-----------------------#2024-04-20</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="bb03" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">Customized backend; GCP Deployment; Data Versioning with GCS Integration</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@AlisonYuhanYao?source=post_page---byline--324c2310d756--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Alison Yuhan Yao" class="l ep by dd de cx" src="../Images/c862182d1b3c549dcf1906ca04038b2a.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*e4LwU0fXlqQ2SDs_gtETdA.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--324c2310d756--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://medium.com/@AlisonYuhanYao?source=post_page---byline--324c2310d756--------------------------------" rel="noopener follow">Alison Yuhan Yao</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--324c2310d756--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">13 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Apr 20, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj la lb ab q ee lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lf k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lg an ao ap id lh li lj" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep lk cn"><div class="l ae"><div class="ab cb"><div class="ll lm ln lo lp lq ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj mk"><img src="../Images/afe12f776d93863b6c22347955c1cdc8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t41c-xM3byCQadgN4qAw0w.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><h2 id="0210" class="nb nc fq bf nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Table of Contents</h2><p id="2100" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh nm oi oj ok nq ol om on nu oo op oq or fj bk">· <a class="af os" href="#202a" rel="noopener ugc nofollow">Introduction</a><br/>· <a class="af os" href="#d792" rel="noopener ugc nofollow">Overview</a><br/> ∘ <a class="af os" href="#2329" rel="noopener ugc nofollow">Goal</a><br/> ∘ <a class="af os" href="#b71f" rel="noopener ugc nofollow">Why semiautomatic?</a><br/> ∘ <a class="af os" href="#d3f4" rel="noopener ugc nofollow">Entering Label Studio</a><br/> ∘ <a class="af os" href="#5a72" rel="noopener ugc nofollow">1 frontend + 2 backends</a><br/>· <a class="af os" href="#4dc5" rel="noopener ugc nofollow">Implementation (Local)</a><br/> ∘ <a class="af os" href="#e769" rel="noopener ugc nofollow">1. Install git and docker &amp; download backend code</a><br/> ∘ <a class="af os" href="#fa97" rel="noopener ugc nofollow">2. Set up frontend to get access token</a><br/> ∘ <a class="af os" href="#4cc0" rel="noopener ugc nofollow">3. Set up backend containers</a><br/> ∘ <a class="af os" href="#f7ab" rel="noopener ugc nofollow">4. Connect containers</a><br/> ∘ <a class="af os" href="#763a" rel="noopener ugc nofollow">5. Happy labeling!</a><br/>· <a class="af os" href="#8783" rel="noopener ugc nofollow">GCP Deployment</a><br/> ∘ <a class="af os" href="#8b11" rel="noopener ugc nofollow">1. Select project/Create new project and set up billing account</a><br/> ∘ <a class="af os" href="#a1b4" rel="noopener ugc nofollow">2. Create VM instance</a><br/> ∘ <a class="af os" href="#cf45" rel="noopener ugc nofollow">3. Set up VM environment</a><br/> ∘ <a class="af os" href="#2ea2" rel="noopener ugc nofollow">4. Follow previous section &amp; set up everything on VM</a><br/>· <a class="af os" href="#f815" rel="noopener ugc nofollow">GCS Integration</a><br/> ∘ <a class="af os" href="#4329" rel="noopener ugc nofollow">1. Set up GCS buckets</a><br/> ∘ <a class="af os" href="#84f3" rel="noopener ugc nofollow">2. Create &amp; set up service account key</a><br/> ∘ <a class="af os" href="#2e13" rel="noopener ugc nofollow">3. Rebuild backend containers</a><br/> ∘ <a class="af os" href="#3d43" rel="noopener ugc nofollow">4. SDK upload images from source bucket</a><br/> ∘ <a class="af os" href="#165a" rel="noopener ugc nofollow">5. Set up Target Storage</a><br/>· <a class="af os" href="#cc13" rel="noopener ugc nofollow">Acknowledgement</a><br/>· <a class="af os" href="#cb81" rel="noopener ugc nofollow">References</a></p><h1 id="202a" class="ot nc fq bf nd ou ov gq nh ow ox gt nl oy oz pa pb pc pd pe pf pg ph pi pj pk bk">Introduction</h1><p id="e74b" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh nm oi oj ok nq ol om on nu oo op oq or fj bk">Creating training data for image segmentation tasks remains a challenge for individuals and small teams. And if you are a student researcher like me, finding a cost-efficient way is especially important. In this post, I will talk about one solution that I used in <a class="af os" href="https://seas.harvard.edu/news/2024/05/masters-student-capstone-spotlight-ai-fashion" rel="noopener ugc nofollow" target="_blank">my capstone project</a> where a team of 9 people successfully labeled 400+ images within a week.</p><p id="dfe0" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">Thanks to Politecnico di Milano <a class="af os" href="https://www.centroricercagianfrancoferre.it/home/FGFhome.php?lang=en" rel="noopener ugc nofollow" target="_blank">Gianfranco Ferré Research Center</a>, we obtained thousands of fashion runway show images from Gianfranco Ferré’s archival database. To explore, manage, enrich, and analyze the database, I employed <em class="pq">image segmentation </em>for<em class="pq"> </em>smarter cataloging and fine-grained research. Image segmentation of runway show photos also lays the foundation for creating informative textual descriptions for better search engine and text-to-image generative AI approaches. Therefore, this blog will detail:</p><ul class=""><li id="db56" class="nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or pr ps pt bk">how to create your own backend with <a class="af os" href="https://labelstud.io/" rel="noopener ugc nofollow" target="_blank">label studio</a>, on top of the existing <a class="af os" href="https://labelstud.io/blog/get-started-using-segment-anything/" rel="noopener ugc nofollow" target="_blank">segment anything backend</a>, for semiautomatic image segmentation labeling,</li><li id="2b25" class="nz oa fq ob b go pu od oe gr pv og oh nm pw oj ok nq px om on nu py op oq or pr ps pt bk">how to host on Google Cloud Platform for group collaboration, and</li><li id="18e2" class="nz oa fq ob b go pu od oe gr pv og oh nm pw oj ok nq px om on nu py op oq or pr ps pt bk">how to employ Google Cloud Storage buckets for data versioning.</li></ul><blockquote class="pz qa qb"><p id="571f" class="nz oa pq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">Code in this post can be found in this <a class="af os" href="https://github.com/AlisonYao/label-studio-customized-ml-backend" rel="noopener ugc nofollow" target="_blank">GitHub repo</a>.</p></blockquote><h1 id="d792" class="ot nc fq bf nd ou ov gq nh ow ox gt nl oy oz pa pb pc pd pe pf pg ph pi pj pk bk">Overview</h1><h2 id="2329" class="nb nc fq bf nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Goal</h2><p id="e1be" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh nm oi oj ok nq ol om on nu oo op oq or fj bk">Segment and identify the names and typologies of fashion clothing items in runway show images, as shown in the first image.</p><h2 id="b71f" class="nb nc fq bf nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Why semiautomatic?</h2><p id="0a94" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh nm oi oj ok nq ol om on nu oo op oq or fj bk">Wouldn’t it be nice if a trained segmentation model out there could perfectly recognize every piece of clothing in the runway show images? Sadly, there isn’t one. There exist trained models tailored to fashion or clothing images but nothing can match our dataset perfectly. Each fashion designer has their own style and preferences for certain clothing items and their color and texture, so even if a segmentation model can be 60% accurate, we call it a win. Then, we still need humans in the loop to correct what the segmentation model got wrong.</p><h2 id="d3f4" class="nb nc fq bf nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Entering Label Studio</h2><p id="11c0" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh nm oi oj ok nq ol om on nu oo op oq or fj bk">Label Studio provides an open-source, customizable, and free-of-charge community version for various types of data labeling. One can create their own backend, so I can connect the Label Studio frontend to the trained segmentation model (mentioned above) backend for labelers to further improve upon the auto-predictions. Furthermore, Label Studio already has an interface that looks somewhat similar to Photoshop and a series of segmentation tools that can come in handy for us:</p><ul class=""><li id="bfa3" class="nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or pr ps pt bk">Brush &amp; eraser</li><li id="e055" class="nz oa fq ob b go pu od oe gr pv og oh nm pw oj ok nq px om on nu py op oq or pr ps pt bk"><a class="af os" href="https://labelstud.io/tags/magicwand" rel="noopener ugc nofollow" target="_blank">Magic Wand</a> for similar-color pixel selection</li><li id="c8d6" class="nz oa fq ob b go pu od oe gr pv og oh nm pw oj ok nq px om on nu py op oq or pr ps pt bk"><a class="af os" href="https://labelstud.io/blog/get-started-using-segment-anything/" rel="noopener ugc nofollow" target="_blank">Segment Anything</a> backend which harnesses the power of <a class="af os" href="https://segment-anything.com/" rel="noopener ugc nofollow" target="_blank">Meta’s SAM</a> and allows you to recognize the object within a bounding box you draw.</li></ul><h2 id="5a72" class="nb nc fq bf nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny bk">1 frontend + 2 backends</h2><p id="62c6" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh nm oi oj ok nq ol om on nu oo op oq or fj bk">So far, we want 2 backends to be connected to the frontend. One backend can do the segmentation prediction and the second can speed up labelers’ modification if the predictions are wrong.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qc"><img src="../Images/cd0d4db085c10c9080342331e55af566.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tGe7cU38QDjZ1pasd0sx2g.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><h1 id="4dc5" class="ot nc fq bf nd ou ov gq nh ow ox gt nl oy oz pa pb pc pd pe pf pg ph pi pj pk bk">Implementation (Local)</h1><p id="b56d" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh nm oi oj ok nq ol om on nu oo op oq or fj bk">Now, let’s fire up the app locally. That is, you will be able to use the app on your laptop or local machine completely for free but you are not able to invite your labeling team to collaborate on their laptops yet. We will talk about teamwork with GCP in the next section.</p><h2 id="e769" class="nb nc fq bf nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny bk">1. Install git and docker &amp; download backend code</h2><p id="701f" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh nm oi oj ok nq ol om on nu oo op oq or fj bk">If you don’t have <a class="af os" href="https://git-scm.com/downloads" rel="noopener ugc nofollow" target="_blank">git</a> or <a class="af os" href="https://www.docker.com/products/docker-desktop/" rel="noopener ugc nofollow" target="_blank">docker</a> on your laptop or local machine yet, please install them. (Note: you can technically bypass the step of installing git if you download the zip file from <a class="af os" href="https://github.com/AlisonYao/label-studio-customized-ml-backend" rel="noopener ugc nofollow" target="_blank">this GitHub repo</a>. If you do so, skip the following.)</p><p id="5057" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">Then, open up your terminal and clone <a class="af os" href="https://github.com/AlisonYao/label-studio-customized-ml-backend" rel="noopener ugc nofollow" target="_blank">this repo</a> to a directory you want.</p><pre class="ml mm mn mo mp qd qe qf bp qg bb bk"><span id="b3ef" class="qh nc fq qe b bg qi qj l qk ql">git clone https://github.com/AlisonYao/label-studio-customized-ml-backend.git</span></pre><p id="42aa" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">If you open up the <code class="cx qm qn qo qe b">label-studio-customized-ml-backend</code> folder in your code editor, you can see the majority are adapted from the <a class="af os" href="https://github.com/HumanSignal/label-studio-ml-backend" rel="noopener ugc nofollow" target="_blank">Label Studio ML backend</a> repo, but this directory also contains frontend template code and SDK code adapted from <a class="af os" href="https://github.com/HumanSignal/label-studio-sdk" rel="noopener ugc nofollow" target="_blank">Label Studio SDK</a>.</p><h2 id="fa97" class="nb nc fq bf nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny bk">2. Set up frontend to get access token</h2><p id="043b" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh nm oi oj ok nq ol om on nu oo op oq or fj bk">Following the official guidelines of <a class="af os" href="https://labelstud.io/blog/get-started-using-segment-anything/" rel="noopener ugc nofollow" target="_blank">segment anything</a>, do the following in your terminal:</p><pre class="ml mm mn mo mp qd qe qf bp qg bb bk"><span id="48dc" class="qh nc fq qe b bg qi qj l qk ql">cd label-studio-customized-ml-backend/label_studio_ml/examples/segment_anything_model<br/><br/>docker run -it -p 8080:8080 \<br/>    -v $(pwd)/mydata:/label-studio/data \<br/>    --env LABEL_STUDIO_LOCAL_FILES_SERVING_ENABLED=true \<br/>    --env LABEL_STUDIO_LOCAL_FILES_DOCUMENT_ROOT=/label-studio/data/images \<br/>    heartexlabs/label-studio:latest</span></pre><p id="b540" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">Then, open your browser and type <a class="af os" href="http://0.0.0.0:8080/" rel="noopener ugc nofollow" target="_blank">http://0.0.0.0:8080/</a> and you will see the frontend of Label Studio. Proceed to sign up with your email address. Now, there is no project yet so we need to create our first project by clicking <strong class="ob fr">Create Project</strong>. Create a name and description (optional) for your project.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qp"><img src="../Images/d88cff94b8c3228e822bd745514700f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gx0xGYPP3s4_9hzSQQxBqQ.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><p id="d967" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">Upload some images locally. (We will talk about how to use cloud storage later.)</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qp"><img src="../Images/60de7269242fb8747a3f027d848404fe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oWdkxA5jlVEMYW5oAsN2pg.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><p id="47ca" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">For Labeling Setup, click on <strong class="ob fr">Custom template</strong> on the left and copy-paste the HTML code from the <code class="cx qm qn qo qe b">label-studio-customized-ml-backend/label_studio_frontend/view.html</code> file. You do not need the four lines of Headers if you don’t want to show image metadata in the labeling interface. Feel free to modify the code here to your need or click <strong class="ob fr">Visual</strong> to add or delete labels.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qp"><img src="../Images/46b0cded775343e89ccd3183fcff4804.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4GN8H2IdMcBJitYc9CV6pA.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><p id="5537" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">Now, click <strong class="ob fr">Save</strong> and your labeling interface should be ready.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qq"><img src="../Images/00078d62a35d98139f516039dd133850.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wzYD-GtLBMhDvals_ghAKg.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><p id="e782" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">On the top right, click on the user setting icon and click <strong class="ob fr">Account &amp; Setting</strong> and then you should be able to copy your access token.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qr"><img src="../Images/7514cd7d8f931d1ea809c810d84ecb77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qXDhjWeLFV1LKDZ7AdWEvA.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><h2 id="4cc0" class="nb nc fq bf nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny bk">3. Set up backend containers</h2><p id="5481" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh nm oi oj ok nq ol om on nu oo op oq or fj bk">In the <code class="cx qm qn qo qe b">label-studio-customized-ml-backend</code> directory, there are many many backends thanks to the Label Studio developers. We will be using the customized <code class="cx qm qn qo qe b">./segmentation</code> backend for segmentation prediction (container 1) and the <code class="cx qm qn qo qe b">./label_studio_ml/examples/segment_anything_model</code> for faster labeling (container 2). The former will use port 7070 and the latter will use port 9090, making it easy to distinguish from the frontend port 8080.</p><p id="fdc9" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">Now, paste your access token to the 2 <code class="cx qm qn qo qe b">docker-compose.yml</code> files in <code class="cx qm qn qo qe b">./segmentation</code>and <code class="cx qm qn qo qe b">./label_studio_ml/examples/segment_anything_model</code> folders.</p><pre class="ml mm mn mo mp qd qe qf bp qg bb bk"><span id="60e2" class="qh nc fq qe b bg qi qj l qk ql">environment:<br/>  - LABEL_STUDIO_ACCESS_TOKEN=6dca0beafd235521cd9f23d855e223720889f4e1</span></pre><p id="5c48" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">Open up a new terminal and you cd into the <code class="cx qm qn qo qe b">segment_anything_model</code> directory as you did before. Then, fire up the segment anything container.</p><pre class="ml mm mn mo mp qd qe qf bp qg bb bk"><span id="d0e8" class="qh nc fq qe b bg qi qj l qk ql">cd label-studio-customized-ml-backend/label_studio_ml/examples/segment_anything_model<br/><br/>docker build . -t sam:latest<br/>docker compose up</span></pre><p id="7264" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">Then, open up another new terminal cd into the <code class="cx qm qn qo qe b">segmentation</code> directory and fire up the segmentation prediction container.</p><pre class="ml mm mn mo mp qd qe qf bp qg bb bk"><span id="d9fb" class="qh nc fq qe b bg qi qj l qk ql">cd label-studio-customized-ml-backend/segmentation<br/><br/>docker build . -t seg:latest<br/>docker compose up</span></pre><p id="e98f" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">As of now, we have successfully started all 3 containers and you can double-check.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qs"><img src="../Images/ee9e5a21a35b9de9be3eef35678a6ae0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JOSuhlQK8QfVXmfnA-JfLg.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><h2 id="f7ab" class="nb nc fq bf nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny bk">4. Connect containers</h2><p id="11db" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh nm oi oj ok nq ol om on nu oo op oq or fj bk">Before, what we did with the access token was helping us connect containers already, so we are almost done. Now, go to the frontend you started a while back and click <strong class="ob fr">Settings</strong> in the top right corner. Click <strong class="ob fr">Machine Learning</strong> on the left and click <strong class="ob fr">Add Model</strong>.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qs"><img src="../Images/a0e3b4bdce93b16aac9fd0b492838629.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cPrvWdwF8NjaMrKej54v6w.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><p id="ba35" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">Be sure to use the URL with port 9090 and toggle on interactive preannotation. Finish adding by clicking <strong class="ob fr">Validate and Save</strong>.</p><p id="5744" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">Similarly, do the same with the segmentation prediction backend.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qs"><img src="../Images/08cba82cb7ad1df12a89c296ab642d4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8kc5Tr1OG2xXvi0wcyrRjQ.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><p id="d4d6" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">Then, I like to toggle on <strong class="ob fr">Retrieve predictions when loading a task automatically</strong>. This way, every time we refresh the labeling page, the segmentation predictions will be automatically triggered and loaded.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qs"><img src="../Images/a976abd4d9d05a89e50d3dec222ff5c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TLw9td0xYzmQL0Qh0-__zA.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><h2 id="763a" class="nb nc fq bf nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny bk">5. Happy labeling!</h2><p id="401c" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh nm oi oj ok nq ol om on nu oo op oq or fj bk">Here is a demo of what you should see if you follow the steps above.</p><figure class="ml mm mn mo mp mq"><div class="qt io l ed"><div class="qu qv l"/></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Video by Author</figcaption></figure><p id="fe19" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">If we are not happy with the predictions of let’s say the skirt, we can delete the skirt and use the purple magic (segment anything) to quickly label it.</p><figure class="ml mm mn mo mp mq"><div class="qt io l ed"><div class="qu qv l"/></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Video By Author</figcaption></figure><p id="6684" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">I’m sure you can figure out how to use the brush, eraser and magic wand on your own!</p></div></div></div><div class="ab cb qw qx qy qz" role="separator"><span class="ra by bm rb rc rd"/><span class="ra by bm rb rc rd"/><span class="ra by bm rb rc"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="5b32" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">If you are working solo, you are all set. But if you are wondering how to collaborate with your team without subscribing to Label Studio Enterprise, we need to host everything on cloud.</p><h1 id="8783" class="ot nc fq bf nd ou ov gq nh ow ox gt nl oy oz pa pb pc pd pe pf pg ph pi pj pk bk">GCP Deployment</h1><p id="4342" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh nm oi oj ok nq ol om on nu oo op oq or fj bk">I chose GCP because of education credits, but you can use any cloud of your choice. The point is to host the app on cloud so that anyone in your labeling team can access and use your Label Studio app.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj re"><img src="../Images/bf6b44162a3ee19a94f92d7803258117.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v8jklFmUnY8zux-Z_QFEjg.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><h2 id="8b11" class="nb nc fq bf nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny bk">1. Select project/Create new project and set up billing account</h2><p id="d5a9" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh nm oi oj ok nq ol om on nu oo op oq or fj bk">Go to <a class="af os" href="https://console.cloud.google.com/" rel="noopener ugc nofollow" target="_blank">GCP console</a> and create a new project if you don’t have an existing one and set up the billing account information as required (unfortunately, cloud costs some money). Here, I will use the <em class="pq">Fashion</em> project I created to demonstrate.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj rf"><img src="../Images/322a3e2f68d88aa1a2334299bdecfd7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZDZ5oAZ6T_ASyujlSj1kTQ.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><h2 id="a1b4" class="nb nc fq bf nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny bk">2. Create VM instance</h2><p id="dda2" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh nm oi oj ok nq ol om on nu oo op oq or fj bk">To have a public IP address for labeling teamwork, we need to create a Virtual Machine (VM) on GCP and host everything here. After going to the project you created or selected, search <strong class="ob fr">compute engine</strong> in the search bar and the first thing that pops up should be <strong class="ob fr">VM instances</strong>. Click <strong class="ob fr">CREATE INSTANCE</strong> and choose the setting based on your need.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qs"><img src="../Images/29fec0320e4591a4fb473093aaadaaa0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MK9ey5MW5xKENfUn-h1kkQ.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><p id="d5a0" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">The default 10GB persistent disk will give you problems, so bump it up please. And more importantly, allow HTTP traffic.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj rg"><img src="../Images/4faa2521bf8d60bbe9cbf68c1f90258b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PdVNrfA7Vj9YT0ZYQLL37g.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><p id="eca8" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">It is a bit painful to modify these settings later, so try to think it through before clicking CREATE.</p><h2 id="cf45" class="nb nc fq bf nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny bk">3. Set up VM environment</h2><p id="ecbc" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh nm oi oj ok nq ol om on nu oo op oq or fj bk">You can think of a VM as a computer somewhere in the cloud, similar to your laptop, but you can only ask it to do things via the terminal or command line. So now we need to set up everything on the VM the same way we set up everything locally (see previous section).</p><p id="3462" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">Click SSH, authorize and open up the command line interface.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qs"><img src="../Images/d5bbbab654b31fbc557ccfd680ded68f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pwBYouHVEd1JPgIO-WBC5Q.jpeg"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><p id="158d" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">Do routine update and install docker, docker compose, git and Python.</p><pre class="ml mm mn mo mp qd qe qf bp qg bb bk"><span id="85cc" class="qh nc fq qe b bg qi qj l qk ql">sudo apt-get update<br/><br/>curl -fsSL https://get.docker.com -o get-docker.sh<br/>sudo sh get-docker.sh<br/>sudo docker --version<br/><br/>sudo apt-get install docker-compose-plugin<br/><br/>sudo apt install git<br/><br/>sudo apt install python3-pip</span></pre><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qs"><img src="../Images/edcc4f0fbdb9e232df1cc9de344fd89e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_NGYZhmco2hylnxpg2jnAw.jpeg"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><h2 id="2ea2" class="nb nc fq bf nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny bk">4. Follow previous section &amp; set up everything on VM</h2><p id="7ab4" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh nm oi oj ok nq ol om on nu oo op oq or fj bk">Now, you can follow steps 1–4 in the previous section but there are some changes:</p><ol class=""><li id="9a4b" class="nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or rh ps pt bk">Add <strong class="ob fr">sudo</strong> when you have docker permission denied error.</li><li id="fdd8" class="nz oa fq ob b go pu od oe gr pv og oh nm pw oj ok nq px om on nu py op oq or rh ps pt bk">If you have data permission error, modify permission using something like <code class="cx qm qn qo qe b">sudo chmod -R 777 mydata</code>. And then you should be able to run your frontend container.</li><li id="67c7" class="nz oa fq ob b go pu od oe gr pv og oh nm pw oj ok nq px om on nu py op oq or rh ps pt bk">The server is not at <a class="af os" href="http://0.0.0.0:8080" rel="noopener ugc nofollow" target="_blank">http://0.0.0.0:8080</a> anymore. Instead, swap 0.0.0.0 with the external IP address of your VM. An example is <a class="af os" href="http://34.1.1.87:8080/" rel="noopener ugc nofollow" target="_blank">http://34.1.1.87:8080/</a>. You can find the external IP address next to the <strong class="ob fr">SSH</strong> button you clicked before. However, you probably still cannot access the frontend just yet. You need to search firewall on GCP console and click <strong class="ob fr">Firewall (VPC network)</strong> and then click <strong class="ob fr">default-allow-http.</strong> Now, change the setting to the following and you should be able to access the frontend.</li></ol><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qs"><img src="../Images/5e236f1fbdef468fd80638526158c572.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H4L04cA5wVPlfLUk-Wo46w.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><p id="aca8" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">4. When editing <code class="cx qm qn qo qe b">docker-compose.yml</code> files, apart from copy-pasting access token, also modify the <code class="cx qm qn qo qe b">LABEL_STUDIO_HOST</code>. Again, swap <code class="cx qm qn qo qe b">host.docker.internal</code> with the VM external IP address. An example is <a class="af os" href="http://34.1.1.87:8080" rel="noopener ugc nofollow" target="_blank">http://34.1.1.87:8080</a> .</p><p id="f435" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">5. Similarly, when adding <em class="pq">Machine Learning</em> in the frontend settings, also use <a class="af os" href="http://34.1.1.87:9090" rel="noopener ugc nofollow" target="_blank">http://34.1.1.87:9090</a> and <!-- -->http://34.1.1.87:7070.</p><p id="2b92" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">You can then export your labeling results and tailor to your uses.</p></div></div></div><div class="ab cb qw qx qy qz" role="separator"><span class="ra by bm rb rc rd"/><span class="ra by bm rb rc rd"/><span class="ra by bm rb rc"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="5955" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">If you only have a couple of images to label or you are fine with uploading images from local, by all means. But for my project, there are thousands of images, so I prefer using Google Cloud Storage to automate data transferring and data versioning.</p><h1 id="f815" class="ot nc fq bf nd ou ov gq nh ow ox gt nl oy oz pa pb pc pd pe pf pg ph pi pj pk bk">GCS Integration</h1><h2 id="4329" class="nb nc fq bf nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny bk">1. Set up GCS buckets</h2><p id="6c29" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh nm oi oj ok nq ol om on nu oo op oq or fj bk">Search bucket in the GCP console and navigate to Cloud Storage buckets. Create 2 buckets: one with your images (source) and another empty (target). The second one will be populated later when you start labeling.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qs"><img src="../Images/e97e77b50ee154b4d579e394380d9b4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gdOw2Hn8vt0tMma1rE67jg.jpeg"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><p id="e508" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">Then, following the <a class="af os" href="https://labelstud.io/guide/storage.html#Google-Cloud-Storage" rel="noopener ugc nofollow" target="_blank">official documentation</a>, we need to set up cross-origin resource sharing (CORS) access to the buckets. Click <strong class="ob fr">Activate Cloud Shell</strong> on the top right, and run the following commands.</p><pre class="ml mm mn mo mp qd qe qf bp qg bb bk"><span id="6761" class="qh nc fq qe b bg qi qj l qk ql">echo '[<br/>   {<br/>      "origin": ["*"],<br/>      "method": ["GET"],<br/>      "responseHeader": ["Content-Type","Access-Control-Allow-Origin"],<br/>      "maxAgeSeconds": 3600<br/>   }<br/>]' &gt; cors-config.json<br/><br/>gsutil cors set cors-config.json gs://ferre-runway # use your bucket name<br/>gsutil cors set cors-config.json gs://ferre-runway-labeled # use your bucket name</span></pre><p id="28e0" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">If you want to set up data versioning for the labeling results, you can click on the bucket and turn on versioning in <strong class="ob fr">PROTECTION</strong>.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qs"><img src="../Images/6d160e1c091107c4632ee9de5cd7168f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1PxZBhScvtUQvvmeuqJc-A.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><h2 id="84f3" class="nb nc fq bf nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny bk">2. Create &amp; set up service account key</h2><p id="3745" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh nm oi oj ok nq ol om on nu oo op oq or fj bk">Chances are that you do not want your buckets to be public, then label studio needs authentication to have access to these images. Click <strong class="ob fr">CREATE SERVICE ACCOUNT</strong> and grant the role of <strong class="ob fr">Storage Admin</strong> so that we can read and write to the GCS buckets. You should be able to see this service account in the permissions list of the buckets as well.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qs"><img src="../Images/0103623a7369a95f066f2fb57f91ddcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zoq5tBJi_tlgbMZzhpHkuw.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><p id="5a32" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">Now, click on the newly created service account and click <strong class="ob fr">KEYS</strong>. Now add a new key and be sure to download the JSON file to somewhere safe.</p><p id="a02b" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">Now, open up your local terminal and encode the JSON file.</p><pre class="ml mm mn mo mp qd qe qf bp qg bb bk"><span id="edd8" class="qh nc fq qe b bg qi qj l qk ql">base64 -i service_account_key.json -o service_account_key_encoded.txt<br/>cat service_account_key_encoded.txt</span></pre><p id="d124" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">You can see the random character and number string and copy it. We are now pasting it as metadata for the VM. Click on your VM, click <strong class="ob fr">EDIT</strong>, and add your custom metadata. For example, my key is GOOGLE_APPLICATION_CREDENTIALS_BASE64.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj ri"><img src="../Images/4f3dabdc2f3136e2737a1d001d537ecb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sic46WpoqDDKZTvAMvS9kQ.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><p id="bc0f" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">We will then decode the service account key for authentication in our Python code.</p><h2 id="2e13" class="nb nc fq bf nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny bk">3. Rebuild backend containers</h2><p id="5f76" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh nm oi oj ok nq ol om on nu oo op oq or fj bk">Since we modified the <code class="cx qm qn qo qe b">docker-compose.yml</code> files, we need to run the new script and rebuild the backend containers.</p><pre class="ml mm mn mo mp qd qe qf bp qg bb bk"><span id="30de" class="qh nc fq qe b bg qi qj l qk ql"># Check running containers and their IDs, find the backends you need to kill<br/>sudo docker ps<br/><br/>sudo docker kill a5a5e21537cb<br/>sudo docker kill 54e51b0ae78f<br/><br/># navigate to the right folders like before and build new containers<br/>sudo docker compose up</span></pre><p id="9b08" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">Now, you should see the new containers.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj rj"><img src="../Images/e87147432f7663230f802652dda96587.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YyhdCawJzP0E_N5tsdPSbA.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><h2 id="3d43" class="nb nc fq bf nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny bk">4. SDK upload images from source bucket</h2><p id="5cc7" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh nm oi oj ok nq ol om on nu oo op oq or fj bk">If you simply want to upload the images without metadata, you can skip this section and do the exact same thing as step 5 (see next). By metadata, I mean the useful information for each image on the labeling interface that might help with labeling more accurately.</p><p id="0706" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">Based on the example from Label Studio SDK repo, you can modify what metadata and how you want to import in the <code class="cx qm qn qo qe b">./label_studio_sdk/annotate_data_from_gcs.ipynb</code> file. After running the python notebook locally, you should be able to see your images and metadata on the frontend.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qs"><img src="../Images/22af11b1076eee4891da4a6fda041c7b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nhscsWxfSDU_tTF7_2m8Ig.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><p id="5415" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">And you should also see the Source Storage bucket in the settings. Do NOT click Sync Storage as it will sync directly from the bucket and mess up the metadata we imported.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj rf"><img src="../Images/85750b44e221bca140385c71d927e2b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*e9CpgKbXelIQoHJz4mpyAA.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><h2 id="165a" class="nb nc fq bf nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny bk">5. Set up Target Storage</h2><p id="b136" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh nm oi oj ok nq ol om on nu oo op oq or fj bk">Click <strong class="ob fr">Add Target Storage</strong>, and filling in the information accordingly. Copy-paste your service account key in the Google Application Credentials textbox and you are all set.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qs"><img src="../Images/0126e2fd1425ec034da10e4476c8780b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4buz-cQG9W-Jn0LKqkmKng.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image by Author</figcaption></figure><p id="24b6" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">Every time you click <strong class="ob fr">Sync Storage</strong> on the Target Cloud Storage, it will sync the labeling outcome in the format of text into the GCS bucket. After clicking sync once, the process should be trigger automatically when submitting labeling results, but please check if you need to manually sync from time to time just in case.</p><p id="d409" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">Happy labeling!</p></div></div></div><div class="ab cb qw qx qy qz" role="separator"><span class="ra by bm rb rc rd"/><span class="ra by bm rb rc rd"/><span class="ra by bm rb rc"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="cc13" class="ot nc fq bf nd ou rk gq nh ow rl gt nl oy rm pa pb pc rn pe pf pg ro pi pj pk bk">Acknowledgement</h1><p id="10a2" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh nm oi oj ok nq ol om on nu oo op oq or fj bk">It is my pleasure to be a part of <a class="af os" href="https://sites.google.com/view/datashack-harvard-polimi/data-shack-2024?authuser=0" rel="noopener ugc nofollow" target="_blank">Data Shack 2024</a> in collaboration with Politecnico di Milano <a class="af os" href="https://www.centroricercagianfrancoferre.it/home/FGFhome.php?lang=en" rel="noopener ugc nofollow" target="_blank">Gianfranco Ferré Research Center</a>. I would like to thank Prof. <span class="ia"><span class="ia" aria-hidden="false"><a class="rp ib rq" href="https://medium.com/u/69c7cfe8dc8e?source=post_page---user_mention--324c2310d756--------------------------------" rel="noopener" target="_blank">Pavlos Protopapas</a></span></span> and Prof. Paola Bertola for your guidance and for making this project happen in the first place. I would like to thank <span class="ia"><span class="ia" aria-hidden="false"><a class="rp ib rq" href="https://medium.com/u/afb3db007f0b?source=post_page---user_mention--324c2310d756--------------------------------" rel="noopener" target="_blank">Chris Gumb</a></span></span> and Prof. <span class="ia"><span class="ia" aria-hidden="false"><a class="rp ib rq" href="https://medium.com/u/88b92e077317?source=post_page---user_mention--324c2310d756--------------------------------" rel="noopener" target="_blank">Marco Brambilla</a></span></span> for technical support and Prof. Federica Vacca and Dr. <span class="ia"><span class="ia" aria-hidden="false"><a class="rp ib rq" href="https://medium.com/u/e391affa9647?source=post_page---user_mention--324c2310d756--------------------------------" rel="noopener" target="_blank">Angelica Vandi</a></span></span> for domain knowledge expertise in fashion. Finally, I would like to thank my teammates <span class="ia"><span class="ia" aria-hidden="false"><a class="rp ib rq" href="https://medium.com/u/48b7440feb38?source=post_page---user_mention--324c2310d756--------------------------------" rel="noopener" target="_blank">Luis Henrique Simplicio Ribeiro</a></span></span>, <span class="ia"><span class="ia" aria-hidden="false"><a class="rp ib rq" href="https://medium.com/u/10478e152ee4?source=post_page---user_mention--324c2310d756--------------------------------" rel="noopener" target="_blank">Lorenzo Campana</a></span></span> and Vittoria Corvetti for your help and for figuring things out with me along the way. I also want to give a round of applause to Emanuela Di Stefano, Jacopo Sileo, Bruna Pio Da Silva Rigato, Martino Fois, Xinxi Liu, and Ilaria Trame for your continued support and hard work.</p><h1 id="cb81" class="ot nc fq bf nd ou ov gq nh ow ox gt nl oy oz pa pb pc pd pe pf pg ph pi pj pk bk">References</h1><ul class=""><li id="e1df" class="nz oa fq ob b go oc od oe gr of og oh nm oi oj ok nq ol om on nu oo op oq or pr ps pt bk">11655 Gianfranco Ferré, Ready-To-Wear Collection, Fall-Winter 2004. Courtesy of Gianfranco Ferré Research Center</li><li id="3f47" class="nz oa fq ob b go pu od oe gr pv og oh nm pw oj ok nq px om on nu py op oq or pr ps pt bk">13215 Gianfranco Ferré, Ready-To-Wear Collection, Spring-Summer 1991. Courtesy of Gianfranco Ferré Research Center</li></ul></div></div></div><div class="ab cb qw qx qy qz" role="separator"><span class="ra by bm rb rc rd"/><span class="ra by bm rb rc rd"/><span class="ra by bm rb rc"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="1674" class="pw-post-body-paragraph nz oa fq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">Thank you for reading! I hope this blog has been helpful to you.</p><blockquote class="pz qa qb"><p id="904d" class="nz oa pq ob b go pl od oe gr pm og oh nm pn oj ok nq po om on nu pp op oq or fj bk">Code in this post can be found in this <a class="af os" href="https://github.com/AlisonYao/label-studio-customized-ml-backend" rel="noopener ugc nofollow" target="_blank">GitHub repo</a>.</p></blockquote></div></div></div></div>    
</body>
</html>