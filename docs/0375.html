<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Building a Chat Application with LangChain, LLMs, and Streamlit for Complex SQL Database Interaction</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Building a Chat Application with LangChain, LLMs, and Streamlit for Complex SQL Database Interaction</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/building-a-chat-app-with-langchain-llms-and-streamlit-for-complex-sql-database-interaction-7433245079f3?source=collection_archive---------0-----------------------#2024-02-09">https://towardsdatascience.com/building-a-chat-app-with-langchain-llms-and-streamlit-for-complex-sql-database-interaction-7433245079f3?source=collection_archive---------0-----------------------#2024-02-09</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="dad9" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">Build and deploy a chat application for complex database interaction with LangChain agents.</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@hamzagharbi_19502?source=post_page---byline--7433245079f3--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Hamza Gharbi" class="l ep by dd de cx" src="../Images/da96d29dfde486875d9a4ed932879aef.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/da:true/resize:fill:88:88/0*o0ycpDpLUYnE4ABl"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--7433245079f3--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://medium.com/@hamzagharbi_19502?source=post_page---byline--7433245079f3--------------------------------" rel="noopener follow">Hamza Gharbi</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--7433245079f3--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">16 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Feb 9, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj lc ld ab q ee le lf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count la lb">11</span></p></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lg k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lh an ao ap id li lj lk" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep ll cn"><div class="l ae"><div class="ab cb"><div class="lm ln lo lp lq lr ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk ml"><img src="../Images/25b9abecbccb4aa01cd6c0d8dff59655.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*OPX-r03wFSnx2MfSKYWqZQ.png"/></div><figcaption class="mt mu mv mj mk mw mx bf b bg z dx">Image generated by DALL-E.</figcaption></figure><p id="2e09" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">In this article we will see how we can use large language models (LLMs) to interact with a complex database using <code class="cx nu nv nw nx b">Langchain</code> agents and tools, and then deploying the chat application using <code class="cx nu nv nw nx b">Streamlit</code>.</p><p id="7cad" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">This article is the second and final part of a two-phase project that exploits <a class="af ny" href="https://api.gouv.fr/les-api/api-rappel-conso" rel="noopener ugc nofollow" target="_blank">RappelConso</a> API data, a French public service that shares information about product recalls in France.</p><p id="8129" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">In the <a class="af ny" href="https://medium.com/towardsdev/end-to-end-data-engineering-system-on-real-data-with-kafka-spark-airflow-postgres-and-docker-a70e18df4090" rel="noopener">first</a> article, we set up a pipeline that queries the data from the API and stores it in a PostgreSQL database using various data engineering tools. In this article, we will develop a language model-based chat application that allows us to interact with the database.</p><h2 id="62f8" class="nz oa fq bf ob oc od oe of og oh oi oj nh ok ol om nl on oo op np oq or os ot bk">Table of Contents</h2><p id="d5b6" class="pw-post-body-paragraph my mz fq na b go ou nc nd gr ov nf ng nh ow nj nk nl ox nn no np oy nr ns nt fj bk">· <a class="af ny" href="#9fc0" rel="noopener ugc nofollow">Overview</a><br/>· <a class="af ny" href="#7676" rel="noopener ugc nofollow">Set-up</a><br/>· <a class="af ny" href="#fc4b" rel="noopener ugc nofollow">SQL Agent</a><br/>· <a class="af ny" href="#b25f" rel="noopener ugc nofollow">SQL Database Toolkit</a><br/>· <a class="af ny" href="#1506" rel="noopener ugc nofollow">Extra tools</a><br/>· <a class="af ny" href="#d5c4" rel="noopener ugc nofollow">Implementing Memory Features</a><br/>· <a class="af ny" href="#3146" rel="noopener ugc nofollow">Creating the application with Streamlit</a><br/>· <a class="af ny" href="#4ee0" rel="noopener ugc nofollow">Observations and enhancements</a><br/>· <a class="af ny" href="#9366" rel="noopener ugc nofollow">Conclusion</a><br/>· <a class="af ny" href="#f9d6" rel="noopener ugc nofollow">References</a></p></div></div></div><div class="ab cb oz pa pb pc" role="separator"><span class="pd by bm pe pf pg"/><span class="pd by bm pe pf pg"/><span class="pd by bm pe pf"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="9fc0" class="ph oa fq bf ob pi pj gq of pk pl gt oj pm pn po pp pq pr ps pt pu pv pw px py bk">Overview</h1><p id="c669" class="pw-post-body-paragraph my mz fq na b go ou nc nd gr ov nf ng nh ow nj nk nl ox nn no np oy nr ns nt fj bk">In this project, we’re going to create a chatbot that can talk to the RappelConso database through the <code class="cx nu nv nw nx b">Langchain</code> framework. This chatbot will be able to understand natural language and use it to create and run SQL queries. We’ll enhance the chatbot’s ability to make SQL queries by giving it additional tools. It will also have a memory feature to remember past interactions with users. To make it user-friendly, we’ll use <code class="cx nu nv nw nx b">Streamlit</code> to turn it into a chat-based web application.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk ml"><img src="../Images/b3af4d786e405eba37415710413a4aaf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*1fjqodC0aIWpTqfQodiA2Q.png"/></div><figcaption class="mt mu mv mj mk mw mx bf b bg z dx">Example of user query and agent response. Image by the author.</figcaption></figure><p id="7918" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">You can see a demo of the final application here:</p><figure class="mm mn mo mp mq mr"><div class="pz io l ed"><div class="qa qb l"/></div><figcaption class="mt mu mv mj mk mw mx bf b bg z dx">Demo for the final Streamlit chat application on the rappel-conso database. Video by the author.</figcaption></figure><p id="3aed" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">The chatbot can answer queries with different complexities, from the categories count of the recalled products to specific questions about the products or brands. It can identify the right columns to query by using the tools at its disposal. The chatbot can also answer queries in “ASCII” compatible languages such as English, French, German, etc …</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk qc"><img src="../Images/18e6ebfee201b4c728aa788c6dda112d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*6p8irBbuy0YPXx7tUHCm3g.png"/></div><figcaption class="mt mu mv mj mk mw mx bf b bg z dx">Example of query and response in German. Image by the author.</figcaption></figure><h2 id="bb57" class="nz oa fq bf ob oc od oe of og oh oi oj nh ok ol om nl on oo op np oq or os ot bk">Glossary:</h2><p id="b8c4" class="pw-post-body-paragraph my mz fq na b go ou nc nd gr ov nf ng nh ow nj nk nl ox nn no np oy nr ns nt fj bk">Here is a quick rundown of key terms to help you get a grasp of the concepts mentioned in this article.</p><ul class=""><li id="99f3" class="my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qd qe qf bk"><strong class="na fr">Langchain</strong>: LangChain is an open-source framework designed for building applications that leverage large language models (LLMs).</li><li id="7be3" class="my mz fq na b go qg nc nd gr qh nf ng nh qi nj nk nl qj nn no np qk nr ns nt qd qe qf bk"><strong class="na fr">Agents: </strong>They are components of Langchain that use a language model to determine which actions to take and in which order. The Agent has typically access to a set of functions called <em class="ql">Tools</em> and it can decide which Tool to use based on the user input.</li><li id="e216" class="my mz fq na b go qg nc nd gr qh nf ng nh qi nj nk nl qj nn no np qk nr ns nt qd qe qf bk"><strong class="na fr">Tools: </strong>These are functions that an agent can invoke and enable it to interact with the world. Tools must be well described in a way that is most helpful to the agent.</li><li id="bb49" class="my mz fq na b go qg nc nd gr qh nf ng nh qi nj nk nl qj nn no np qk nr ns nt qd qe qf bk"><strong class="na fr">Toolkits: </strong>A set of related tools. In this project we will be using the <em class="ql">SQLDatabaseToolkit. </em>More on this in the subsequent sections.</li><li id="ded3" class="my mz fq na b go qg nc nd gr qh nf ng nh qi nj nk nl qj nn no np qk nr ns nt qd qe qf bk"><strong class="na fr">SQL Databases:</strong> The backbone holding the data you’ll be querying. In our project we will be using a Postgres Database.</li><li id="1d69" class="my mz fq na b go qg nc nd gr qh nf ng nh qi nj nk nl qj nn no np qk nr ns nt qd qe qf bk"><strong class="na fr">Streamlit: </strong>A python framework that enables the creation of interactive web applications very simply.</li></ul><p id="1961" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">Now let’s dive into the technical details of this project !</p></div></div></div><div class="ab cb oz pa pb pc" role="separator"><span class="pd by bm pe pf pg"/><span class="pd by bm pe pf pg"/><span class="pd by bm pe pf"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="7676" class="ph oa fq bf ob pi pj gq of pk pl gt oj pm pn po pp pq pr ps pt pu pv pw px py bk"><strong class="al">Set-up</strong></h1><p id="bb77" class="pw-post-body-paragraph my mz fq na b go ou nc nd gr ov nf ng nh ow nj nk nl ox nn no np oy nr ns nt fj bk">First you can clone the github repo with the following command:</p><pre class="mm mn mo mp mq qm nx qn bp qo bb bk"><span id="7151" class="qp oa fq nx b bg qq qr l qs qt">git clone https://github.com/HamzaG737/rappel-conso-chat-app.git</span></pre><p id="ebab" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">Next, you can navigate to the project root and install the packages requirements:</p><pre class="mm mn mo mp mq qm nx qn bp qo bb bk"><span id="d753" class="qp oa fq nx b bg qq qr l qs qt">pip install -r requirements.txt</span></pre><p id="1556" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">In this project we experimented with two large language models from OpenAI, <code class="cx nu nv nw nx b">gpt-3.5-turbo-1106</code> and <code class="cx nu nv nw nx b">gpt-4–1106-preview</code> . Since the latter is better at understanding and executing complex queries, we used it as the default LLM.</p><h2 id="cb32" class="nz oa fq bf ob oc od oe of og oh oi oj nh ok ol om nl on oo op np oq or os ot bk">Setting-up the database</h2><p id="3c5c" class="pw-post-body-paragraph my mz fq na b go ou nc nd gr ov nf ng nh ow nj nk nl ox nn no np oy nr ns nt fj bk">In my <a class="af ny" href="https://medium.com/@hamzagharbi_19502/end-to-end-data-engineering-system-on-real-data-with-kafka-spark-airflow-postgres-and-docker-a70e18df4090" rel="noopener">previous</a> article, I covered how to set up a data pipeline for streaming data from a source API directly into a Postgres database. However, if you want a simpler solution, I created a script that allows you to transfer all the data from the API straight to Postgres, bypassing the need to set up the entire pipeline.</p><p id="f34d" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">First off, you need to install <a class="af ny" href="https://www.docker.com/products/docker-desktop/" rel="noopener ugc nofollow" target="_blank">Docker</a>. Then you have to set the POSTGRES_PASSWORD as environment variable. By default, it will be set to the string <code class="cx nu nv nw nx b">"postgres"</code> .</p><p id="56a8" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">Next, get the Postgres server running with the docker-compose yaml file at the project’s root:</p><pre class="mm mn mo mp mq qm nx qn bp qo bb bk"><span id="4386" class="qp oa fq nx b bg qq qr l qs qt">docker-compose -f docker-compose-postgres.yaml up -d</span></pre><p id="4e1a" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">After that, the script <code class="cx nu nv nw nx b">database/stream_data.py</code> helps you create the <code class="cx nu nv nw nx b">rappel_conso_table</code> table, stream the data from the API into the database, and do a quick check on the data by counting the rows. As of February 2024, you should see around 10400 rows, so expect a number close to that.</p><p id="72f5" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">To run the script, use this command:</p><pre class="mm mn mo mp mq qm nx qn bp qo bb bk"><span id="763b" class="qp oa fq nx b bg qq qr l qs qt">python database/stream_data.py</span></pre><p id="8f25" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">Please note that the data transfer might take around one minute, possibly a little longer, depending on the speed of your internet connection.</p><p id="79cb" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">The <em class="ql">rappel_conso_table </em>contains in total <strong class="na fr">25 </strong>columns, most of them are in <strong class="na fr">TEXT </strong>type and can take infinite values. Some of the important columns are:</p><ul class=""><li id="16fd" class="my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qd qe qf bk"><em class="ql">reference_fiche (reference sheet): </em>Unique identifier of the recalled product. It acts as the primary key of our Postgres database.</li><li id="9605" class="my mz fq na b go qg nc nd gr qh nf ng nh qi nj nk nl qj nn no np qk nr ns nt qd qe qf bk"><em class="ql">categorie_de_produit (Product category): </em>For instance food, electrical appliance, tools, transport means, etc …</li><li id="e593" class="my mz fq na b go qg nc nd gr qh nf ng nh qi nj nk nl qj nn no np qk nr ns nt qd qe qf bk"><em class="ql">sous_categorie_de_produit (Product sub-category): </em>For instance we can have meat, dairy products, cereals as sub-categories for the food category.</li><li id="dba8" class="my mz fq na b go qg nc nd gr qh nf ng nh qi nj nk nl qj nn no np qk nr ns nt qd qe qf bk"><em class="ql">motif_de_rappel (Reason for recall</em>): Self explanatory and one of the most important fields.</li><li id="031c" class="my mz fq na b go qg nc nd gr qh nf ng nh qi nj nk nl qj nn no np qk nr ns nt qd qe qf bk"><em class="ql">date_de_publication </em>which translates to the publication date.</li><li id="e1f6" class="my mz fq na b go qg nc nd gr qh nf ng nh qi nj nk nl qj nn no np qk nr ns nt qd qe qf bk"><em class="ql">risques_pour_le_consommateur </em>which contains the risks that the consumer may encounter when using the product.</li><li id="a742" class="my mz fq na b go qg nc nd gr qh nf ng nh qi nj nk nl qj nn no np qk nr ns nt qd qe qf bk">There are also several fields that correspond to different links, such as link to product image, link to the distributers list, etc..</li></ul><p id="262a" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">The full list of columns can be found in the <code class="cx nu nv nw nx b">constants.py</code> file under the constant <code class="cx nu nv nw nx b">RAPPEL_CONSO_COLUMNS</code> .</p><p id="8df9" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">Given the wide range of columns present, it’s crucial for the agent to effectively distinguish between them, particularly in cases of ambiguous user queries. The <code class="cx nu nv nw nx b">SQLDatabaseToolkit</code>, along with the additional tools we plan to implement, will play an important role in providing the necessary context. This context is key for the agent to accurately generate the appropriate SQL queries.</p></div></div></div><div class="ab cb oz pa pb pc" role="separator"><span class="pd by bm pe pf pg"/><span class="pd by bm pe pf pg"/><span class="pd by bm pe pf"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="fc4b" class="ph oa fq bf ob pi pj gq of pk pl gt oj pm pn po pp pq pr ps pt pu pv pw px py bk">SQL Agent</h1><p id="35f0" class="pw-post-body-paragraph my mz fq na b go ou nc nd gr ov nf ng nh ow nj nk nl ox nn no np oy nr ns nt fj bk">LangChain has a SQL Agent which provides a flexible way of interacting with SQL Databases.</p><p id="10f4" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">The benefits of employing the SQL Agent include:</p><ul class=""><li id="c098" class="my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qd qe qf bk">Its capability to respond to queries not only about the structure of the databases (such as details about a particular table) but also their content.</li><li id="6d5b" class="my mz fq na b go qg nc nd gr qh nf ng nh qi nj nk nl qj nn no np qk nr ns nt qd qe qf bk">Its ability to handle errors effectively. When an error occurs during the execution of a query, the SQL Agent can identify the issue, correct it, and then execute the revised query successfully.</li></ul><p id="45a6" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">In Langchain, we can initalize a SQL agent with the <code class="cx nu nv nw nx b">create_sql_agent</code> function.</p><pre class="mm mn mo mp mq qm nx qn bp qo bb bk"><span id="59c7" class="qp oa fq nx b bg qq qr l qs qt">from langchain.agents import create_sql_agent<br/><br/>agent = create_sql_agent(<br/>        llm=llm_agent,<br/>        agent_type=AgentType.ZERO_SHOT_REACT_DESCRIPTION,<br/>        toolkit=toolkit,<br/>        verbose=True,<br/>    )</span></pre><ul class=""><li id="6a81" class="my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qd qe qf bk">In this function, the <strong class="na fr">llm</strong> is the large language model backbone of the agent. We chose OpenAI GPT models for this task but other models could also be suitable. Here is how we can define the LLM for the agent:</li></ul><pre class="mm mn mo mp mq qm nx qn bp qo bb bk"><span id="59da" class="qp oa fq nx b bg qq qr l qs qt">from langchain.chat_models import ChatOpenAI<br/><br/>from constants import chat_openai_model_kwargs, langchain_chat_kwargs<br/><br/># Optional: set the API key for OpenAI if it's not set in the environment.<br/># os.environ["OPENAI_API_KEY"] = "xxxxxx"<br/><br/>def get_chat_openai(model_name):<br/>    llm = ChatOpenAI(<br/>        model_name=model_name,<br/>        model_kwargs=chat_openai_model_kwargs,<br/>        **langchain_chat_kwargs<br/>    )<br/>    return llm</span></pre><ul class=""><li id="2dd1" class="my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qd qe qf bk">Currently, the <code class="cx nu nv nw nx b">create_sql_agent</code> function supports two types of agents: OpenAI functions and ReAct agents. We opted for ReAct agents due to their easier integration with memory features. The <strong class="na fr">ReAct</strong> agent model uses large language models to generate reasoning and task-specific actions together. This method helps the agent to plan, track, and adjust its actions while dealing with exceptions. It also enables the agent to connect with external sources like knowledge bases to get more information, improving its effectiveness in tasks. More details about this framework can be found <a class="af ny" href="https://react-lm.github.io/" rel="noopener ugc nofollow" target="_blank">here</a>.</li></ul><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="qv qw ed qx bh qy"><div class="mj mk qu"><img src="../Images/1596483c06cb80ea7fd602cb48f6743c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sfn4sSAADFOvY9qrHUg9Fw.png"/></div></div><figcaption class="mt mu mv mj mk mw mx bf b bg z dx">Illustration of ReAct framework. Image based on the ReAct paper (check references section).</figcaption></figure><ul class=""><li id="6d8e" class="my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qd qe qf bk">Finally the <code class="cx nu nv nw nx b">toolkit</code> in the <code class="cx nu nv nw nx b">create_sql_agent</code> function represents the SQL set of tools used to interact with the database. More on this in the next section !</li></ul></div></div></div><div class="ab cb oz pa pb pc" role="separator"><span class="pd by bm pe pf pg"/><span class="pd by bm pe pf pg"/><span class="pd by bm pe pf"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="b25f" class="ph oa fq bf ob pi pj gq of pk pl gt oj pm pn po pp pq pr ps pt pu pv pw px py bk">SQL Database Toolkit</h1><p id="2a84" class="pw-post-body-paragraph my mz fq na b go ou nc nd gr ov nf ng nh ow nj nk nl ox nn no np oy nr ns nt fj bk">The <code class="cx nu nv nw nx b">SQLDatabaseToolkit</code> contains tools that can:</p><ul class=""><li id="ce84" class="my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qd qe qf bk">Create and execute queries: In the following example, the ReAct agent will call the <code class="cx nu nv nw nx b">sql_db_query</code> tool with a certain SQL query as input. Following this, it analyzes the database results to formulate an appropriate response for the user.</li></ul><pre class="mm mn mo mp mq qm nx qn bp qo bb bk"><span id="bdb8" class="qp oa fq nx b bg qq qr l qs qt">Action: sql_db_query<br/>Action Input: SELECT reference_fiche, nom_de_la_marque_du_produit, noms_des_modeles_ou_references, date_de_publication, liens_vers_les_images FROM rappel_conso_table WHERE categorie_de_produit = 'Alimentation' ORDER BY date_de_publication DESC LIMIT 1<br/>Observation: [('2024-01-0125', 'MAITRE COQ', 'Petite Dinde', '2024-01-13', 'https://rappel.conso.gouv.fr/image/ea3257df-7a68-4b49-916b-d6f019672ed2.jpg https://rappel.conso.gouv.fr/image/2a73be1e-b2ae-4a31-ad38-266028c6b219.jpg https://rappel.conso.gouv.fr/image/95bc9aa0-cc75-4246-bf6f-b8e8e35e2a88.jpg')]<br/>Thought:I now know the final answer to the question about the last recalled food item.<br/><br/>Final Answer: The last recalled food item is "Petite Dinde" by the brand "MAITRE COQ", which was published on January 13, 2024. You can find the images of the recalled food item here: [lien vers l'image](https://rappel.conso.gouv.fr/image/ea3257df-7a68-4b49-916b-d6f019672ed2.jpg), [lien vers l'image](https://rappel.conso.gouv.fr/image/2a73be1e-b2ae-4a31-ad38-266028c6b219.jpg), [lien vers l'image](https://rappel.conso.gouv.fr/image/95bc9aa0-cc75-4246-bf6f-b8e8e35e2a88.jpg).</span></pre><ul class=""><li id="e825" class="my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qd qe qf bk">Check the query syntax with the <code class="cx nu nv nw nx b">sql_db_query_checker</code> tool.</li></ul><pre class="mm mn mo mp mq qm nx qn bp qo bb bk"><span id="bb58" class="qp oa fq nx b bg qq qr l qs qt">Action: sql_db_query_checker<br/>Action Input: SELECT reference_fiche, nom_de_la_marque_du_produit, noms_des_modeles_ou_references, date_de_publication, liens_vers_les_images FROM rappel_conso_table WHERE categorie_de_produit = 'Alimentation' ORDER BY date_de_publication DESC LIMIT 1<br/>Observation: ```sql<br/>SELECT reference_fiche, nom_de_la_marque_du_produit, noms_des_modeles_ou_references, date_de_publication, liens_vers_les_images FROM rappel_conso_table WHERE categorie_de_produit = 'Alimentation' ORDER BY date_de_publication DESC LIMIT 1<br/>```<br/>Thought:The query has been checked and is correct. I will now execute the query to find the last recalled food item.</span></pre><ul class=""><li id="58b3" class="my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qd qe qf bk">Retrieve table descriptions with the <code class="cx nu nv nw nx b">sql_db_schema</code> tool.</li></ul><pre class="mm mn mo mp mq qm nx qn bp qo bb bk"><span id="f70e" class="qp oa fq nx b bg qq qr l qs qt">Action: sql_db_schema<br/>Action Input: rappel_conso_table<br/>Observation: <br/>CREATE TABLE rappel_conso_table (<br/>        reference_fiche TEXT NOT NULL, <br/>        liens_vers_les_images TEXT, <br/>        lien_vers_la_liste_des_produits TEXT, <br/>        lien_vers_la_liste_des_distributeurs TEXT, <br/>        lien_vers_affichette_pdf TEXT, <br/>        lien_vers_la_fiche_rappel TEXT, <br/>        date_de_publication TEXT, <br/>        date_de_fin_de_la_procedure_de_rappel TEXT, <br/>        categorie_de_produit TEXT, <br/>        sous_categorie_de_produit TEXT, <br/>        nom_de_la_marque_du_produit TEXT, <br/>        noms_des_modeles_ou_references TEXT, <br/>        identification_des_produits TEXT, <br/>        conditionnements TEXT, <br/>        temperature_de_conservation TEXT, <br/>        zone_geographique_de_vente TEXT, <br/>        distributeurs TEXT, <br/>        motif_du_rappel TEXT, <br/>        numero_de_contact TEXT, <br/>        modalites_de_compensation TEXT, <br/>        risques_pour_le_consommateur TEXT, <br/>        recommandations_sante TEXT, <br/>        date_debut_commercialisation TEXT, <br/>        date_fin_commercialisation TEXT, <br/>        informations_complementaires TEXT, <br/>        CONSTRAINT rappel_conso_table_pkey PRIMARY KEY (reference_fiche)<br/>)<br/><br/>/*<br/>1 rows from rappel_conso_table table:<br/>reference_fiche liens_vers_les_images   lien_vers_la_liste_des_produits lien_vers_la_liste_des_distributeurs    lien_vers_affichette_pdf        lien_vers_la_fiche_rappel      date_de_publication     date_de_fin_de_la_procedure_de_rappel   categorie_de_produit    sous_categorie_de_produit       nom_de_la_marque_du_produit     noms_des_modeles_ou_references identification_des_produits     conditionnements        temperature_de_conservation     zone_geographique_de_vente      distributeurs   motif_du_rappel        numero_de_contact       modalites_de_compensation       risques_pour_le_consommateur    recommandations_sante   date_debut_commercialisation    date_fin_commercialisation     informations_complementaires<br/>2021-04-0165    https://rappel.conso.gouv.fr/image/bd8027eb-ba27-499f-ba07-9a5610ad8856.jpg     None    None    https://rappel.conso.gouv.fr/affichettePDF/225/Internehttps://rappel.conso.gouv.fr/fiche-rappel/225/Interne    2021-04-22      mercredi 5 mai 2021     Alimentation    Cereales et produits de boulangerie     GERBLE BIO    BISCUITS 3 GRAINES BIO   3175681257535 11908141 Date de durabilite minimale 31/03/2022   ETUI CARTON 132 g       Produit a conserver a temperature ambiante      France entiere CASINO  Presence possible d'oxyde d'ethylene superieure a la limite autorisee sur un lot de matiere premiere    0805293032      Remboursement   Produits phytosanitaires non autorises Ne plus consommer Rapporter le produit au point de vente        19/03/2021      02/04/2021      None</span></pre><p id="d8c1" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">Before defining the SQLDatabaseToolkit class, we must initialise the <code class="cx nu nv nw nx b">SQLDatabase</code> wrapper around the Postgres database:</p><pre class="mm mn mo mp mq qm nx qn bp qo bb bk"><span id="c5fa" class="qp oa fq nx b bg qq qr l qs qt">import os<br/><br/>from langchain.sql_database import SQLDatabase<br/>from .constants_db import port, password, user, host, dbname<br/><br/><br/>url = f"postgresql+psycopg2://{user}:{password}@{host}:{port}/{dbname}"<br/>TABLE_NAME = "rappel_conso_table"<br/><br/>db = SQLDatabase.from_uri(<br/>    url,<br/>    include_tables=[TABLE_NAME],<br/>    sample_rows_in_table_info=1,<br/>)</span></pre><p id="0422" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">The <code class="cx nu nv nw nx b">sample_rows_in_table_info</code> setting determines how many example rows are added to each table’s description. Adding these sample rows can enhance the agent’s performance, as shown in this <a class="af ny" href="https://arxiv.org/abs/2204.00498" rel="noopener ugc nofollow" target="_blank">paper</a>. Therefore, when the agent accesses a table’s description to gain a clearer understanding, it will obtain both the table’s schema and a sample row from that table.</p><p id="e6f4" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">Finally let’s define the SQL toolkit:</p><pre class="mm mn mo mp mq qm nx qn bp qo bb bk"><span id="714b" class="qp oa fq nx b bg qq qr l qs qt">from langchain.agents.agent_toolkits import SQLDatabaseToolkit<br/><br/><br/>def get_sql_toolkit(tool_llm_name):<br/>    llm_tool = get_chat_openai(model_name=tool_llm_name)<br/>    toolkit = SQLDatabaseToolkit(db=db, llm=llm_tool)<br/>    return toolkit</span></pre></div></div></div><div class="ab cb oz pa pb pc" role="separator"><span class="pd by bm pe pf pg"/><span class="pd by bm pe pf pg"/><span class="pd by bm pe pf"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="1506" class="ph oa fq bf ob pi pj gq of pk pl gt oj pm pn po pp pq pr ps pt pu pv pw px py bk">Extra tools</h1><p id="9c34" class="pw-post-body-paragraph my mz fq na b go ou nc nd gr ov nf ng nh ow nj nk nl ox nn no np oy nr ns nt fj bk">Given the complexity of our table, the agent might not fully understand the information in the database by only examining the schema and a sample row. For example, the agent should recognise that a query regarding cars equates to searching the ‘category’ column for the value ‘Automobiles et moyens de déplacement’ (i.e., ‘Automobiles and means of transportation’). Therefore, additional tools are necessary to provide the agent with more context about the database.</p><p id="cc77" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">Here’s a breakdown of the extra tools we plan to use:</p><ul class=""><li id="7fab" class="my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qd qe qf bk"><code class="cx nu nv nw nx b">get_categories_and_sub_categories</code>: This tool is designed to help the agent fetch a list of distinct items from the <code class="cx nu nv nw nx b">category</code> and <code class="cx nu nv nw nx b">sub_category</code> columns. This approach is effective due to the relatively low number of unique values within these columns. If the columns contained hundreds or thousands of unique values, it might be better to use a retrieval tool. In such cases, when a user asks about a category, the agent could look for the most similar categories in a vector database, which stores embeddings of various values. The agent would then use these categories for its SQL queries. However, given that our <code class="cx nu nv nw nx b">category</code> and <code class="cx nu nv nw nx b">sub_category</code> columns don't have a wide range of unique values, we'll simply return the list directly.</li></ul><pre class="mm mn mo mp mq qm nx qn bp qo bb bk"><span id="867c" class="qp oa fq nx b bg qq qr l qs qt">from langchain.tools import tool, Tool<br/><br/>import ast<br/>import json<br/><br/>from sql_agent.sql_db import db<br/><br/><br/>def run_query_save_results(db, query):<br/>    res = db.run(query)<br/>    res = [el for sub in ast.literal_eval(res) for el in sub]<br/>    return res<br/><br/><br/><br/>def get_categories(query: str) -&gt; str:<br/>    """<br/>    Useful to get categories and sub_categories. A json is returned where the key can be category or sub_category,<br/>    and the value is a list of unique itmes for either both.<br/>    """<br/>    sub_cat = run_query_save_results(<br/>        db, "SELECT DISTINCT sous_categorie_de_produit FROM rappel_conso_table"<br/>    )<br/>    cat = run_query_save_results(<br/>        db, "SELECT DISTINCT categorie_de_produit FROM rappel_conso_table"<br/>    )<br/>    category_str = (<br/>        "List of unique values of the categorie_de_produit column : \n"<br/>        + json.dumps(cat, ensure_ascii=False)<br/>    )<br/>    sub_category_str = (<br/>        "\n List of unique values of the sous_categorie_de_produit column : \n"<br/>        + json.dumps(sub_cat, ensure_ascii=False)<br/>    )<br/><br/>    return category_str + sub_category_str</span></pre><ul class=""><li id="1f59" class="my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qd qe qf bk"><code class="cx nu nv nw nx b">get_columns_descriptions</code>: Since we can’t feed the columns descriptions in the schema directly, we created an extra tool that returns short description for every ambiguous column. Some examples include:</li></ul><pre class="mm mn mo mp mq qm nx qn bp qo bb bk"><span id="7c34" class="qp oa fq nx b bg qq qr l qs qt">"reference_fiche": "primary key of the database and unique identifier in the database. ",<br/>"nom_de_la_marque_du_produit": "A string representing the Name of the product brand. Example: Apple, Carrefour, etc ... When you filter by this column,you must use LOWER() function to make the comparison case insensitive and you must use LIKE operator to make the comparison fuzzy.",<br/>"noms_des_modeles_ou_references": "Names of the models or references. Can be used to get specific infos about the product. Example: iPhone 12, etc, candy X, product Y, bread, butter ...",<br/>"identification_des_produits": "Identification of the products, for example the sales lot.",</span></pre><pre class="qz qm nx qn bp qo bb bk"><span id="6f50" class="qp oa fq nx b bg qq qr l qs qt"><br/>def get_columns_descriptions(query: str) -&gt; str:<br/>    """<br/>    Useful to get the description of the columns in the rappel_conso_table table.<br/>    """<br/>    return json.dumps(COLUMNS_DESCRIPTIONS)</span></pre><ul class=""><li id="5135" class="my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qd qe qf bk"><code class="cx nu nv nw nx b">get_today_date</code> : tool that retrieves today’s date using python datetime library. The agent will use this tool when asked about temporality. For example: <em class="ql">“What are the recalled products since last week ?”</em></li></ul><pre class="mm mn mo mp mq qm nx qn bp qo bb bk"><span id="9821" class="qp oa fq nx b bg qq qr l qs qt">from datetime import datetime<br/><br/><br/>def get_today_date(query: str) -&gt; str:<br/>    """<br/>    Useful to get the date of today.<br/>    """<br/>    # Getting today's date in string format<br/>    today_date_string = datetime.now().strftime("%Y-%m-%d")<br/>    return today_date_string</span></pre><p id="fad5" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">Finally we create a list of all these tools and we feed it to the <code class="cx nu nv nw nx b">create_sql_agent</code> function. For every tool we must define a unique name within the set of tools provided to the agent. The description is optional but is very recommended as it can be used to provide more information.</p><pre class="mm mn mo mp mq qm nx qn bp qo bb bk"><span id="a052" class="qp oa fq nx b bg qq qr l qs qt">def sql_agent_tools():<br/>    tools = [<br/>        Tool.from_function(<br/>            func=get_categories,<br/>            name="get_categories_and_sub_categories",<br/>            description="""<br/>            Useful to get categories and sub_categories. A json is returned where the key can be category or sub_category, <br/>            and the value is a list of unique items for either both.<br/>            """,<br/>        ),<br/>        Tool.from_function(<br/>            func=get_columns_descriptions,<br/>            name="get_columns_descriptions",<br/>            description="""<br/>            Useful to get the description of the columns in the rappel_conso_table table.<br/>            """,<br/>        ),<br/>        Tool.from_function(<br/>            func=get_today_date,<br/>            name="get_today_date",<br/>            description="""<br/>            Useful to get the date of today.<br/>            """,<br/>        ),<br/>    ]<br/>    return tools</span></pre><pre class="qz qm nx qn bp qo bb bk"><span id="bd00" class="qp oa fq nx b bg qq qr l qs qt">extra_tools = sql_agent_tools()<br/><br/>agent = create_sql_agent(<br/>    llm=llm_agent,<br/>    toolkit=toolkit,<br/>    agent_type=AgentType.ZERO_SHOT_REACT_DESCRIPTION,<br/>    extra_tools=extra_tools,<br/>    verbose=True,<br/>)</span></pre><p id="a913" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">Sometimes, the tool descriptions aren’t enough for the agent to understand when to use them. To address this, we can change the ending part of the agent LLM prompt, known as the suffix. In our setup, the prompt has three sections:</p><ol class=""><li id="f9f2" class="my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt ra qe qf bk"><strong class="na fr">Prefix:</strong> This is a string placed before the tool list. We’re sticking with the default prefix, which instructs the agent on how to create and execute SQL queries in response to user questions, set a limit on result numbers to <strong class="na fr">10</strong> , check the queries carefully, and avoid making changes to the database.</li><li id="0d6a" class="my mz fq na b go qg nc nd gr qh nf ng nh qi nj nk nl qj nn no np qk nr ns nt ra qe qf bk"><strong class="na fr">The list of tools:</strong> This part lists out all the tools that the agent has at its disposal.</li><li id="7f69" class="my mz fq na b go qg nc nd gr qh nf ng nh qi nj nk nl qj nn no np qk nr ns nt ra qe qf bk"><strong class="na fr">Suffix:</strong> This is the part where we give the agent directions on how to process and think about the user’s question.</li></ol><p id="710d" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">Here’s the default suffix for the SQL ReAct agent in Langchain:</p><pre class="mm mn mo mp mq qm nx qn bp qo bb bk"><span id="4eec" class="qp oa fq nx b bg qq qr l qs qt">SQL_SUFFIX = """Begin!<br/><br/>Question: {input}<br/>Thought: I should look at the tables in the database to see what I can query.  Then I should query the schema of the most relevant tables.<br/>{agent_scratchpad}"""</span></pre><p id="73d2" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk"><code class="cx nu nv nw nx b">input</code> and <code class="cx nu nv nw nx b">agent_scratchpad</code> are two placeholders. <code class="cx nu nv nw nx b">input</code> represents the user’s query and <code class="cx nu nv nw nx b">agent_scratchpad</code> will represent the history of tool invocations and the corresponding tool outputs.</p><p id="5117" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">We can make the “Thought” part longer to give more instructions on which tools to use and when:</p><pre class="mm mn mo mp mq qm nx qn bp qo bb bk"><span id="0c9e" class="qp oa fq nx b bg qq qr l qs qt">CUSTOM_SUFFIX = """Begin!<br/><br/>Question: {input}<br/>Thought Process: It is imperative that I do not fabricate information not present in the database or engage in hallucination; <br/>maintaining trustworthiness is crucial. If the user specifies a category, I should attempt to align it with the categories in the `categories_produits` <br/>or `sous_categorie_de_produit` columns of the `rappel_conso_table` table, utilizing the `get_categories` tool with an empty string as the argument. <br/>Next, I will acquire the schema of the `rappel_conso_table` table using the `sql_db_schema` tool. <br/>Utilizing the `get_columns_descriptions` tool is highly advisable for a deeper understanding of the `rappel_conso_table` columns, except for straightforward tasks. <br/>When provided with a product brand, I will search in the `nom_de_la_marque_du_produit` column; for a product type, in the `noms_des_modeles_ou_references` column. <br/>The `get_today_date` tool, requiring an empty string as an argument, will provide today's date. <br/>In SQL queries involving string or TEXT comparisons, I must use the `LOWER()` function for case-insensitive comparisons and the `LIKE` operator for fuzzy matching. <br/>Queries for currently recalled products should return rows where `date_de_fin_de_la_procedure_de_rappel` (the recall's ending date) is null or later than today's date. <br/>When presenting products, I will include image links from the `liens_vers_les_images` column, formatted strictly as:  [lien vers l'image] url1, [lien vers l'image] url2 ... Preceded by the mention in the query's language "here is(are) the image(s) :"<br/>Additionally, the specific recalled product lot will be included from the `identification_des_produits` column. <br/>My final response must be delivered in the language of the user's query.<br/><br/>{agent_scratchpad}<br/>"""</span></pre><p id="3413" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">This way, the agent doesn’t just know what tools it has but also gets better guidance on when to use them.</p><p id="04f8" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">Now let’s modify the arguments for the <code class="cx nu nv nw nx b">create_sql_agent</code> to account for new suffix:</p><pre class="mm mn mo mp mq qm nx qn bp qo bb bk"><span id="4c3e" class="qp oa fq nx b bg qq qr l qs qt">agent = create_sql_agent(<br/>    llm=llm_agent,<br/>    toolkit=toolkit,<br/>    agent_type=AgentType.ZERO_SHOT_REACT_DESCRIPTION,<br/>    suffix=CUSTOM_SUFFIX,<br/>    extra_tools=agent_tools,<br/>    verbose=True,<br/>)</span></pre><p id="605d" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">Another option we considered was to include the instructions in the prefix. However, our empirical observations indicated that this had little to no impact on the final response. Therefore, we chose to retain the instructions in the suffix. Conducting a more extensive evaluation of the model outputs could be beneficial for a detailed comparison of the two approaches.</p></div></div></div><div class="ab cb oz pa pb pc" role="separator"><span class="pd by bm pe pf pg"/><span class="pd by bm pe pf pg"/><span class="pd by bm pe pf"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="d5c4" class="ph oa fq bf ob pi pj gq of pk pl gt oj pm pn po pp pq pr ps pt pu pv pw px py bk">Implementing Memory Features</h1><p id="b82a" class="pw-post-body-paragraph my mz fq na b go ou nc nd gr ov nf ng nh ow nj nk nl ox nn no np oy nr ns nt fj bk">A useful feature for our agent would be the ability to remember past interactions. This way, it doesn’t have to start over with each conversation, especially when queries are connected.</p><p id="f5cd" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">To add this memory feature, we’ll take a few steps:</p><ul class=""><li id="4c13" class="my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qd qe qf bk">First, we import the <code class="cx nu nv nw nx b">ConversationBufferMemory</code> class. This is a buffer that keeps track of the conversation history.</li></ul><pre class="mm mn mo mp mq qm nx qn bp qo bb bk"><span id="239a" class="qp oa fq nx b bg qq qr l qs qt">from langchain.memory import ConversationBufferMemory<br/><br/>memory = ConversationBufferMemory(memory_key="history", input_key="input")</span></pre><ul class=""><li id="3e82" class="my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qd qe qf bk">Next, we update the suffix to include the conversation history.</li></ul><pre class="mm mn mo mp mq qm nx qn bp qo bb bk"><span id="374e" class="qp oa fq nx b bg qq qr l qs qt">custom_suffix = """Begin!<br/><br/>Relevant pieces of previous conversation:<br/>{history}<br/>(Note: Only reference this information if it is relevant to the current query.)<br/><br/>Question: {input}<br/>Thought Process: It is imperative that I do not fabricate information ... (same as previous suffix)<br/><br/>{agent_scratchpad}<br/>"""</span></pre><ul class=""><li id="3b0c" class="my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qd qe qf bk">Finally, we adjust the <code class="cx nu nv nw nx b">create_sql_agent</code> function to add the history into the prompt placeholders and include the memory in the agent executor arguments.</li></ul><pre class="mm mn mo mp mq qm nx qn bp qo bb bk"><span id="9a3f" class="qp oa fq nx b bg qq qr l qs qt">agent = create_sql_agent(<br/>    llm=llm_agent,<br/>    toolkit=toolkit,<br/>    agent_type=AgentType.ZERO_SHOT_REACT_DESCRIPTION,<br/>    input_variables=["input", "agent_scratchpad", "history"],<br/>    suffix=custom_suffix,<br/>    agent_executor_kwargs={"memory": memory},<br/>    extra_tools=agent_tools,<br/>    verbose=True,<br/>)</span></pre><p id="d7d9" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">This way, the agent can use its memory to better handle related queries in a conversation.</p></div></div></div><div class="ab cb oz pa pb pc" role="separator"><span class="pd by bm pe pf pg"/><span class="pd by bm pe pf pg"/><span class="pd by bm pe pf"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="3146" class="ph oa fq bf ob pi pj gq of pk pl gt oj pm pn po pp pq pr ps pt pu pv pw px py bk">Creating the application with Streamlit</h1><p id="9263" class="pw-post-body-paragraph my mz fq na b go ou nc nd gr ov nf ng nh ow nj nk nl ox nn no np oy nr ns nt fj bk">We will use the python framework Streamlit to build a basic LLM chat app. Streamlit offers chat elements that can be used to construct a conversational application. The elements that we will use are:</p><ul class=""><li id="ece6" class="my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qd qe qf bk"><code class="cx nu nv nw nx b">st.chat_input</code> : a chat input widget that the user can use to type in a message.</li></ul><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="qv qw ed qx bh qy"><div class="mj mk rb"><img src="../Images/ba7d74f909f6e39d96a303d4b480c8f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OGgaODHZLPfptK2bUhA1Mg.png"/></div></div><figcaption class="mt mu mv mj mk mw mx bf b bg z dx">Example of chat_input widget. Image by the author.</figcaption></figure><ul class=""><li id="ff90" class="my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qd qe qf bk"><code class="cx nu nv nw nx b">st.chat_message</code> : This function adds a chat message to the app, displaying input from either the user or the application. The first argument specifies the message author, with “user” or “assistant” options to apply appropriate styling and avatars.</li></ul><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="qv qw ed qx bh qy"><div class="mj mk rc"><img src="../Images/74c46cd5d15e2463b57ecb4147797d07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YgYtFBEzB9iEW3mmzKHxyg.png"/></div></div><figcaption class="mt mu mv mj mk mw mx bf b bg z dx">Example of “User” chat message. Image by the author.</figcaption></figure><p id="8d20" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">Additionally, we’ll utilize Streamlit’s <a class="af ny" href="https://docs.streamlit.io/library/api-reference/session-state" rel="noopener ugc nofollow" target="_blank">session state</a> to maintain a history of the conversation. This feature is crucial for providing a good user experience by preserving chat context.</p><p id="3ccd" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">More details on the process to create the conversational app can be found <a class="af ny" href="https://docs.streamlit.io/knowledge-base/tutorials/build-conversational-apps" rel="noopener ugc nofollow" target="_blank">here</a>.</p><p id="951c" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">Since we instructed the agent to always return the images urls, we created a post-processing function that fetches the images from these urls, formats the output, and displays the content using Streamlit’s markdown and image components. The implementation details for this functionality are available in the <code class="cx nu nv nw nx b">streamlit_app/gen_final_output.py</code> module.</p><p id="4260" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">Now everything is set to start the chat application. You can execute the following command:</p><pre class="mm mn mo mp mq qm nx qn bp qo bb bk"><span id="2d61" class="qp oa fq nx b bg qq qr l qs qt">streamlit run streamlit_app/app.py</span></pre><p id="9ed6" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">Future enhancements could include options for users to select the desired model and configure the OpenAI API key, further customizing the chat experience.</p></div></div></div><div class="ab cb oz pa pb pc" role="separator"><span class="pd by bm pe pf pg"/><span class="pd by bm pe pf pg"/><span class="pd by bm pe pf"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="4ee0" class="ph oa fq bf ob pi pj gq of pk pl gt oj pm pn po pp pq pr ps pt pu pv pw px py bk">Observations and enhancements</h1><p id="e6e4" class="pw-post-body-paragraph my mz fq na b go ou nc nd gr ov nf ng nh ow nj nk nl ox nn no np oy nr ns nt fj bk">Here are some insights we gained after running multiple dialogues with the agent:</p><ul class=""><li id="b1ba" class="my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qd qe qf bk">It’s not surprising, but GPT-4 is significantly better than GPT-3.5. The latter manages simple queries well but often struggles to invoke the necessary tools for additional context about the database, leading to frequent hallucinations.</li><li id="c0b7" class="my mz fq na b go qg nc nd gr qh nf ng nh qi nj nk nl qj nn no np qk nr ns nt qd qe qf bk">The complexity of the user’s question can make using GPT-4 both costly and slow. Generating detailed information like the database schema, row counts, and column descriptions uses a lot of tokens. Furthermore, if you’re looking for in-depth results, such as information on the last 10 recalled products, the agent has to process the query’s output along with the tools’ actions and observations, which can be very expensive. Therefore, it’s important to keep an eye on your usage to avoid unexpected costs.</li></ul><p id="546d" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">To enhance the agent’s performance, we can:</p><ul class=""><li id="4f6f" class="my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt qd qe qf bk">Refine how we engineer prompts, adjusting the suffix and/or prefix to better anticipate and efficiently invoke the right tools when needed.</li><li id="c7d9" class="my mz fq na b go qg nc nd gr qh nf ng nh qi nj nk nl qj nn no np qk nr ns nt qd qe qf bk">Include a few examples in the prompt, or employ a retrieval tool to find the most relevant examples for common user queries, reducing the need to repeatedly invoke the same tools for each new question.</li><li id="9c30" class="my mz fq na b go qg nc nd gr qh nf ng nh qi nj nk nl qj nn no np qk nr ns nt qd qe qf bk">Add an evaluation framework to assess for instance the LLMs performance based on the final answer, or to compare prompts.</li></ul></div></div></div><div class="ab cb oz pa pb pc" role="separator"><span class="pd by bm pe pf pg"/><span class="pd by bm pe pf pg"/><span class="pd by bm pe pf"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="9366" class="ph oa fq bf ob pi pj gq of pk pl gt oj pm pn po pp pq pr ps pt pu pv pw px py bk">Conclusion</h1><p id="4171" class="pw-post-body-paragraph my mz fq na b go ou nc nd gr ov nf ng nh ow nj nk nl ox nn no np oy nr ns nt fj bk">To wrap up, this article delved into creating a chat application that uses Large Language Models (LLMs) to communicate with SQL databases via the Langchain framework. We utilized the ReACT agent framework, along with various SQL tools and additional resources, to be able to respond to a wide range of user queries.</p><p id="a772" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">By incorporating memory capabilities and deploying via Streamlit, we’ve created a user-friendly interface that simplifies complex database queries into conversational exchanges.</p><p id="2311" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">Given the database’s complexity and the extensive number of columns it contains, our solution required a comprehensive set of tools and a powerful LLM.</p><p id="762a" class="pw-post-body-paragraph my mz fq na b go nb nc nd gr ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt fj bk">We already talked about ways to enhance the capabilities of the chatbot. Additionally, using an LLM fine-tuned on SQL queries can be a substitute approach to using a general model like GPT. This could make the system much better at working with databases, helping it get even better at figuring out and handling tough queries.</p></div></div></div><div class="ab cb oz pa pb pc" role="separator"><span class="pd by bm pe pf pg"/><span class="pd by bm pe pf pg"/><span class="pd by bm pe pf"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="72fa" class="ph oa fq bf ob pi pj gq of pk pl gt oj pm pn po pp pq pr ps pt pu pv pw px py bk">To reach out</h1><ul class=""><li id="0139" class="my mz fq na b go ou nc nd gr ov nf ng nh ow nj nk nl ox nn no np oy nr ns nt qd qe qf bk">LinkedIn : <a class="af ny" href="https://www.linkedin.com/in/hamza-gharbi-043045151/" rel="noopener ugc nofollow" target="_blank">https://www.linkedin.com/in/hamza-gharbi-043045151/</a></li><li id="a10e" class="my mz fq na b go qg nc nd gr qh nf ng nh qi nj nk nl qj nn no np qk nr ns nt qd qe qf bk">Twitter : <a class="af ny" href="https://twitter.com/HamzaGh25079790" rel="noopener ugc nofollow" target="_blank">https://twitter.com/HamzaGh25079790</a></li></ul></div></div></div><div class="ab cb oz pa pb pc" role="separator"><span class="pd by bm pe pf pg"/><span class="pd by bm pe pf pg"/><span class="pd by bm pe pf"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="f9d6" class="ph oa fq bf ob pi pj gq of pk pl gt oj pm pn po pp pq pr ps pt pu pv pw px py bk">References</h1><ul class=""><li id="a277" class="my mz fq na b go ou nc nd gr ov nf ng nh ow nj nk nl ox nn no np oy nr ns nt qd qe qf bk"><a class="af ny" href="https://arxiv.org/abs/2210.03629" rel="noopener ugc nofollow" target="_blank">[2210.03629] ReAct: Synergizing Reasoning and Acting in Language Models (arxiv.org)</a></li><li id="8cd0" class="my mz fq na b go qg nc nd gr qh nf ng nh qi nj nk nl qj nn no np qk nr ns nt qd qe qf bk"><a class="af ny" href="https://python.langchain.com/docs/integrations/toolkits/sql_database" rel="noopener ugc nofollow" target="_blank">Langchain SQL database</a></li><li id="015f" class="my mz fq na b go qg nc nd gr qh nf ng nh qi nj nk nl qj nn no np qk nr ns nt qd qe qf bk"><a class="af ny" href="https://python.langchain.com/docs/use_cases/sql/agents" rel="noopener ugc nofollow" target="_blank">Langchain SQL agent</a></li><li id="0f0c" class="my mz fq na b go qg nc nd gr qh nf ng nh qi nj nk nl qj nn no np qk nr ns nt qd qe qf bk">Langchain <a class="af ny" href="https://python.langchain.com/docs/modules/agents/" rel="noopener ugc nofollow" target="_blank">agents</a> and <a class="af ny" href="https://python.langchain.com/docs/modules/agents/tools/" rel="noopener ugc nofollow" target="_blank">tools</a> documentation</li><li id="988b" class="my mz fq na b go qg nc nd gr qh nf ng nh qi nj nk nl qj nn no np qk nr ns nt qd qe qf bk"><a class="af ny" href="https://docs.streamlit.io/knowledge-base/tutorials/build-conversational-apps" rel="noopener ugc nofollow" target="_blank">Build a basic LLM chat app with Streamlit</a></li><li id="8a0a" class="my mz fq na b go qg nc nd gr qh nf ng nh qi nj nk nl qj nn no np qk nr ns nt qd qe qf bk"><a class="af ny" href="https://blog.langchain.dev/llms-and-sql/" rel="noopener ugc nofollow" target="_blank">An article on LLMs and SQL on Langchain’s blog.</a></li></ul></div></div></div></div>    
</body>
</html>