<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Real-Time Twitch Chat Sentiment Analysis with Apache Flink</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Real-Time Twitch Chat Sentiment Analysis with Apache Flink</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/real-time-twitch-chat-sentiment-analysis-with-apache-flink-e165ac1a8dcf?source=collection_archive---------5-----------------------#2024-03-27">https://towardsdatascience.com/real-time-twitch-chat-sentiment-analysis-with-apache-flink-e165ac1a8dcf?source=collection_archive---------5-----------------------#2024-03-27</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="5fd3" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">Learn how to empower creators by real-time sentiment analysis with Apache Flink to decipher audience emotions to steer content for viewer satisfaction</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://vojay.medium.com/?source=post_page---byline--e165ac1a8dcf--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Volker Janz" class="l ep by dd de cx" src="../Images/0825160d6d521f4152948f0187cf354b.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*UKWFUrD3gzsvYC0QKsPT3g.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--e165ac1a8dcf--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://vojay.medium.com/?source=post_page---byline--e165ac1a8dcf--------------------------------" rel="noopener follow">Volker Janz</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--e165ac1a8dcf--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">22 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Mar 27, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj lc ld ab q ee le lf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count la lb">1</span></p></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lg k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lh an ao ap id li lj lk" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep ll cn"><div class="l ae"><div class="ab cb"><div class="lm ln lo lp lq lr ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div></div></div><div class="mj"><div class="ab cb"><div class="lm mk ln ml lo mm cf mn cg mo ci bh"><figure class="ms mt mu mv mw mj mx my paragraph-image"><div role="button" tabindex="0" class="mz na ed nb bh nc"><div class="mp mq mr"><img src="../Images/e55f68a621ce60805ded66c172ab01cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:2000/format:webp/0*I7ZKedomEo4t_OJ8"/></div></div><figcaption class="ne nf ng mp mq nh ni bf b bg z dx">Photo by <a class="af nj" href="https://unsplash.com/@spideyjoey?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Joey kwok</a> on <a class="af nj" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh ev ew ex ey"><blockquote class="nk nl nm"><p id="d56d" class="nn no np nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">🚀 Let’s learn about Apache Flink and sentiment analysis by building a real-time sentiment analysis streaming application for the Twitch chat.</p></blockquote><p id="99be" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">– <a class="af nj" href="#cbac" rel="noopener ugc nofollow">Introduction and demo</a><br/>– <a class="af nj" href="#590a" rel="noopener ugc nofollow">Apache Flink</a><br/>– <a class="af nj" href="#0d10" rel="noopener ugc nofollow">NLP and sentiment analysis</a><br/>– <a class="af nj" href="#138d" rel="noopener ugc nofollow">Setting up a Flink project</a><br/>– <a class="af nj" href="#acf0" rel="noopener ugc nofollow">Prepare the project</a><br/> −− <a class="af nj" href="#d36b" rel="noopener ugc nofollow">Project settings in IntelliJ</a><br/> −− <a class="af nj" href="#5b50" rel="noopener ugc nofollow">Rename and reduce main class</a><br/> −− <a class="af nj" href="#9c6a" rel="noopener ugc nofollow">pom.xml project settings</a><br/> −− <a class="af nj" href="#88d6" rel="noopener ugc nofollow">Run configuration</a><br/> −− <a class="af nj" href="#d646" rel="noopener ugc nofollow">Local Flink Web UI</a><br/>– <a class="af nj" href="#cc63" rel="noopener ugc nofollow">Read the Twitch chat</a><br/> −− <a class="af nj" href="#db06" rel="noopener ugc nofollow">Add Twitch4J dependency</a><br/> −− <a class="af nj" href="#9ce2" rel="noopener ugc nofollow">Create POJO for Twitch chat messages</a><br/> −− <a class="af nj" href="#b69b" rel="noopener ugc nofollow">Create custom Twitch source function for Flink</a><br/> −− <a class="af nj" href="#78d2" rel="noopener ugc nofollow">Use source function</a><br/>– <a class="af nj" href="#b566" rel="noopener ugc nofollow">Twitch chat sentiment analysis</a><br/> −− <a class="af nj" href="#600f" rel="noopener ugc nofollow">Add Stanford CoreNLP dependencies</a><br/>−− <a class="af nj" href="#eea7" rel="noopener ugc nofollow">Create sentiment analysis map function</a><br/> −− <a class="af nj" href="#75ee" rel="noopener ugc nofollow">Use map function</a><br/>– <a class="af nj" href="#35a9" rel="noopener ugc nofollow">Conclusion</a></p><p id="5da2" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk"><strong class="nq fr"><em class="np">Disclaimer</em></strong><em class="np">: Within this article and demo, I am only analyzing my own chat messages, without storing data or processing other users messages. Please be advised to consult the Twitch </em><a class="af nj" href="https://www.twitch.tv/p/en/legal/terms-of-service/" rel="noopener ugc nofollow" target="_blank"><em class="np">Terms of Service</em></a><em class="np"> and </em><a class="af nj" href="https://www.twitch.tv/p/en/legal/developer-agreement/" rel="noopener ugc nofollow" target="_blank"><em class="np">Developer Services Agreement</em></a><em class="np">, as well as the official </em><a class="af nj" href="https://dev.twitch.tv/docs/api/" rel="noopener ugc nofollow" target="_blank"><em class="np">Twitch API documentation</em></a><em class="np"> before using it for other purposes.</em></p></div></div></div><div class="ab cb ok ol om on" role="separator"><span class="oo by bm op oq or"/><span class="oo by bm op oq or"/><span class="oo by bm op oq"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="cbac" class="os ot fq bf ou ov ow gq ox oy oz gt pa pb pc pd pe pf pg ph pi pj pk pl pm pn bk">Introduction and demo</h1><p id="e4b3" class="pw-post-body-paragraph nn no fq nq b go po ns nt gr pp nv nw nx pq nz oa ob pr od oe of ps oh oi oj fj bk">In this blog post, I will guide you through building a real-time sentiment analysis application for Twitch chat using <a class="af nj" href="https://flink.apache.org/" rel="noopener ugc nofollow" target="_blank">Apache Flink</a>. This application will be able to process live messages from a Twitch channel and determine the overall sentiment of the chat.</p><p id="d076" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">The project was built with the following environment:</p><ul class=""><li id="e2b5" class="nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj pt pu pv bk"><strong class="nq fr">OS</strong>: macOS Sonoma</li><li id="1f98" class="nn no fq nq b go pw ns nt gr px nv nw nx py nz oa ob pz od oe of qa oh oi oj pt pu pv bk"><strong class="nq fr">Java</strong>: 11</li><li id="9480" class="nn no fq nq b go pw ns nt gr px nv nw nx py nz oa ob pz od oe of qa oh oi oj pt pu pv bk"><strong class="nq fr">Flink</strong>: 1.17.2</li></ul></div></div><div class="mj"><div class="ab cb"><div class="lm mk ln ml lo mm cf mn cg mo ci bh"><figure class="ms mt mu mv mw mj mx my paragraph-image"><div role="button" tabindex="0" class="mz na ed nb bh nc"><div class="mp mq qb"><img src="../Images/e46b1477e09e4b3e113640ed6cebc535.png" data-original-src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*NvIJ5Hj_UocFxU3BOa_eBA.gif"/></div></div><figcaption class="ne nf ng mp mq nh ni bf b bg z dx">Real-time Twitch chat sentiment analysis with Apache Flink (by author)</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="2c1d" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">The underlying idea of this article is: to further educate ourselves in the field of Data Engineering, we should follow our passion and grow through actual projects.</p><p id="2749" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Find a problem that interests and motivates you, and try to solve it.</p><p id="1a09" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">By the end of this blog post, you will have a working application that can be used to track the sentiment of a Twitch chat in real-time. It can be used with one ore more Twitch channels. You will also learn the basics of <a class="af nj" href="https://flink.apache.org/" rel="noopener ugc nofollow" target="_blank">Apache Flink</a> and sentiment analysis in Java.</p><p id="1156" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk"><strong class="nq fr">You can find the final result also on Github</strong> 🪄: <a class="af nj" href="https://github.com/vojay-dev/flitch" rel="noopener ugc nofollow" target="_blank">https://github.com/vojay-dev/flitch</a></p></div></div></div><div class="ab cb ok ol om on" role="separator"><span class="oo by bm op oq or"/><span class="oo by bm op oq or"/><span class="oo by bm op oq"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="590a" class="os ot fq bf ou ov ow gq ox oy oz gt pa pb pc pd pe pf pg ph pi pj pk pl pm pn bk">Apache Flink</h1><p id="d4e0" class="pw-post-body-paragraph nn no fq nq b go po ns nt gr pp nv nw nx pq nz oa ob pr od oe of ps oh oi oj fj bk">Streams of data are everywhere. Almost all data that is generated is generated as a stream of data naturally, even if we mostly process data in batches. This can be GPS data, interaction tracking for apps or websites, sensor data or messages in a Twitch chat.</p><blockquote class="nk nl nm"><p id="19a0" class="nn no np nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk"><strong class="nq fr"><em class="fq">Stream processing means to process data in motion</em></strong></p></blockquote><p id="275d" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">A stream processing application usually consists of data sources, which generate streams of data, operators to process the data and sinks. These days, there are many frameworks and services that allow to implement stream processing applications and often concepts are similar. One of them is <a class="af nj" href="https://flink.apache.org/" rel="noopener ugc nofollow" target="_blank">Apache Flink</a>.</p><p id="c19e" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk"><a class="af nj" href="https://flink.apache.org/" rel="noopener ugc nofollow" target="_blank">Apache Flink</a> is not only a framework but also a distributed process engine. It allows to create and run <strong class="nq fr">stateful</strong> computations on <strong class="nq fr">unbounded</strong> and <strong class="nq fr">bounded</strong> data streams. <strong class="nq fr">Ubounded</strong> streams have a defined start, but no defined end while <strong class="nq fr">bounded</strong> data streams have a defined start and end. This might sound familiar, since that can also be seen as a batch of data but represented as a stream.</p></div></div><div class="mj"><div class="ab cb"><div class="lm mk ln ml lo mm cf mn cg mo ci bh"><figure class="ms mt mu mv mw mj mx my paragraph-image"><div role="button" tabindex="0" class="mz na ed nb bh nc"><div class="mp mq qc"><img src="../Images/c65239a997c588ae867dcc6bfa8a2beb.png" data-original-src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*KfJiKYvM1_1i_hhhzI7uZQ.png"/></div></div><figcaption class="ne nf ng mp mq nh ni bf b bg z dx">Flink concepts (by author)</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="a3ed" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Flink offers APIs to define streaming applications. With those you can control data sources, transformations and data sinks. With the SQL / Table API you can define streaming applications using SQL, which is an amazing feature but please keep in mind that streaming SQL behaves differently from batch SQL, which might require a shift in how to approach problems. Then, there is the DataStream API which can be used to compose your streaming pipeline with predefined functions. This can be used in Python, Java and Scala. If you need full control over events, state and time, the ProcessFunction layer is the way to go.</p></div></div><div class="mj"><div class="ab cb"><div class="lm mk ln ml lo mm cf mn cg mo ci bh"><figure class="ms mt mu mv mw mj mx my paragraph-image"><div role="button" tabindex="0" class="mz na ed nb bh nc"><div class="mp mq qd"><img src="../Images/d485c1cf66873673c44c2b23823c9f90.png" data-original-src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*NUr19khtBBh52BuF2_vPtg.png"/></div></div><figcaption class="ne nf ng mp mq nh ni bf b bg z dx">Flink APIs (by author)</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="e11a" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">For this use-case, we will use the DataStream API in Java to define a custom source to read the Twitch chat as a stream of data. Futhermore, we will define a custom map function, which takes each Twitch message as input, performs the sentiment analysis on it and returns a tuple with the message and the analysis result. Finally, we simply use a pre-defined sink to print the result. In this particular case, we only look at one invdividual event at a time, this is called <strong class="nq fr">stateless stream processing</strong>. Bare in mind that one of the key features of Flink is to remember information across multiple events, e.g. in form of windowing functions. This is called <strong class="nq fr">stateful stream processing</strong>.</p></div></div><div class="mj"><div class="ab cb"><div class="lm mk ln ml lo mm cf mn cg mo ci bh"><figure class="ms mt mu mv mw mj mx my paragraph-image"><div role="button" tabindex="0" class="mz na ed nb bh nc"><div class="mp mq qe"><img src="../Images/b08d47365c06f9e10a96bd63298dfe55.png" data-original-src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*lkO1wCXqrWHtXXBKAEI-Sg.png"/></div></div><figcaption class="ne nf ng mp mq nh ni bf b bg z dx">Flink state (by author)</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="c05e" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">If you are interested in a more advanced Flink use-case including state and other advanced techniques like the Broadcast State Pattern, have a look at my talk at the Big Data Conference Europe 2023:</p><p id="e5ea" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">📼 <a class="af nj" href="https://www.youtube.com/watch?v=djikIGOm90U" rel="noopener ugc nofollow" target="_blank">Real-time Customer Engagement in Gaming Using Kafka and Flink</a></p><h1 id="0d10" class="os ot fq bf ou ov qf gq ox oy qg gt pa pb qh pd pe pf qi ph pi pj qj pl pm pn bk">NLP and sentiment analysis</h1><p id="afec" class="pw-post-body-paragraph nn no fq nq b go po ns nt gr pp nv nw nx pq nz oa ob pr od oe of ps oh oi oj fj bk">Imagine Natural Language Processing (NLP) as your super-powered translator for computer brains. It lets them understand the nuances of human language, just like you can tell the difference between a sarcastic “good job” and a genuine one. This goes beyond simple keyword matching and delves into the complexities of grammar, syntax, and semantics.</p><p id="9cfe" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Here are some NLP applications you might encounter:</p><ul class=""><li id="d4bc" class="nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj pt pu pv bk"><strong class="nq fr">Spam filtering</strong>: NLP can identify suspicious patterns in emails, separating legitimate messages from spam.</li><li id="fc52" class="nn no fq nq b go pw ns nt gr px nv nw nx py nz oa ob pz od oe of qa oh oi oj pt pu pv bk"><strong class="nq fr">Machine translation</strong>: NLP helps bridge the language gap by analyzing the structure and meaning of sentences for accurate translation.</li><li id="2809" class="nn no fq nq b go pw ns nt gr px nv nw nx py nz oa ob pz od oe of qa oh oi oj pt pu pv bk"><strong class="nq fr">Voice assistants</strong>: Siri, Alexa, and Google Assistant all leverage NLP to understand your voice commands and respond intelligently.</li></ul><p id="258c" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">One other application of NLP is sentiment analysis. Think of it like an emotional compass for text. It assigns a sentiment score (positive, negative, or neutral) to a piece of text, helping us gauge the overall feeling behind it.</p><p id="50a0" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">There are two main approaches to sentiment analysis:</p><ul class=""><li id="0ad9" class="nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj pt pu pv bk"><strong class="nq fr">Lexicon-based</strong>: This approach relies on pre-built dictionaries containing words with predefined sentiment scores. The sentiment score of a text is calculated based on the scores of the identified words.</li><li id="8482" class="nn no fq nq b go pw ns nt gr px nv nw nx py nz oa ob pz od oe of qa oh oi oj pt pu pv bk"><strong class="nq fr">Machine Learning-based</strong>: This method utilizes machine learning algorithms trained on massive datasets of text labeled with sentiment. These algorithms can learn complex relationships between words and their emotional connotations, leading to more nuanced sentiment analysis.</li></ul><figure class="ms mt mu mv mw mj mp mq paragraph-image"><div role="button" tabindex="0" class="mz na ed nb bh nc"><div class="mp mq qk"><img src="../Images/4e822594adf58749fb9ba3ba5ef4470e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7od80qrcv-HEv1FmjO6TNA.png"/></div></div><figcaption class="ne nf ng mp mq nh ni bf b bg z dx">Sentiment analysis example (by author)</figcaption></figure><p id="8261" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">This is perfect for deciphering those Twitch chat vibes!</p><p id="daa1" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">In our Twitch chat example, we can use sentiment analysis to see if the chat is overflowing with happiness or tilting over a missed play. This can be fascinating for streamers to understand their audience’s real-time reaction and maybe even adjust their content accordingly! It could be used for real-time monitoring of the communities mood.</p><h1 id="138d" class="os ot fq bf ou ov qf gq ox oy qg gt pa pb qh pd pe pf qi ph pi pj qj pl pm pn bk">Setting up a Flink project</h1><p id="dc09" class="pw-post-body-paragraph nn no fq nq b go po ns nt gr pp nv nw nx pq nz oa ob pr od oe of ps oh oi oj fj bk">A simple and fast way to setup a Flink project is Maven. Maven is a tool that can be used for building and managing primarily Java-based projects. Maven can support you as a developer by addressing the aspects of how your project is buil and how its dependencies are managed.</p><p id="4dd2" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Maven also includes a project templating toolkit called Archetype. With Archetype you can quickly generate a new project based on an existing template.</p><p id="8454" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">There are Archetypes for all kinds of projects, from a simple Java project (<code class="cx ql qm qn qo b">maven-archetype-quickstart</code>) to framework specific project skeletons, for example to create Flink based projects (<code class="cx ql qm qn qo b">flink-quickstart-java</code>).</p><p id="f1da" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">We will use this to create the demo application:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="67ce" class="qs ot fq qo b bg qt qu l qv qw">mvn archetype:generate \<br/>-DarchetypeGroupId=org.apache.flink \<br/>-DarchetypeArtifactId=flink-quickstart-java \<br/>-DarchetypeVersion=1.17.2 \<br/>-DgroupId=de.vojay \<br/>-DartifactId=flitch \<br/>-Dpackage=de.vojay.flitch \<br/>-Dversion=0.1.0 \<br/>-q</span></pre><p id="c4d4" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Most of the parameters are optional, if you don’t add them, the CLI tool will ask you to enter the details while it is creating your project. With <code class="cx ql qm qn qo b">-q</code> we reduce the output. After executing the above command, we will get the following output:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="2756" class="qs ot fq qo b bg qt qu l qv qw">Confirm properties configuration:<br/>groupId: de.vojay<br/>artifactId: flitch<br/>version: 0.1.0<br/>package: de.vojay.flitch<br/> Y: :</span></pre><p id="7ce1" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Press <code class="cx ql qm qn qo b">enter</code> to confirm and you will get a folder named after your <code class="cx ql qm qn qo b">artifactId</code> with the generated project boilerplate.</p><figure class="ms mt mu mv mw mj mp mq paragraph-image"><div role="button" tabindex="0" class="mz na ed nb bh nc"><div class="mp mq qx"><img src="../Images/145bdd5fb2440c1c8d0e5dae9add44da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LtRWCw6CWSDOG6FIAzls6Q.png"/></div></div><figcaption class="ne nf ng mp mq nh ni bf b bg z dx">Maven Archetype for Flink (by author)</figcaption></figure><p id="b240" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">From here, you can use the Java IDE of your choice. However, I recommend using <a class="af nj" href="https://www.jetbrains.com/idea" rel="noopener ugc nofollow" target="_blank">IntelliJ</a>. There is a completely free to use <a class="af nj" href="https://www.jetbrains.com/idea/download" rel="noopener ugc nofollow" target="_blank">IntelliJ IDEA Community Edition</a>.</p><h1 id="acf0" class="os ot fq bf ou ov qf gq ox oy qg gt pa pb qh pd pe pf qi ph pi pj qj pl pm pn bk">Prepare the project</h1><p id="ac9d" class="pw-post-body-paragraph nn no fq nq b go po ns nt gr pp nv nw nx pq nz oa ob pr od oe of ps oh oi oj fj bk">Before we get to the actual implementation, we will prepare the generated project a bit for our use-case.</p><h1 id="d36b" class="os ot fq bf ou ov qf gq ox oy qg gt pa pb qh pd pe pf qi ph pi pj qj pl pm pn bk">Project settings in IntelliJ</h1><p id="1649" class="pw-post-body-paragraph nn no fq nq b go po ns nt gr pp nv nw nx pq nz oa ob pr od oe of ps oh oi oj fj bk">If you are using IntelliJ, we now have to adjust the module and project settings, to ensure we are using the right Java version and also have the correct language level.</p><p id="40b2" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">With the project opened in IntelliJ, click on <em class="np">File</em> → <em class="np">Project Structure</em>.</p><p id="1bbf" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Within the <em class="np">Project Structure</em> window, navigate to <em class="np">Project</em> and ensure to use the <strong class="nq fr">Java 11 SDK</strong>.</p><figure class="ms mt mu mv mw mj mp mq paragraph-image"><div role="button" tabindex="0" class="mz na ed nb bh nc"><div class="mp mq qy"><img src="../Images/a5b31219b3207121e668789a569e111a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1fQxSoBu-GDmMN14fThiPg.png"/></div></div><figcaption class="ne nf ng mp mq nh ni bf b bg z dx">Project settings (by author)</figcaption></figure><p id="d3b5" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Finally, navigate to <em class="np">Modules</em> and change the language level to <strong class="nq fr">11</strong>.</p><figure class="ms mt mu mv mw mj mp mq paragraph-image"><div role="button" tabindex="0" class="mz na ed nb bh nc"><div class="mp mq qy"><img src="../Images/cb22316ceadf7e852814bf460bb8b45b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ho57PhvL7WJB2FZRIH9QSA.png"/></div></div><figcaption class="ne nf ng mp mq nh ni bf b bg z dx">Module settings (by author)</figcaption></figure><h1 id="5b50" class="os ot fq bf ou ov qf gq ox oy qg gt pa pb qh pd pe pf qi ph pi pj qj pl pm pn bk">Rename and reduce main class</h1><p id="b052" class="pw-post-body-paragraph nn no fq nq b go po ns nt gr pp nv nw nx pq nz oa ob pr od oe of ps oh oi oj fj bk">Rename the generated class <code class="cx ql qm qn qo b">DataStreamJob</code> simply to <code class="cx ql qm qn qo b">App</code>.</p><figure class="ms mt mu mv mw mj mp mq paragraph-image"><div role="button" tabindex="0" class="mz na ed nb bh nc"><div class="mp mq qz"><img src="../Images/276f020259185a0efb176433f7c80f0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*liajPspGC28wSFrkn2VQ4A.png"/></div></div><figcaption class="ne nf ng mp mq nh ni bf b bg z dx">Rename class (by author)</figcaption></figure><p id="5450" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Then replace the code with the following content:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="bb10" class="qs ot fq qo b bg qt qu l qv qw">package de.vojay.flitch;<br/><br/>import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;<br/><br/>public class App {<br/><br/> public static void main(String[] args) throws Exception {<br/>  StreamExecutionEnvironment env = StreamExecutionEnvironment<br/>   .getExecutionEnvironment();<br/><br/>  env.fromElements("Hello", "World").print();<br/>  env.execute("Flitch");<br/> }<br/><br/>}</span></pre><p id="ccfd" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">With this, we create a execution environment, read data from a bounded stream with two elements (“Hello” and “World”), print the elements to STDOUT and execute the application with the name “Flitch”.</p><p id="7623" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk"><strong class="nq fr">But for now, let’s not start the application since more adjustments are necessary.</strong></p><h1 id="9c6a" class="os ot fq bf ou ov qf gq ox oy qg gt pa pb qh pd pe pf qi ph pi pj qj pl pm pn bk"><code class="cx ql qm qn qo b">pom.xml</code> project settings</h1><p id="710f" class="pw-post-body-paragraph nn no fq nq b go po ns nt gr pp nv nw nx pq nz oa ob pr od oe of ps oh oi oj fj bk">The <code class="cx ql qm qn qo b">pom.xml</code> file in Maven is a configuration file that serves as the project’s blueprint. It stands for “Project Object Model” and contains information and configurations for the project, such as project dependencies, project version, build plugins, and goals, among others. Maven uses this file to understand the project structure, manage dependencies, and perform various tasks during the build process.</p><p id="1cee" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Let’s change the following aspects, so that we use the desired Java version, have a proper name and adjust the main class of the demo.</p><p id="fd77" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk"><strong class="nq fr">Set target Java version to 11 (LTS):</strong></p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="27f3" class="qs ot fq qo b bg qt qu l qv qw">&lt;target.java.version&gt;11&lt;/target.java.version&gt;</span></pre><p id="f2bb" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk"><strong class="nq fr">Change name:</strong></p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="39fa" class="qs ot fq qo b bg qt qu l qv qw">&lt;name&gt;Flitch - Flink Twitch Demo Project&lt;/name&gt;</span></pre><p id="a0ec" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk"><strong class="nq fr">Change main class:</strong></p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="5a82" class="qs ot fq qo b bg qt qu l qv qw">&lt;mainClass&gt;de.vojay.flitch.App&lt;/mainClass&gt;</span></pre><h1 id="88d6" class="os ot fq bf ou ov qf gq ox oy qg gt pa pb qh pd pe pf qi ph pi pj qj pl pm pn bk">Run configuration</h1><p id="baa0" class="pw-post-body-paragraph nn no fq nq b go po ns nt gr pp nv nw nx pq nz oa ob pr od oe of ps oh oi oj fj bk">Run configurations in IntelliJ are settings that specify how to launch and debug your project. They allow you to customize aspects like the main class to run, program arguments, and environment variables. You can create multiple configurations to easily switch between different running or debugging scenarios, streamlining your development process.</p><p id="46af" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">But before we create one, let’s see what happens if we run our application. So without further ado, let’s start our main class <code class="cx ql qm qn qo b">App</code> by simply clicking the play button.</p><p id="7459" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk"><strong class="nq fr">The application will fail, this is on purpose.</strong></p></div></div><div class="mj"><div class="ab cb"><div class="lm mk ln ml lo mm cf mn cg mo ci bh"><figure class="ms mt mu mv mw mj mx my paragraph-image"><div role="button" tabindex="0" class="mz na ed nb bh nc"><div class="mp mq ra"><img src="../Images/fa265b3c95e57d588ad77d2be842ab5e.png" data-original-src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*1Lze8dsUGe5UNkY7aecDiA.png"/></div></div><figcaption class="ne nf ng mp mq nh ni bf b bg z dx">Run the app (by author)</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="a7d6" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">The reason it failed is a <code class="cx ql qm qn qo b">java.lang.NoClassDefFoundError</code>. This is, because we have dependencies defined in our <code class="cx ql qm qn qo b">pom.xml</code>, which are not in the classpath of Java when running the application:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="9573" class="qs ot fq qo b bg qt qu l qv qw">&lt;dependency&gt;<br/> &lt;groupId&gt;org.apache.flink&lt;/groupId&gt;<br/> &lt;artifactId&gt;flink-streaming-java&lt;/artifactId&gt;<br/> &lt;version&gt;${flink.version}&lt;/version&gt;<br/> &lt;scope&gt;provided&lt;/scope&gt;<br/>&lt;/dependency&gt;<br/>&lt;dependency&gt;<br/> &lt;groupId&gt;org.apache.flink&lt;/groupId&gt;<br/> &lt;artifactId&gt;flink-clients&lt;/artifactId&gt;<br/> &lt;version&gt;${flink.version}&lt;/version&gt;<br/> &lt;scope&gt;provided&lt;/scope&gt;<br/>&lt;/dependency&gt;</span></pre><p id="5dcd" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">The relevant part is the <strong class="nq fr">scope</strong>. In Maven, the scope of a dependency specifies the visibility and the lifecycle of the dependency in relation to the project. It determines how and when a dependency is included in your project, affecting classpath and module builds.</p><p id="6baa" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Scope <code class="cx ql qm qn qo b">provided</code> means that the dependencies are expected to be provided by the JDK or the runtime environment when executing or deploying your project, thus not packaged.</p><p id="0f06" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">When using Flink in a production environment, you will have a running Flink cluster somewhere, either on-premises or in the cloud. This environment already has the required dependencies in the classpath per default and we submit our application JAR to this production cluster. Thus, we do not need to package these dependencies with the JAR.</p><p id="b51e" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">However, that also means when we run the application locally, these are not in the classpath. And since we have a plain Java setup, we get the <code class="cx ql qm qn qo b">java.lang.NoClassDefFoundError</code>.</p><p id="b173" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">There are multiple solutions for this problem. We could define different profiles with different scopes in Maven, so that the scope is different in our local environment.</p><p id="c802" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">But since we are using IntelliJ, there is also a way to solve it with the run configuration. Click on <em class="np">Run</em> → <em class="np">Edit Configurations…</em> and then click on the <strong class="nq fr">+</strong> or <em class="np">Add new</em> to create a new run configuration. From the list, select “Application” and name it “Flitch”.</p><p id="9ad1" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Ensure to select Java 11 and enter <code class="cx ql qm qn qo b">de.vojay.flitch.App</code> as your main class.</p><p id="efd9" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">To solve the <code class="cx ql qm qn qo b">java.lang.NoClassDefFoundError</code>, we now have to enable the option <em class="np">Add dependencies with “provided” scope to classpath</em>.</p></div></div><div class="mj"><div class="ab cb"><div class="lm mk ln ml lo mm cf mn cg mo ci bh"><figure class="ms mt mu mv mw mj mx my paragraph-image"><div role="button" tabindex="0" class="mz na ed nb bh nc"><div class="mp mq rb"><img src="../Images/341fbe9ef1b6dd2e3f33420ce528f6bd.png" data-original-src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*KVU35KdpItpNWY0_ev8DDw.png"/></div></div><figcaption class="ne nf ng mp mq nh ni bf b bg z dx">Run configuration (by author)</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="d8ad" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Your run configuration is ready, lets click “Run” and enjoy our first streaming application.</p><p id="ed92" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">It works 🎉. The streaming application will run until the bounded stream is processed. You will also find the output of the two elements of your stream in the logs.</p></div></div><div class="mj"><div class="ab cb"><div class="lm mk ln ml lo mm cf mn cg mo ci bh"><figure class="ms mt mu mv mw mj mx my paragraph-image"><div role="button" tabindex="0" class="mz na ed nb bh nc"><div class="mp mq rc"><img src="../Images/0718a522b627323d624d088c065c7b98.png" data-original-src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*x9asKD7FlnXqdXyhQfJKAw.png"/></div></div><figcaption class="ne nf ng mp mq nh ni bf b bg z dx">First successful run (by author)</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="d646" class="os ot fq bf ou ov qf gq ox oy qg gt pa pb qh pd pe pf qi ph pi pj qj pl pm pn bk">Local Flink Web UI</h1><p id="76ae" class="pw-post-body-paragraph nn no fq nq b go po ns nt gr pp nv nw nx pq nz oa ob pr od oe of ps oh oi oj fj bk">There’s still one thing before we turn our attention to the fun part. The Flink Web UI is a user-friendly interface that allows developers and administrators to monitor and manage their Apache Flink applications. It provides a real-time overview of running or completed jobs, displays metrics such as throughput and latency, and offers detailed insights into the job’s execution plan. Essentially, it’s a convenient dashboard where you can visualize the performance and status of your Flink applications, making the process of debugging, optimizing, and managing your streaming or batch processing jobs much easier and more intuitive.</p><p id="da6e" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">When you run a Flink application locally like in this example, you usually do not have the Flink Web UI enabled. However, there is a way to also get the Flink Web UI in a local execution environment. I find this useful, especially to get an idea of the execution plan before running streaming applications in production.</p><p id="7017" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Let’s start by adding a dependency to the <code class="cx ql qm qn qo b">pom.xml</code>:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="4b04" class="qs ot fq qo b bg qt qu l qv qw">&lt;dependency&gt;<br/> &lt;groupId&gt;org.apache.flink&lt;/groupId&gt;<br/> &lt;artifactId&gt;flink-runtime-web&lt;/artifactId&gt;<br/> &lt;version&gt;${flink.version}&lt;/version&gt;<br/>&lt;/dependency&gt;</span></pre><p id="ffde" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">And slightly change the code in our main class <code class="cx ql qm qn qo b">App.java</code>:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="fa97" class="qs ot fq qo b bg qt qu l qv qw">package de.vojay.flitch;<br/><br/>import org.apache.flink.configuration.Configuration;<br/>import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;<br/><br/>public class App {<br/><br/> public static void main(String[] args) throws Exception {<br/>  StreamExecutionEnvironment env = StreamExecutionEnvironment<br/>   .createLocalEnvironmentWithWebUI(new Configuration());<br/><br/>  env.fromSequence(1, Long.MAX_VALUE).print();<br/>  env.execute("Flitch");<br/>  env.close();<br/> }<br/><br/>}</span></pre><p id="84fa" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">The streaming application will now process a sequence of numbers, so that it will not finish immediately. Also with <code class="cx ql qm qn qo b">createLocalEnvironmentWithWebUI</code> we will have the Flink Web UI available locally on port <code class="cx ql qm qn qo b">8081</code> while the application is running.</p><p id="a968" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Start again and open <a class="af nj" href="http://localhost:8081/" rel="noopener ugc nofollow" target="_blank">http://localhost:8081/</a> in your browser. Apart from various metrics, you can also see the execution plan of your Flink application.</p><figure class="ms mt mu mv mw mj mp mq paragraph-image"><div role="button" tabindex="0" class="mz na ed nb bh nc"><div class="mp mq rd"><img src="../Images/d241e32e3d4e642fcb33f54117488f69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BSylThtvwGGbVVD_RI89Yg.png"/></div></div><figcaption class="ne nf ng mp mq nh ni bf b bg z dx">Flink Web UI (by author)</figcaption></figure><p id="45dd" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Now we have a proper local setup and can get started connecting our application to Twitch and run sentiment analysis on chat messages.</p><h1 id="cc63" class="os ot fq bf ou ov qf gq ox oy qg gt pa pb qh pd pe pf qi ph pi pj qj pl pm pn bk">Read the Twitch chat</h1><p id="fa9d" class="pw-post-body-paragraph nn no fq nq b go po ns nt gr pp nv nw nx pq nz oa ob pr od oe of ps oh oi oj fj bk"><a class="af nj" href="https://www.twitch.tv/" rel="noopener ugc nofollow" target="_blank">Twitch</a>, the leading live streaming platform for gamers, offers a comprehensive API and a chat feature that’s deeply integrated with the Internet Relay Chat (IRC) protocol.</p><figure class="ms mt mu mv mw mj mp mq paragraph-image"><div role="button" tabindex="0" class="mz na ed nb bh nc"><div class="mp mq re"><img src="../Images/31fb16b46f763b431e6eb957b698c3f5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*4k3SazJOVAfp6o2i"/></div></div><figcaption class="ne nf ng mp mq nh ni bf b bg z dx">Photo by <a class="af nj" href="https://unsplash.com/@casparrubin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Caspar Camille Rubin</a> on <a class="af nj" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0ba5" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">At its core, the Twitch API allows applications to interact with Twitch’s data. This includes retrieving information about live streams, VODs (Video on Demand), users, and game details. The API is RESTful, meaning it follows the architectural style of the web, making it straightforward to use with common HTTP requests. Developers can use this API to create custom experiences, such as displaying live stream stats, searching for channels, or even automating stream setups.</p><p id="cf35" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">The Twitch chat is a vital aspect of the Twitch experience, allowing viewers to interact with streamers and other viewers in real-time. Underneath the modern interface of Twitch Chat lies the Internet Relay Chat (IRC) protocol, a staple of online communication since the late 80s. This reliance on IRC allows for a wide range of possibilities when it comes to reading and interacting with chat through custom applications.</p><p id="6e95" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">For our purpose, we simply want to read the chat, without writing messages ourselves. Fortunately, Twitch allows anonymous connections to the chat for read-only application use-cases.</p><p id="edd4" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">To reduce the implementation effort, we will use an existing library to interact with Twitch: Twitch4J. Twitch4J is a modern Java library designed to simplify the integration with Twitch’s features, including its API, Chat (via IRC), PubSub (for real-time notifications), and Webhooks. Essentially, it’s a powerful toolkit for Java developers looking to interact with Twitch services without having to directly manage low-level details like HTTP requests or IRC protocol handling.</p><h1 id="db06" class="os ot fq bf ou ov qf gq ox oy qg gt pa pb qh pd pe pf qi ph pi pj qj pl pm pn bk">Add Twitch4J dependency</h1><p id="b6ff" class="pw-post-body-paragraph nn no fq nq b go po ns nt gr pp nv nw nx pq nz oa ob pr od oe of ps oh oi oj fj bk">The first step is to add Twitch4J as a dependency to the <code class="cx ql qm qn qo b">pom.xml</code>:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="4ff8" class="qs ot fq qo b bg qt qu l qv qw">&lt;dependency&gt;<br/> &lt;groupId&gt;com.github.twitch4j&lt;/groupId&gt;<br/> &lt;artifactId&gt;twitch4j&lt;/artifactId&gt;<br/> &lt;version&gt;1.19.0&lt;/version&gt;<br/>&lt;/dependency&gt;</span></pre><h1 id="9ce2" class="os ot fq bf ou ov qf gq ox oy qg gt pa pb qh pd pe pf qi ph pi pj qj pl pm pn bk">Create POJO for Twitch chat messages</h1><p id="d9da" class="pw-post-body-paragraph nn no fq nq b go po ns nt gr pp nv nw nx pq nz oa ob pr od oe of ps oh oi oj fj bk">We would like to have a lightweight, serializable Plain Old Java Object (POJO) in order to represent Twitch chat messages within our application. We are interested in the channel where the message was written, the user and the content itself.</p><p id="ce51" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Create a new class <code class="cx ql qm qn qo b">TwitchMessage</code> with the following implementation:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="dc13" class="qs ot fq qo b bg qt qu l qv qw">package de.vojay.flitch;<br/><br/>public class TwitchMessage {<br/><br/> private final String channel;<br/> private final String user;<br/> private final String message;<br/><br/> public TwitchMessage(String channel, String user, String message) {<br/>  this.channel = channel;<br/>  this.user = user;<br/>  this.message = message;<br/> }<br/><br/> public String getChannel() {<br/>  return channel;<br/> }<br/><br/> public String getUser() {<br/>  return user;<br/> }<br/><br/> public String getMessage() {<br/>  return message;<br/> }<br/><br/> @Override<br/> public String toString() {<br/>  StringBuffer sb = new StringBuffer("TwitchMessage{");<br/>  sb.append("channel='").append(channel).append('\'');<br/>  sb.append(", user='").append(user).append('\'');<br/>  sb.append(", message='").append(message).append('\'');<br/>  sb.append('}');<br/>  return sb.toString();<br/> }<br/><br/>}</span></pre><p id="62e8" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">As a side note: You do not have to write basic functions like <code class="cx ql qm qn qo b">toString()</code> on your own, you can use IntelliJ to generate it for you. Simply click on <em class="np">Code</em> → <em class="np">Generate…</em> → <code class="cx ql qm qn qo b">toString()</code> to get the result above.</p><figure class="ms mt mu mv mw mj mp mq paragraph-image"><div role="button" tabindex="0" class="mz na ed nb bh nc"><div class="mp mq rf"><img src="../Images/b3202075c87edca8319d6db7ae8379d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LyaZjaZSzZ4a9PFklygxFA.png"/></div></div><figcaption class="ne nf ng mp mq nh ni bf b bg z dx">Generate toString (by author)</figcaption></figure><h1 id="b69b" class="os ot fq bf ou ov qf gq ox oy qg gt pa pb qh pd pe pf qi ph pi pj qj pl pm pn bk">Create custom Twitch source function for Flink</h1><p id="0844" class="pw-post-body-paragraph nn no fq nq b go po ns nt gr pp nv nw nx pq nz oa ob pr od oe of ps oh oi oj fj bk">We will now use Twitch4J to implement a custom Twitch source function for Flink. The source function will generate an unbounded stream of data, in this case Twitch chat messages. That also means, the application will not terminate until we explicitly stop it.</p><p id="070c" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">The Twitch client can be built like this:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="b7d8" class="qs ot fq qo b bg qt qu l qv qw">TwitchClientBuilder clientBuilder = TwitchClientBuilder.builder();<br/>client = clientBuilder<br/> .withEnableChat(true)<br/> .build();<br/><br/>client.getChat().joinChannel("vojay");</span></pre><p id="23d9" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">With this example we get a <code class="cx ql qm qn qo b">client</code> that joins the Twitch channel called <em class="np">vojay</em>. <strong class="nq fr">Yes, I once was an active streamer myself</strong>. Fun fact: I teached people game development and general software development in my streams. I also enjoyed playing retro games live on stream 🎮. But that is a different topic, let’s focus on the project 😉.</p><p id="1e88" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">You should also notice, that there is no authentication in the example above. As said before, since we only want to read the chat, no authentication is needed. In fact, we simply join an IRC chat anonymously and read the messages.</p><p id="14cd" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Since we want to establish the connection to the Twitch chat only once per source instance, we have to extend the abstract <code class="cx ql qm qn qo b">RichSourceFunction</code> class, in order to be able to override the <code class="cx ql qm qn qo b">open</code> function, which allows to add code for initialization.</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="fa3a" class="qs ot fq qo b bg qt qu l qv qw">public class TwitchSource extends RichSourceFunction&lt;TwitchMessage&gt; {<br/> @Override<br/> public void open(Configuration configuration) {<br/>  // ...<br/> }<br/><br/> // ...<br/>}</span></pre><p id="0d35" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">We also use our <code class="cx ql qm qn qo b">TwitchMessage</code> POJO for the generic parameter to tell Flink that this source generates elements of type <code class="cx ql qm qn qo b">TwitchMessage</code>.</p><p id="66dc" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Furthermore, want to be able to pass an array of Twitch channels we want to listen on in the constructor of the source function.</p><p id="d771" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">To control the state of our source function, we use a <code class="cx ql qm qn qo b">boolean</code> variable called <code class="cx ql qm qn qo b">running</code>, which we set to <code class="cx ql qm qn qo b">true</code> in the <code class="cx ql qm qn qo b">open</code> function.</p><p id="743b" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Based on this, the constructor and <code class="cx ql qm qn qo b">open</code> function look like the following:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="eb4f" class="qs ot fq qo b bg qt qu l qv qw">public class TwitchSource extends RichSourceFunction&lt;TwitchMessage&gt; {<br/><br/> private final String[] twitchChannels;<br/><br/> private TwitchClient client;<br/> private SimpleEventHandler eventHandler;<br/> private boolean running = true;<br/><br/> public TwitchSource(String[] twitchChannels) {<br/>  this.twitchChannels = twitchChannels;<br/> }<br/><br/> @Override<br/> public void open(Configuration configuration) {<br/>  client = TwitchClientBuilder<br/>   .builder()<br/>   .withEnableChat(true)<br/>   .build();<br/><br/>  for(String channel : twitchChannels) {<br/>   client.getChat().joinChannel(channel);<br/>  }<br/><br/>  eventHandler = client<br/>   .getEventManager()<br/>   .getEventHandler(SimpleEventHandler.class);<br/><br/>  running = true;<br/> }<br/><br/> // ...</span></pre><p id="0dcd" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">With that, we have all we need to consume messages and emit them for further processing as a stream of data.</p><p id="71d1" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">The <code class="cx ql qm qn qo b">run</code> function of a source function is where the magic happens. Here we generate the data and with a given <code class="cx ql qm qn qo b">SourceContext</code>, we can emit data.</p><p id="2927" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">The <code class="cx ql qm qn qo b">SimpleEventHandler</code> provided by Twitch4J can be used to react on specific messages.</p><p id="4ca5" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Whenever we get an event of type <code class="cx ql qm qn qo b">IRCMessageEvent</code>, which is a message in the Twitch chat, we generate an instance of our POJO and emit it to the stream via the context.</p><p id="afbe" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">To ensure our source function does not terminate, we will add a loop with an artificial delay, which will run until our <code class="cx ql qm qn qo b">boolean</code> variable <code class="cx ql qm qn qo b">running</code> is set to <code class="cx ql qm qn qo b">false</code>. This will be done in the <code class="cx ql qm qn qo b">cancel</code> function, which is called by the Flink environment on shutdown.</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="4b2b" class="qs ot fq qo b bg qt qu l qv qw"> @Override<br/> public void run(SourceContext&lt;TwitchMessage&gt; ctx) throws InterruptedException {<br/>  eventHandler.onEvent(IRCMessageEvent.class, event -&gt; {<br/>   String channel = event.getChannel().getName();<br/>   EventUser eventUser = event.getUser();<br/>   String user = eventUser == null ? "" : eventUser.getName();<br/>   String message = event.getMessage().orElseGet(String::new);<br/><br/>   ctx.collect(new TwitchMessage(channel, user, message));<br/>  });<br/><br/>  while(running) {<br/>   Thread.sleep(100);<br/>  }<br/> }<br/><br/> @Override<br/> public void cancel() {<br/>  client.close();<br/>  running = false;<br/> }</span></pre><p id="c283" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Putting it all together, this is the full implementation of our custom Twitch source function for Flink <code class="cx ql qm qn qo b">TwitchSource.java</code>:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="e47d" class="qs ot fq qo b bg qt qu l qv qw">package de.vojay.flitch;<br/><br/>import com.github.philippheuer.events4j.simple.SimpleEventHandler;<br/>import com.github.twitch4j.TwitchClient;<br/>import com.github.twitch4j.TwitchClientBuilder;<br/>import com.github.twitch4j.chat.events.channel.IRCMessageEvent;<br/>import com.github.twitch4j.common.events.domain.EventUser;<br/>import org.apache.flink.configuration.Configuration;<br/>import org.apache.flink.streaming.api.functions.source.RichSourceFunction;<br/><br/>public class TwitchSource extends RichSourceFunction&lt;TwitchMessage&gt; {<br/><br/> private final String[] twitchChannels;<br/><br/> private TwitchClient client;<br/> private SimpleEventHandler eventHandler;<br/> private boolean running = true;<br/><br/> public TwitchSource(String[] twitchChannels) {<br/>  this.twitchChannels = twitchChannels;<br/> }<br/><br/> @Override<br/> public void open(Configuration configuration) {<br/>  client = TwitchClientBuilder<br/>   .builder()<br/>   .withEnableChat(true)<br/>   .build();<br/><br/>  for(String channel : twitchChannels) {<br/>   client.getChat().joinChannel(channel);<br/>  }<br/><br/>  eventHandler = client<br/>   .getEventManager()<br/>   .getEventHandler(SimpleEventHandler.class);<br/><br/>  running = true;<br/> }<br/><br/> @Override<br/> public void run(SourceContext&lt;TwitchMessage&gt; ctx) throws InterruptedException {<br/>  eventHandler.onEvent(IRCMessageEvent.class, event -&gt; {<br/>   String channel = event.getChannel().getName();<br/>   EventUser eventUser = event.getUser();<br/>   String user = eventUser == null ? "" : eventUser.getName();<br/>   String message = event.getMessage().orElseGet(String::new);<br/><br/>   ctx.collect(new TwitchMessage(channel, user, message));<br/>  });<br/><br/>  while(running) {<br/>   Thread.sleep(100);<br/>  }<br/> }<br/><br/> @Override<br/> public void cancel() {<br/>  client.close();<br/>  running = false;<br/> }<br/><br/>}</span></pre><h1 id="78d2" class="os ot fq bf ou ov qf gq ox oy qg gt pa pb qh pd pe pf qi ph pi pj qj pl pm pn bk">Use source function</h1><p id="a32d" class="pw-post-body-paragraph nn no fq nq b go po ns nt gr pp nv nw nx pq nz oa ob pr od oe of ps oh oi oj fj bk">With this custom source function, we can already extend our streaming pipeline in <code class="cx ql qm qn qo b">App.java</code> to simply print each chat message written to the chat:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="e68a" class="qs ot fq qo b bg qt qu l qv qw">package de.vojay.flitch;<br/><br/>import org.apache.flink.configuration.Configuration;<br/>import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;<br/><br/>public class App {<br/><br/> public static void main(String[] args) throws Exception {<br/>  StreamExecutionEnvironment env = StreamExecutionEnvironment<br/>   .createLocalEnvironmentWithWebUI(new Configuration());<br/><br/>  TwitchSource twitchSource = new TwitchSource(new String[]{"vojay"});<br/>  env.addSource(twitchSource)<br/>   .print();<br/><br/>  env.execute("Flitch");<br/>  env.close();<br/> }<br/><br/>}</span></pre><p id="2f8d" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">With <code class="cx ql qm qn qo b">addSource</code> we can add our source function. The elements are then processed by the next step in the stream, which is <code class="cx ql qm qn qo b">print()</code>. With this sink, we will again output each element to STDOUT.</p><p id="a95c" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">When running the application now and writing to the chat at <a class="af nj" href="https://www.twitch.tv/popout/vojay/chat" rel="noopener ugc nofollow" target="_blank">https://twitch.tv/vojay</a>, the messages will be processed and printed by our streaming application 🎉.</p><figure class="ms mt mu mv mw mj mp mq paragraph-image"><div role="button" tabindex="0" class="mz na ed nb bh nc"><div class="mp mq rg"><img src="../Images/a308cbba3475c4b7ba1ab2b77ef0178c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PwQsJ3t6z0QJpTVFlgslWw.png"/></div></div><figcaption class="ne nf ng mp mq nh ni bf b bg z dx">Twitch source for Flink (by author)</figcaption></figure><h1 id="b566" class="os ot fq bf ou ov qf gq ox oy qg gt pa pb qh pd pe pf qi ph pi pj qj pl pm pn bk">Twitch chat sentiment analysis</h1><p id="8cc9" class="pw-post-body-paragraph nn no fq nq b go po ns nt gr pp nv nw nx pq nz oa ob pr od oe of ps oh oi oj fj bk">Now that we can read the Twitch chat as a stream of data, it is time to process each message. The basic idea is: for each Twitch message, we detect the individual sentences of the message and calculate the sentiment for each of the sentences. The output will be a structure like this:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="d834" class="qs ot fq qo b bg qt qu l qv qw">Tuple2&lt;TwitchMessage, Tuple2&lt;List&lt;Integer&gt;, List&lt;String&gt;&gt;&gt;</span></pre><p id="d741" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Let’s break it down: the result contains the original POJO of the Twitch chat message together with another tuple with 2 elements:</p><ul class=""><li id="6c08" class="nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj pt pu pv bk">A list of <strong class="nq fr">sentiment scores</strong> (<code class="cx ql qm qn qo b">List&lt;Integer&gt;</code>) containing the score for each sentence in the message, from 0 (very negative) to 4 (very positive) and</li><li id="421f" class="nn no fq nq b go pw ns nt gr px nv nw nx py nz oa ob pz od oe of qa oh oi oj pt pu pv bk">a list of <strong class="nq fr">sentiment classes</strong> (<code class="cx ql qm qn qo b">List&lt;String&gt;</code>) containing the readable class for each sentence in the message, for example: Neutral or Negative.</li></ul></div></div><div class="mj"><div class="ab cb"><div class="lm mk ln ml lo mm cf mn cg mo ci bh"><figure class="ms mt mu mv mw mj mx my paragraph-image"><div role="button" tabindex="0" class="mz na ed nb bh nc"><div class="mp mq qe"><img src="../Images/370607a498f8c196cf9fb7a621cec6e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*_VDioxVhmpRJjwNQDuZfhA.png"/></div></div><figcaption class="ne nf ng mp mq nh ni bf b bg z dx">Sentiment map function (by author)</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="600f" class="os ot fq bf ou ov qf gq ox oy qg gt pa pb qh pd pe pf qi ph pi pj qj pl pm pn bk">Add Stanford CoreNLP dependencies</h1><p id="4fb5" class="pw-post-body-paragraph nn no fq nq b go po ns nt gr pp nv nw nx pq nz oa ob pr od oe of ps oh oi oj fj bk">To perform the sentiment analysis, we will use the <a class="af nj" href="https://stanfordnlp.github.io/CoreNLP/" rel="noopener ugc nofollow" target="_blank">CoreNLP library</a> by the <a class="af nj" href="https://nlp.stanford.edu/" rel="noopener ugc nofollow" target="_blank">Stanford NLP Group</a>. There are alternatives like <a class="af nj" href="https://opennlp.apache.org/" rel="noopener ugc nofollow" target="_blank">Apache OpenNLP</a> or the <a class="af nj" href="https://djl.ai/" rel="noopener ugc nofollow" target="_blank">Deep Java Library</a>. In this project, we will focus on CoreNLP but feel free to create alternative versions using one of the other libraries, which can be a great way to learn more about it.</p><p id="b060" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">CoreNLP is a comprehensive tool for NLP in Java, supporting multiple languages including Arabic, Chinese, English, French, German, Hungarian, Italian, and Spanish. It processes text to provide linguistic annotations such as sentence boundaries, parts of speech, named entities, and more through a <strong class="nq fr">pipeline system</strong> that generates <strong class="nq fr">CoreDocuments</strong>. These documents hold all annotation information, which can be accessed easily or exported.</p><p id="ef81" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">In the context of CoreNLP, a <strong class="nq fr">pipeline</strong> is essentially a sequence of processing steps designed to analyze text. When you input raw text into CoreNLP, the pipeline passes the text through various <strong class="nq fr">annotators</strong> (<em class="np">processing units</em>), each responsible for a different aspect of NLP. These annotators might identify sentence boundaries, recognize parts of speech, detect named entities, parse sentence structures, and more, depending on the specific tasks you want to perform.</p><p id="ff93" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">In our case, we will use the <strong class="nq fr">sentences annotation</strong> to split the Twitch message into sentences and then use the <strong class="nq fr">sentiment core annotations</strong> on each sentence to get the sentiment of it. But first, we need to add the required dependencies to the <code class="cx ql qm qn qo b">pom.xml</code> of our project:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="ff05" class="qs ot fq qo b bg qt qu l qv qw">&lt;dependency&gt;<br/> &lt;groupId&gt;edu.stanford.nlp&lt;/groupId&gt;<br/> &lt;artifactId&gt;stanford-corenlp&lt;/artifactId&gt;<br/> &lt;version&gt;4.5.6&lt;/version&gt;<br/>&lt;/dependency&gt;<br/>&lt;dependency&gt;<br/> &lt;groupId&gt;edu.stanford.nlp&lt;/groupId&gt;<br/> &lt;artifactId&gt;stanford-corenlp&lt;/artifactId&gt;<br/> &lt;version&gt;4.5.6&lt;/version&gt;<br/> &lt;classifier&gt;models&lt;/classifier&gt;<br/>&lt;/dependency&gt;</span></pre><p id="7f32" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">The first dependency represents the library itself while the second dependency will fetch all the related pre-trained models into your local <code class="cx ql qm qn qo b">.m2</code> folder. Don’t be surprised, the first time Maven resolves the dependencies will take a while due to the download of the models.</p><h1 id="eea7" class="os ot fq bf ou ov qf gq ox oy qg gt pa pb qh pd pe pf qi ph pi pj qj pl pm pn bk">Create sentiment analysis map function</h1><p id="5f32" class="pw-post-body-paragraph nn no fq nq b go po ns nt gr pp nv nw nx pq nz oa ob pr od oe of ps oh oi oj fj bk">For the map function, we will use the abstract class <code class="cx ql qm qn qo b">RichMapFunction</code> as a basis, so that we can again override the <code class="cx ql qm qn qo b">open</code> function in order to initialize the pipeline for sentiment analysis only once per instance. When extending the <code class="cx ql qm qn qo b">RichMapFunction</code>, we need to specify to generics, one for the type of input and another one for the type of output. The input will be one Twitch message POJO, so <code class="cx ql qm qn qo b">TwitchMessage</code> and the output will be the message again together with its sentiment in form of a list of scores and another list of classes, as described before.</p><p id="2e75" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Let’s start by creating a new class called <code class="cx ql qm qn qo b">AnalyzeSentiment</code> and extend the <code class="cx ql qm qn qo b">RichMapFunction</code>:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="a82a" class="qs ot fq qo b bg qt qu l qv qw">public class AnalyzeSentiment extends RichMapFunction&lt;<br/> TwitchMessage,<br/> Tuple2&lt;TwitchMessage, Tuple2&lt;List&lt;Integer&gt;, List&lt;String&gt;&gt;&gt;<br/>&gt; {<br/> // ...<br/>}</span></pre><p id="62e0" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">When initializing the Stanford CoreNLP pipeline, we have to specify the types of annotators we want to use in our pipeline, so that the library only loads the required models. This can be achieved via a <code class="cx ql qm qn qo b">Properties</code> object, passed to the constructor of <code class="cx ql qm qn qo b">StanfordCoreNLP</code>. This is how we initialize the pipeline for our use-case:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="11a0" class="qs ot fq qo b bg qt qu l qv qw"> @Override<br/> public void open(Configuration configuration) {<br/>  Properties properties = new Properties();<br/>  properties.setProperty(<br/>   "annotators",<br/>   "tokenize, ssplit, parse, sentiment"<br/>  );<br/><br/>  pipeline = new StanfordCoreNLP(properties);<br/> }</span></pre><p id="21af" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">To make our map operator more readable, we extract the core logic to get the sentiment to a dedicated function. We start by processing the message with the pipeline:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="c690" class="qs ot fq qo b bg qt qu l qv qw">Annotation annotation = pipeline.process(message);</span></pre><p id="fa38" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Then we process each individual sentence:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="6c65" class="qs ot fq qo b bg qt qu l qv qw">annotation.get(SentencesAnnotation.class).forEach(sentence -&gt; {</span></pre><p id="d382" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Get the score of the sentence and add it to a list of scores:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="e090" class="qs ot fq qo b bg qt qu l qv qw">// sentiment score<br/>Tree tree = sentence.get(SentimentAnnotatedTree.class);<br/>scores.add(getPredictedClass(tree));</span></pre><p id="fb89" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">And get the class of the sentence and add it to a list of classes:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="9927" class="qs ot fq qo b bg qt qu l qv qw">// sentiment class<br/>classes.add(sentence.get(SentimentClass.class));</span></pre><p id="d038" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">With that, the full function to get the sentiment tuple with the scores and classes looks like this:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="081a" class="qs ot fq qo b bg qt qu l qv qw">private Tuple2&lt;List&lt;Integer&gt;, List&lt;String&gt;&gt; getSentiment(String message) {<br/> List&lt;Integer&gt; scores = new ArrayList&lt;&gt;();<br/> List&lt;String&gt; classes = new ArrayList&lt;&gt;();<br/><br/> if (message != null &amp;&amp; !message.isEmpty()) {<br/>  Annotation annotation = pipeline.process(message);<br/><br/>  annotation.get(SentencesAnnotation.class).forEach(sentence -&gt; {<br/>   // sentiment score<br/>   Tree tree = sentence.get(SentimentAnnotatedTree.class);<br/>   scores.add(getPredictedClass(tree));<br/><br/>   // sentiment class<br/>   classes.add(sentence.get(SentimentClass.class));<br/>  });<br/> }<br/><br/> return new Tuple2&lt;&gt;(scores, classes);<br/>}</span></pre><p id="efcf" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">The map function itself simply calls this function and puts everything together into a tuple to emit it to the stream.</p><p id="20ac" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Putting everything together, this is the full implementation of our custom map function <code class="cx ql qm qn qo b">AnalyzeSentiment.java</code>:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="38c3" class="qs ot fq qo b bg qt qu l qv qw">package de.vojay.flitch;<br/><br/>import edu.stanford.nlp.ling.CoreAnnotations.SentencesAnnotation;<br/>import edu.stanford.nlp.pipeline.Annotation;<br/>import edu.stanford.nlp.pipeline.StanfordCoreNLP;<br/>import edu.stanford.nlp.sentiment.SentimentCoreAnnotations.SentimentAnnotatedTree;<br/>import edu.stanford.nlp.sentiment.SentimentCoreAnnotations.SentimentClass;<br/>import edu.stanford.nlp.trees.Tree;<br/>import org.apache.flink.api.common.functions.RichMapFunction;<br/>import org.apache.flink.api.java.tuple.Tuple2;<br/>import org.apache.flink.configuration.Configuration;<br/><br/>import java.util.ArrayList;<br/>import java.util.List;<br/>import java.util.Properties;<br/><br/>import static edu.stanford.nlp.neural.rnn.RNNCoreAnnotations.getPredictedClass;<br/><br/>public class AnalyzeSentiment extends RichMapFunction&lt;<br/> TwitchMessage,<br/> Tuple2&lt;TwitchMessage, Tuple2&lt;List&lt;Integer&gt;, List&lt;String&gt;&gt;&gt;<br/>&gt; {<br/><br/> private StanfordCoreNLP pipeline;<br/><br/><br/> @Override<br/> public void open(Configuration configuration) {<br/>  Properties properties = new Properties();<br/>  properties.setProperty(<br/>   "annotators",<br/>   "tokenize, ssplit, parse, sentiment"<br/>  );<br/><br/>  pipeline = new StanfordCoreNLP(properties);<br/> }<br/><br/> @Override<br/> public Tuple2&lt;<br/>  TwitchMessage,<br/>  Tuple2&lt;List&lt;Integer&gt;, List&lt;String&gt;&gt;<br/> &gt; map(TwitchMessage twitchMessage) {<br/>  return new Tuple2&lt;&gt;(<br/>   twitchMessage,<br/>   getSentiment(twitchMessage.getMessage())<br/>  );<br/> }<br/><br/> private Tuple2&lt;List&lt;Integer&gt;, List&lt;String&gt;&gt; getSentiment(String message) {<br/>  List&lt;Integer&gt; scores = new ArrayList&lt;&gt;();<br/>  List&lt;String&gt; classes = new ArrayList&lt;&gt;();<br/><br/>  if (message != null &amp;&amp; !message.isEmpty()) {<br/>   Annotation annotation = pipeline.process(message);<br/><br/>   annotation.get(SentencesAnnotation.class).forEach(sentence -&gt; {<br/>    // sentiment score<br/>    Tree tree = sentence<br/>     .get(SentimentAnnotatedTree.class);<br/>    scores.add(getPredictedClass(tree));<br/><br/>    // sentiment class<br/>    classes.add(sentence.get(SentimentClass.class));<br/>   });<br/>  }<br/><br/>  return new Tuple2&lt;&gt;(scores, classes);<br/> }<br/><br/>}</span></pre><h1 id="75ee" class="os ot fq bf ou ov qf gq ox oy qg gt pa pb qh pd pe pf qi ph pi pj qj pl pm pn bk">Use map function</h1><p id="c8c0" class="pw-post-body-paragraph nn no fq nq b go po ns nt gr pp nv nw nx pq nz oa ob pr od oe of ps oh oi oj fj bk">We now have all ingredients for our real-time sentiment analysis streaming application 🚀. That means, we can switch back to our <code class="cx ql qm qn qo b">App</code> class, where we define how the streaming application looks like.</p><p id="81ef" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Here, we will also introduce another useful Apache Flink feature, which is the <code class="cx ql qm qn qo b">ParameterTool</code>. A generic helper class allowing to parameterize your application in different ways. We will use it to add a program argument <code class="cx ql qm qn qo b">--twitchChannels</code> that allows to pass a comma-separated list of Twitch channels we want to use in our <code class="cx ql qm qn qo b">TwitchSource</code>:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="a612" class="qs ot fq qo b bg qt qu l qv qw">ParameterTool parameters = ParameterTool.fromArgs(args);<br/>String[] twitchChannels = parameters<br/> .getRequired("twitchChannels")<br/> .trim()<br/> .split(",");</span></pre><p id="1369" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Also we will include our new map function in the pipeline:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="cdd4" class="qs ot fq qo b bg qt qu l qv qw">.map(new AnalyzeSentiment())</span></pre><p id="d589" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">This is how our <code class="cx ql qm qn qo b">App</code> class looks in the end:</p><pre class="ms mt mu mv mw qp qo qq bp qr bb bk"><span id="4221" class="qs ot fq qo b bg qt qu l qv qw">package de.vojay.flitch;<br/><br/>import org.apache.flink.api.java.utils.ParameterTool;<br/>import org.apache.flink.configuration.Configuration;<br/>import org.apache.flink.streaming.api.environment.StreamExecutionEnvironment;<br/><br/>public class App {<br/><br/> public static void main(String[] args) throws Exception {<br/>  StreamExecutionEnvironment env = StreamExecutionEnvironment<br/>   .createLocalEnvironmentWithWebUI(new Configuration());<br/><br/>  ParameterTool parameters = ParameterTool.fromArgs(args);<br/>  String[] twitchChannels = parameters<br/>   .getRequired("twitchChannels")<br/>   .trim()<br/>   .split(",");<br/><br/>  env<br/>   .addSource(new TwitchSource(twitchChannels))<br/>   .map(new AnalyzeSentiment())<br/>   .print();<br/><br/>  env.execute("Flitch");<br/>  env.close();<br/> }<br/><br/>}</span></pre><p id="3668" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Before we run it again, we need to adjust our run configuration again by adding the new <code class="cx ql qm qn qo b">--twitchChannels</code> parameter. As we marked it as <strong class="nq fr">required</strong>, the application would fail otherwise. Navigate to <em class="np">Run</em> → <em class="np">Edit Configurations…</em> and add:</p><p id="08ed" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk"><code class="cx ql qm qn qo b">--twitchChannels vojay,valorant</code></p><p id="7c43" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">as program arguments. <strong class="nq fr">You can use any Twitch channel here, feel free to browse Twitch for bigger channels and see what happens.</strong></p><figure class="ms mt mu mv mw mj mp mq paragraph-image"><div role="button" tabindex="0" class="mz na ed nb bh nc"><div class="mp mq rh"><img src="../Images/1af0e4eb58a9d5447c2310ac491f19a0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4P6BFEWiHh2MTSykU6sEVQ.png"/></div></div><figcaption class="ne nf ng mp mq nh ni bf b bg z dx">Run configuration with twitchChannels parameter (by author)</figcaption></figure><p id="2901" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Now it is time to run your streaming application again and enjoy the show!</p><figure class="ms mt mu mv mw mj mp mq paragraph-image"><div role="button" tabindex="0" class="mz na ed nb bh nc"><div class="mp mq ri"><img src="../Images/9fa3cbde399e5bc2d238f4b3919a2d84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*hMMgQdkImPw1Q6x8"/></div></div><figcaption class="ne nf ng mp mq nh ni bf b bg z dx">Photo by <a class="af nj" href="https://unsplash.com/@djravine?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Stanley Li</a> on <a class="af nj" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="35a9" class="os ot fq bf ou ov qf gq ox oy qg gt pa pb qh pd pe pf qi ph pi pj qj pl pm pn bk">Conclusion</h1><p id="ebe5" class="pw-post-body-paragraph nn no fq nq b go po ns nt gr pp nv nw nx pq nz oa ob pr od oe of ps oh oi oj fj bk">And there you have it! We’ve built a real-time sentiment analysis application for Twitch chat using Apache Flink. Now you can not only see the chat flow by, but also understand the emotional pulse of the audience. This might be the boilerplate for a more advanced version. Track the sentiment throughout a stream, see how the viewers react to big plays or funny moments, and use that knowledge to create even more engaging content.</p><p id="9854" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Some inspiration to turn this prototype into a valuable, production-ready project:</p><p id="bdf8" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">⚙️ <strong class="nq fr">Adjust model</strong></p><p id="2fc9" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Use a model that is trained specifically on social media data (e.g., <a class="af nj" href="https://huggingface.co/cardiffnlp/twitter-roberta-base-sentiment" rel="noopener ugc nofollow" target="_blank">RoBERTa</a>) or even better, train a model directly with historical Twitch chat data to incorporate Twitch-specific communication aspects like specific emoji codes.</p><p id="631d" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">🧮 <strong class="nq fr">Apply windowing</strong></p><p id="f548" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Extend the Flink pipeline with a window function, for example, a tumbling window per minute, and aggregate the sentiment score as an average per minute.</p><p id="ac47" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">📦 <strong class="nq fr">Persist results</strong></p><p id="91a4" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Persist the resulting stream with an aggregate per minute in Kafka or a Time Series Database (TSDB).</p><p id="82c9" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">📊 <strong class="nq fr">Create dashboard</strong></p><p id="a044" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Create a dashboard on the aggregated data, visualizing the average sentiment per minute in a graph.</p><p id="fe00" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">With these suggestions, you can combine the result with other metadata, like the actual category/game played of the stream or the time of the day, to create sophisticated recommendations about what content results in a positive Twitch chat experience.</p><p id="5e2e" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">So, the next time you tune into your favorite streamer, keep an eye out for that sentiment analysis running in the background. It might just reveal some fascinating insights about the passionate world of the Twitch chat!</p><p id="6732" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">But the most important thing about this article is: get inspired, learn and inspire others. The cool thing about Data Engineering and related fields:</p><blockquote class="nk nl nm"><p id="6b22" class="nn no np nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk"><strong class="nq fr"><em class="fq">data is everywhere</em></strong></p></blockquote><p id="7143" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">so there is always the next interesting question around the corner that can be used to learn and ideally share your inspiration with others.</p><figure class="ms mt mu mv mw mj mp mq paragraph-image"><div role="button" tabindex="0" class="mz na ed nb bh nc"><div class="mp mq rj"><img src="../Images/258f31d4a003728a74203f1bdb1d1f6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*909oIBLMmne9PflF"/></div></div><figcaption class="ne nf ng mp mq nh ni bf b bg z dx">Photo by <a class="af nj" href="https://unsplash.com/@swimstaralex?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Alexander Sinn</a> on <a class="af nj" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="7f96" class="pw-post-body-paragraph nn no fq nq b go nr ns nt gr nu nv nw nx ny nz oa ob oc od oe of og oh oi oj fj bk">Enjoy and let me know about your experiences in the comments ✌️.</p></div></div></div></div>    
</body>
</html>