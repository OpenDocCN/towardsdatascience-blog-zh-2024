- en: Practical Computer Simulations for Product Analysts
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 产品分析师的实用计算机模拟
- en: 原文：[https://towardsdatascience.com/practical-computer-simulations-for-product-analysts-90b5deb6a54e?source=collection_archive---------5-----------------------#2024-04-19](https://towardsdatascience.com/practical-computer-simulations-for-product-analysts-90b5deb6a54e?source=collection_archive---------5-----------------------#2024-04-19)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://towardsdatascience.com/practical-computer-simulations-for-product-analysts-90b5deb6a54e?source=collection_archive---------5-----------------------#2024-04-19](https://towardsdatascience.com/practical-computer-simulations-for-product-analysts-90b5deb6a54e?source=collection_archive---------5-----------------------#2024-04-19)
- en: 'Part 1: Task-specific approaches for scenario forecasting'
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第一部分：针对场景预测的任务特定方法
- en: '[](https://miptgirl.medium.com/?source=post_page---byline--90b5deb6a54e--------------------------------)[![Mariya
    Mansurova](../Images/b1dd377b0a1887db900cc5108bca8ea8.png)](https://miptgirl.medium.com/?source=post_page---byline--90b5deb6a54e--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--90b5deb6a54e--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--90b5deb6a54e--------------------------------)
    [Mariya Mansurova](https://miptgirl.medium.com/?source=post_page---byline--90b5deb6a54e--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://miptgirl.medium.com/?source=post_page---byline--90b5deb6a54e--------------------------------)[![Mariya
    Mansurova](../Images/b1dd377b0a1887db900cc5108bca8ea8.png)](https://miptgirl.medium.com/?source=post_page---byline--90b5deb6a54e--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--90b5deb6a54e--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--90b5deb6a54e--------------------------------)
    [Mariya Mansurova](https://miptgirl.medium.com/?source=post_page---byline--90b5deb6a54e--------------------------------)'
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--90b5deb6a54e--------------------------------)
    ·20 min read·Apr 19, 2024
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: ·发布于 [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--90b5deb6a54e--------------------------------)
    ·20分钟阅读·2024年4月19日
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '![](../Images/6987a0f2acb152826d29e342f49419d6.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/6987a0f2acb152826d29e342f49419d6.png)'
- en: Image by DALL-E
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 图片来自DALL-E
- en: In product analytics, we quite often get "what-if" questions. Our teams are
    constantly inventing different ways to improve the product and want to understand
    how it can affect our KPI or other metrics.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 在产品分析中，我们经常遇到“如果怎样”的问题。我们的团队不断发明各种方法来改进产品，并希望了解它如何影响我们的KPI或其他指标。
- en: 'Let''s look at some examples:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来看一些例子：
- en: Imagine we're in the fintech industry and facing new regulations requiring us
    to check more documents from customers making the first donation or sending more
    than $100K to a particular country. We want to understand the effect of this change
    on our Ops demand and whether we need to hire more agents.
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 假设我们在金融科技行业，面对新的规定，要求我们检查来自首次捐赠或向特定国家汇款超过10万美元的客户的更多文件。我们希望了解这一变化对我们的运营需求的影响，以及是否需要雇佣更多的客服人员。
- en: Let's switch to another industry. We might want to incentivise our taxi drivers
    to work late or take long-distance rides by introducing a new reward scheme. Before
    launching this change, it would be crucial for us to estimate the expected size
    of rewards and conduct a cost vs. benefit analysis.
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 让我们切换到另一个行业。我们可能希望通过推出一个新的奖励计划，鼓励出租车司机晚间工作或接受长途订单。在推出这一变化之前，估算奖励的预期规模并进行成本与收益分析对我们来说至关重要。
- en: As the last example, let's look at the main Customer Support KPIs. Usually,
    companies track the average waiting time. There are many possible ways how to
    improve this metric. We can add night shifts, hire more agents or leverage LLMs
    to answer questions quickly. To prioritise these ideas, we will need to estimate
    their impact on our KPI.
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 以最后一个例子为例，让我们看看主要的客户支持KPI。通常，公司会跟踪平均等待时间。改善这一指标有很多可能的方式。我们可以增加夜班，雇佣更多的客服人员，或者利用大型语言模型（LLMs）快速回答问题。为了优先考虑这些想法，我们需要估算它们对我们的KPI的影响。
- en: When you see such questions for the first time, they look pretty intimidating.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 当你第一次看到这样的问题时，它们看起来可能非常令人畏惧。
- en: If someone asks you to calculate monthly active users or 7-day retention, it's
    straightforward. You just need to go to your database, write SQL and use the data
    you have.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 如果有人要求你计算月活跃用户数或7天留存率，这是直接的。你只需访问你的数据库，写SQL语句并使用现有的数据。
- en: Things become way more challenging (and exciting) when you need to calculate
    something that doesn't exist. Computer simulations will usually be the best solution
    for such tasks. According to [Wikipedia](https://en.wikipedia.org/wiki/Simulation),
    **simulation** is an imitative representation of a process or system that could
    exist in the real world. So, we will try to imitate different situations and use
    them in our decision-making.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 当你需要计算一些不存在的东西时，事情变得更加具有挑战性（也更为激动人心）。计算机模拟通常是此类任务的最佳解决方案。根据[维基百科](https://en.wikipedia.org/wiki/Simulation)，**模拟**是对一个可能存在于现实世界中的过程或系统的模拟性表现。因此，我们将尝试模仿不同的情景，并将其用于决策过程。
- en: 'Simulation is a powerful tool that can help you in various situations. So,
    I would like to share with you the practical examples of computer simulations
    in the series of articles:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 模拟是一个强大的工具，可以在各种情况下帮助你。因此，我想通过这系列文章与大家分享计算机模拟的实际案例：
- en: In this article, we will discuss how to use simulations to estimate different
    scenarios. You will learn the basic idea of simulations and see how they can solve
    complex tasks.
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在本文中，我们将讨论如何利用模拟来估算不同的情景。你将了解模拟的基本概念，并看到它们如何解决复杂的任务。
- en: In the second part, we will diverge from scenario analysis and will focus on
    the classic of computer simulations — bootstrap. Bootstrap can help you get confidence
    intervals for your metrics and analyse A/B tests.
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在第二部分，我们将不再讨论情景分析，而是聚焦于计算机模拟的经典方法——自举法（bootstrap）。自举法可以帮助你为度量指标获取置信区间，并分析A/B测试。
- en: I would like to devote the third part to [agent-based models](https://en.wikipedia.org/wiki/Agent-based_model).
    We will model the CS agent behaviour to understand how our process changes can
    affect CS KPIs such as queue size or average waiting time.
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我想将第三部分的内容奉献给[基于代理的模型](https://en.wikipedia.org/wiki/Agent-based_model)。我们将模拟客户服务（CS）代理的行为，了解我们的过程变动如何影响客户服务的关键绩效指标（KPI），如队列长度或平均等待时间。
- en: So, it's time to start and discuss the task we will solve in this article.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，是时候开始并讨论我们将在本文中解决的任务了。
- en: 'Our project: Launching tests for English courses'
  id: totrans-21
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 我们的项目：为英语课程启动测试
- en: Suppose we are working on an edtech product that helps people learn the English
    language. We've been working on a test that could assess the student's knowledge
    from different angles (reading, listening, writing and speaking). The test will
    give us and our students a clear understanding of their current level.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们正在开发一款教育技术产品，帮助人们学习英语。我们正在进行一项测试，这项测试可以从不同角度评估学生的知识水平（阅读、听力、写作和口语）。这项测试将为我们和我们的学生提供清晰的当前水平认知。
- en: We agreed to launch it for all new students so that we can assess their initial
    level. Also, we will suggest existing students pass this test when they return
    to the service next time.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经决定为所有新学生启动该测试，以便评估他们的初始水平。同时，我们会建议现有学生在下次回归服务时通过这项测试。
- en: Our goal is to build a forecast on the number of submitted tests over time.
    Since some parts of these tests (writing and speaking) will require manual review
    from our teachers, we would like to ensure that we will have enough capacity to
    check these tests on time.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的目标是根据提交的测试数量建立时间预测。由于这些测试的某些部分（写作和口语）需要我们的老师进行人工审核，我们希望确保我们有足够的能力按时完成这些测试的审核。
- en: 'Let''s try to structure our problem. We have two groups of students:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们试着对问题进行结构化。我们有两组学生：
- en: The first group is **existing students.** It's a good practice to be precise
    in analytics, so we will define them as students who started using our service
    before this launch. We will need to check them once at their next transaction,
    so we will have a substantial spike while processing them all. Later, the demand
    from this segment will be negligible (only rare reactivations).
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第一组是**现有学生**。在分析中精准是一个好习惯，因此我们将把他们定义为在本次上线之前已开始使用我们服务的学生。我们需要在他们下次交易时进行一次检查，因此在处理他们时会出现一个显著的需求激增。之后，这一群体的需求将变得微不足道（只有偶尔的重新激活）。
- en: '**New students** will hopefully continue joining our courses. So, we should
    expect consistent demand from this group.'
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**新学生**希望能够继续加入我们的课程。因此，我们应该预期这一群体的需求会保持稳定。'
- en: Now, it's time to think about how we can estimate the demand for these two groups
    of customers.
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，是时候思考我们如何估算这两组客户的需求了。
- en: The situation is pretty straightforward for **new students** — we need to predict
    the number of new customers weekly and use it to estimate demand. So, it's a classic
    task of time series forecasting.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 对于**新学生**的情况就比较直接——我们需要预测每周的新客户数量，并用它来估算需求。因此，这就是经典的时间序列预测任务。
- en: The task of predicting demand from **existing customers** might be more challenging.
    The direct approach would be to build a model to predict the week when students
    will return to the service next time and use it for estimations. It's a possible
    solution, but it sounds a bit overcomplicated to me.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 预测**现有客户**需求的任务可能会更具挑战性。直接的方法是构建一个模型，预测学生下次回归服务的周数，并用它来进行估算。这是一个可行的解决方案，但对我来说有点过于复杂。
- en: I would prefer the other approach. I would simulate the situation when we launched
    this test some time ago and use the previous data. In that case, we will have
    all the data after "this simulated launch" and will be able to calculate all the
    metrics. So, it's actually a basic idea of scenario simulations.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 我更倾向于采用另一种方法。我会模拟我们在一段时间前启动这个测试的情景，并使用之前的数据。这样，我们将获得“此模拟启动”之后的所有数据，并能够计算出所有的指标。所以，这实际上是场景模拟的基本思路。
- en: Cool, we have a plan. Let's move on to execution.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 很好，我们有了计划。让我们继续执行。
- en: Modelling demand from new customers
  id: totrans-33
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 建模新客户需求
- en: Before jumping to analysis, let's examine the data we have. We keep a record
    of the lessons' completion events. We know each event's user identifier, date,
    module, and lesson number. We will use weekly data to avoid seasonality and capture
    meaningful trends.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 在进行分析之前，让我们先检查一下我们拥有的数据。我们记录了课程完成事件的记录。我们知道每个事件的用户标识符、日期、模块和课程编号。我们将使用每周数据，以避免季节性波动，并捕捉有意义的趋势。
- en: '![](../Images/43843a3d3569e67eaf6d34c85251d222.png)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/43843a3d3569e67eaf6d34c85251d222.png)'
- en: Let me share some context about the educational process. Students primarily
    come to our service to learn English from scratch and pass six modules (from pre-A1
    to C1). Each module consists of 100 lessons.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 让我分享一些关于教育过程的背景信息。学生们主要来到我们的服务平台，从零开始学习英语，并通过六个模块（从预A1到C1）。每个模块包含100节课程。
- en: The data was generated explicitly for this use case, so we are working with
    a synthetic data set.
  id: totrans-37
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 这些数据是专门为这个用例生成的，因此我们正在使用一个合成数据集。
- en: First, we need to calculate the metric we want to predict. We will offer students
    the opportunity to pass the initial evaluation test after completing the first
    demo lesson. So, we can easily calculate the number of customers who passed the
    first lesson or aggregate users by their first date.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们需要计算出我们想要预测的指标。我们将为学生提供在完成第一节演示课后参加初步评估测试的机会。所以，我们可以轻松地计算出通过第一节课的客户数，或者按他们的首次日期来汇总用户数据。
- en: '[PRE0]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: We can look at the data and see an overall growing trend with some seasonal
    effects (i.e. fewer customers joining during the summer or Christmas time).
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以查看数据，发现整体呈增长趋势，并伴随有一些季节性影响（例如，夏季或圣诞节期间客户的加入人数较少）。
- en: '![](../Images/4f1587dc8cb87734b463b1df1d8ff7a7.png)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/4f1587dc8cb87734b463b1df1d8ff7a7.png)'
- en: For forecasting, we will use [Prophet](https://facebook.github.io/prophet/)
    — an open-source library from Meta. It works pretty well with business data since
    it can predict non-linear trends and automatically take into account seasonal
    effects. You can easily install it from PyPI.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 在预测中，我们将使用[Prophet](https://facebook.github.io/prophet/)——Meta的一个开源库。它在处理商业数据时效果非常好，因为它可以预测非线性趋势，并自动考虑季节性影响。你可以很容易地从PyPI安装它。
- en: '[PRE1]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Prophet library expects a data frame with two columns: `ds` with timestamp
    and `y` with a metric we want to predict. Also, `ds` must be a datetime column.
    So, we need to transform our data to the expected format.'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: Prophet库期望的数据框架包含两列：`ds`表示时间戳，`y`表示我们想要预测的指标。此外，`ds`必须是日期时间列。因此，我们需要将数据转换为所需的格式。
- en: '[PRE2]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Now, we are ready to make predictions. As usual in ML, we need to initialise
    and fit a model.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们准备好进行预测了。像往常一样，在机器学习中，我们需要初始化并拟合一个模型。
- en: '[PRE3]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: The next step is prediction. First, we need to create a future data frame specifying
    the number of periods and their frequency (in our case, weekly). Then, we need
    to call the `predict` function.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是预测。首先，我们需要创建一个未来的数据框，指定预测的周期数和它们的频率（在我们的例子中是每周）。然后，我们需要调用`predict`函数。
- en: '[PRE4]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: As a result, we get the forecast (`yhat`) and confidence interval (`yhat_lower`
    and `yhat_upper`).
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 结果，我们得到了预测值（`yhat`）和置信区间（`yhat_lower` 和 `yhat_upper`）。
- en: '![](../Images/038a1e1d4a20c36f00e76a9ffacecb3e.png)'
  id: totrans-51
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/038a1e1d4a20c36f00e76a9ffacecb3e.png)'
- en: It's difficult to understand the result without charts. Let's use Prophet functions
    to visualise the output better.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 如果没有图表，结果很难理解。让我们使用Prophet函数来更好地可视化输出结果。
- en: '[PRE5]'
  id: totrans-53
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: The forecast chart shows you the forecast with a confidence interval.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 预测图表向你展示了带有置信区间的预测结果。
- en: '![](../Images/023fd7c58cfd4628e700d281faf1819d.png)'
  id: totrans-55
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/023fd7c58cfd4628e700d281faf1819d.png)'
- en: The components view lets you understand the split between trend and seasonal
    effects. For example, the second chart displays a seasonal drop-off during summer
    and an increase at the beginning of September (when people might be more motivated
    to start learning something new).
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 组件视图让你了解趋势和季节性效应之间的分布。例如，第二张图显示了夏季期间的季节性下降，以及九月初的增长（当人们可能更有动力开始学习新事物时）。
- en: '![](../Images/c4c514ca943e9bf65483ddfa2e0f0fd4.png)'
  id: totrans-57
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c4c514ca943e9bf65483ddfa2e0f0fd4.png)'
- en: We can put all this forecasting logic into one function. It will be helpful
    for us later.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以将所有这些预测逻辑放入一个函数中。这样以后会对我们很有帮助。
- en: '[PRE6]'
  id: totrans-59
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: I prefer to share with my stakeholders a more styled version of visualisation
    (especially for public presentations), so I've added it to the function as well.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 我更倾向于与我的利益相关者分享一个更具样式的可视化版本（尤其是对于公开演讲），所以我也将其添加到了函数中。
- en: '![](../Images/06eaa510b37b23b26f271744de6aaaf1.png)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/06eaa510b37b23b26f271744de6aaaf1.png)'
- en: In this example, we've used the default Prophet model and got quite a plausible
    forecast. However, in some cases, you might want to tweak parameters, so I advise
    you to read [the Prophet docs](https://facebook.github.io/prophet/docs/quick_start.html#python-api)
    to learn more about the possible levers.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，我们使用了默认的Prophet模型，并得到了一个相当可信的预测结果。然而，在某些情况下，你可能需要调整参数，因此我建议你阅读[Prophet文档](https://facebook.github.io/prophet/docs/quick_start.html#python-api)以了解更多可能的调整选项。
- en: For example, in our case, we believe that our audience will continue growing
    at the same rate. However, this might not be the case, and you might expect it
    to have a cap of around 100 users. Let's update our prediction for saturating
    growth.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，在我们的案例中，我们相信我们的受众将以相同的速度继续增长。然而，这可能并非如此，你可能预计它会在约100个用户时达到上限。让我们更新一下对饱和增长的预测。
- en: '[PRE7]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: We can see that the forecast has changed significantly, and the growth stops
    at ~100 new clients per week.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到，预测结果发生了显著变化，并且增长停滞在每周约100个新客户。
- en: '![](../Images/c50618f0e4851c98c777991e5dad7c1c.png)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c50618f0e4851c98c777991e5dad7c1c.png)'
- en: It's also interesting to look at the components' chart in this case. We can
    see that the seasonal effects stayed the same, while the trend has changed to
    logistic (as we specified).
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，查看组件图表也很有趣。我们可以看到季节性效应保持不变，而趋势已变为逻辑增长（正如我们指定的那样）。
- en: '![](../Images/cd9448cab3099823c8aafa704be0f14f.png)'
  id: totrans-68
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/cd9448cab3099823c8aafa704be0f14f.png)'
- en: We've learned a bit about the ability to tweak forecasts. However, for future
    calculations, we will use a basic model. Our business is still relatively small,
    and most likely, we haven’t reached saturation yet.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经了解了一些关于调整预测的能力。然而，针对未来的计算，我们将使用一个基本模型。我们的业务仍然相对较小，且最有可能尚未达到饱和状态。
- en: We've got all the needed estimations for new customers and are ready to move
    on to the existing ones.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经得到了所有新客户所需的估算，并准备开始考虑现有客户的需求。
- en: Modelling demand from existing customers
  id: totrans-71
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 建模现有客户的需求
- en: The first version
  id: totrans-72
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 第一个版本
- en: The key point in our approach is to simulate the situation when we launched
    this test some time ago and calculate the demand using this data. Our solution
    is based on the idea that we can use the past data instead of predicting the future.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 我们方法的关键点在于模拟我们在某段时间前进行该测试的情况，并使用这些数据计算需求。我们的解决方案基于一个理念，即我们可以利用过去的数据，而不是预测未来。
- en: Since there's significant yearly seasonality, I will use data for -1 year to
    take into account these effects automatically. We want to launch this project
    at the beginning of April. So, I will use past data from the week of 2nd April
    2023.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 由于存在显著的年度季节性，我将使用过去一年的数据来自动考虑这些效应。我们希望在4月初启动这个项目。因此，我将使用2023年4月2日那一周的数据。
- en: First, we need to filter the data related to existing customers at the beginning
    of April 2023\. We've already forecasted demand from new users, so we don't need
    to consider them in this estimation.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们需要筛选出与现有客户相关的数据，时间是2023年4月初。我们已经预测了新用户的需求，因此在此次估算中不需要考虑新用户。
- en: '[PRE8]'
  id: totrans-76
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Then, we need to model the demand from these users. We will offer our existing
    students the chance to pass the test the next time they use our product. So, we
    need to define when each customer returned to our service after the launch and
    aggregate the number of customers by week. There's no rocket science at all.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我们需要对这些用户的需求进行建模。我们将为现有学生提供下次使用我们产品时参加测试的机会。所以，我们需要定义每个客户在推出后何时返回我们的服务，并按周汇总客户数量。这一点其实并不复杂。
- en: '[PRE9]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: We got the first estimations. If we had launched this test in April 2023, we
    would have gotten around 1.3K tests in the first week, 0.3K for the second week,
    80 cases in the third week, and even less afterwards.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 我们得到了第一次估算。如果我们在2023年4月推出这个测试，第一周大约会有1.3K个测试，第二周0.3K，第三周80个案例，之后会更少。
- en: '![](../Images/fbefdfd378810634f2b65d8598dd309d.png)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/fbefdfd378810634f2b65d8598dd309d.png)'
- en: We assumed that 100% of existing customers would finish the test, and we would
    need to check it. In real-life tasks, it's worth taking conversion into account
    and adjusting the numbers. Here, we will continue using 100% conversion for simplicity.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 我们假设100%的现有客户都会完成测试，我们需要对其进行检查。在实际任务中，值得考虑转化率，并相应调整数字。为了简便起见，这里我们将继续使用100%的转化率。
- en: So, we've done our first modelling. It wasn't challenging at all. But is this
    estimation good enough?
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，我们完成了第一次建模。其实一点也不难。但这个估算足够好吗？
- en: Taking into account long-term trends
  id: totrans-83
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 考虑长期趋势
- en: We are using data from the previous year. However, everything changes. Let's
    look at the number of active customers over time.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 我们正在使用去年的数据。然而，一切都在变化。让我们来看看活跃客户的数量变化情况。
- en: '[PRE10]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '![](../Images/aa96d886a01bb6c2677baf121cc54707.png)'
  id: totrans-86
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/aa96d886a01bb6c2677baf121cc54707.png)'
- en: We can see that it's growing steadily. I would expect it to continue growing.
    So, it's worth adjusting our forecast due to this YoY (*Year-over-Year*) growth.
    We can re-use our prediction function and calculate YoY using forecasted values
    to make it more accurate.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以看到它在稳步增长。我预计它会继续增长。所以，考虑到这一点，我们应该调整我们的预测以反映这个同比增长（*Year-over-Year*）。我们可以重新使用我们的预测函数，并利用预测值计算同比增长，以使其更加准确。
- en: '[PRE11]'
  id: totrans-88
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '![](../Images/ee2f35233a05c10748da4fa37c376da4.png)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/ee2f35233a05c10748da4fa37c376da4.png)'
- en: Let's calculate YoY growth based on our forecast and adjust the model's predictions.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们根据我们的预测计算同比增长，并调整模型的预测值。
- en: '[PRE12]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: We've finished the estimations for the existing students as well. So, we are
    ready to merge both parts and get the result.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 我们也完成了现有学生的估算。所以，我们准备将两部分合并，得到最终结果。
- en: Putting everything together
  id: totrans-93
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 将一切汇总
- en: First results
  id: totrans-94
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 初步结果
- en: Now, we can combine all our previous estimations and see the final chart. For
    that, we need to convert data to the common format and add segments so that we
    can distinguish demand between new and existing students.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以将所有之前的估算结合起来，看看最终的图表。为此，我们需要将数据转换为通用格式，并添加不同的分段，以便我们能够区分新客户和现有客户的需求。
- en: '[PRE13]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '![](../Images/2ed261ca8aa5d7ae80ade41198fecebc.png)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/2ed261ca8aa5d7ae80ade41198fecebc.png)'
- en: We should expect around 2.5K tests for the first week after launch, mostly from
    existing customers. Then, within four weeks, we will review tests from existing
    users and will have only ~100–130 cases per week from new joiners.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 我们应该预期在推出后的第一周大约会有2.5K的测试需求，主要来自现有客户。然后，在接下来的四周内，我们将审查现有用户的测试，新增用户每周大约只有100到130个案例。
- en: That's wonderful. Now, we can share our estimations with colleagues so they
    can also plan their work.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 太好了。现在，我们可以将我们的估算与同事分享，这样他们也可以规划自己的工作。
- en: What if we have demand constraints?
  id: totrans-100
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如果我们遇到需求限制怎么办？
- en: In real life, you will often face the problem of capacity constraints when it's
    impossible to launch a new feature to 100% of customers. So, it’s time to learn
    how to deal with such situations.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 在现实生活中，当无法将新功能推广到100%的客户时，你经常会面临容量限制的问题。所以，是时候学习如何应对这种情况了。
- en: Suppose we've found out that our teachers can check only 1K tests each week.
    Then, we need to stagger our demand to avoid bad customer experience (when students
    need to wait for weeks to get their results).
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们发现我们的教师每周只能检查1000个测试。那我们就需要分散需求，避免糟糕的客户体验（当学生需要等待好几周才能得到结果时）。
- en: Luckily, we can do it easily by rolling out tests to our existing customers
    in batches (or cohorts). We can switch the functionality on for all new joiners
    and X% of existing customers in the first week. Then, we can add another Y% of
    existing customers in the second week, etc. Eventually, we will evaluate all existing
    students and have ongoing demand only from new users.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 幸运的是，我们可以通过将测试分批推出给现有客户来轻松实现。我们可以在第一周为所有新加入的用户和X%的现有客户开启此功能。然后，我们可以在第二周增加Y%的现有客户，等等。最终，我们将评估所有现有学生，并仅从新用户中产生持续的需求。
- en: Let's come up with a rollout plan without exceeding the 1K capacity threshold.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们制定一个推出计划，确保不会超过1000个容量的阈值。
- en: Since we definitely want to launch it for all new students, let's start with
    them and add them to our plan. We will store all demand estimations by segments
    in the `raw_demand_est_model_df` data frame and initialise them with our `new_model_df`
    estimations that we got before.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们肯定要为所有新学生推出，因此让我们从他们开始并将其加入计划中。我们将按分段存储所有的需求估算在`raw_demand_est_model_df`数据框中，并使用我们之前得到的`new_model_df`估算进行初始化。
- en: '[PRE14]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Now, we can aggregate this data and calculate the remaining capacity.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以汇总这些数据并计算剩余的容量。
- en: '[PRE15]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '![](../Images/259999a7d45437eadf0ac9b1dbabf9ce.png)'
  id: totrans-109
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/259999a7d45437eadf0ac9b1dbabf9ce.png)'
- en: Let's put this logic into a separate function since we will need it to evaluate
    our estimations after each iteration.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们将这个逻辑放到一个单独的函数中，因为我们将在每次迭代后需要它来评估我们的估算结果。
- en: '[PRE16]'
  id: totrans-111
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: I've also added a chart to the output of this function that will help us to
    assess our results effortlessly.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 我还在此函数的输出中添加了一个图表，帮助我们轻松评估结果。
- en: '![](../Images/67a0113dbc61d742f2dbf40c7e31ac44.png)'
  id: totrans-113
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/67a0113dbc61d742f2dbf40c7e31ac44.png)'
- en: Now, we can start planning the rollout for existing customers week by week.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以按周计划现有客户的推出进程。
- en: First, let's transform our current demand model for existing students. I would
    like it to be indexed by the sequence number of weeks and show the 100% demand
    estimation. Then, I can smoothly get estimations for each batch by multiplying
    demand by weight and calculating the dates based on the launch date and week number.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，让我们转变当前针对现有学生的需求模型。我希望它能够按周序列号进行索引，并显示100%的需求估算。然后，我可以通过将需求乘以权重，并根据启动日期和周数计算日期，顺利得到每批次的估算。
- en: '[PRE17]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '![](../Images/736f165ce31047c1a725014b012a9c2e.png)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/736f165ce31047c1a725014b012a9c2e.png)'
- en: So, for example, if we launch our evaluation test for 10% of random customers,
    then we expect to get 244 tests on the first week, 52 tests on the second week,
    14 on the third, etc.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，例如，如果我们为10%的随机客户推出评估测试，那么我们预计第一周会进行244个测试，第二周52个测试，第三周14个测试，等等。
- en: I will be using the same estimations for all batches. I assume that all batches
    of the same size will produce the exact number of tests over the following weeks.
    So, I don't take into account any seasonal effects related to the launch date
    for each batch.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 我将使用相同的估算来处理所有批次。我假设所有相同大小的批次在接下来的几周内将产生相同数量的测试。所以，我没有考虑与每个批次的启动日期相关的任何季节性影响。
- en: This assumption simplifies your process quite a bit. And it's pretty reasonable
    in our case because we will do a rollout only within 4–5 weeks, and there are
    no significant seasonal effects during this period. However, if you want to be
    more accurate (or have considerable seasonality), you can build demand estimations
    for each batch by repeating our previous process.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 这个假设大大简化了你的过程。在我们的案例中这是相当合理的，因为我们将在4到5周内完成推出，而且在这段时间内没有显著的季节性影响。然而，如果你想要更准确（或有显著季节性波动），你可以通过重复我们之前的过程来为每个批次建立需求估算。
- en: Let's start with the week of 31st March 2024\. As we saw before, we have a spare
    capacity for 888 tests. If we launch our test to 100% of existing customers, we
    will get ~2.4K tests to check in the first week. So, we are ready to roll out
    only to a portion of all customers. Let's calculate it.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从2024年3月31日那一周开始。如我们之前看到的，我们有888个测试的剩余容量。如果我们为100%的现有客户推出测试，第一周我们将需要检查大约2400个测试。因此，我们只准备向一部分客户推出。让我们来计算一下。
- en: '[PRE18]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: It's easier to operate with more round numbers, so let's round the number to
    a fraction of 5%. I've rounded the number down to have some buffer.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 使用更简洁的数字操作会更容易，所以让我们将数字四舍五入到5%的倍数。我已将数字向下舍入，以留出一些缓冲。
- en: '[PRE19]'
  id: totrans-124
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Since we will make several iterations, we need to track the percentage of existing
    customers for whom we’ve enabled the new feature. Also, it's worth checking whether
    we've already processed all the customers to avoid double-counting.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们将进行几次迭代，我们需要追踪已有客户中启用了新功能的百分比。此外，检查我们是否已经处理了所有客户以避免重复计数也是值得的。
- en: '[PRE20]'
  id: totrans-126
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: Also, saving our rollout plan in a separate variable will be helpful.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，将我们的推出计划保存在一个单独的变量中将会很有帮助。
- en: '[PRE21]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: Now, we need to estimate the expected demand from this batch. Launching tests
    for 35% of customers on 31st March will lead to some demand not only in the first
    week but also in the subsequent weeks. So, we need to calculate the total demand
    from this batch and add it to our plans.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们需要估算这一批次的预期需求。3月31日对35%的客户进行测试，将不仅会在第一周产生需求，还会在接下来的几周产生需求。因此，我们需要计算这一批次的总需求，并将其纳入我们的计划中。
- en: '[PRE22]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: Now, we can re-use the function `get_total_demand_mode`, which helps us analyse
    the current demand vs capacity balance.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以重用函数`get_total_demand_mode`，它帮助我们分析当前的需求与容量之间的平衡。
- en: '[PRE23]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: We are utilising most of our capacity for the first week. We still have some
    free resources, but it was our conscious decision to keep some buffer for sustainability.
    We can see that there’s almost no demand from this batch after 3 weeks.
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在第一周已经利用了大部分容量。我们仍然有一些空闲资源，但我们故意决定为可持续性留出一些缓冲。我们可以看到，在三周后，这一批次几乎没有需求。
- en: '![](../Images/69099cf101463ab326d82459ced45d43.png)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/69099cf101463ab326d82459ced45d43.png)'
- en: With that, we've finished the first iteration and can move on to the following
    week — 4th April 2024\. We can check an additional 706 cases during this week.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 到此为止，我们完成了第一轮迭代，可以进入下一个周期——2024年4月4日。我们可以在这一周再检查706个案例。
- en: '![](../Images/3daf0fc5aa2f9e3b3152e00a51861ff1.png)'
  id: totrans-136
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3daf0fc5aa2f9e3b3152e00a51861ff1.png)'
- en: We can repeat the whole process for this week and move to the next one. We can
    iterate to the point when we launch our project to 100% of existing customers
    (`enabled_user_share` equals to 1).
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以重复整个过程直到本周结束，然后继续进入下一个阶段。我们可以进行迭代，直到我们将项目推广到100%的现有客户（`enabled_user_share`等于1）。
- en: We can roll out our tests to all customers without breaching the 1K tests per
    week capacity constraint within just four weeks. In the end, we will have the
    following weekly forecast.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以在不违反每周1000次测试容量限制的情况下，在四周内将我们的测试推出到所有客户。最后，我们将得到如下的每周预测。
- en: '![](../Images/ba0dd724bd732b52409020fe5c6e2b95.png)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/ba0dd724bd732b52409020fe5c6e2b95.png)'
- en: We can also look at the rollout plan we've logged throughout our simulations.
    So, we need to launch the test for randomly selected 35% of customers on the week
    of 31st March, then for the next 20% of customers next week, followed by 25% and
    20% of existing users for the remaining two weeks. After that, we will roll out
    our project to all existing students.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以查看我们在模拟过程中记录的推出计划。所以，我们需要在3月31日那一周对随机选择的35%的客户进行测试，接着在下周对下一个20%的客户进行测试，再对接下来的两周分别对25%和20%的现有用户进行测试。之后，我们将把我们的项目推广到所有现有学生。
- en: '[PRE24]'
  id: totrans-141
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: So, congratulations. We now have a plan for how to roll out our feature sustainably.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，恭喜你。我们现在有了一个可持续推出新功能的计划。
- en: Tracking students' performance over time
  id: totrans-143
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 跟踪学生的表现变化
- en: We've already done a lot to estimate demand. We've leveraged the idea of simulation
    by imitating the launch of our project a year ago, scaling it and assessing the
    consequences. So, it's definitely a simulation example.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经做了很多工作来估算需求。我们通过模拟一年前项目的推出过程，进行扩展并评估后果，从而运用了模拟的思路。所以，这绝对是一个模拟的例子。
- en: However, we mostly used the basic tools you use daily — some Pandas data wrangling
    and arithmetic operations. In the last part of the article, I would like to show
    you a bit more complex case where we will need to simulate the process for each
    customer independently.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，我们主要使用的是你每天都会用到的基本工具——一些Pandas数据整理和算术运算。在文章的最后部分，我想向你展示一个稍微复杂的案例，我们将需要为每个客户独立模拟该过程。
- en: Product requirements often change over time, and it happened with our project.
    You, with a team, decided that it would be even better if you could allow your
    students to track progress over time (not only once at the very beginning). So,
    we would like to offer students to go through a performance test after each module
    (if more than one month has passed since the previous test) or if the student
    returned to the service after three months of absence.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 产品需求随着时间的推移通常会发生变化，我们的项目也经历了这种情况。你和团队决定，如果能够让学生在学习过程中跟踪进展（不仅仅是在一开始），那会更好。因此，我们希望能够让学生在每个模块结束后进行一次表现测试（如果距离上次测试已经超过一个月），或者如果学生在三个月的缺席后重新返回服务。
- en: Now, the criteria for test assignments are pretty tricky. However, we can still
    use the same approach by looking at the data for the previous year. However, this
    time, we will need to look at each customer's behaviour and define at what point
    they would get a test.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，测试分配的标准相当复杂。然而，我们仍然可以使用相同的方法，通过查看前一年的数据来进行判断。但是，这一次，我们需要查看每个客户的行为，并确定他们在什么情况下会得到一个测试。
- en: We will take into account both new and existing customers since we want to estimate
    the effects of follow-up tests on all of them. We don't need any data before the
    launch because the first test will be assigned at the next active transaction,
    and all the history won't matter. So we can filter it out.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将同时考虑新客户和现有客户，因为我们希望评估跟踪测试对所有客户的影响。我们不需要发布前的数据，因为第一个测试将在下一次有效交易时分配，之前的历史数据不再重要。因此，我们可以将其过滤掉。
- en: '[PRE25]'
  id: totrans-149
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: Let's also define a function that calculates the number of days between two
    date strings. It will be helpful for us in the implementation.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们还定义一个函数，用于计算两个日期字符串之间的天数。这对我们在实现时会非常有帮助。
- en: '[PRE26]'
  id: totrans-151
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: Let's start with one user and discuss the logic with all the details. First,
    we will filter events related to this user and convert them into the list of dictionaries.
    It will be way easier for us to work with such data.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从一个用户开始，详细讨论一下逻辑。首先，我们将筛选与该用户相关的事件，并将其转换为字典列表。这样处理数据对我们来说会更加方便。
- en: '[PRE27]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: To simulate our product logic, we will be processing user events one by one
    and, at each point, checking whether the customer is eligible for the evaluation.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 为了模拟我们的产品逻辑，我们将逐一处理用户事件，并在每个阶段检查客户是否符合评估的条件。
- en: 'Let''s discuss what variables we need to maintain to be able to tell whether
    the customer is eligible for the test or not. For that, let''s recap all the possible
    cases when a customer might get a test:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们讨论一下我们需要维护哪些变量，以便能够判断客户是否符合测试条件。为此，让我们回顾一下客户可能会进行测试的所有情况：
- en: If there were no previous tests -> we need to know whether they passed a test
    before.
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果之前没有测试记录 -> 我们需要知道他们是否曾经通过过测试。
- en: If the customer finished the module and more than one month has passed since
    the previous test **->** we need to know the last test date.
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果客户完成了模块并且距离上次测试已经超过一个月 **->** 我们需要知道最后一次测试的日期。
- en: If the customer returns after three months **->** we need to store the date
    of the last lesson.
  id: totrans-158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果客户在三个月后返回 **->** 我们需要存储最后一课的日期。
- en: 'To be able to check all these criteria, we can use only two variables: the
    last test date (`None` if there was no test before) and the previous lesson date.
    Also, we will need to store all the generated tests to calculate them later. Let''s
    initialise all the variables.'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 为了能够检查所有这些标准，我们只需要使用两个变量：最后的测试日期（如果之前没有测试，则为`None`）和上次课程日期。此外，我们还需要存储所有生成的测试，以便稍后进行计算。让我们初始化所有变量。
- en: '[PRE28]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: Now, we need to iterate by event and check the criteria.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们需要按事件进行迭代并检查标准。
- en: '[PRE29]'
  id: totrans-162
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: Let's go through all our criteria, starting from the initial test. In this case,
    `last_test_date` will be equal to `None`. It's important for us to update the
    `last_test_date` variable after "assigning" the test.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们从最初的测试开始，逐一检查我们的标准。在这种情况下，`last_test_date`将等于`None`。在"分配"测试之后，更新`last_test_date`变量是非常重要的。
- en: '[PRE30]'
  id: totrans-164
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: In the case of the finished module, we need to check that it's the last lesson
    in the module and that more than 30 days have passed.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 在已完成的模块的情况下，我们需要检查它是否是该模块的最后一课，并且是否已经过去了30天以上。
- en: '[PRE31]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: The last case is that the customer hasn't used our service for three months.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 最后一种情况是客户已经三个月没有使用我们的服务。
- en: '[PRE32]'
  id: totrans-168
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: Besides, we need to update the `last_lesson_date` at each iteration to keep
    it accurate.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，我们需要在每次迭代时更新`last_lesson_date`以保持准确性。
- en: We've discussed all the building blocks and are ready to combine them and do
    simulations for all our customers.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经讨论了所有的构建块，现在可以将它们结合起来，进行所有客户的模拟。
- en: '[PRE33]'
  id: totrans-171
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: Now, we can aggregate this data. Since we are again using the previous year's
    data, I will adjust the number by ~80% YoY, as we've estimated before.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我们可以汇总这些数据。由于我们再次使用的是去年的数据，我将按大约80%的年增长率调整这个数字，正如我们之前估算的那样。
- en: '[PRE34]'
  id: totrans-173
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: We got quite a similar estimation for the initial test. In this case, the "initial
    test" segment equals the sum of new and existing demand in our previous estimations.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 我们为初始测试得到了相似的估算。在这个案例中，“初始测试”部分等于我们之前估算中新增需求和现有需求的总和。
- en: '![](../Images/bc6a32d76bbf1b88a6a9de80fac98f1d.png)'
  id: totrans-175
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/bc6a32d76bbf1b88a6a9de80fac98f1d.png)'
- en: So, looking at other segments is way more interesting since they will be incremental
    to our previous calculations. We can see around 30–60 cases per week from customers
    who finished modules starting in May.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，观察其他部分要更有趣，因为它们会是我们之前计算的增量。我们可以看到每周大约有30到60个案例来自于5月开始的模块完成的客户。
- en: There will be almost no cases of reactivation. In our simulation, we got 4 cases
    per year in total.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 几乎不会出现重新激活的情况。在我们的模拟中，我们每年总共得到了4个案例。
- en: '![](../Images/9c2a0f348fed3e36d1efb42886f7b790.png)'
  id: totrans-178
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/9c2a0f348fed3e36d1efb42886f7b790.png)'
- en: Congratulations! Now the case is solved, and we’ve found a nice approach that
    allows us to make precise estimations without advanced math and with only simulation.
    You can use similar
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 恭喜！现在问题已经解决，我们找到了一个很好的方法，可以让我们在没有高级数学的情况下，仅通过模拟就能做出精确的估算。你可以使用类似的方法。
- en: You can find the full code for this example on [GitHub](https://github.com/miptgirl/miptgirl_medium/blob/main/simulations/student_activities_model.ipynb).
  id: totrans-180
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 你可以在[GitHub](https://github.com/miptgirl/miptgirl_medium/blob/main/simulations/student_activities_model.ipynb)上找到这个示例的完整代码。
- en: Summary
  id: totrans-181
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: 'Let me quickly recap what we''ve discussed today:'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 让我快速回顾一下今天讨论的内容：
- en: The main idea of computer simulation is imitation based on your data.
  id: totrans-183
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 计算机模拟的主要思想是基于你的数据进行模仿。
- en: In many cases, you can reframe the problem from predicting the future to using
    the data you already have and simulating the process you're interested in. So,
    this approach is quite powerful.
  id: totrans-184
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在许多情况下，你可以将问题的框架从预测未来转变为使用你已经拥有的数据，并模拟你感兴趣的过程。因此，这种方法非常强大。
- en: In this article, we went through an end-to-end example of scenario estimations.
    We've seen how to structure complex problems and split them into a bunch of more
    defined ones. We've also learned to deal with constraints and plan a gradual rollout.
  id: totrans-185
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在本文中，我们通过一个端到端的示例介绍了情景估算。我们展示了如何构建复杂问题，并将其拆分成更多定义明确的问题。我们还学会了如何处理约束并计划逐步推出。
- en: Thank you a lot for reading this article. If you have any follow-up questions
    or comments, please leave them in the comments section.
  id: totrans-186
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 非常感谢你阅读本文。如果你有任何后续问题或评论，请在评论区留言。
- en: Reference
  id: totrans-187
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参考文献
- en: '*All the images are produced by the author unless otherwise stated.*'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: '*除非另有说明，所有图像均由作者制作。*'
