<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Use R to build Clinical Flowchart with shinyCyJS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Use R to build Clinical Flowchart with shinyCyJS</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/clinical-flowchart-shinycyjs-e-2f5489154794?source=collection_archive---------10-----------------------#2024-09-03">https://towardsdatascience.com/clinical-flowchart-shinycyjs-e-2f5489154794?source=collection_archive---------10-----------------------#2024-09-03</a></blockquote><div><div class="em ff fg fh fi fj"/><div class="fk fl fm fn fo"><div class="ab cb"><div class="ci bh ew ex ey ez"><div/><div><h2 id="b4a3" class="pw-subtitle-paragraph go fq fr bf b gp gq gr gs gt gu gv gw gx gy gz ha hb hc hd cq dx">Customizable R package for Graph / Network visualization</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="he hf hg hh hi ab"><div><div class="ab hj"><div><div class="bm" aria-hidden="false"><a href="https://jhk0530.medium.com/?source=post_page---byline--2f5489154794--------------------------------" rel="noopener follow"><div class="l hk hl by hm hn"><div class="l ed"><img alt="Jinhwan Kim" class="l ep by dd de cx" src="../Images/b88f1327cd0800b21ccd235262fefeec.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*vU_fccC8YOReY6tGTxackA.jpeg"/><div class="ho by l dd de em n hp eo"/></div></div></a></div></div><div class="hq ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--2f5489154794--------------------------------" rel="noopener follow"><div class="l hr hs by hm ht"><div class="l ed"><img alt="Towards Data Science" class="l ep by br hu cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="ho by l br hu em n hp eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hv ab q"><div class="ab q hw"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hx hy bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hz" data-testid="authorName" href="https://jhk0530.medium.com/?source=post_page---byline--2f5489154794--------------------------------" rel="noopener follow">Jinhwan Kim</a></p></div></div></div><div class="ia ib l"><div class="ab ic"><div class="ab"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewbox="0 0 16 16"><path fill="#437AFF" d="M15.163 8c0 .65-.459 1.144-.863 1.575-.232.244-.471.5-.563.719s-.086.543-.092.875c-.006.606-.018 1.3-.49 1.781-.47.481-1.15.494-1.744.5-.324.006-.655.013-.857.094s-.465.337-.704.575c-.422.412-.906.881-1.542.881-.637 0-1.12-.469-1.543-.881-.239-.238-.49-.482-.704-.575-.214-.094-.532-.088-.857-.094-.593-.006-1.273-.019-1.744-.5s-.484-1.175-.49-1.781c-.006-.332-.012-.669-.092-.875-.08-.207-.33-.475-.563-.719-.404-.431-.863-.925-.863-1.575s.46-1.144.863-1.575c.233-.244.472-.5.563-.719.092-.219.086-.544.092-.875.006-.606.019-1.3.49-1.781s1.15-.494 1.744-.5c.325-.006.655-.012.857-.094.202-.081.465-.337.704-.575C7.188 1.47 7.671 1 8.308 1s1.12.469 1.542.881c.239.238.49.481.704.575s.533.088.857.094c.594.006 1.273.019 1.745.5.47.481.483 1.175.49 1.781.005.331.011.669.091.875s.33.475.563.719c.404.431.863.925.863 1.575"/><path fill="#fff" d="M7.328 10.5c.195 0 .381.08.519.22.137.141.215.331.216.53 0 .066.026.13.072.177a.24.24 0 0 0 .346 0 .25.25 0 0 0 .071-.177c.001-.199.079-.389.216-.53a.73.73 0 0 1 .519-.22h1.959c.13 0 .254-.053.346-.146a.5.5 0 0 0 .143-.354V6a.5.5 0 0 0-.143-.354.49.49 0 0 0-.346-.146h-1.47c-.324 0-.635.132-.865.366-.23.235-.359.552-.359.884v2.5c0 .066-.025.13-.071.177a.24.24 0 0 1-.346 0 .25.25 0 0 1-.072-.177v-2.5c0-.332-.13-.65-.359-.884A1.21 1.21 0 0 0 6.84 5.5h-1.47a.49.49 0 0 0-.346.146A.5.5 0 0 0 4.88 6v4c0 .133.051.26.143.354a.49.49 0 0 0 .347.146z"/></svg></div></div></div><span class="id ie" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hx hy dx"><button class="if ig ah ai aj ak al am an ao ap aq ar ih ii ij" disabled="">Follow</button></p></div></div></span></div></div><div class="l ik"><span class="bf b bg z dx"><div class="ab cn il im in"><div class="io ip ab"><div class="bf b bg z dx ab iq"><span class="ir l ik">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hz ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--2f5489154794--------------------------------" rel="noopener follow"><p class="bf b bg z is it iu iv iw ix iy iz bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="id ie" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">6 min read</span><div class="ja jb l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Sep 3, 2024</span></div></span></div></span></div></div></div><div class="ab cp jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr"><div class="h k w ea eb q"><div class="kh l"><div class="ab q ki kj"><div class="pw-multi-vote-icon ed ir kk kl km"><div class=""><div class="kn ko kp kq kr ks kt am ku kv kw km"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kx ky kz la lb lc ld"><p class="bf b dy z dx"><span class="ko">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kn le lf ab q ee lg lh" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="li"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg></button></div></div></div><div class="ab q js jt ju jv jw jx jy jz ka kb kc kd ke kf kg"><div class="lj k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lk an ao ap ih ll lm ln" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep lo cn"><div class="l ae"><div class="ab cb"><div class="lp lq lr ls lt lu ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lk an ao ap ih lv lw lh lx ly lz ma mb s mc md me mf mg mh mi u mj mk ml"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lk an ao ap ih lv lw lh lx ly lz ma mb s mc md me mf mg mh mi u mj mk ml"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lk an ao ap ih lv lw lh lx ly lz ma mb s mc md me mf mg mh mi u mj mk ml"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><h1 id="a964" class="mm mn fr bf mo mp mq gr mr ms mt gu mu mv mw mx my mz na nb nc nd ne nf ng nh bk">Clinical Flowchart</h1><p id="ed5a" class="pw-post-body-paragraph ni nj fr nk b gp nl nm nn gs no np nq nr ns nt nu nv nw nx ny nz oa ob oc od fk bk">A Clinical (Trial) Flowchart is a visual representation of each step and procedure in a clinical trial or treatment process.</p><p id="3dda" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">It starts with patients, lists which therapeutic methods are used, which patients are excluded from the trial and for what reason, how the groups are assigned, and so on, and looks like the example below.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot ed ou bh ov"><div class="oj ok ol"><img src="../Images/746cddecc4f78642a9a5a0c89bdd7838.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uQUEWbSmtrV16eYwlUnh2g.png"/></div></div><figcaption class="ox oy oz oj ok pa pb bf b bg z dx"><a class="af pc" href="https://www.jmir.org/2013/6/e113/" rel="noopener ugc nofollow" target="_blank">Cesa, Gian Luca, et al</a>. JMIR Publications 15(6) 2013</figcaption></figure><p id="f1ac" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">This illustration implies the following</p><ol class=""><li id="80d3" class="ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od pd pe pf bk">Initially started with 124 patients</li><li id="49e5" class="ni nj fr nk b gp pg nm nn gs ph np nq nr pi nt nu nv pj nx ny nz pk ob oc od pd pe pf bk">Exclude 34 patients due to ineligibility or declining to participate</li><li id="3597" class="ni nj fr nk b gp pg nm nn gs ph np nq nr pi nt nu nv pj nx ny nz pk ob oc od pd pe pf bk">The remaining 90 patients are randomly assigned to a group (Extended CBT, CBT, IP) to compare treatments.</li><li id="75ea" class="ni nj fr nk b gp pg nm nn gs ph np nq nr pi nt nu nv pj nx ny nz pk ob oc od pd pe pf bk">In each group, 4, 10, and 10 people drop out of the course (although ideally 30 people would be split), and the rest receive the assigned treatment.</li><li id="1e73" class="ni nj fr nk b gp pg nm nn gs ph np nq nr pi nt nu nv pj nx ny nz pk ob oc od pd pe pf bk">When the patients were followed up after 1 year, 9, 6, and 7 were unresponsive, respectively.</li></ol><p id="8688" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk"><em class="pl">The trial started with 124 patients and ended up with only 44 patients, which shows how difficult and expensive clinical trials can be.</em></p><p id="48f3" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">Anyway, there is no set way to draw this flowchart, and you can use any commercial software such as PowerPoint or Keynote, or web-based diagramming tools such as <strong class="nk fs">draw.io</strong> or lucidchart.</p></div></div></div><div class="ab cb pm pn po pp" role="separator"><span class="pq by bm pr ps pt"/><span class="pq by bm pr ps pt"/><span class="pq by bm pr ps"/></div><div class="fk fl fm fn fo"><div class="ab cb"><div class="ci bh ew ex ey ez"><h1 id="d9c0" class="mm mn fr bf mo mp pu gr mr ms pv gu mu mv pw mx my mz px nb nc nd py nf ng nh bk">Clinical Flowchart with R</h1><p id="cc73" class="pw-post-body-paragraph ni nj fr nk b gp nl nm nn gs no np nq nr ns nt nu nv nw nx ny nz oa ob oc od fk bk">I don’t know exactly why, but this time I needed to use R to plot the chart.</p><p id="e479" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">The advantages of using a programming approach like R include automation and reuse, integration with other functions (e.g., a program that plots from data source to chart), and a level of customization not available in commercial programs.</p><p id="7442" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">Anyway, here’s how I’ve tried to accomplish this.</p><ul class=""><li id="02da" class="ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od pz pe pf bk"><a class="af pc" href="https://github.com/bruigtp/flowchart/" rel="noopener ugc nofollow" target="_blank">flowchart</a></li></ul><p id="c4c3" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">Since the original purpose of the package was to draw participant flow diagrams, this is the closest I could get to what I was trying to achieve. I think it’s the best choice unless you have special circumstances.</p><ul class=""><li id="f800" class="ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od pz pe pf bk"><a class="af pc" href="https://github.com/rich-iannone/DiagrammeR/" rel="noopener ugc nofollow" target="_blank">DiagrammeR</a></li></ul><p id="1fa7" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">A library for graph and network visualization that leverages features from d3 and mermaid.</p><ul class=""><li id="c801" class="ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od pz pe pf bk">ggplot2 + <a class="af pc" href="https://github.com/thomasp85/ggforce" rel="noopener ugc nofollow" target="_blank">ggforce</a></li></ul><p id="5630" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">R’s best friend ggplot (recommended by GPT) and its companion packages.</p><ul class=""><li id="857f" class="ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od pz pe pf bk"><a class="af pc" href="https://github.com/datastorm-open/visNetwork" rel="noopener ugc nofollow" target="_blank">visNetwork</a></li></ul><p id="da34" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">R package for network visualization graphs based on vis.js.</p></div></div></div><div class="ab cb pm pn po pp" role="separator"><span class="pq by bm pr ps pt"/><span class="pq by bm pr ps pt"/><span class="pq by bm pr ps"/></div><div class="fk fl fm fn fo"><div class="ab cb"><div class="ci bh ew ex ey ez"><p id="dcad" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">However, as it turns out, all four methods failed.</p><p id="1cfa" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">This is because there was a special situation with the figure I was trying to draw.</p><p id="6349" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">The following figure shows the actual drawing, with only the numbers and groups replaced with 1000, 1,2,3… A, B.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot ed ou bh ov"><div class="oj ok qa"><img src="../Images/016e612bd2311ba14f738932cc947dd7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FrQEvJ64gn1HsxqmCxSI6Q.png"/></div></div><figcaption class="ox oy oz oj ok pa pb bf b bg z dx">Image by the author</figcaption></figure><p id="c625" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">There were two problematic parts: the <strong class="nk fs">Completed curative surgery</strong> part in the middle, where the two nodes from the previous step connect to one long node, and the difficulty of positioning the edge.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot ed ou bh ov"><div class="oj ok qb"><img src="../Images/04cdc6a40c8db3327eb8f80d2f87578d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RseTwwee9feq4UalkGjs_g.png"/></div></div><figcaption class="ox oy oz oj ok pa pb bf b bg z dx">Image by the author</figcaption></figure><p id="c0b4" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">I considered several ways to do this, and eventually decided to use an old friend, shinyCyJS, which I can customize to my purpose.</p><p id="e139" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk"><a class="af pc" href="https://github.com/jhk0530/shinyCyJS" rel="noopener ugc nofollow" target="_blank">shinyCyJS</a>is a R package to leverage the network/graph visualization capabilities of <a class="af pc" href="https://js.cytoscape.org/" rel="noopener ugc nofollow" target="_blank">cytoscape.js</a> in R. It was the first thing I wrote when I was looking for genomic network visualization when I graduated (at the time, there was only <a class="af pc" href="https://github.com/igraph/rigraph" rel="noopener ugc nofollow" target="_blank">igraph</a> and <a class="af pc" href="https://bioconductor.org/packages/release/bioc/html/RCyjs.html" rel="noopener ugc nofollow" target="_blank">RCyjs</a>) and didn’t find what I was looking for, which is how I ended up at my current job.</p></div></div></div><div class="ab cb pm pn po pp" role="separator"><span class="pq by bm pr ps pt"/><span class="pq by bm pr ps pt"/><span class="pq by bm pr ps"/></div><div class="fk fl fm fn fo"><div class="ab cb"><div class="ci bh ew ex ey ez"><h1 id="98c3" class="mm mn fr bf mo mp pu gr mr ms pv gu mu mv pw mx my mz px nb nc nd py nf ng nh bk">2 Custom feature with shinyCyJS</h1><ul class=""><li id="975b" class="ni nj fr nk b gp nl nm nn gs no np nq nr ns nt nu nv nw nx ny nz oa ob oc od pz pe pf bk">Positioning Edges</li></ul><p id="935e" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">In order to implement the positioning of the edges in the two custom features above, I initially tried to use taxi edges.</p><p id="b0a0" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">However, again, this only determines the edge based on the position of the node, and it is not possible to move the edge, so I switched to adding a microscopic node in the middle and traversing the edge to it, as shown below (since it is possible to specify the position of the “micro” node).</p></div></div><div class="or"><div class="ab cb"><div class="lp qc lq qd lr qe cf qf cg qg ci bh"><div class="om on oo op oq ab ki"><figure class="li or qh qi qj qk ql paragraph-image"><div role="button" tabindex="0" class="os ot ed ou bh ov"><img src="../Images/babadb179203976e4b121a8bbded6abd.png" data-original-src="https://miro.medium.com/v2/resize:fit:760/format:webp/1*litBenl_QAlXqmacerA-FA.png"/></div></figure><figure class="li or qm qi qj qk ql paragraph-image"><div role="button" tabindex="0" class="os ot ed ou bh ov"><img src="../Images/42277c7591b1d66da5c96ca2186d78cf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1242/format:webp/1*5PFz_irwvWKx7CQFJKo72g.png"/></div><figcaption class="ox oy oz oj ok pa pb bf b bg z dx qn ed qo qp">Image by the author</figcaption></figure></div></div></div></div><div class="ab cb"><div class="ci bh ew ex ey ez"><ul class=""><li id="d213" class="ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od pz pe pf bk">One Big Node</li></ul><p id="65ac" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">In cytoscape.js, by default, nodes are connected by edges that consider the <strong class="nk fs">shortest distance between the center and the center</strong>, and if they go through other points along the way, like the taxi mentioned above, the <strong class="nk fs">points are not specified and are calculated algorithmically</strong>.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot ed ou bh ov"><div class="oj ok qq"><img src="../Images/8644b2d457d7368f9e2cc7a332339188.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*of59_sU7qk00zOnA8e2Xlg.png"/></div></div><figcaption class="ox oy oz oj ok pa pb bf b bg z dx"><a class="af pc" href="https://js.cytoscape.org/demos/edge-arrows/" rel="noopener ugc nofollow" target="_blank">Edge arrow types</a> of Cytoscape.js</figcaption></figure><p id="d86a" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">The problem with allowing intermediate points to be specified is that when there are multiple edges between nodes, like in the bezier and haystack examples, it is annoying to have to specify intermediate points for all of them.</p><p id="248f" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">In the previous example, there are only three edges, so it’s not a big deal, but in the case of genomic networks, which I studied in graduate school, a single gene often interacts with dozens or hundreds of other genes, so it’s a big deal.</p><p id="cb1e" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">In the worst case scenario, the edges overlap and missing a few edges can cause the graph to produce completely different information.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot ed ou bh ov"><div class="oj ok qr"><img src="../Images/327075482d992cced5961cdce0e739ff.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eBEiqTi4Rekrht_YP0Ee1w.png"/></div></div><figcaption class="ox oy oz oj ok pa pb bf b bg z dx"><a class="af pc" href="https://www.embopress.org/doi/full/10.1038/msb.2011.99" rel="noopener ugc nofollow" target="_blank">Ideker, T., &amp; Krogan, N. J.</a> Molecular systems biology 8(1) 2012</figcaption></figure><p id="6d74" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">In other words, in the problem of connecting to one long node, the long node is only a graphical (<code class="cx qs qt qu qv b">width</code>) perspective for the user,</p><p id="51af" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">But from the computer’s point of view, it is irrational behavior to connect an edge to a node that doesn’t even exist, as shown in the image below, so there is no reason to consider this option in the first place.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot ed ou bh ov"><div class="oj ok qw"><img src="../Images/737e59fbe58d29be0a3eb076f2d7ae88.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3nb0mivERG4XLHrn8HVLlw.png"/></div></div><figcaption class="ox oy oz oj ok pa pb bf b bg z dx">Image by the author</figcaption></figure><p id="9550" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">To solve this problem, I created a micro node and modified it to connect to the appropriate part, just like the previous edge midpoint problem.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot ed ou bh ov"><div class="oj ok qx"><img src="../Images/f3684ec9694dbe5d039a51fe3feb55b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qrV86XIcP2x7x05opm2t4w.png"/></div></div><figcaption class="ox oy oz oj ok pa pb bf b bg z dx">Image by the author</figcaption></figure><p id="9893" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">Here is a partial view of the graph I ended up creating in R. (Again, groups and numbers are arbitrarily modified)</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot ed ou bh ov"><div class="oj ok qy"><img src="../Images/133e2f8d8cee75d916a2ee92b09063f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zdv_XE1PfU3HLpAjiPHJUQ.png"/></div></div><figcaption class="ox oy oz oj ok pa pb bf b bg z dx">Image by the author</figcaption></figure></div></div></div><div class="ab cb pm pn po pp" role="separator"><span class="pq by bm pr ps pt"/><span class="pq by bm pr ps pt"/><span class="pq by bm pr ps"/></div><div class="fk fl fm fn fo"><div class="ab cb"><div class="ci bh ew ex ey ez"><h1 id="9ce4" class="mm mn fr bf mo mp pu gr mr ms pv gu mu mv pw mx my mz px nb nc nd py nf ng nh bk">Another problem, download as PNG</h1><p id="c220" class="pw-post-body-paragraph ni nj fr nk b gp nl nm nn gs no np nq nr ns nt nu nv nw nx ny nz oa ob oc od fk bk">Technically, you can use the Export as PNG button in Rstudio viewer as shown below, and if that doesn’t work, you can take a screenshot, but cytoscape.js has a function to save the graph as png, so I used it.</p><figure class="om on oo op oq or oj ok paragraph-image"><div role="button" tabindex="0" class="os ot ed ou bh ov"><div class="oj ok qz"><img src="../Images/ed572ffe8e4f78fc955df54632aa1924.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zbfMATmwOt_pZt8C6EW8wg.png"/></div></div><figcaption class="ox oy oz oj ok pa pb bf b bg z dx">Image by the author</figcaption></figure><p id="512d" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk"><em class="pl">*I actually had a request to add a download to png feature to shinyCyJS a while back, and I replied “why not just take a screenshot?”.</em></p><p id="4b56" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">This required using an internet browser (chrome) (As cytoscape.js is Javascript) and that meant I had to go beyond R and implement it on the web using Shiny.</p><p id="7521" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">Of course, shinyCyJS is a package that was built with shiny integration in mind from the start, so it was no problem.</p><p id="173f" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">Below is the code you need to run in Chrome’s developer tools to download it</p><pre class="om on oo op oq ra qv rb bp rc bb bk"><span id="8d95" class="rd mn fr qv b bg re rf l rg rh">const pngBlob = await cy.png({<br/>  output: 'blob-promise',<br/>});<br/><br/>const fileName = 'myfile.png';<br/>const downloadLink = document.createElement('a');<br/>downloadLink.href = URL.createObjectURL(pngBlob);<br/>downloadLink.download = fileName;<br/>downloadLink.click();</span></pre></div></div></div><div class="ab cb pm pn po pp" role="separator"><span class="pq by bm pr ps pt"/><span class="pq by bm pr ps pt"/><span class="pq by bm pr ps"/></div><div class="fk fl fm fn fo"><div class="ab cb"><div class="ci bh ew ex ey ez"><p id="200e" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">shinyCyJS is an R package I wrote, and it literally does everything cytoscape does, plus custom features like this if needed, so if you need to do network/graph visualization in R, you can try it out or ask for what you need.</p><p id="627e" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">Of course, if you don’t need to use R, <strong class="nk fs">draw.io seems better.</strong></p><p id="fdca" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">Additionally, if you want to package other Javascript libraries for use with R, you can send me an email.</p><p id="2aaf" class="pw-post-body-paragraph ni nj fr nk b gp oe nm nn gs of np nq nr og nt nu nv oh nx ny nz oi ob oc od fk bk">Thanks for reading.</p></div></div></div></div>    
</body>
</html>