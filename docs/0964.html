<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>More Robust Multivariate EDA with Statistical Testing</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>More Robust Multivariate EDA with Statistical Testing</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/more-robust-multivariate-eda-with-statistical-testing-d221fc145870?source=collection_archive---------5-----------------------#2024-04-16">https://towardsdatascience.com/more-robust-multivariate-eda-with-statistical-testing-d221fc145870?source=collection_archive---------5-----------------------#2024-04-16</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><figure class="fr fs ft fu fv fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp fq"><img src="../Images/53b659ed4f9847990917b4f161ff46fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*-WHnXGfIdUwlPX2n"/></div></div><figcaption class="gd ge gf fo fp gg gh bf b bg z dx">Photo by <a class="af gi" href="https://unsplash.com/@jruscello?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Jessica Ruscello</a> on <a class="af gi" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><div/><div><h2 id="e6e6" class="pw-subtitle-paragraph hi gk gl bf b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx cq dx">Improve robustness in identifying relationships between variables by incorporating relevant hypothesis testing methods</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hy hz ia ib ic ab"><div><div class="ab id"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@pararawendy19?source=post_page---byline--d221fc145870--------------------------------" rel="noopener follow"><div class="l ie if by ig ih"><div class="l ed"><img alt="Pararawendy Indarjo" class="l ep by dd de cx" src="../Images/afba0cb7f3af9554a187bbc7a3c00e60.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*l45Yv4O0vcCQfjAHzjO_qQ.jpeg"/><div class="ii by l dd de em n ij eo"/></div></div></a></div></div><div class="ik ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--d221fc145870--------------------------------" rel="noopener follow"><div class="l il im by ig in"><div class="l ed"><img alt="Towards Data Science" class="l ep by br io cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="ii by l br io em n ij eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="ip ab q"><div class="ab q iq"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b ir is bk"><a class="af ag ah ai aj ak al am an ao ap aq ar it" data-testid="authorName" href="https://medium.com/@pararawendy19?source=post_page---byline--d221fc145870--------------------------------" rel="noopener follow">Pararawendy Indarjo</a></p></div></div></div><span class="iu iv" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b ir is dx"><button class="iw ix ah ai aj ak al am an ao ap aq ar iy iz ja" disabled="">Follow</button></p></div></div></span></div></div><div class="l jb"><span class="bf b bg z dx"><div class="ab cn jc jd je"><div class="jf jg ab"><div class="bf b bg z dx ab jh"><span class="ji l jb">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar it ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--d221fc145870--------------------------------" rel="noopener follow"><p class="bf b bg z jj jk jl jm jn jo jp jq bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="iu iv" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">8 min read</span><div class="jr js l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Apr 16, 2024</span></div></span></div></span></div></div></div><div class="ab cp jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki"><div class="h k w ea eb q"><div class="ky l"><div class="ab q kz la"><div class="pw-multi-vote-icon ed ji lb lc ld"><div class=""><div class="le lf lg lh li lj lk am ll lm ln ld"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l lo lp lq lr ls lt lu"><p class="bf b dy z dx"><span class="lf">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao le lv lw ab q ee lx ly" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lz"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg></button></div></div></div><div class="ab q kj kk kl km kn ko kp kq kr ks kt ku kv kw kx"><div class="ma k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al mb an ao ap iy mc md me" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep mf cn"><div class="l ae"><div class="ab cb"><div class="mg mh mi mj mk gb ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al mb an ao ap iy ml mm ly mn mo mp mq mr s ms mt mu mv mw mx my u mz na nb"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al mb an ao ap iy ml mm ly mn mo mp mq mr s ms mt mu mv mw mx my u mz na nb"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al mb an ao ap iy ml mm ly mn mo mp mq mr s ms mt mu mv mw mx my u mz na nb"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><p id="9cb1" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Exploratory Data Analysis (EDA) is a fundamental skill for data scientists. To emphasize its significance, I would argue that EDA is more important than ML modeling skills. Why? Because EDA is relevant in a larger context than ML modeling.</p><p id="be6c" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">You come across new data that you need to familiarize yourself with? Do EDA. You want to gain insights from data? Do EDA. Even if you want to create an ML model? You still need to perform EDA to prepare the modeling dataset.</p><p id="5f46" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">As you may already be aware, one step in EDA is multivariate analysis. This exercise aims at identifying whether there are relationships between variables in the dataset. Knowing such relationships (if they exist) may allow one to take appropriate action based on the data’s high-level context.</p><p id="fcce" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Having said that, we should be aware of the noise-induced relationship. A seemingly interesting relationship between two variables observed on a bivariate visualization may be due to noise rather than a true meaningful relationship.</p><p id="f347" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Fortunately, statistics provide us with a tool to help us determine whether an observed relationship is truly meaningful or is most likely due to noise. Yes, we’re talking about statistical hypothesis-testing methods.</p><p id="8b83" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">In this blog post, I’ll discuss how to use statistical testing methods in addition to standard bivariate visualization to improve the robustness of multivariate EDA exercises.</p><p id="2191" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">The remainder of this article will be organized as follows.</p><ol class=""><li id="e462" class="nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa bk">Dataset preparation.</li><li id="6f7b" class="nc nd gl ne b hj ob ng nh hm oc nj nk nl od nn no np oe nr ns nt of nv nw nx ny nz oa bk">Identifying numeric-to-numeric variables relationship: scatter plot + correlation test.</li><li id="70de" class="nc nd gl ne b hj ob ng nh hm oc nj nk nl od nn no np oe nr ns nt of nv nw nx ny nz oa bk">Identifying numeric-to-categoric variables relationship: KDE plot + one-way ANOVA.</li><li id="ac1d" class="nc nd gl ne b hj ob ng nh hm oc nj nk nl od nn no np oe nr ns nt of nv nw nx ny nz oa bk">Identifying categoric-to-categoric variables relationship: Count plot + Chi-square test.</li></ol></div></div></div><div class="ab cb og oh oi oj" role="separator"><span class="ok by bm ol om on"/><span class="ok by bm ol om on"/><span class="ok by bm ol om"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h2 id="b87b" class="oo op gl bf oq or os ot ou ov ow ox oy nl oz pa pb np pc pd pe nt pf pg ph pi bk">Dataset Preparation</h2><p id="c7f7" class="pw-post-body-paragraph nc nd gl ne b hj pj ng nh hm pk nj nk nl pl nn no np pm nr ns nt pn nv nw nx fj bk">We’ll use the popular MPG dataset. It’s a publicly available dataset with a <a class="af gi" href="https://archive.ics.uci.edu/dataset/9/auto+mpg" rel="noopener ugc nofollow" target="_blank">Creative Common 4.0 license</a> (which allows for sharing and adaptation of the dataset for any purpose).</p><p id="5075" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">The dataset is about car fuel efficiency details (mile per gallon/MPG) and other vehicle attributes. The data dictionary information can be found on its <a class="af gi" href="https://archive.ics.uci.edu/dataset/9/auto+mpg" rel="noopener ugc nofollow" target="_blank">UCI Machine Learning repo </a>page.</p><p id="c064" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">We load the dataset and remove missing values (which are minimal in this dataset and therefore acceptable to remove). For method demonstration purposes, we also create a new categorical column called <code class="cx po pp pq pr b">efficiency</code> from the <code class="cx po pp pq pr b">mpg</code> column. It has a value of “yes” if the mpg is at least 25, and “no” otherwise.</p><pre class="ps pt pu pv pw px pr py bp pz bb bk"><span id="1080" class="qa op gl pr b bg qb qc l qd qe"># import libraries<br/>import seaborn as sns<br/>import pandas as pd<br/><br/># load dataset via seaborn lib<br/>df = sns.load_dataset("mpg")<br/><br/># inspect missing values<br/>df.isna().sum() #result: minimal, hence OK to remove<br/><br/># remove missing values<br/>df.dropna(inplace=True)<br/><br/># create a new categorical column based on mpg column<br/>df["efficiency"] = df["mpg"].apply(lambda x: "yes" if x &gt;= 25 else "no")<br/><br/># dataframe info<br/>df.info()<br/><br/># dataframe head<br/>df.head()</span></pre><figure class="ps pt pu pv pw fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp qf"><img src="../Images/58d3b996cfa6c2d31b455814fede0753.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_1lWZo2pr-r3RjgTbOmZYQ.png"/></div></div><figcaption class="gd ge gf fo fp gg gh bf b bg z dx">df.info() output (Image by Author)</figcaption></figure></div></div><div class="fw"><div class="ab cb"><div class="mg qg mh qh mi qi cf qj cg qk ci bh"><figure class="ps pt pu pv pw fw qm qn paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp ql"><img src="../Images/b201021478eb6df3d2c7cf23e715c394.png" data-original-src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*nWm23-FrUwBbl-h5zrCCsQ.png"/></div></div><figcaption class="gd ge gf fo fp gg gh bf b bg z dx">df.head() output (Image by Author)</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="1188" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Regarding the goal of multivariate EDA on this dataset, we naturally want to know which factors influence car fuel efficiency. To that end, we will answer the following questions:</p><ol class=""><li id="233f" class="nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa bk">What numerical features influence mpg performance?</li><li id="4ca9" class="nc nd gl ne b hj ob ng nh hm oc nj nk nl od nn no np oe nr ns nt of nv nw nx ny nz oa bk">Do mpg profiles vary depending on origin?</li><li id="1212" class="nc nd gl ne b hj ob ng nh hm oc nj nk nl od nn no np oe nr ns nt of nv nw nx ny nz oa bk">Do different origins result in varying profiles of car efficiency?</li></ol><h2 id="849f" class="oo op gl bf oq or os ot ou ov ow ox oy nl oz pa pb np pc pd pe nt pf pg ph pi bk">Numeric-to-Numeric Relationship</h2><p id="3a5e" class="pw-post-body-paragraph nc nd gl ne b hj pj ng nh hm pk nj nk nl pl nn no np pm nr ns nt pn nv nw nx fj bk">For the first case of multivariate EDA, let’s discuss about identifying relationship between two numerical variables. In this case, it is well known that we can use a scatter plot to visually inspect any relationship that exists between the variables.</p><p id="ecd1" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">As previously stated, not all observed patterns are guaranteed meaningful. In the numeric-to-numeric case, we can supplement the scatter plot with the Pearson correlation test. First, we calculate the Pearson correlation coefficient for the plotted variables. Second, we determine whether the obtained coefficient is significant by computing its p-values.</p><p id="f194" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">The latter step is important as a sanity check whether a certain value of correlation coefficient is larger enough to be considered as meaningful (i.e., there is a linear relationship between plotted variables). This is especially true in the small data size regime. For example, if we only have 10 data points, the correlation coefficient must be at least 0.64 to be considered significant (<a class="af gi" href="https://openstax.org/books/introductory-business-statistics-2e/pages/13-2-testing-the-significance-of-the-correlation-coefficient" rel="noopener ugc nofollow" target="_blank">ref</a>)!</p><p id="075a" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">In python, we can use <code class="cx po pp pq pr b">pearsonr</code> function from the<code class="cx po pp pq pr b">scipy</code> library to do the mentioned correlation test.</p><p id="4529" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">In the following codes, we draw a scatter plot for each pair of numerical features-mpg column. As a title, we print the correlation coefficient plus conditional double-asterix characters if the coefficient is significant (p-value &lt; 0.05).</p><pre class="ps pt pu pv pw px pr py bp pz bb bk"><span id="19e0" class="qa op gl pr b bg qb qc l qd qe">import seaborn as sns<br/>import matplotlib.pyplot as plt<br/>from scipy.stats import pearsonr<br/><br/># prepare variables to inspect<br/>numeric_features = ['cylinders','displacement','horsepower',<br/>                    'weight','acceleration','model_year']<br/>target = 'mpg'<br/><br/># Create a figure and axis<br/>fig, axes = plt.subplots(nrows=2, ncols=3, figsize=(12, 6))<br/><br/># Loop through the numerical columns and plot each scatter plot<br/>for i, col in enumerate(numeric_features):<br/>    # Calculate Pearson correlation coefficient<br/>    corr_coeff, p_val = pearsonr(df[col],df[target])<br/><br/>    # Scatter plot using seaborn<br/>    sns.scatterplot(data=df, x=col, y=target, ax=axes[i//3, i%3])<br/><br/>    # Set title with Pearson correlation coefficient<br/>    # Print ** after the correlation if the correlation coefficient is significant<br/>    axes[i//3, i%3].set_title(f'{col} vs {target} (Corr: {corr_coeff:.2f} {"**" if p_val &lt; 0.05 else ""})')<br/><br/>plt.tight_layout()<br/>plt.show()</span></pre><figure class="ps pt pu pv pw fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp qo"><img src="../Images/686931bcf9bcd0c95955e1f7b4f30822.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WCWXDUca2lzGxkZSEkH1sA.png"/></div></div><figcaption class="gd ge gf fo fp gg gh bf b bg z dx">Numerical features vs mpg (Image by Author)</figcaption></figure><p id="2dca" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Observe that all plot titles contain a double asterix, indicating that the correlations are significant. Thus, we can conclude the following:</p><ol class=""><li id="8f27" class="nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa bk">Cylinders, displacement, horsepower, and weight have a strong negative correlation with mpg. This means that for each of these variables, a higher value corresponds to lower fuel efficiency.</li><li id="4368" class="nc nd gl ne b hj ob ng nh hm oc nj nk nl od nn no np oe nr ns nt of nv nw nx ny nz oa bk">Acceleration and model year have a medium positive correlation with mpg. This means that longer acceleration times (slower cars) and more recently produced cars are associated with higher fuel efficiency.</li></ol><h2 id="d861" class="oo op gl bf oq or os ot ou ov ow ox oy nl oz pa pb np pc pd pe nt pf pg ph pi bk">Numeric-to-Categoric Relationship</h2><p id="5dff" class="pw-post-body-paragraph nc nd gl ne b hj pj ng nh hm pk nj nk nl pl nn no np pm nr ns nt pn nv nw nx fj bk">Next, we’ll investigate if the mpg profiles differ depending on the origin. Note that origin is a categorical variable. As a result, we’re considering the numeric-to-categorical case.</p><p id="b650" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">A KDE (kernel density estimation) plot, also known as a smooth version of a histogram, can be used to visualize the mpg distribution with breakdowns for each origin value.</p><p id="65c2" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">In terms of statistical testing, we can use one-way ANOVA. The hypothesis we want to test is whether there are significant mean differences in mpg between different car origins.</p><p id="b407" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">In python, we can use <code class="cx po pp pq pr b">f_oneway</code> function from <code class="cx po pp pq pr b">scipy</code> library to perform one-way ANOVA.</p><p id="ef73" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">In the following code, we create a KDE plot of mpg with breakdowns for different origin values. Next, we run one-way ANOVA and display the p-value in the title.</p><pre class="ps pt pu pv pw px pr py bp pz bb bk"><span id="1389" class="qa op gl pr b bg qb qc l qd qe">import seaborn as sns<br/>import matplotlib.pyplot as plt<br/>from scipy.stats import f_oneway<br/><br/># Create a KDE plot with hue<br/>sns.set(style="whitegrid")<br/>ax = sns.kdeplot(data=df, x="mpg", hue="origin", fill=True)<br/><br/># Calculate one-way ANOVA p-value<br/>p_value = f_oneway(*[df[df['origin'] == cat]['mpg'] for cat in df['origin'].unique()])[1]<br/><br/># Set title with one-way ANOVA p-value<br/>ax.set_title(f'KDE Plot mpg by origin (One-way ANOVA p-value: {p_value:.4f})')<br/><br/>plt.show()</span></pre><figure class="ps pt pu pv pw fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp qp"><img src="../Images/2d06ff86108afe2d4a6ed03e16a551aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oK-XUCNk-6tKl9iZkl6XJQ.png"/></div></div><figcaption class="gd ge gf fo fp gg gh bf b bg z dx">KDE plot of MPG by origin (Image by Author)</figcaption></figure><p id="9235" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">The p-value in the plot above is less than 0.05, indicating significance. On a high level, we can interpret the plot like this: <strong class="ne gm">In general, cars made in the United States are less fuel efficient than cars made elsewhere </strong>(this is because the peak of USA mpg distribution is located on the left when compared to other origins).</p><h2 id="9644" class="oo op gl bf oq or os ot ou ov ow ox oy nl oz pa pb np pc pd pe nt pf pg ph pi bk">Categoric-to-Categoric Relationship</h2><p id="e032" class="pw-post-body-paragraph nc nd gl ne b hj pj ng nh hm pk nj nk nl pl nn no np pm nr ns nt pn nv nw nx fj bk">Finally, we will evaluate the scenario in which we have two categorical variables. Considering our dataset, we’ll see if different origins produce different car efficiency profiles.</p><p id="fe5a" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">In this case, a count plot with breakdown is the appropriate bivariate visualization. We’ll show the frequency of cars for each origin, broken down by efficiency flag (yes/no).</p><p id="bb7a" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">In terms of statistical testing method to use, chi-square test is the one to go. Using this test, we want to validate if different car origins have different distribution of efficient vs inefficient cars.</p><p id="2d25" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">In python, we can use <code class="cx po pp pq pr b">chisquare</code> function from <code class="cx po pp pq pr b">scipy</code> library. However, unlike the previous cases, we must first prepare the data. Specifically, we need to calculate the “expected frequency” of each origin-efficient value combination.</p><p id="045d" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">For readers who want a more in-depth explanation of this expected frequency concept and chi square test overall mechanics, I recommend reading my blog on the subject, which is attached below.</p><div class="qq qr qs qt qu qv"><a href="https://medium.com/bukalapak-data/meet-the-engine-of-a-b-testing-chi-square-test-30e8a8ab44c5?source=post_page-----d221fc145870--------------------------------" rel="noopener follow" target="_blank"><div class="qw ab jb"><div class="qx ab co cb qy qz"><h2 class="bf gm ir z jj ra jl jm rb jo jq gk bk">Meet the Engine of A/B Testing: Chi-Square Test</h2><div class="rc l"><h3 class="bf b ir z jj ra jl jm rb jo jq dx">Understand the concept and perform one from scratch</h3></div><div class="rd l"><p class="bf b dy z jj ra jl jm rb jo jq dx">medium.com</p></div></div><div class="re l"><div class="rf l rg rh ri re rj gb qv"/></div></div></a></div><p id="5b38" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">The codes to perform the mentioned data preparation are given below.</p><pre class="ps pt pu pv pw px pr py bp pz bb bk"><span id="8743" class="qa op gl pr b bg qb qc l qd qe"># create frequency table of each origin-efficient pair<br/>chi_df = (<br/>    df[['origin','efficiency']]<br/>    .value_counts()<br/>    .reset_index()<br/>    .sort_values(['origin','efficiency'], ignore_index=True)<br/>)<br/><br/># calculate expected frequency for each pair<br/>n = chi_df['count'].sum()<br/><br/>exp = []<br/>for i in range(len(chi_df)):<br/>  sum_row = chi_df.loc[chi_df['origin']==chi_df['origin'][i],'count'].sum()<br/>  sum_col = chi_df.loc[chi_df['efficiency']==chi_df['efficiency'][i],'count'].sum()<br/>  e = sum_row * sum_col / n<br/>  exp.append(e)<br/><br/>chi_df['exp'] = exp<br/>chi_df</span></pre><figure class="ps pt pu pv pw fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp rk"><img src="../Images/13e4075f31ca8f9e5a46a1365969aa38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rQ25GIjdyOprKOvQ5E5-2A.png"/></div></div><figcaption class="gd ge gf fo fp gg gh bf b bg z dx">chi_df result (Image by Author)</figcaption></figure><p id="07c9" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Finally, we can execute the codes below to draw the count plot of car origins with breakdowns on efficiency flags. Furthermore, we use <code class="cx po pp pq pr b">chi_df</code> to perform the chi-square test and get the p-value.</p><pre class="ps pt pu pv pw px pr py bp pz bb bk"><span id="8364" class="qa op gl pr b bg qb qc l qd qe">import seaborn as sns<br/>import matplotlib.pyplot as plt<br/>from scipy.stats import chisquare<br/><br/># Create a count plot with hue<br/>sns.set(style="whitegrid")<br/>ax = sns.countplot(data=df, x="origin", hue="efficiency", fill=True)<br/><br/># Calculate chi-square p-value<br/>p_value = chisquare(chi_df['count'], chi_df['exp'])[1]<br/><br/># Set title with chi-square p-value<br/>ax.set_title(f'Count Plot efficiency vs origin (chi2 p-value: {p_value:.4f})')<br/><br/>plt.show()</span></pre><figure class="ps pt pu pv pw fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp rl"><img src="../Images/4c1f50ad11c848742ee83016acda97eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CJ7zT5GSSZ-_OCsp4d-mOQ.png"/></div></div><figcaption class="gd ge gf fo fp gg gh bf b bg z dx">Count plot efficiency vs origin (Image by Author)</figcaption></figure><p id="5133" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">The plot indicates that there are differences in the distribution of efficient cars across origins (p-value &lt; 0.05). We can see that <strong class="ne gm">American cars are mostly inefficient, whereas Japanese and European cars follow the opposite pattern</strong>.</p><h1 id="567c" class="rm op gl bf oq rn ro hl ou rp rq ho oy rr rs rt ru rv rw rx ry rz sa sb sc sd bk">Summary</h1><p id="2e15" class="pw-post-body-paragraph nc nd gl ne b hj pj ng nh hm pk nj nk nl pl nn no np pm nr ns nt pn nv nw nx fj bk">In this blog post, we learned how to improve bivariate visualization using appropriate statistical testing methods. This would improve the robustness of our multivariate EDA by filtering out noise-induced relationships that would otherwise be visible based solely on visual inspection of bivariate plots.</p><p id="f130" class="pw-post-body-paragraph nc nd gl ne b hj nf ng nh hm ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">I hope this article will help you during your next EDA exercise! All in all, thanks for reading, and let’s connect with me on <a class="af gi" href="https://www.linkedin.com/in/pararawendy-indarjo/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>! 👋</p></div></div></div></div>    
</body>
</html>