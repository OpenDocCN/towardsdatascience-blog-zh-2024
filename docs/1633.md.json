["```py\n# Load libraries\nlibrary(readxl) # To read excel files in R\nlibrary(dplyr) # For data manipulation purpose\nlibrary(lubridate) # To work with dates and times\nlibrary(tidyr) # For data manipulation (use in drop_na)\nlibrary(cluster) # For K-Means clustering\nlibrary(factoextra) # For data visualization in the context of clustering\nlibrary(ggplot2) # For data visualization\n\n# Load the data\ndata <- read_excel(\"online_retail_II.xlsx\", sheet = \"Year 2010-2011\")\n\n# Remove missing Customer IDs\ndata <- data %>% drop_na(`Customer ID`)\n\n# Remove negative or zero quantities and prices\ndata <- data %>% filter(Quantity > 0, Price > 0)\n\n# Calculate the Monetary value\ndata <- data %>% mutate(TotalPrice = Quantity * Price)\n\n# Define the reference date for Recency calculation\nreference_date <- as.Date(\"2011-12-09\")\n```", "```py\n# Calculate RFM metrics\nrfm <- data %>%\n  group_by(`Customer ID`) %>%\n  summarise(\n    Recency = as.numeric(reference_date - max(as.Date(InvoiceDate))),\n    Frequency = n_distinct(Invoice),\n    Monetary = sum(TotalPrice)\n  )\n\n# Assign scores from 1 to 5 for each RFM metric\nrfm <- rfm %>%\n  mutate(\n    R_Score = ntile(Recency, 5),\n    F_Score = ntile(Frequency, 5),\n    M_Score = ntile(Monetary, 5)\n  )\n\n# Scale the RFM scores\nrfm_scaled <- rfm %>%\n  select(R_Score, F_Score, M_Score) %>%\n  scale()\n```", "```py\n# Determine the optimal number of clusters using the Elbow method\nfviz_nbclust(rfm_scaled, kmeans, method = \"wss\")\n\n# Perform K-means clustering\nset.seed(123)\nkmeans_result <- kmeans(rfm_scaled, centers = 4, nstart = 25)\n\n# Add cluster assignment to the original RFM data\nrfm <- rfm %>% mutate(Cluster = kmeans_result$cluster)\n\n# Visualize the clusters\nfviz_cluster(kmeans_result, data = rfm_scaled, \n             geom = \"point\",\n             ellipse.type = \"convex\",\n             palette = \"jco\",\n             ggtheme = theme_minimal(),\n             main = \"Online Retail RFM Segmentation\",\n             pointsize = 3) +\n  theme(\n    plot.title = element_text(size = 15, face = \"bold\"),\n    axis.title.x = element_blank(),  \n    axis.title.y = element_blank(),  \n    axis.text = element_blank(),     \n    axis.ticks = element_blank(),    \n    legend.title = element_text(size = 12, face = \"bold\"),\n    legend.text = element_text(size = 10)\n  )\n```", "```py\n# Summary of each cluster\nrfm_summary <- rfm %>%\n  group_by(Cluster) %>%\n  summarise(\n    Recency = mean(Recency),\n    Frequency = mean(Frequency),\n    Monetary = mean(Monetary),\n    Count = n()\n  )\n```"]