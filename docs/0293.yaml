- en: Using Causal Graphs to answer causal questions
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: åŸæ–‡ï¼š[https://towardsdatascience.com/using-causal-graphs-to-answer-causal-questions-5fd1dd82fa90?source=collection_archive---------1-----------------------#2024-01-31](https://towardsdatascience.com/using-causal-graphs-to-answer-causal-questions-5fd1dd82fa90?source=collection_archive---------1-----------------------#2024-01-31)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Causal AI, exploring the integration of causal reasoning into machine learning
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@raz1470?source=post_page---byline--5fd1dd82fa90--------------------------------)[![Ryan
    O''Sullivan](../Images/7cd161d38d67d2c0b7da2d8f3e7d33fe.png)](https://medium.com/@raz1470?source=post_page---byline--5fd1dd82fa90--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--5fd1dd82fa90--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--5fd1dd82fa90--------------------------------)
    [Ryan O''Sullivan](https://medium.com/@raz1470?source=post_page---byline--5fd1dd82fa90--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
- en: Â·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--5fd1dd82fa90--------------------------------)
    Â·9 min readÂ·Jan 31, 2024
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/de2d3dc8860ce785769383e679f20d22.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
- en: Photo by [GuerrillaBuzz](https://unsplash.com/@guerrillabuzz?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
- en: What is this series of articles about?
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Welcome to my series on Causal AI, where we will explore the integration of
    causal reasoning into machine learning models. Expect to explore a number of practical
    applications across different business contexts.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
- en: '**Introduction**'
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This article gives a practical introduction to the potential of causal graphs.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
- en: 'It is aimed at anyone who wants to understand more about:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
- en: What causal graphs are and how they work
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A worked case study in Python illustrating how to build causal graphs
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How they compare to ML
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The key challenges and future considerations
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The full notebook can be found here:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://github.com/raz1470/causal_ai/blob/main/notebooks/using%20causal%20graphs%20to%20answer%20causal%20questions.ipynb?source=post_page-----5fd1dd82fa90--------------------------------)
    [## causal_ai/notebooks/using causal graphs to answer causal questions.ipynb at
    main Â·â€¦'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
- en: This project introduces Causal AI and how it can drive business value. - causal_ai/notebooks/using
    causal graphs toâ€¦
  id: totrans-19
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: github.com](https://github.com/raz1470/causal_ai/blob/main/notebooks/using%20causal%20graphs%20to%20answer%20causal%20questions.ipynb?source=post_page-----5fd1dd82fa90--------------------------------)
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
- en: '**What are Causal Graphs?**'
  id: totrans-21
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Causal graphs help us disentangle causes from correlations. They are a key part
    of the causal inference/causal ML/causal AI toolbox and can be used to answer
    causal questions.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
- en: Often referred to as a DAG (directed acyclic graph), a causal graph contains
    nodes and edges â€” Edges link nodes that are causally related.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: å› æœå›¾é€šå¸¸è¢«ç§°ä¸ºDAGï¼ˆæœ‰å‘æ— ç¯å›¾ï¼‰ï¼Œå®ƒåŒ…å«èŠ‚ç‚¹å’Œè¾¹â€”â€”è¾¹è¿æ¥çš„æ˜¯å…·æœ‰å› æœå…³ç³»çš„èŠ‚ç‚¹ã€‚
- en: 'There are two ways to determine a causal graph:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: ç¡®å®šå› æœå›¾çš„æ–¹å¼æœ‰ä¸¤ç§ï¼š
- en: Expert domain knowledge
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸“å®¶é¢†åŸŸçŸ¥è¯†
- en: Causal discovery algorithms
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å› æœå‘ç°ç®—æ³•
- en: For now, we will assume we have expert domain knowledge to determine the causal
    graph (we will cover causal discovery algorithms further down the line).
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: ç›®å‰ï¼Œæˆ‘ä»¬å‡è®¾æˆ‘ä»¬æœ‰ä¸“å®¶é¢†åŸŸçŸ¥è¯†æ¥ç¡®å®šå› æœå›¾ï¼ˆæˆ‘ä»¬å°†åœ¨åç»­è®²è§£å› æœå‘ç°ç®—æ³•ï¼‰ã€‚
- en: '**Why canâ€™t we just use ML?**'
  id: totrans-28
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '**ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸èƒ½ä»…ä»…ä½¿ç”¨æœºå™¨å­¦ä¹ ï¼Ÿ**'
- en: 'The objective of ML is to classify or predict as accurately as possible given
    some training data. There is no incentive for an ML algorithm to ensure the features
    it uses are causally linked to the target. There is no guarantee that the direction
    (positive/negative effect) and strength of each feature will align with the true
    data generating process. ML wonâ€™t take into account the following situations:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: æœºå™¨å­¦ä¹ çš„ç›®æ ‡æ˜¯å°½å¯èƒ½å‡†ç¡®åœ°åˆ†ç±»æˆ–é¢„æµ‹ï¼Œå‰ææ˜¯æœ‰ä¸€äº›è®­ç»ƒæ•°æ®ã€‚æœºå™¨å­¦ä¹ ç®—æ³•æ²¡æœ‰åŠ¨åŠ›ç¡®ä¿å®ƒä½¿ç”¨çš„ç‰¹å¾ä¸ç›®æ ‡ä¹‹é—´å…·æœ‰å› æœå…³ç³»ã€‚ä¹Ÿæ— æ³•ä¿è¯æ¯ä¸ªç‰¹å¾çš„æ–¹å‘ï¼ˆæ­£å‘/è´Ÿå‘æ•ˆåº”ï¼‰å’Œå¼ºåº¦ä¸çœŸå®çš„æ•°æ®ç”Ÿæˆè¿‡ç¨‹ç›¸ç¬¦ã€‚æœºå™¨å­¦ä¹ ä¸ä¼šè€ƒè™‘ä»¥ä¸‹æƒ…å†µï¼š
- en: Spurious correlations â€” Two variables having a spurious correlation when they
    have a common cause e.g. High temperatures increasing the number of ice cream
    sales and shark attacks.
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å‡ç›¸å…³â€”â€”å½“ä¸¤ä¸ªå˜é‡æœ‰ä¸€ä¸ªå…±åŒåŸå› æ—¶ï¼Œå®ƒä»¬ä¼šæœ‰ä¸€ä¸ªå‡ç›¸å…³ï¼Œä¾‹å¦‚ï¼šé«˜æ¸©å¢åŠ å†°æ·‡æ·‹é”€é‡å’Œé²¨é±¼è¢­å‡»çš„æ•°é‡ã€‚
- en: Confounders â€” A variable is affecting your treatment and outcome e.g. Demand
    affecting how much we spend on marketing and how many new customers sign up.
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ··æ‚å› å­â€”â€”ä¸€ä¸ªå˜é‡åŒæ—¶å½±å“ä½ çš„å¤„ç†å’Œç»“æœï¼Œä¾‹å¦‚ï¼šéœ€æ±‚å½±å“æˆ‘ä»¬åœ¨è¥é”€ä¸ŠèŠ±è´¹çš„é‡‘é¢ä»¥åŠæ–°å®¢æˆ·çš„æ³¨å†Œæ•°é‡ã€‚
- en: Colliders â€” A variable that is affected by two independent variables e.g. Quality
    of customer care -> User satisfaction <- Size of company
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å†²çªå˜é‡â€”â€”ä¸€ä¸ªå˜é‡å—åˆ°ä¸¤ä¸ªç‹¬ç«‹å˜é‡çš„å½±å“ï¼Œä¾‹å¦‚ï¼šå®¢æˆ·å…³æ€€è´¨é‡ -> ç”¨æˆ·æ»¡æ„åº¦ <- å…¬å¸è§„æ¨¡
- en: Mediators â€” Two variables being (indirectly) linked through a mediator e.g.
    Regular exercise -> Cardiovascular fitness (the mediator) -> Overall health
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸­ä»‹å˜é‡â€”â€”ä¸¤ä¸ªå˜é‡é€šè¿‡ä¸€ä¸ªä¸­ä»‹å˜é‡ï¼ˆé—´æ¥ï¼‰å…³è”ï¼Œä¾‹å¦‚ï¼šè§„å¾‹æ€§è¿åŠ¨ -> å¿ƒè¡€ç®¡å¥åº·ï¼ˆä¸­ä»‹å˜é‡ï¼‰ -> æ€»ä½“å¥åº·
- en: Because of these complexities and the black-box nature of ML, we canâ€™t be confident
    in its ability to answer causal questions.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: ç”±äºè¿™äº›å¤æ‚æ€§ä»¥åŠæœºå™¨å­¦ä¹ çš„é»‘ç®±æ€§è´¨ï¼Œæˆ‘ä»¬æ— æ³•ç¡®ä¿¡å®ƒèƒ½å¤Ÿå›ç­”å› æœé—®é¢˜ã€‚
- en: '**Structural Causal Models**'
  id: totrans-35
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '**ç»“æ„å› æœæ¨¡å‹**'
- en: Given a known causal graph and observed data, we can train a structural causal
    model (SCM). An SCM can be thought of as a series of causal models, one per node.
    Each model uses one node as a target, and its direct parents as features. If the
    relationships in our observed data are linear, an SCM will be a series of linear
    equations. This could be modelled by a series of linear regression models. If
    the relationships in our observed data are non-linear, this could be modelled
    with a series of boosted trees.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: ç»™å®šå·²çŸ¥çš„å› æœå›¾å’Œè§‚å¯Ÿæ•°æ®ï¼Œæˆ‘ä»¬å¯ä»¥è®­ç»ƒä¸€ä¸ªç»“æ„å› æœæ¨¡å‹ï¼ˆSCMï¼‰ã€‚ä¸€ä¸ªSCMå¯ä»¥çœ‹ä½œæ˜¯ä¸€ç³»åˆ—å› æœæ¨¡å‹ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸€ä¸ªæ¨¡å‹ã€‚æ¯ä¸ªæ¨¡å‹ä½¿ç”¨ä¸€ä¸ªèŠ‚ç‚¹ä½œä¸ºç›®æ ‡ï¼Œå¹¶ä½¿ç”¨å…¶ç›´æ¥çˆ¶èŠ‚ç‚¹ä½œä¸ºç‰¹å¾ã€‚å¦‚æœæˆ‘ä»¬è§‚å¯Ÿæ•°æ®ä¸­çš„å…³ç³»æ˜¯çº¿æ€§çš„ï¼ŒSCMå°†æ˜¯ä¸€ä¸ªçº¿æ€§æ–¹ç¨‹ç»„ã€‚è¿™å¯ä»¥é€šè¿‡ä¸€ç³»åˆ—çº¿æ€§å›å½’æ¨¡å‹æ¥å»ºæ¨¡ã€‚å¦‚æœæˆ‘ä»¬è§‚å¯Ÿæ•°æ®ä¸­çš„å…³ç³»æ˜¯éçº¿æ€§çš„ï¼Œå¯ä»¥é€šè¿‡ä¸€ç³»åˆ—å¢å¼ºæ ‘æ¥å»ºæ¨¡ã€‚
- en: The key difference to traditional ML is that an SCM models causal relationships
    and accounts for spurious correlations, confounders, colliders and mediators.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ä¼ ç»Ÿæœºå™¨å­¦ä¹ çš„å…³é”®åŒºåˆ«åœ¨äºï¼ŒSCMå»ºæ¨¡çš„æ˜¯å› æœå…³ç³»ï¼Œå¹¶è€ƒè™‘äº†å‡ç›¸å…³ã€æ··æ‚å› å­ã€å†²çªå˜é‡å’Œä¸­ä»‹å˜é‡ã€‚
- en: It is common to use an additive noise model (ANM) for each non-root node (meaning
    it has at least one parent). This allows us to use a range of machine learning
    algorithms (plus a noise term) to estimate each non-root node.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: é€šå¸¸ä¸ºæ¯ä¸ªéæ ¹èŠ‚ç‚¹ä½¿ç”¨åŠ æ€§å™ªå£°æ¨¡å‹ï¼ˆANMï¼‰ï¼ˆæ„å‘³ç€å®ƒè‡³å°‘æœ‰ä¸€ä¸ªçˆ¶èŠ‚ç‚¹ï¼‰ã€‚è¿™ä½¿æˆ‘ä»¬èƒ½å¤Ÿä½¿ç”¨ä¸€ç³»åˆ—æœºå™¨å­¦ä¹ ç®—æ³•ï¼ˆåŠ ä¸Šå™ªå£°é¡¹ï¼‰æ¥ä¼°è®¡æ¯ä¸ªéæ ¹èŠ‚ç‚¹ã€‚
- en: Y := f(X) + N
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: Y := f(X) + N
- en: Root nodes can modelled using a stochastic model to describe the distribution.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: æ ¹èŠ‚ç‚¹å¯ä»¥ä½¿ç”¨éšæœºæ¨¡å‹æ¥å»ºæ¨¡ï¼Œä»¥æè¿°å…¶åˆ†å¸ƒã€‚
- en: An SCM can be seen as a generative model as can to generate new samples of data
    â€” This enables it to answer a range of causal questions. It generates new data
    by sampling from the root nodes and then propagating data through the graph.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: ç»“æ„å› æœæ¨¡å‹ï¼ˆSCMï¼‰å¯ä»¥è§†ä¸ºä¸€ä¸ªç”Ÿæˆæ¨¡å‹ï¼Œå®ƒèƒ½å¤Ÿç”Ÿæˆæ–°çš„æ•°æ®æ ·æœ¬â€”â€”è¿™ä½¿å¾—å®ƒèƒ½å¤Ÿå›ç­”ä¸€ç³»åˆ—å› æœé—®é¢˜ã€‚å®ƒé€šè¿‡ä»æ ¹èŠ‚ç‚¹é‡‡æ ·æ•°æ®å¹¶é€šè¿‡å›¾ä¼ æ’­æ•°æ®æ¥ç”Ÿæˆæ–°æ•°æ®ã€‚
- en: '**Answering causal questions**'
  id: totrans-42
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '**å›ç­”å› æœé—®é¢˜**'
- en: 'The value of an SCM is that it allows us to answer causal questions by calculating
    counterfactuals and simulating interventions:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: ç»“æ„å› æœæ¨¡å‹çš„ä»·å€¼åœ¨äºï¼Œå®ƒé€šè¿‡è®¡ç®—åäº‹å®å’Œæ¨¡æ‹Ÿå¹²é¢„æ¥å›ç­”å› æœé—®é¢˜ï¼š
- en: 'Counterfactuals: Using historically observed data to calculate what would have
    happened to y if we had changed x. e.g. What would have happened to the number
    of customers churning if we had reduced call waiting time by 20% last month?'
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åäº‹å®ï¼šä½¿ç”¨å†å²è§‚æµ‹æ•°æ®è®¡ç®—å¦‚æœæˆ‘ä»¬æ”¹å˜äº†xï¼Œyä¼šå‘ç”Ÿä»€ä¹ˆã€‚ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬ä¸Šä¸ªæœˆå°†å‘¼å«ç­‰å¾…æ—¶é—´å‡å°‘20%ï¼Œå®¢æˆ·æµå¤±æ•°é‡ä¼šæœ‰ä»€ä¹ˆå˜åŒ–ï¼Ÿ
- en: 'Interventions: Very similar to counterfactuals (and often used interchangeably)
    but interventions simulate what what would happen in the future e.g. What will
    happen to the number of customers churning if we reduce call waiting time by 20%
    next year?'
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¹²é¢„ï¼šä¸åäº‹å®éå¸¸ç›¸ä¼¼ï¼ˆä¸”å¸¸å¸¸äº’æ¢ä½¿ç”¨ï¼‰ï¼Œä½†å¹²é¢„æ¨¡æ‹Ÿçš„æ˜¯æœªæ¥å¯èƒ½å‘ç”Ÿçš„æƒ…å†µã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ˜å¹´æˆ‘ä»¬å°†å‘¼å«ç­‰å¾…æ—¶é—´å‡å°‘20%ï¼Œå®¢æˆ·æµå¤±æ•°é‡ä¼šæœ‰ä»€ä¹ˆå˜åŒ–ï¼Ÿ
- en: '**Call Centre case study**'
  id: totrans-46
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '**å‘¼å«ä¸­å¿ƒæ¡ˆä¾‹ç ”ç©¶**'
- en: There are several KPIs that the customer service team monitors. One of these
    is call waiting times. Increasing the number of call centre staff will decrease
    call waiting times.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: å®¢æˆ·æœåŠ¡å›¢é˜Ÿç›‘æ§å¤šä¸ªå…³é”®ç»©æ•ˆæŒ‡æ ‡ï¼ˆKPIï¼‰ã€‚å…¶ä¸­ä¹‹ä¸€æ˜¯å‘¼å«ç­‰å¾…æ—¶é—´ã€‚å¢åŠ å‘¼å«ä¸­å¿ƒå‘˜å·¥æ•°é‡å°†å‡å°‘å‘¼å«ç­‰å¾…æ—¶é—´ã€‚
- en: But how will decreasing call waiting time impact customer churn levels? And
    will this offset the cost of additional call centre staff?
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†å‡å°‘å‘¼å«ç­‰å¾…æ—¶é—´ä¼šå¦‚ä½•å½±å“å®¢æˆ·æµå¤±ç‡ï¼Ÿè¿™æ˜¯å¦è¶³ä»¥æŠµæ¶ˆå¢åŠ å‘¼å«ä¸­å¿ƒå‘˜å·¥çš„æˆæœ¬ï¼Ÿ
- en: The Data Science team is asked to build and evaluate the business case.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: æ•°æ®ç§‘å­¦å›¢é˜Ÿè¢«è¦æ±‚æ„å»ºå¹¶è¯„ä¼°ä¸šåŠ¡æ¡ˆä¾‹ã€‚
- en: '**Determining the causal graph**'
  id: totrans-50
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '**ç¡®å®šå› æœå›¾**'
- en: 'The population of interest is customers who make an inbound call. The following
    time-series data is collected daily:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: å…³æ³¨çš„ç¾¤ä½“æ˜¯æ‹¨æ‰“è¿›çº¿ç”µè¯çš„å®¢æˆ·ã€‚ä»¥ä¸‹æ˜¯æ¯å¤©æ”¶é›†çš„æ—¶é—´åºåˆ—æ•°æ®ï¼š
- en: '![](../Images/ea95f2a517a5ea6c23b1cc89cb028263.png)'
  id: totrans-52
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/ea95f2a517a5ea6c23b1cc89cb028263.png)'
- en: Image by author
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡ç”±ä½œè€…æä¾›
- en: In this example, we use time-series data but causal graphs can also work with
    customer-level data.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨æ—¶é—´åºåˆ—æ•°æ®ï¼Œä½†å› æœå›¾ä¹Ÿå¯ä»¥ä¸å®¢æˆ·çº§åˆ«çš„æ•°æ®ä¸€èµ·ä½¿ç”¨ã€‚
- en: In this example, we use expert domain knowledge to determine the causal graph.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨ä¸“å®¶é¢†åŸŸçŸ¥è¯†æ¥ç¡®å®šå› æœå›¾ã€‚
- en: '[PRE0]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '![](../Images/7f87d73da2c5be5e5e94137445c52f12.png)'
  id: totrans-57
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/7f87d73da2c5be5e5e94137445c52f12.png)'
- en: Image by author
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡ç”±ä½œè€…æä¾›
- en: '**Data generating process**'
  id: totrans-59
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '**æ•°æ®ç”Ÿæˆè¿‡ç¨‹**'
- en: Next, we need to generate data for our case study.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºæ¡ˆä¾‹ç ”ç©¶ç”Ÿæˆæ•°æ®ã€‚
- en: We want to generate some data which will allow us to compare calculating counterfactuals
    using causal graphs vs ML (to keep things simple, ridge regression).
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬æƒ³è¦ç”Ÿæˆä¸€äº›æ•°æ®ï¼Œä»¥ä¾¿æ¯”è¾ƒä½¿ç”¨å› æœå›¾ä¸æœºå™¨å­¦ä¹ ï¼ˆä¸ºäº†ç®€å•èµ·è§ï¼Œä½¿ç”¨å²­å›å½’ï¼‰è®¡ç®—åäº‹å®çš„ç»“æœã€‚
- en: As we identified the causal graph in the last section, we can use this knowledge
    to create a data-generating process.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: æ­£å¦‚æˆ‘ä»¬åœ¨ä¸Šä¸€èŠ‚ä¸­ç¡®å®šçš„å› æœå›¾ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™äº›çŸ¥è¯†æ¥åˆ›å»ºæ•°æ®ç”Ÿæˆè¿‡ç¨‹ã€‚
- en: '[PRE1]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '[PRE2]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '![](../Images/9922931040e9b9c7d7029dbe255b01bf.png)'
  id: totrans-65
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/9922931040e9b9c7d7029dbe255b01bf.png)'
- en: Image by author
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡ç”±ä½œè€…æä¾›
- en: '**Training an SCM**'
  id: totrans-67
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '**è®­ç»ƒSCM**'
- en: We now have an adjacency matrix which represents our causal graph and some data.
    We use the gcm module from the dowhy Python package to train an SCM.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬æœ‰äº†è¡¨ç¤ºå› æœå›¾çš„é‚»æ¥çŸ©é˜µå’Œä¸€äº›æ•°æ®ã€‚æˆ‘ä»¬ä½¿ç”¨æ¥è‡ªdowhy PythonåŒ…çš„gcmæ¨¡å—æ¥è®­ç»ƒSCMã€‚
- en: Itâ€™s important to think about what causal mechanism to use for the root and
    non-root nodes. If you look at our data generator function, you will see all of
    the relationships are linear. Therefore choosing ridge regression should be sufficient.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: è€ƒè™‘é€‰æ‹©ä½•ç§å› æœæœºåˆ¶ç”¨äºæ ¹èŠ‚ç‚¹å’Œéæ ¹èŠ‚ç‚¹æ˜¯éå¸¸é‡è¦çš„ã€‚å¦‚æœä½ æŸ¥çœ‹æˆ‘ä»¬çš„æ•°æ®ç”Ÿæˆå‡½æ•°ï¼Œä½ ä¼šçœ‹åˆ°æ‰€æœ‰çš„å…³ç³»éƒ½æ˜¯çº¿æ€§çš„ã€‚å› æ­¤ï¼Œé€‰æ‹©å²­å›å½’åº”è¯¥è¶³å¤Ÿäº†ã€‚
- en: '[PRE3]'
  id: totrans-70
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: You could also use the auto assignment function to automatically assign the
    causal mechanisms instead of manually assigning them.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨è‡ªåŠ¨åˆ†é…åŠŸèƒ½ï¼Œè‡ªåŠ¨åˆ†é…å› æœæœºåˆ¶ï¼Œè€Œä¸æ˜¯æ‰‹åŠ¨åˆ†é…ã€‚
- en: 'For more info on the gcm package see the docs:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: å…³äºgcmåŒ…çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…æ–‡æ¡£ï¼š
- en: '[## DoWhy documentation - DoWhy documentation'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: '[## DoWhyæ–‡æ¡£ - DoWhyæ–‡æ¡£](https://www.pywhy.org/dowhy/v0.11.1/?source=post_page-----5fd1dd82fa90--------------------------------)'
- en: 'Date: Dec 25, 2023 Version: v0.11.1 Related resources: Source Repository |
    Issues & Ideas | PyWhy Organization | DoWhyâ€¦'
  id: totrans-74
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æ—¥æœŸï¼š2023å¹´12æœˆ25æ—¥ ç‰ˆæœ¬ï¼šv0.11.1 ç›¸å…³èµ„æºï¼šæºä»£ç ä»“åº“ | é—®é¢˜ä¸å»ºè®® | PyWhyç»„ç»‡ | DoWhyâ€¦
- en: www.pywhy.org](https://www.pywhy.org/dowhy/v0.11.1/?source=post_page-----5fd1dd82fa90--------------------------------)
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.pywhy.org](https://www.pywhy.org/dowhy/v0.11.1/?source=post_page-----5fd1dd82fa90--------------------------------)'
- en: '**Ridge regression comparison**'
  id: totrans-76
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '**å²­å›å½’æ¯”è¾ƒ**'
- en: We also use ridge regression to help create a baseline comparison. We can look
    back at the data generator and see that it correctly estimates the coefficients
    for each variable. However, in addition to directly influencing churn, call waiting
    time indirectly influences churn through abandoned calls, reported problems and
    discounts sent.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
- en: When it comes to estimating counterfactuals it is going to be interesting to
    see how the SCM compares to ridge regression.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '![](../Images/8bdef4723a46a3c0aaec5a3a2a4d6f89.png)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
- en: Image by author
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
- en: '**Estimating ground truth**'
  id: totrans-82
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Before we move on to calculating counterfactuals using causal graphs and ridge
    regression, we need a ground truth benchmark. We can use our data generator to
    create counterfactual samples after we have reduced call waiting time by 20%.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
- en: We couldnâ€™t do this with real-world problems but this method allows us to assess
    how effective the causal graph and ridge regression is.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '**Estimating counterfactuals**'
  id: totrans-86
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We can now estimate what would have happened if we had of decreased the call
    waiting time by 20% using our 3 methods:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
- en: Ground truth (from the data generator)
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ridge regression
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Causal graph
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We see that ridge regression underestimates the impact on churn significantly
    whilst the causal graph is very close to the ground truth.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  id: totrans-92
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '![](../Images/0da8f6eb1bd4a932cc8e7626cb4e0046.png)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
- en: Image by author
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
- en: '**Future considerations**'
  id: totrans-95
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This was a simple example to start you thinking about the power of causal graphs.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
- en: 'For more complex situations, several challenges that would need some consideration:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
- en: What assumptions are made and what is the impact of these being violated?
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: What about if we donâ€™t have the expert domain knowledge to identify the causal
    graph?
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: What if there are non-linear relationships?
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How damaging is multi-collinearity?
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: What if some variables have lagged effects?
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How can we deal with high-dimensional datasets (lots of variables)?
  id: totrans-103
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: All of these points will be covered in future blogs.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
- en: '**Resources**'
  id: totrans-105
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'If your interested in learning more about causal AI, I highly recommend the
    following resources:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://www.packtpub.com/product/causal-inference-and-discovery-in-python/9781804612989?source=post_page-----5fd1dd82fa90--------------------------------)
    [## Causal Inference and Discovery in Python | Packt'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
- en: Demystify causal inference and casual discovery by uncovering causal principles
    and merging them with powerful machineâ€¦
  id: totrans-108
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: www.packtpub.com](https://www.packtpub.com/product/causal-inference-and-discovery-in-python/9781804612989?source=post_page-----5fd1dd82fa90--------------------------------)
    [](https://www.oreilly.com/library/view/causal-inference-in/9781098140243/?source=post_page-----5fd1dd82fa90--------------------------------)
    [## Causal Inference in Python
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
- en: How many buyers will an additional dollar of online marketing bring in? Which
    customers will only buy when given aâ€¦
  id: totrans-110
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: www.oreilly.com](https://www.oreilly.com/library/view/causal-inference-in/9781098140243/?source=post_page-----5fd1dd82fa90--------------------------------)
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: '[www.oreilly.com](https://www.oreilly.com/library/view/causal-inference-in/9781098140243/?source=post_page-----5fd1dd82fa90--------------------------------)'
- en: What does ChatGPT have to say about the author? ğŸ˜Š
  id: totrans-112
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ChatGPTå¯¹ä½œè€…æœ‰ä»€ä¹ˆè¯„ä»·å‘¢ï¼ŸğŸ˜Š
- en: â€œMeet Ryan, a seasoned Lead Data Scientist with a specialized focus on employing
    causal techniques within business contexts, spanning Marketing, Operations, and
    Customer Service. His proficiency lies in unraveling the intricacies of cause-and-effect
    relationships to drive informed decision-making and strategic enhancements across
    diverse organizational functions.â€
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: â€œè®¤è¯†ä¸€ä¸‹Ryanï¼Œä¸€ä½ç»éªŒä¸°å¯Œçš„é¦–å¸­æ•°æ®ç§‘å­¦å®¶ï¼Œä¸“æ³¨äºåœ¨å•†ä¸šç¯å¢ƒä¸­è¿ç”¨å› æœåˆ†ææŠ€æœ¯ï¼Œæ¶µç›–è¥é”€ã€è¿è¥å’Œå®¢æˆ·æœåŠ¡ç­‰é¢†åŸŸã€‚ä»–çš„ä¸“é•¿åœ¨äºæ­ç¤ºå› æœå…³ç³»çš„å¤æ‚æ€§ï¼Œä»è€Œæ¨åŠ¨æ˜æ™ºçš„å†³ç­–å’Œæˆ˜ç•¥æ”¹è¿›ï¼ŒæœåŠ¡äºä¸åŒçš„ç»„ç»‡èŒèƒ½ã€‚â€
- en: Follow me if you want to continue this journey into Causal AI â€” In the next
    article we will take a step back and delve into using Causal Discovery to estimate
    the Causal Graph when we donâ€™t have expert domain knowledge.
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä½ æƒ³ç»§ç»­æ¢ç´¢å› æœäººå·¥æ™ºèƒ½ï¼Œè¯·å…³æ³¨æˆ‘â€”â€”åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†å›é¡¾ä¸€æ­¥ï¼Œæ·±å…¥æ¢è®¨å¦‚ä½•åœ¨ç¼ºä¹ä¸“å®¶é¢†åŸŸçŸ¥è¯†çš„æƒ…å†µä¸‹ï¼Œåˆ©ç”¨å› æœå‘ç°æ¥ä¼°è®¡å› æœå›¾ã€‚
