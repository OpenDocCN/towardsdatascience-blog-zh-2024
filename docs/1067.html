<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Improving the Analysis of Object (or Cell) Counts with Lots of Zeros</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Improving the Analysis of Object (or Cell) Counts with Lots of Zeros</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/improving-the-analysis-of-object-or-cells-counts-with-lots-of-zeros-f343d1430637?source=collection_archive---------6-----------------------#2024-04-27">https://towardsdatascience.com/improving-the-analysis-of-object-or-cells-counts-with-lots-of-zeros-f343d1430637?source=collection_archive---------6-----------------------#2024-04-27</a></blockquote><div><div class="em ff fg fh fi fj"/><div class="fk fl fm fn fo"><div class="ab cb"><div class="ci bh ew ex ey ez"><div/><div><h2 id="fc91" class="pw-subtitle-paragraph go fq fr bf b gp gq gr gs gt gu gv gw gx gy gz ha hb hc hd cq dx">An approach using hurdle and zero-inflated models with brms</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="he hf hg hh hi ab"><div><div class="ab hj"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@damanrique?source=post_page---byline--f343d1430637--------------------------------" rel="noopener follow"><div class="l hk hl by hm hn"><div class="l ed"><img alt="Daniel Manrique-Castano" class="l ep by dd de cx" src="../Images/06f857ae6e82688113f1089c7f03be88.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/da:true/resize:fill:88:88/0*9lYBpTGF3RXmvDod"/><div class="ho by l dd de em n hp eo"/></div></div></a></div></div><div class="hq ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--f343d1430637--------------------------------" rel="noopener follow"><div class="l hr hs by hm ht"><div class="l ed"><img alt="Towards Data Science" class="l ep by br hu cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="ho by l br hu em n hp eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hv ab q"><div class="ab q hw"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hx hy bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hz" data-testid="authorName" href="https://medium.com/@damanrique?source=post_page---byline--f343d1430637--------------------------------" rel="noopener follow">Daniel Manrique-Castano</a></p></div></div></div><div class="ia ib l"><div class="ab ic"><div class="ab"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewbox="0 0 16 16"><path fill="#437AFF" d="M15.163 8c0 .65-.459 1.144-.863 1.575-.232.244-.471.5-.563.719s-.086.543-.092.875c-.006.606-.018 1.3-.49 1.781-.47.481-1.15.494-1.744.5-.324.006-.655.013-.857.094s-.465.337-.704.575c-.422.412-.906.881-1.542.881-.637 0-1.12-.469-1.543-.881-.239-.238-.49-.482-.704-.575-.214-.094-.532-.088-.857-.094-.593-.006-1.273-.019-1.744-.5s-.484-1.175-.49-1.781c-.006-.332-.012-.669-.092-.875-.08-.207-.33-.475-.563-.719-.404-.431-.863-.925-.863-1.575s.46-1.144.863-1.575c.233-.244.472-.5.563-.719.092-.219.086-.544.092-.875.006-.606.019-1.3.49-1.781s1.15-.494 1.744-.5c.325-.006.655-.012.857-.094.202-.081.465-.337.704-.575C7.188 1.47 7.671 1 8.308 1s1.12.469 1.542.881c.239.238.49.481.704.575s.533.088.857.094c.594.006 1.273.019 1.745.5.47.481.483 1.175.49 1.781.005.331.011.669.091.875s.33.475.563.719c.404.431.863.925.863 1.575"/><path fill="#fff" d="M7.328 10.5c.195 0 .381.08.519.22.137.141.215.331.216.53 0 .066.026.13.072.177a.24.24 0 0 0 .346 0 .25.25 0 0 0 .071-.177c.001-.199.079-.389.216-.53a.73.73 0 0 1 .519-.22h1.959c.13 0 .254-.053.346-.146a.5.5 0 0 0 .143-.354V6a.5.5 0 0 0-.143-.354.49.49 0 0 0-.346-.146h-1.47c-.324 0-.635.132-.865.366-.23.235-.359.552-.359.884v2.5c0 .066-.025.13-.071.177a.24.24 0 0 1-.346 0 .25.25 0 0 1-.072-.177v-2.5c0-.332-.13-.65-.359-.884A1.21 1.21 0 0 0 6.84 5.5h-1.47a.49.49 0 0 0-.346.146A.5.5 0 0 0 4.88 6v4c0 .133.051.26.143.354a.49.49 0 0 0 .347.146z"/></svg></div></div></div><span class="id ie" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hx hy dx"><button class="if ig ah ai aj ak al am an ao ap aq ar ih ii ij" disabled="">Follow</button></p></div></div></span></div></div><div class="l ik"><span class="bf b bg z dx"><div class="ab cn il im in"><div class="io ip ab"><div class="bf b bg z dx ab iq"><span class="ir l ik">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hz ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--f343d1430637--------------------------------" rel="noopener follow"><p class="bf b bg z is it iu iv iw ix iy iz bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="id ie" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">13 min read</span><div class="ja jb l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Apr 27, 2024</span></div></span></div></span></div></div></div><div class="ab cp jc jd je jf jg jh ji jj jk jl jm jn jo jp jq jr"><div class="h k w ea eb q"><div class="kh l"><div class="ab q ki kj"><div class="pw-multi-vote-icon ed ir kk kl km"><div class=""><div class="kn ko kp kq kr ks kt am ku kv kw km"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kx ky kz la lb lc ld"><p class="bf b dy z dx"><span class="ko">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kn le lf ab q ee lg lh" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="li"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg></button></div></div></div><div class="ab q js jt ju jv jw jx jy jz ka kb kc kd ke kf kg"><div class="lj k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lk an ao ap ih ll lm ln" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep lo cn"><div class="l ae"><div class="ab cb"><div class="lp lq lr ls lt lu ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lk an ao ap ih lv lw lh lx ly lz ma mb s mc md me mf mg mh mi u mj mk ml"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lk an ao ap ih lv lw lh lx ly lz ma mb s mc md me mf mg mh mi u mj mk ml"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lk an ao ap ih lv lw lh lx ly lz ma mb s mc md me mf mg mh mi u mj mk ml"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="mp mq mr ms mt mu mm mn paragraph-image"><div role="button" tabindex="0" class="mv mw ed mx bh my"><div class="mm mn mo"><img src="../Images/7ca3306348a80ac2c32c3bb56be3f0cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qkqoH3ozvcYxKp63E8N2dA.png"/></div></div><figcaption class="na nb nc mm mn nd ne bf b bg z dx">NeuN and GFAP staining in a mouse brain following cerebral ischemia. <a class="af nf" href="https://www.biorxiv.org/content/10.1101/2023.10.04.560910v1" rel="noopener ugc nofollow" target="_blank">Manrique-Castano et al</a>. (2024) (CC-BY).</figcaption></figure><p id="7ba9" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">Counting is a fundamental task in biomedical research, particularly when analyzing cell populations. Imagine staring at countless cells within a tiny brain region — sometimes numbering in the hundreds or thousands. Yet, in other areas, these numbers may dwindle to few or even none.</p><p id="069c" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">The challenge arises in how we analyze these counts. For large numbers, linear models, which assume a normal distribution, often serve as a reasonable approximation. Though not optimal, they provide a logical framework for initial analysis. However, the scenario shifts dramatically when cell counts are low or predominantly zeros. Here, traditional linear models (like those t-tests we run in GraphPad) falter, losing their effectiveness and relevance.</p><p id="c573" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">As researchers, we must strive for better, going beyond t-tests and ANOVAs. This post aims to explore alternative statistical methods that more accurately reflect the realities of our data, especially when dealing with low or zero counts. By embracing more fitted approaches, we can enhance the precision of our findings and deepen our understanding of our cell populations.</p><p id="ebf1" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">First, let’s load the necessary libraries and create a visual theme for our plots.</p><pre class="mp mq mr ms mt oc od oe bp of bb bk"><span id="8b83" class="og oh fr od b bg oi oj l ok ol">library(ggplot2)<br/>library(brms)<br/>library(ggdist)<br/>library(easystats)<br/>library(dplyr)<br/>library(modelr)<br/>library(patchwork)<br/>library(tibble)<br/>library(tidybayes)<br/><br/>logit2prob &lt;- function(logit){<br/>  odds &lt;- exp(logit)<br/>  prob &lt;- odds / (1 + odds)<br/>  return(prob)<br/>}<br/><br/>Plot_theme &lt;- theme_classic() +<br/>  theme(<br/>      plot.title = element_text(size=18, hjust = 0.5, face="bold"),<br/>      plot.subtitle = element_text(size = 10, color = "black"),<br/>      plot.caption = element_text(size = 12, color = "black"),<br/>      axis.line = element_line(colour = "black", size = 1.5, linetype = "solid"),<br/>      axis.ticks.length=unit(7,"pt"),<br/>     <br/>      axis.title.x = element_text(colour = "black", size = 16),<br/>      axis.text.x = element_text(colour = "black", size = 16, angle = 0, hjust = 0.5),<br/>      axis.ticks.x = element_line(colour = "black", size = 1),<br/>      <br/>      axis.title.y = element_text(colour = "black", size = 16),<br/>      axis.text.y = element_text(colour = "black", size = 16),<br/>      axis.ticks.y = element_line(colour = "black", size = 1),<br/>      <br/>      legend.position="right",<br/>      legend.direction="vertical",<br/>      legend.title = element_text(colour="black", face="bold", size=12),<br/>      legend.text = element_text(colour="black", size=10),<br/>      <br/>      plot.margin = margin(t = 10,  # Top margin<br/>                             r = 2,  # Right margin<br/>                             b = 10,  # Bottom margin<br/>                             l = 10) # Left margin<br/>      ) </span></pre></div></div></div><div class="ab cb om on oo op" role="separator"><span class="oq by bm or os ot"/><span class="oq by bm or os ot"/><span class="oq by bm or os"/></div><div class="fk fl fm fn fo"><div class="ab cb"><div class="ci bh ew ex ey ez"><h1 id="79cd" class="ou oh fr bf ov ow ox gr oy oz pa gu pb pc pd pe pf pg ph pi pj pk pl pm pn po bk">What is the issue with counting zeros?</h1><p id="8a20" class="pw-post-body-paragraph ng nh fr ni b gp pp nk nl gs pq nn no np pr nr ns nt ps nv nw nx pt nz oa ob fk bk">In many studies, like the one shown in the graph by (<a class="af nf" href="#ref-baraibar2020" rel="noopener ugc nofollow"><em class="pu">1</em></a>), we encounter the challenge of low cell counts, particularly where one group — marked here in black — appears to be dominated by zero counts. This scenario is not uncommon in biomedical literature, where straightforward linear models are frequently applied to analyze such data.</p><figure class="mp mq mr ms mt mu mm mn paragraph-image"><div class="mm mn pv"><img src="../Images/03b18f75422dabf28c42ebb43ddf279f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1140/format:webp/1*oxZF7HKC4AFQRVSNU7IHpw.png"/></div><figcaption class="na nb nc mm mn nd ne bf b bg z dx">Figure 1: CD3+ cells by Baraibar et. al (2020) (CC-BY)</figcaption></figure><p id="e435" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">However, the use of these models in cases of low or zero counts can be problematic. Without access to the original datasets — which researchers often do not share — it’s difficult to evaluate the efficacy of the analysis fully. To better understand this issue, let’s consider a separate dataset from my own research. Several years ago, I undertook the task of counting BrdU+ cells following an ischemic event in a specific brain area called the subventricular zone (SVZ). This particular experience inclined me to evaluate more suitable statistical approaches.</p><p id="ba9c" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">These are the data:</p><pre class="mp mq mr ms mt oc od oe bp of bb bk"><span id="79a7" class="og oh fr od b bg oi oj l ok ol">Svz_data &lt;- read.csv("Data/CellCounts.csv")<br/>Svz_data$Hemisphere &lt;- factor(Svz_data$Hemisphere, levels = c("Contralateral", "Ipsilateral"))<br/>head(Svz_data)</span></pre><figure class="mp mq mr ms mt mu mm mn paragraph-image"><div role="button" tabindex="0" class="mv mw ed mx bh my"><div class="mm mn pw"><img src="../Images/fc557806dbde71b37b57f919be9b7ea2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7Gs5-YfGszagci9zyUuL4A.png"/></div></div></figure><p id="b18a" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">We can visualize that the contralateral hemisphere has a lot of null cell counts. We can have a better angle if we use a boxplot:</p><pre class="mp mq mr ms mt oc od oe bp of bb bk"><span id="889d" class="og oh fr od b bg oi oj l ok ol">ggplot(Svz_data, aes(x = Hemisphere, y = Cells)) +<br/>  geom_boxplot() +<br/>  labs(x = "Hemisphere", y = "Number of cells", title = "Cells by hemisphere") +<br/>  Plot_theme +<br/>  theme(legend.position = "top", legend.direction = "horizontal")</span></pre><figure class="mp mq mr ms mt mu mm mn paragraph-image"><div role="button" tabindex="0" class="mv mw ed mx bh my"><div class="mm mn px"><img src="../Images/1f2ef5bb688bbce545181496a6029bc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JSgL3gIsgBElcbQOrWK4LQ.png"/></div></div><figcaption class="na nb nc mm mn nd ne bf b bg z dx">Figure 2: Cell counts by hemisphere</figcaption></figure><p id="c682" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk"><a class="af nf" href="#fig-EDA" rel="noopener ugc nofollow">Figure 2</a> vividly illustrates the substantial disparities in cell counts across hemispheres. To examine what happens when we apply a typical (and horrific) linear model to such data, we’ll proceed with a practical demonstration using the <code class="cx py pz qa od b">brms</code>. This will help us understand the effects of these variations when analyzed under a traditional framework predicated on normal distribution assumptions.</p><p id="9c99" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">In this example, I’ll fit a linear model where the factor variable “hemisphere” is the sole predictor of the cell counts:</p><pre class="mp mq mr ms mt oc od oe bp of bb bk"><span id="b747" class="og oh fr od b bg oi oj l ok ol">lm_Fit &lt;- brm(Cells ~ Hemisphere, <br/>           data = Svz_data, <br/>           # seed for reproducibility purposes<br/>           seed = 8807,<br/>           control = list(adapt_delta = 0.99),<br/>           # this is to save the model in my laptop<br/>           file    = "Models/2024-04-19_CountsZeroInflated/lm_Fit.rds",<br/>           file_refit = "never")<br/><br/># Add loo for model comparison<br/>lm_Fit &lt;- <br/>  add_criterion(lm_Fit, c("loo", "waic", "bayes_R2"))</span></pre><p id="3625" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">Are you willing to bet on what the results will be? Let’s find out:</p><figure class="mp mq mr ms mt mu mm mn paragraph-image"><div role="button" tabindex="0" class="mv mw ed mx bh my"><div class="mm mn qb"><img src="../Images/ef819bf385242f34194a1aac4ad0180e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EecwTO-OgsKScAIGvLJteA.png"/></div></div></figure><p id="29ef" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">If you like, you can fit a frequentist (OLS) model with <code class="cx py pz qa od b">lm</code> and you will certainly get the same results. In these results, the intercept represents an estimate of cell counts for the contralateral hemisphere, which serves as our reference group. However, a significant inconsistency arises when employing a normal distribution for data that includes numerous zero counts or values close to zero. In such cases, the model is inappropriately “forced” to predict that cell counts in our hemisphere could be negative, such as -1 to -2 cells, with a confidence interval ranging from -1.5 to 3.7. This prediction is fundamentally flawed because it disregards the intrinsic nature of cells as entities that can only assume non-negative integer values.</p><p id="968d" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">This issue stems from the fact that our model, in its current form, does not comprehend the true characteristics of the data it’s handling. Instead, it merely follows our directives — albeit incorrectly — to fit the data to a linear model. This common oversight often leads researchers to further exacerbate the problem by applying t-tests and ANOVAs, thereby superimposing additional analysis onto a model that is fundamentally unsound. It is imperative that we, as researchers, recognize and harness our capabilities and tools to develop and utilize more appropriate and logically sound modeling methods that respect the inherent properties of our data.</p><p id="bc2b" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">Let’s plot the results using the great <code class="cx py pz qa od b">TidyBayes</code> package (<a class="af nf" href="#ref-tidybayes" rel="noopener ugc nofollow"><em class="pu">2</em></a>) by the great <a class="af nf" href="https://www.mjskay.com/" rel="noopener ugc nofollow" target="_blank">Matthew Kay</a></p><pre class="mp mq mr ms mt oc od oe bp of bb bk"><span id="f8c7" class="og oh fr od b bg oi oj l ok ol">Svz_data %&gt;%<br/>  data_grid(Hemisphere) %&gt;%<br/>  add_epred_draws(lm_Fit) %&gt;%<br/>  ggplot(aes(x = .epred, y = Hemisphere)) +<br/>  labs(x = "Number of cells") +<br/>  stat_halfeye() +<br/>  geom_vline(xintercept = 0) +<br/>  Plot_theme</span></pre><figure class="mp mq mr ms mt mu mm mn paragraph-image"><div class="mm mn qc"><img src="../Images/c06d291722fd2e60a45af8adc86ee81b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1240/format:webp/1*2HYD3VlxnU0T7l_YmaCIkw.png"/></div><figcaption class="na nb nc mm mn nd ne bf b bg z dx">Figure 3: Posterior distribution for cell counts by hemisphere</figcaption></figure><p id="5235" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">We can also see this inconsistency if we perform <code class="cx py pz qa od b">pp_check</code> to compare the observations with the model predictions:</p><figure class="mp mq mr ms mt mu mm mn paragraph-image"><div role="button" tabindex="0" class="mv mw ed mx bh my"><div class="mm mn px"><img src="../Images/2ba8710d00422226c3c7c6fd1a7278fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UmytGxTstNqkdvLJxaWxYQ.png"/></div></div><figcaption class="na nb nc mm mn nd ne bf b bg z dx">Figure 4: Posterior predictive checks gaussian model</figcaption></figure><p id="2bf4" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">Once again, we encounter irrational predictions of cell counts falling below zero. As scientists, it’s crucial to reflect on the suitability of our models in relation to the data they are intended to explain. This consideration guides us toward <strong class="ni fs">generative models</strong>, which are build under the premise that they could plausibly have generated the observed data. Clearly, the linear model currently in use falls short of this criterion. It predicts impossible negative values for cell counts. Let’s try to find out a better model.</p></div></div></div><div class="ab cb om on oo op" role="separator"><span class="oq by bm or os ot"/><span class="oq by bm or os ot"/><span class="oq by bm or os"/></div><div class="fk fl fm fn fo"><div class="ab cb"><div class="ci bh ew ex ey ez"><h1 id="1af3" class="ou oh fr bf ov ow ox gr oy oz pa gu pb pc pd pe pf pg ph pi pj pk pl pm pn po bk">Working with lots of zeros</h1><p id="1ff9" class="pw-post-body-paragraph ng nh fr ni b gp pp nk nl gs pq nn no np pr nr ns nt ps nv nw nx pt nz oa ob fk bk">A zero-inflated model effectively captures the nuances of datasets characterized by a preponderance of zeros. It operates by distinguishing between two distinct processes: 1) Determining whether the result is zero, and 2) predicting the values for non-zero results. This dual approach is particularly apt for asking questions like, “Are there any cells present, and if so, how many?”</p><p id="ea38" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">For handling datasets with an abundance of zeros, we employ models such as <code class="cx py pz qa od b">hurdle_poisson()</code> and <code class="cx py pz qa od b">Zero_inflated_poisson</code>, both designed for scenarios where standard count models like the Poisson or negative binomial models prove inadequate (<a class="af nf" href="#ref-feng2021a" rel="noopener ugc nofollow"><em class="pu">3</em></a>).Loosely speaking, a key difference between <code class="cx py pz qa od b">hurdle_poisson()</code> and <code class="cx py pz qa od b">Zero_inflated_poisson</code> is that the latter incorporates an additional probability component specifically for zeros, enhancing their ability to handle datasets where zeros are not merely common but significant. We’ll see the impact these features have in our modeling strategy using <code class="cx py pz qa od b">brms</code>.</p><h2 id="2493" class="qd oh fr bf ov qe qf qg oy qh qi qj pb np qk ql qm nt qn qo qp nx qq qr qs qt bk">Fitting a hurdle_poisson model</h2><p id="a0a7" class="pw-post-body-paragraph ng nh fr ni b gp pp nk nl gs pq nn no np pr nr ns nt ps nv nw nx pt nz oa ob fk bk">Let’s start by using the <code class="cx py pz qa od b">hurdle_poisson()</code> distribution in our modeling scheme:</p><pre class="mp mq mr ms mt oc od oe bp of bb bk"><span id="00dd" class="og oh fr od b bg oi oj l ok ol">Hurdle_Fit1 &lt;- brm(Cells ~ Hemisphere, <br/>           data = Svz_data, <br/>           family = hurdle_poisson(),<br/>           # seed for reproducibility purposes<br/>           seed = 8807,<br/>           control = list(adapt_delta = 0.99),<br/>           # this is to save the model in my laptop<br/>           file    = "Models/2024-04-19_CountsZeroInflated/Hurdle_Fit1.rds",<br/>           file_refit = "never")<br/><br/># Add loo for model comparison<br/>Hurdle_Fit1 &lt;- <br/>  add_criterion(Hurdle_Fit1, c("loo", "waic", "bayes_R2"))</span></pre><p id="317d" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">Let’s see the results using the standard summary function.</p><pre class="mp mq mr ms mt oc od oe bp of bb bk"><span id="e2e5" class="og oh fr od b bg oi oj l ok ol">summary(Hurdle_Fit1)</span></pre><figure class="mp mq mr ms mt mu mm mn paragraph-image"><div role="button" tabindex="0" class="mv mw ed mx bh my"><div class="mm mn qu"><img src="../Images/0d23609c27931943a7d384c039567cf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zMsmZkwCy_E2GWEzYz1mUw.png"/></div></div></figure><p id="e077" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">Given this family distribution, the estimates are shown in the log scale (mu = log). In practical terms, this means that the number of cells in the contralateral subventricular zone (SVZ) can be expressed as exp(1.11) = 3.03. Similarly, the ipsilateral hemisphere is estimated to have exp(1.07) = 2.91 times the number of cells. These results align well with our expectations and offer a coherent interpretation of the cell distribution between the two hemispheres.</p><p id="359c" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">Additionally, the <code class="cx py pz qa od b">hu</code> parameter within the “Family Specific Parameters” sheds light on the likelihood of observing zero cell counts. It indicates a 38% probability of zero occurrences. This probability highlights the need for a zero-inflated model approach and justifies its use in our analysis.</p><p id="23a1" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">To better visualize the implications of these findings, we can leverage the <code class="cx py pz qa od b">conditional_effects</code> function. This tool in the <code class="cx py pz qa od b">brms</code> package allows us to plot the estimated effects of different predictors on the response variable, providing a clear graphical representation of how the predictors influence the expected cell counts.</p><pre class="mp mq mr ms mt oc od oe bp of bb bk"><span id="485e" class="og oh fr od b bg oi oj l ok ol">Hurdle_CE &lt;- <br/>  conditional_effects(Hurdle_Fit1)<br/><br/>Hurdle_CE &lt;- plot(Hurdle_CE, <br/>       plot = FALSE)[[1]]<br/><br/>Hurdle_Com &lt;- Hurdle_CE + <br/>  Plot_theme +<br/>  theme(legend.position = "bottom", legend.direction = "horizontal")<br/><br/><br/>Hurdle_CE_hu &lt;- <br/>  conditional_effects(Hurdle_Fit1, dpar = "hu")<br/><br/>Hurdle_CE_hu &lt;- plot(Hurdle_CE_hu, <br/>       plot = FALSE)[[1]]<br/><br/>Hurdle_hu &lt;- Hurdle_CE_hu + <br/>  Plot_theme +<br/>  theme(legend.position = "bottom", legend.direction = "horizontal")<br/><br/>Hurdle_Com | Hurdle_hu</span></pre><figure class="mp mq mr ms mt mu mm mn paragraph-image"><div role="button" tabindex="0" class="mv mw ed mx bh my"><div class="mm mn px"><img src="../Images/0dc34c66ed8f38f315e0fdf6d7f771f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WsB_AZ8xrpvEmgd7JFZwgA.png"/></div></div><figcaption class="na nb nc mm mn nd ne bf b bg z dx">Figure 5: Conditional effects for the hurdle fit</figcaption></figure><p id="6e28" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">These plots draw a more logical picture than our first model. The graph on the left shows the two parts of the model (“mu” and “hu”). Also, if this model is suitable, we should see more aligned predictions when using <code class="cx py pz qa od b">pp_check</code>:</p><pre class="mp mq mr ms mt oc od oe bp of bb bk"><span id="03ec" class="og oh fr od b bg oi oj l ok ol">pp_check(Hurdle_Fit1, ndraws = 100) +<br/>  labs(title = "Hurdle regression") +<br/>  theme_classic()</span></pre><figure class="mp mq mr ms mt mu mm mn paragraph-image"><div role="button" tabindex="0" class="mv mw ed mx bh my"><div class="mm mn px"><img src="../Images/2121effaca5730a4b7207ef53287e026.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SC3c6fLgVlCsx12lVixZOQ.png"/></div></div><figcaption class="na nb nc mm mn nd ne bf b bg z dx">Figure 6: Posterior predictive checks hurdle model</figcaption></figure><p id="bb85" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">As expected, our model predictions have a lower boundary at 0.</p><h2 id="37c6" class="qd oh fr bf ov qe qf qg oy qh qi qj pb np qk ql qm nt qn qo qp nx qq qr qs qt bk">Modeling the dispersion of the data</h2><p id="457f" class="pw-post-body-paragraph ng nh fr ni b gp pp nk nl gs pq nn no np pr nr ns nt ps nv nw nx pt nz oa ob fk bk">Observing the data presented in the right graph of <a class="af nf" href="#fig-HurdleCE" rel="noopener ugc nofollow">Figure 5</a> reveals a discrepancy between our empirical findings and our theoretical understanding of the subject. Based on established knowledge, we expect a higher probability of non-zero cell counts in the subventricular zone (SVZ) of the ipsilateral hemisphere, especially following an injury. This is because the ipsilateral SVZ typically becomes a hub of cellular activity, with significant cell proliferation post-injury. Our data, indicating prevalent non-zero counts in this region, supports this biological expectation.</p><p id="2dfd" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">However, the current model predictions do not fully align with these insights. This divergence underscores the importance of incorporating scientific understanding into our statistical modeling. Relying solely on standard tests without contextual adaptation can lead to misleading conclusions.</p><p id="628e" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">To address this, we can refine our model by specifically adjusting the <code class="cx py pz qa od b">hu</code> parameter, which represents the probability of zero occurrences. This allows us to more accurately reflect the expected biological activity in the ipsilateral hemisphere’s SVZ. We build then a second hurdle model:</p><pre class="mp mq mr ms mt oc od oe bp of bb bk"><span id="bee5" class="og oh fr od b bg oi oj l ok ol">Hurdle_Mdl2 &lt;- bf(Cells ~ Hemisphere, <br/>                   hu ~ Hemisphere)<br/>  <br/>Hurdle_Fit2 &lt;- brm(<br/>           formula = Hurdle_Mdl2,<br/>           data = Svz_data, <br/>           family = hurdle_poisson(),<br/>           # seed for reproducibility purposes<br/>           seed = 8807,<br/>           control = list(adapt_delta = 0.99),<br/>           # this is to save the model in my laptop<br/>           file    = "Models/2024-04-19_CountsZeroInflated/Hurdle_Fit2.rds",<br/>           file_refit = "never")<br/><br/># Add loo for model comparison<br/>Hurdle_Fit2 &lt;- <br/>  add_criterion(Hurdle_Fit2, c("loo", "waic", "bayes_R2"))</span></pre><p id="5c67" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">Let’s see first if the results graph aligns with our hypothesis:</p><pre class="mp mq mr ms mt oc od oe bp of bb bk"><span id="9696" class="og oh fr od b bg oi oj l ok ol">Hurdle_CE &lt;- <br/>  conditional_effects(Hurdle_Fit2)<br/><br/>Hurdle_CE &lt;- plot(Hurdle_CE, <br/>       plot = FALSE)[[1]]<br/><br/>Hurdle_Com &lt;- Hurdle_CE + <br/>  Plot_theme +<br/>  theme(legend.position = "bottom", legend.direction = "horizontal")<br/><br/><br/>Hurdle_CE_hu &lt;- <br/>  conditional_effects(Hurdle_Fit2, dpar = "hu")<br/><br/>Hurdle_CE_hu &lt;- plot(Hurdle_CE_hu, <br/>       plot = FALSE)[[1]]<br/><br/>Hurdle_hu &lt;- Hurdle_CE_hu + <br/>  Plot_theme +<br/>  theme(legend.position = "bottom", legend.direction = "horizontal")<br/><br/>Hurdle_Com | Hurdle_hu</span></pre><figure class="mp mq mr ms mt mu mm mn paragraph-image"><div role="button" tabindex="0" class="mv mw ed mx bh my"><div class="mm mn px"><img src="../Images/1abbbbecb854b57c1c450cfd57e7d50c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bq56En2ELZtrFWSxt5FLRg.png"/></div></div><figcaption class="na nb nc mm mn nd ne bf b bg z dx">Figure 7: Conditional effects for the hurdle fit 2</figcaption></figure><p id="e691" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">This revised modeling approach seems to be a substantial improvement. By specifically accounting for the higher probability of zero counts (~75%) in the contralateral hemisphere, the model now aligns more closely with both the observed data and our scientific knowledge. This adjustment not only reflects the expected lower cell activity in this region but also enhances the precision of our estimates. With these changes, the model now offers a more nuanced interpretation of cellular dynamics post-injury. Let’s see the summary and the TRANSFORMATION FOR THE <code class="cx py pz qa od b">hu</code> parameters (do not look at the others) to visualize them in a probability scale using the <code class="cx py pz qa od b">logit2prob</code> <a class="af nf" href="https://sebastiansauer.github.io/convert_logit2prob/" rel="noopener ugc nofollow" target="_blank">function</a> we created at the beginning.</p><pre class="mp mq mr ms mt oc od oe bp of bb bk"><span id="c9d5" class="og oh fr od b bg oi oj l ok ol">logit2prob(fixef(Hurdle_Fit2))</span></pre><figure class="mp mq mr ms mt mu mm mn paragraph-image"><div role="button" tabindex="0" class="mv mw ed mx bh my"><div class="mm mn qv"><img src="../Images/eab8d96043a26084cf01440fb870ea1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KE5BD5Ee-3ele6isTHFYrw.png"/></div></div></figure><p id="6836" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">Although the estimates for the number of cells are similar, the <code class="cx py pz qa od b">hu</code> parameters (in the logit scale) tells us that the probability for seeing zeros in the contralateral hemisphere is:</p><figure class="mp mq mr ms mt mu mm mn paragraph-image"><div class="mm mn qw"><img src="../Images/64254e6b3d45eb207beacb2df19b24aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:926/format:webp/1*52aebjEMY3ivfdXYf-kw2A.png"/></div></figure><p id="c6a3" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">Conversely:</p><figure class="mp mq mr ms mt mu mm mn paragraph-image"><div class="mm mn qx"><img src="../Images/835e1ce50dbb7ba0c7e6563d5a4cf441.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*YFRI8jMDEw6_9JubzIU6Sg.png"/></div></figure><p id="f235" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">Depicts a drastic reduction to about 0.23% probability of observing zero cell counts in the injured (ipsilateral) hemisphere. This is a remarkable change in our estimates.</p><p id="dce6" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">Now, let’s explore if a <code class="cx py pz qa od b">zero_inflated_poisson()</code> distribution family changes these insights.</p></div></div></div><div class="ab cb om on oo op" role="separator"><span class="oq by bm or os ot"/><span class="oq by bm or os ot"/><span class="oq by bm or os"/></div><div class="fk fl fm fn fo"><div class="ab cb"><div class="ci bh ew ex ey ez"><h1 id="21d7" class="ou oh fr bf ov ow ox gr oy oz pa gu pb pc pd pe pf pg ph pi pj pk pl pm pn po bk">Fitting a zero-inflated Poisson model</h1><p id="cdc5" class="pw-post-body-paragraph ng nh fr ni b gp pp nk nl gs pq nn no np pr nr ns nt ps nv nw nx pt nz oa ob fk bk">As we modeled the broad variations in cell counts between the ipsilateral and contralateral hemispheres using the <code class="cx py pz qa od b">hu</code> parameter, we’ll fit as well these two parts of the model in our <code class="cx py pz qa od b">zero_inflated_poisson()</code>. Here, the count part of the model uses a “log” link, and the excess of zeros is modeled with a “logit” link. These are linked functions associated to the distribution family that we’ll not discuss here.</p><pre class="mp mq mr ms mt oc od oe bp of bb bk"><span id="1ca9" class="og oh fr od b bg oi oj l ok ol">Inflated_mdl1 &lt;- bf(Cells ~ Hemisphere,<br/>                    zi ~ Hemisphere)<br/><br/>Inflated_Fit1 &lt;- brm(<br/>           formula = Inflated_mdl1, <br/>           data = Svz_data, <br/>           family = zero_inflated_poisson(),<br/>           # seed for reproducibility purposes<br/>           seed = 8807,<br/>           control = list(adapt_delta = 0.99),<br/>           # this is to save the model in my laptop<br/>           file    = "Models/2024-04-19_CountsZeroInflated/Inflated_Fit.rds",<br/>           file_refit = "never")<br/><br/># Add loo for model comparison<br/>Inflated_Fit1 &lt;- <br/>  add_criterion(Inflated_Fit1, c("loo", "waic", "bayes_R2"))</span></pre><p id="b648" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">Before we look at the results, let’s do some basic diagnostics to compare the observations and the model predictions.</p><pre class="mp mq mr ms mt oc od oe bp of bb bk"><span id="6fda" class="og oh fr od b bg oi oj l ok ol">set.seed(8807)<br/><br/>pp_check(Inflated_Fit1, ndraws = 100) +<br/>  labs(title = "Zero-inflated regression") +<br/>  theme_classic()</span></pre><figure class="mp mq mr ms mt mu mm mn paragraph-image"><div role="button" tabindex="0" class="mv mw ed mx bh my"><div class="mm mn px"><img src="../Images/48058f3c848ad77b1ad76deb3726e23a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aMHjislfdflC0JqtmuBX7g.png"/></div></div><figcaption class="na nb nc mm mn nd ne bf b bg z dx">Figure 8: Model diagnostics for the zero-inflated regression</figcaption></figure><p id="08e4" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">From <a class="af nf" href="#fig-ZeroInflatedDiag1" rel="noopener ugc nofollow">Figure 8</a>, we can see that the predictions deviate from the observed data in a similar way to the hurdle model. So, we have no major changes up to this point.</p><p id="d44a" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">Let’s see the numerical results:</p><pre class="mp mq mr ms mt oc od oe bp of bb bk"><span id="b576" class="og oh fr od b bg oi oj l ok ol">logit2prob(fixef(Inflated_Fit1))</span></pre><p id="fa3b" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">Here, we do see tiny changes in the estimates. The estimate for the number of cells is similar with small changes in the credible intervals. Otherwise, the parameter for the number of zeros seems to experience a larger shift. Let’s see if this has any effect on our conclusions:</p><figure class="mp mq mr ms mt mu mm mn paragraph-image"><div class="mm mn qy"><img src="../Images/b0441637655fcc4cf8ea62529c43f93c.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*Uy9Zn0iqBInxWK6pB5Z03g.png"/></div></figure><p id="1d19" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">Indicates that there is approximately a 77% probability of observing zero counts in the reference hemisphere. Now, for the injured hemisphere, we have:</p><figure class="mp mq mr ms mt mu mm mn paragraph-image"><div class="mm mn qz"><img src="../Images/933eaff53d574b13b9cc95a322868a03.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/format:webp/1*UzbOpnLD5J15Onp3Of8u-A.png"/></div></figure><p id="6745" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">Again, this signals a drastic reduction in observing zero cell counts in the injured (ipsilateral) hemisphere. Evaluating the results using scientific knowledge, I would say that both models provide similarly sound predictions. The graphical results for our <code class="cx py pz qa od b">zero_inflated_poisson</code> model are as follows:</p><pre class="mp mq mr ms mt oc od oe bp of bb bk"><span id="7135" class="og oh fr od b bg oi oj l ok ol">Inflated_CE &lt;- <br/>  conditional_effects(Inflated_Fit1)<br/><br/>Inflated_CE &lt;- plot(Inflated_CE, <br/>       plot = FALSE)[[1]]<br/><br/>Inflated_Com &lt;- Inflated_CE + <br/>  Plot_theme +<br/>  theme(legend.position = "bottom", legend.direction = "horizontal")<br/><br/><br/>Inflated_CE_zi &lt;- <br/>  conditional_effects(Inflated_Fit1, dpar = "zi")<br/><br/>Inflated_CE_zi &lt;- plot(Inflated_CE_zi, <br/>       plot = FALSE)[[1]]<br/><br/>Inflated_zi &lt;- Inflated_CE_zi + <br/>  Plot_theme +<br/>  theme(legend.position = "bottom", legend.direction = "horizontal")<br/><br/>Inflated_Com | Inflated_zi</span></pre><figure class="mp mq mr ms mt mu mm mn paragraph-image"><div role="button" tabindex="0" class="mv mw ed mx bh my"><div class="mm mn px"><img src="../Images/c63a4acd4ca85e86eed8b6ebb4db3f29.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lCk3vhfbxowN03otMWkb5w.png"/></div></div><figcaption class="na nb nc mm mn nd ne bf b bg z dx">Figure 9: Conditional effects for the Inflated fit</figcaption></figure><p id="13d0" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">The results seem analogous to those of the hurdle model. However, we can observe that the estimates for the probability of 0 in the contralateral hemisphere is more restrictive for the <code class="cx py pz qa od b">zero_inflated_poisson</code>. The reason is, as I explained at the beginning, that the zero-inflated model locates a larger probability of zeros than the <code class="cx py pz qa od b">hurdle_poisson</code> distribution. Let’s compare the models to finish this post.</p></div></div></div><div class="ab cb om on oo op" role="separator"><span class="oq by bm or os ot"/><span class="oq by bm or os ot"/><span class="oq by bm or os"/></div><div class="fk fl fm fn fo"><div class="ab cb"><div class="ci bh ew ex ey ez"><h1 id="2200" class="ou oh fr bf ov ow ox gr oy oz pa gu pb pc pd pe pf pg ph pi pj pk pl pm pn po bk">Model comparison</h1><p id="45f3" class="pw-post-body-paragraph ng nh fr ni b gp pp nk nl gs pq nn no np pr nr ns nt ps nv nw nx pt nz oa ob fk bk">We carry out leave-one-out cross-validation using the the <code class="cx py pz qa od b">loo</code> package (<a class="af nf" href="#ref-loo" rel="noopener ugc nofollow"><em class="pu">4</em></a>, <a class="af nf" href="#ref-vehtari2016" rel="noopener ugc nofollow"><em class="pu">5</em></a>). WAIC (<a class="af nf" href="#ref-gelman2013" rel="noopener ugc nofollow"><em class="pu">6</em></a>) is another approach you can explore in <a class="af nf" href="https://medium.com/towards-data-science/do-not-over-think-about-outliers-use-a-student-t-distribution-instead-b6c584b91d5c" rel="noopener">this</a> post.</p><pre class="mp mq mr ms mt oc od oe bp of bb bk"><span id="cf5f" class="og oh fr od b bg oi oj l ok ol">loo(Hurdle_Fit2, Inflated_Fit1)</span></pre><figure class="mp mq mr ms mt mu mm mn paragraph-image"><div class="mm mn ra"><img src="../Images/f76a5e8c28e127995d0b6817b7b7c593.png" data-original-src="https://miro.medium.com/v2/resize:fit:1006/format:webp/1*RKilHD3F4xdngeXEtksu_A.png"/></div></figure><p id="af8b" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">Even though if our model predictions are alike, the “pareto-k-diagnostic” indicates that the <code class="cx py pz qa od b">hurdle_poisson</code> model has 1 <code class="cx py pz qa od b">very bad</code> value, whereas this value shifts to <code class="cx py pz qa od b">bad</code> in the <code class="cx py pz qa od b">zero_inflated_poisson()</code>. I judge that this “bad and very bad” value may be a product of the extreme observation that we see as a black dot in the contralateral count in <a class="af nf" href="#fig-EDA" rel="noopener ugc nofollow">Figure 2</a>. We could fit another model excluding this value and re-evaluate the results. However, this procedure would only aim to evaluate the effect of this extreme observation and inform the audience of a possible bias in the estimates (which should be fully reported). This is a thorough and transparent way to interpret the data. I wrote another <a class="af nf" href="https://medium.com/towards-data-science/do-not-over-think-about-outliers-use-a-student-t-distribution-instead-b6c584b91d5c" rel="noopener">post</a> concerning extreme values that may be of interest to you.</p><p id="855f" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">I conclude that the modeling performed in this post is a more appropriate approach than a naive linear model based on a Gaussian distribution. It is an ethical and professional responsibility of scientists to use the most appropriate statistical modeling tools available. Fortunately, <code class="cx py pz qa od b">brms</code> exists!</p><p id="0121" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">I would appreciate your comments or feedback letting me know if this journey was useful to you. If you want more quality content on data science and other topics, you might consider becoming a <a class="af nf" href="https://medium.com/membership" rel="noopener">medium member</a>.</p><p id="4c14" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">In the future, you can find an updated version of this post on my <a class="af nf" href="https://github.com/daniel-manrique/MediumBlog/blob/main/2024-04-19_CountsZeroInflated.qmd" rel="noopener ugc nofollow" target="_blank">GitHub site</a>.</p><ul class=""><li id="902f" class="ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob rb rc rd bk">All images, unless otherwise stated, were generated using the displayed R code.</li></ul><h1 id="a2fd" class="ou oh fr bf ov ow re gr oy oz rf gu pb pc rg pe pf pg rh pi pj pk ri pm pn po bk">References</h1><p id="34dc" class="pw-post-body-paragraph ng nh fr ni b gp pp nk nl gs pq nn no np pr nr ns nt ps nv nw nx pt nz oa ob fk bk">1.I. Baraibar, M. Roman, M. Rodríguez-Remírez, I. López, A. Vilalta, E. Guruceaga, M. Ecay, M. Collantes, T. Lozano, D. Alignani, A. Puyalto, A. Oliver, S. Ortiz-Espinosa, H. Moreno, M. Torregrosa, C. Rolfo, C. Caglevic, D. García-Ros, M. Villalba-Esparza, C. De Andrea, S. Vicent, R. Pío, J. J. Lasarte, A. Calvo, D. Ajona, I. Gil-Bazo, <a class="af nf" href="https://doi.org/10.3390/cancers12113169" rel="noopener ugc nofollow" target="_blank">Id1 and PD-1 Combined Blockade Impairs Tumor Growth and Survival of KRAS-mutant Lung Cancer by Stimulating PD-L1 Expression and Tumor Infiltrating CD8+ T Cells</a>. <em class="pu">Cancers</em>. <strong class="ni fs">12</strong>, 3169 (2020).</p><p id="7263" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">2. M. Kay, <em class="pu">tidybayes: Tidy data and geoms for Bayesian models</em> (2023; <a class="af nf" href="http://mjskay.github.io/tidybayes/" rel="noopener ugc nofollow" target="_blank">http://mjskay.github.io/tidybayes/</a>).</p><p id="5d74" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">3. C. X. Feng, A comparison of zero-inflated and hurdle models for modeling zero-inflated count data. <em class="pu">Journal of Statistical Distributions and Applications</em>. <strong class="ni fs">8</strong> (2021), doi:<a class="af nf" href="https://doi.org/10.1186/s40488-021-00121-4" rel="noopener ugc nofollow" target="_blank">10.1186/s40488–021–00121–4</a>.</p><p id="03fc" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">4. A. Vehtari, J. Gabry, M. Magnusson, Y. Yao, P.-C. Bürkner, T. Paananen, A. Gelman, Loo: Efficient leave-one-out cross-validation and WAIC for bayesian models (2022) (available at <a class="af nf" href="https://mc-stan.org/loo/" rel="noopener ugc nofollow" target="_blank">https://mc-stan.org/loo/</a>).</p><p id="f53d" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">5. A. Vehtari, A. Gelman, J. Gabry, <a class="af nf" href="https://doi.org/10.1007/s11222-016-9696-4" rel="noopener ugc nofollow" target="_blank">Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC</a>. <em class="pu">Statistics and Computing</em>. <strong class="ni fs">27</strong>, 1413–1432 (2016).</p><p id="5d72" class="pw-post-body-paragraph ng nh fr ni b gp nj nk nl gs nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob fk bk">6. A. Gelman, J. Hwang, A. Vehtari, <a class="af nf" href="https://doi.org/10.1007/s11222-013-9416-2" rel="noopener ugc nofollow" target="_blank">Understanding predictive information criteria for Bayesian models</a>. <em class="pu">Statistics and Computing</em>. <strong class="ni fs">24</strong>, 997–1016 (2013).</p></div></div></div></div>    
</body>
</html>