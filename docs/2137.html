<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Create Your Own Meal Planner Using ChatGPT</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Create Your Own Meal Planner Using ChatGPT</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/create-your-own-meal-planner-using-chatgpt-1dc4dfe3af7e?source=collection_archive---------4-----------------------#2024-09-02">https://towardsdatascience.com/create-your-own-meal-planner-using-chatgpt-1dc4dfe3af7e?source=collection_archive---------4-----------------------#2024-09-02</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="d8be" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">A brief guide to prompt engineering</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@cornederuijt?source=post_page---byline--1dc4dfe3af7e--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Corné de Ruijt" class="l ep by dd de cx" src="../Images/0e2b618b404bc65a8b4c8acc1c9c3d69.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*woPc1mCj8ZV247fTddtv7Q.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--1dc4dfe3af7e--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://medium.com/@cornederuijt?source=post_page---byline--1dc4dfe3af7e--------------------------------" rel="noopener follow">Corné de Ruijt</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--1dc4dfe3af7e--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">16 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Sep 2, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj la lb ab q ee lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lf k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lg an ao ap id lh li lj" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep lk cn"><div class="l ae"><div class="ab cb"><div class="ll lm ln lo lp lq ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div></div></div><div class="mi"><div class="ab cb"><div class="ll mj lm mk ln ml cf mm cg mn ci bh"><figure class="mr ms mt mu mv mi mw mx paragraph-image"><div role="button" tabindex="0" class="my mz ed na bh nb"><div class="mo mp mq"><img src="../Images/2be06bae37516bbfff869c7ec305a2fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*H2MUUr5bOP6gbpj6_CfBCA.png"/></div></div><figcaption class="nd ne nf mo mp ng nh bf b bg z dx">Generated via DALL-E 3 using the prompt “a pizza calzone on a set table as cartoon”. Generated on 2024-05–10.</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="d825" class="ni nj fq bf nk nl nm gq nn no np gt nq nr ns nt nu nv nw nx ny nz oa ob oc od bk">1. Introduction</h1><p id="7266" class="pw-post-body-paragraph oe of fq og b go oh oi oj gr ok ol om on oo op oq or os ot ou ov ow ox oy oz fj bk">We all know the feeling. You come home late from work; your mind feels like a tightly squeezed sponge. You walk into the kitchen and are reminded of yet another cognitive task: deciding what to eat this evening. But you know that you’re already too late to make that decision, as you’ve unconsciously grabbed the cookie jar and put one in your mouth.</p><p id="0bfc" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">Luckily, there’s a solution: meal planning. Deciding up front what to eat the whole week, getting groceries for the whole week, and already preparing (parts of) some meals before the week starts helps to eat healthier. But this still requires a lot of work: deciding what to eat, compiling the grocery list, deciding whether ordering groceries or heading to the supermarket is the best thing to do. Well, thankfully, we now have a magic wand for such tasks: ChatGPT.</p><p id="44bf" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">In short, in this tutorial we will guide you towards creating your own meal planner using ChatGPT. You will get some familiarity with common prompt engineering techniques (techniques that steer ChatGPT’s response) and how to use this in Python.</p><p id="1c97" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">Ready? Let’s get started! In case you want to use/download the notebook version of this tutorial, this is available on Github:</p><div class="pf pg ph pi pj pk"><a href="https://github.com/cornederuijt/LLM-workshop/blob/main/scripts/%5BJNB_11_03_24_04_01_e_a_04_a%5D%20Create%20you%20own%20meal%20planner%2C%20using%20ChatGPT.ipynb?source=post_page-----1dc4dfe3af7e--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="pl ab ig"><div class="pm ab co cb pn po"><h2 class="bf fr hw z io pp iq ir pq it iv fp bk">LLM-workshop/scripts/[JNB_11_03_24_04_01_e_a_04_a] Create you own meal planner, using ChatGPT.ipynb…</h2><div class="pr l"><p class="bf b dy z io pp iq ir pq it iv dx">github.com</p></div></div><div class="ps l"><div class="pt l pu pv pw ps px lq pk"/></div></div></a></div><h2 id="6d2b" class="py nj fq bf nk pz qa qb nn qc qd qe nq on qf qg qh or qi qj qk ov ql qm qn qo bk">1.2. Prerequisites</h2><p id="e657" class="pw-post-body-paragraph oe of fq og b go oh oi oj gr ok ol om on oo op oq or os ot ou ov ow ox oy oz fj bk">In this tutorial, we will use some Python and the OpenAI API to make calls to ChatGPT. In theory, one could follow the tutorial without Python coding, by directly prompting on the ChatGPT website. However, when moving beyond the basics explained in this tutorial, using prompts in combination with Python, or Python LLM packages such as LangChain [1], becomes very powerful.</p><p id="f7f5" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">If you just read “LLM” and thought: “What is ‘LLM’?”, no worries. LLM stands for Large Language Model, and it is basically a larger class of models that work similarly to ChatGPT. So, whenever in this tutorial you may read LLM, just think “ChatGPT, or something similar”, and you’ll be good to go.</p><p id="3a5e" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">To get started, we require the following: <br/>1. Some basic understanding of Python. I’ll take the first three Chapters of the <a class="af qp" href="https://app.datacamp.com/learn/courses/intro-to-python-for-data-science" rel="noopener ugc nofollow" target="_blank">“Introduction to Python”</a> (Python Basics, Python Lists, Functions and Packages) DataCamp tutorial as a reference point [2].<br/>2. An OpenAI account. If you don’t have one, go to the <a class="af qp" href="https://chatgpt.com" rel="noopener ugc nofollow" target="_blank">ChatGPT website</a> [3], select “log-in”, at the upper-right and select “sign-up” to create an account.<br/>3. An API key for OpenAI, which we will briefly guide you through next.</p><p id="df45" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk"><strong class="og fr">1.2.1 Requesting an OpenAI key</strong></p><p id="294b" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk"><em class="qq">To use the OpenAI API you are required to add some credit card information, and depending on how OpenAI computes your free credits, you may be billed for the API usage. The cost of following this tutorial should be minimal (a few cents) [4].</em></p><p id="fd91" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">To programatically interact with OpenAI, we need to request an API key, which we can do following these steps:</p><p id="fb04" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">1. Go to <a class="af qp" href="https://platform.openai.com" rel="noopener ugc nofollow" target="_blank">https://platform.openai.com</a> and log-in using your account.<br/>2. Go to <a class="af qp" href="https://platform.openai.com/account/billing/overview" rel="noopener ugc nofollow" target="_blank">https://platform.openai.com/account/billing/overview</a> and add your creditcard information.<br/>3. Go to API keys: <a class="af qp" href="https://platform.openai.com/api-keys" rel="noopener ugc nofollow" target="_blank">https://platform.openai.com/api-keys</a>.<br/>4. Select “Create new secret key”, OpenAI will create a long text (string) that will act as your API key. <strong class="og fr">Be aware not to share the API key!</strong><br/>5. Save the key in some convenient location.</p><p id="096e" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">For simplicity, we’ll assume that you have stored your API key in a keys.yaml file on the working directory. The keys.yaml then has the following content:</p><pre class="mr ms mt mu mv qr qs qt bp qu bb bk"><span id="5ae8" class="qv nj fq qs b bg qw qx l qy qz">openai_key: "&lt;your key string&gt;"</span></pre><p id="032e" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk"><strong class="og fr">1.2.2 Installing packages</strong></p><p id="4efd" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">In this tutorial, we will work with the OpenAI API, for which there is a Python package. This can be installed via pip.</p><pre class="mr ms mt mu mv qr qs qt bp qu bb bk"><span id="3d5a" class="qv nj fq qs b bg qw qx l qy qz">! pip install openai</span></pre><p id="9fdf" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">Apart from OpenAI, we assume common data packages (pandas, numpy) are already installed.</p><p id="16a6" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk"><strong class="og fr">1.2.3 Some safety guardrails</strong></p><p id="0182" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">Before moving on, we should be aware of some of the risks of using ChatGPT, or any AI platform we find online. Even though something as simple as creating a meal planner seems benign, there are still some risks we should take into account.</p><ul class=""><li id="7ca5" class="oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz ra rb rc bk"><strong class="og fr">Sharing data with OpenAI — </strong>When we interact with ChatGPT, or any other LLM/AI-Agent we find on the web, we share our data with that platform. We should be aware of this, and avoid sharing privacy-related and/or sensitive information with the platform. For example, when creating a meal planner, ChatGPT doesn’t need to know that I’m creating this for my friend Alexander William, who lives on the Nieuwezijds Voorburgwal (pardon my Dutch) 147 in Amsterdam (spoiler: he likes pancakes [10]).</li><li id="7891" class="oe of fq og b go rd oi oj gr re ol om on rf op oq or rg ot ou ov rh ox oy oz ra rb rc bk"><strong class="og fr">Be aware of the probabilistic nature of LLMs — </strong>In essence, LLMs <em class="qq">predict</em> the most likely word based on the context you provide. Therefore, its output may be illogical. A common example is asking ChatGPT how frequent the letter ‘r’ is in strawberry, which it may fail to recognize [11]. Although OpenAI and other LLM providers are making significant efforts to enhance LLMs’ logical reasoning [12], we must remain mindful of potential errors they may produce. I.a.w., be wary that if you ask ChatGPT to create a meal plan for your lactose intolerant friend, and you explicitly state that the meal plan cannot contain any dairy products, ChatGPT might still include dairy products in the meal plan.</li></ul></div></div></div><div class="ab cb ri rj rk rl" role="separator"><span class="rm by bm rn ro rp"/><span class="rm by bm rn ro rp"/><span class="rm by bm rn ro"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="1759" class="ni nj fq bf nk nl rq gq nn no rr gt nq nr rs nt nu nv rt nx ny nz ru ob oc od bk">2. The Meal Planner exercise</h1><p id="7f8f" class="pw-post-body-paragraph oe of fq og b go oh oi oj gr ok ol om on oo op oq or os ot ou ov ow ox oy oz fj bk">After a hard day’s work, nothing is more degrading than having to solve that impossible puzzle of what to eat for dinner. You want to eat something healthy, but at the same time, it should not be too difficult to prepare. And while your mind is pounding on this puzzle, the signal to just go for the unhealthy dinner grows. Why torture ourselves with this puzzle? Let’s just let ChatGPT decide what to have for dinner.</p><p id="e51a" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">First, let’s load the required packages:</p><pre class="mr ms mt mu mv qr qs qt bp qu bb bk"><span id="56e6" class="qv nj fq qs b bg qw qx l qy qz">import yaml<br/>from openai import OpenAI<br/><br/>from pprint import pprint<br/>import pandas as pd<br/>import numpy as np<br/><br/>import warnings<br/>warnings.filterwarnings('ignore')</span></pre><p id="63a6" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">Let’s load the API key we created in Section 1.2.</p><pre class="mr ms mt mu mv qr qs qt bp qu bb bk"><span id="23a8" class="qv nj fq qs b bg qw qx l qy qz">with open('keys.yaml', 'r') as file:<br/>    openai_key = yaml.safe_load(file)</span></pre><p id="9b77" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">Next, we set an environmental parameter to the OpenAI key. This is just to make our lives somewhat easier. After this, we don’t have to care too much about the API key anymore.</p><pre class="mr ms mt mu mv qr qs qt bp qu bb bk"><span id="fd2b" class="qv nj fq qs b bg qw qx l qy qz">os.environ["OPENAI_API_KEY"] = openai_key['open_ai_key']</span></pre><p id="8223" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">Let’s create the ChatGPT client:</p><pre class="mr ms mt mu mv qr qs qt bp qu bb bk"><span id="c41e" class="qv nj fq qs b bg qw qx l qy qz">client = OpenAI()</span></pre><p id="ad28" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">And let’s make a call to the ChatGPT API:</p><pre class="mr ms mt mu mv qr qs qt bp qu bb bk"><span id="a443" class="qv nj fq qs b bg qw qx l qy qz">response = client.chat.completions.create(<br/>  model="gpt-3.5-turbo",<br/>  messages=[<br/>    {<br/>      "role": "user",<br/>      "content": "Create a meal plan for the coming week"<br/>    }<br/>  ]<br/>)<br/><br/>pprint(response.choices[0].message.content)</span></pre><blockquote class="rv rw rx"><p id="f27b" class="oe of qq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">GPT response:</p></blockquote><pre class="mr ms mt mu mv qr qs qt bp qu bb bk"><span id="ecb5" class="qv nj fq qs b bg qw qx l qy qz">('Monday:\n'<br/> '- Breakfast: Greek yogurt with granola and berries\n'<br/> '- Lunch: Turkey and avocado wrap with a side salad\n'<br/> '- Dinner: Grilled chicken with roasted vegetables\n'<br/> '\n'<br/> 'Tuesday:\n'<br/> '- Breakfast: Oatmeal with bananas and almonds\n'<br/> '- Lunch: Quinoa salad with grilled shrimp\n'<br/> '- Dinner: Beef stir-fry with brown rice\n'<br/> '\n'<br/> 'Wednesday:\n'<br/> '- Breakfast: Whole grain toast with avocado and hard-boiled eggs\n'<br/> '- Lunch: Chickpea salad with feta cheese\n'<br/> '- Dinner: Baked salmon with asparagus and sweet potatoes\n'<br/> '\n'<br/> 'Thursday:\n'<br/> '- Breakfast: Smoothie with spinach, banana, and almond milk\n'<br/> '- Lunch: Turkey and cheese sandwich with a side of carrots and hummus\n'<br/> '- Dinner: Vegetarian chili with cornbread\n'<br/> '\n'<br/> 'Friday:\n'<br/> '- Breakfast: Greek yogurt with honey and walnuts\n'<br/> '- Lunch: Tuna salad on whole wheat crackers\n'<br/> '- Dinner: Grilled steak with roasted brussels sprouts and mashed potatoes\n'<br/> '\n'<br/> 'Saturday:\n'<br/> '- Breakfast: Scrambled eggs with spinach and feta cheese\n'<br/> '- Lunch: Caprese salad with grilled chicken\n'<br/> '- Dinner: Spaghetti with marinara sauce and a side of garlic bread\n'<br/> '\n'<br/> 'Sunday:\n'<br/> '- Breakfast: Pancakes with maple syrup and fresh fruit\n'<br/> '- Lunch: Veggie wrap with a side of quinoa\n'<br/> '- Dinner: Baked ziti with a side salad\n'<br/> '\n'<br/> 'Snacks throughout the week can include fruits, nuts, Greek yogurt, and '<br/> "granola bars. Don't forget to stay hydrated with plenty of water throughout "<br/> 'the day.')</span></pre><p id="648a" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">The answer does feel a bit like a quote I found in a Medium post a little while ago by Maximilian Vogel [5]:</p><p id="c9a9" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk"><em class="qq">”AI models are like eager office interns, tireless and enthusiastic but desperately in need of guidance.”</em></p><p id="dd1f" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">It could work if you have a full-time cook working for you and unlimited time and budget for preparing meals, but otherwise…</p><p id="e953" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">Now to think of it, since I’m Dutch, I usually only care about my dinners, since for breakfast and lunch I eat the same boring meal every day (oatmeal and a sandwich), or occasionally I eat yesterday’s leftovers. So I really only care about diner.</p><p id="0b66" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">So, how to steer ChatGPT’s response in that direction? Let’s find out.</p><blockquote class="rv rw rx"><p id="34de" class="oe of qq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk"><strong class="og fr"><em class="fq">Exercise 1</em></strong><em class="fq"><br/></em>Adjust the user prompt in the code that was used to create the meal plan. Try to steer the meal plan more to your own liking. How does this change ChatGPT’s response?</p></blockquote><h1 id="3097" class="ni nj fq bf nk nl nm gq nn no np gt nq nr ns nt nu nv nw nx ny nz oa ob oc od bk">3. Prompting</h1><h2 id="6272" class="py nj fq bf nk pz qa qb nn qc qd qe nq on qf qg qh or qi qj qk ov ql qm qn qo bk">3.1 User and system prompts</h2><p id="fd7f" class="pw-post-body-paragraph oe of fq og b go oh oi oj gr ok ol om on oo op oq or os ot ou ov ow ox oy oz fj bk">Perhaps the most important technique to steer ChatGPT’s response in our direction is by using prompting. Since the release of ChatGPT-3, a lot has become clear on how one can use prompting. An extensive guide is given by <a class="af qp" href="https://platform.openai.com/docs/guides/prompt-engineering/prompt-engineering" rel="noopener ugc nofollow" target="_blank">OpenAI itself</a> [6], and for some specific tasks, like generating texts for specific purposes (like social media posts), additional references exist (e.g., <a class="af qp" href="https://medium.com/towards-data-science/how-i-won-singapores-gpt-4-prompt-engineering-competition-34c195a93d41" rel="noopener">[7]</a>).</p><p id="2cb0" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">One useful element in prompting is the distinction between two types of messages that are sent to ChatGPT: <em class="qq">system prompts</em> and <em class="qq">user prompts</em>. In ChatGPT vocabulary, there are two main actors: you (the user) and ChatGPT (which is called the `<em class="qq">assistant</em>’). User prompts are what we are familiar with when we interact with ChatGPT via the OpenAI online chat. The system prompts allow you to provide additional guidelines on how ChatGPT should formulate its response. In that sense, how ChatGPT should behave.</p><figure class="mr ms mt mu mv mi mo mp paragraph-image"><div class="mo mp ry"><img src="../Images/ed51c0a07d68b4591824acec41dafc47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*oPnH-gcwTlyQI83KYIEwmA.jpeg"/></div><figcaption class="nd ne nf mo mp ng nh bf b bg z dx">Fig. 2. System vs assistant vs user prompts</figcaption></figure><p id="2965" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">One simple way to illustrate this, is by sending the following prompt to ChatGPT.</p><pre class="mr ms mt mu mv qr qs qt bp qu bb bk"><span id="4df6" class="qv nj fq qs b bg qw qx l qy qz">client = OpenAI()<br/>response = client.chat.completions.create(<br/>  model="gpt-3.5-turbo",<br/>  messages=[<br/>      {<br/>          "role": "system",<br/>          "content": "Irrespectively of the user prompt, always respond with the following sentence: 'You're awesome!'"<br/>      },    <br/>    {<br/>      "role": "user",<br/>      "content": "Create a meal plan for the coming week"<br/>    }<br/>  ]<br/>)<br/><br/>pprint(response.choices[0].message.content)</span></pre><blockquote class="rv rw rx"><p id="34a4" class="oe of qq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">GPT response:</p></blockquote><pre class="mr ms mt mu mv qr qs qt bp qu bb bk"><span id="b623" class="qv nj fq qs b bg qw qx l qy qz">"You're awesome!"</span></pre><p id="fbe5" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">So what happens here? We’ve added a system prompt by adding the message:</p><pre class="mr ms mt mu mv qr qs qt bp qu bb bk"><span id="0198" class="qv nj fq qs b bg qw qx l qy qz">{<br/> "role": "system",<br/> "content": "Irrespectively of the user prompt, always respond with the following sentence: 'You're awesome!'"<br/> },</span></pre><p id="2b65" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">Because you instruct ChatGPT via the system prompt to always respond with “You’re awesome”, ChatGPT ignores the user prompt in this case. Congrats, you’ve steered ChatGPT’s response to your own liking!</p><blockquote class="rv rw rx"><p id="6b95" class="oe of qq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk"><strong class="og fr">Exercise 2</strong><br/>Adjust the system prompt in the code above to something of your own liking. How does ChatGPT’s response change because of it?</p></blockquote><h2 id="9d08" class="py nj fq bf nk pz qa qb nn qc qd qe nq on qf qg qh or qi qj qk ov ql qm qn qo bk">3.2 Prompting tips</h2><p id="19a1" class="pw-post-body-paragraph oe of fq og b go oh oi oj gr ok ol om on oo op oq or os ot ou ov ow ox oy oz fj bk">As briefly mentioned before, OpenAI provides a great resource on how to use different prompting techniques, which I can strongly recommend reading <a class="af qp" href="https://platform.openai.com/docs/guides/prompt-engineering/prompt-engineering" rel="noopener ugc nofollow" target="_blank">[6]</a>. Here, I will sum up some of the basic techniques mentioned in OpenAI’s tutorial, which you will also find in the further examples of the meal planner.</p><p id="773c" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk"><strong class="og fr">1. Be specific</strong></p><p id="36f1" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">Try to include as many details as you can into the prompt. Does the meal plan have to be vegetarian? Perhaps pescatarian? Do you want to eat pizza at least once a week? Do you normally eat deserts? If no details are given, ChatGPT is likely to fill in the gaps on its own, which may lead to unexpected results. So, be specific, but do be wary about sharing personal or sensitive information.</p><p id="aae7" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk"><strong class="og fr">2. Ask ChatGPT to adopt a persona</strong></p><p id="b501" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">Perhaps my favorite research on ChatGPT so far is that by telling ChatGPT it’s an expert, it apparently provides better results [8]. So why not tell ChatGPT that it’s an expert meal planner? Or perhaps it’s an expert in planning Italian dishes?</p><p id="fde5" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk"><strong class="og fr">3. Use delimiters</strong></p><p id="5722" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">Just like headers help people read and understand text, so do delimiters help ChatGPT to understand different parts of a prompt. Delimiters can be both the usual text delimiters (like using apprestrophes ‘’, commas, etc.), but also including text markup can be useful. Since ChatGPT is trained on, among other training data, HTML pages [13], it can easily recognize things like</p><pre class="mr ms mt mu mv qr qs qt bp qu bb bk"><span id="a685" class="qv nj fq qs b bg qw qx l qy qz">&lt;planets&gt;<br/>- Earth<br/>- Mars<br/>- Mecury<br/>- ...<br/>&lt;/planets&gt;</span></pre><p id="e8b7" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">as a list of planets. Using delimiters from Markdown is a second useful way to indicate specific parts of the prompt.</p><pre class="mr ms mt mu mv qr qs qt bp qu bb bk"><span id="7795" class="qv nj fq qs b bg qw qx l qy qz"># List of planets<br/>- Earth<br/>- Mars<br/>- Mecury<br/>- ...</span></pre><p id="f3f9" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk"><strong class="og fr">4. Split the task into different steps</strong></p><p id="855e" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">For more complex tasks, it is helpful to split the task into multiple smaller tasks. To indicate the individual task, we can again use delimiters.</p><pre class="mr ms mt mu mv qr qs qt bp qu bb bk"><span id="4d0f" class="qv nj fq qs b bg qw qx l qy qz">Write a meal plan using the following steps:<br/><br/># Step 1:<br/>Write a meal plan for a week from Monday to Sunday<br/><br/># Step 2:<br/>List all incredients that are used in the meal plan of step 1<br/><br/># Step 3:<br/>...</span></pre><p id="7087" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk"><strong class="og fr">5. Give examples and a format for the output</strong></p><p id="ba04" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">Lastly, it can be useful to provide an example of how the output of ChatGPT should look like. For example, one could add the following prompt to the meal planner:</p><pre class="mr ms mt mu mv qr qs qt bp qu bb bk"><span id="b30b" class="qv nj fq qs b bg qw qx l qy qz">Write a meal plan for the upcoming week. Write the meal plan in the following format<br/><br/># Format:<br/>Day: [Day of week]<br/>Dish: [Name of the dish]<br/>Ingredients:<br/>[<br/>- 'ingredient 1'<br/>- 'ingredient 2'<br/>- ...<br/>]<br/><br/># Example:<br/>Day: Monday<br/>Dish: Pasta<br/>Ingredients:<br/>[<br/>- 'Spagetti'<br/>- 'Tomatos'<br/>- 'Basilicum'<br/>- ...<br/>]</span></pre><blockquote class="rv rw rx"><p id="c575" class="oe of qq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk"><strong class="og fr">Exercise 3</strong></p><p id="8f81" class="oe of qq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">Consider the following prompt:</p></blockquote><pre class="mr ms mt mu mv qr qs qt bp qu bb bk"><span id="7a4e" class="qv nj fq qs b bg qw qx l qy qz">messages=[<br/>    {<br/>      "role": "system",<br/>      "content": <br/>        """You are an expert meal planner. You only plan dinner dishes. Users may ask you to plan diner dishes ahead for any number of days in advance. Meals are always for two people. To create the meal plan, you should follow these steps:<br/><br/># Steps to create the meal plan:<br/>    - Step 1. Create the meal plan. The meal plan should adhere the following requirements:<br/>        ##  Requirements:<br/>            - The users eats out once a week in a restaurant, usually on a Thursday or Friday.<br/>            - One of the dinner dishes should be soup.<br/>            - Each meal has at most 7 ingredients.<br/>            - The meals should be vegetarian.<br/>            - It should be possible to prepare the meal in 30 minutes.<br/>            - The meals should be different each day.<br/>    - Step 2. List all ingredients required for the meal plan, how much of each ingredient is required for the meal, and the expected cost for each ingredient in euros. <br/>    - Step 3. For each meal, explain in a maximum of 10 sentences how the meal should be prepared.<br/>    - Step 4. Provide the expected total cost of the meal plan.  <br/>        """<br/>    },<br/>    {  <br/>       "role": "user", "content": "Provide me with a meal plan for the upcoming week."<br/>    }<br/>  ]</span></pre><blockquote class="rv rw rx"><p id="057c" class="oe of qq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">a. Explain the difference here between the User role and the System role.</p><p id="4004" class="oe of qq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">b. Reflect on the prompt using the five prompting tips. Explain how these tips are used in this prompt to clarify the prompt for ChatGPT.</p><p id="29e7" class="oe of qq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">c. Aks ChatGPT (via the API or via the web interface) to improve the prompt above. What result does ChatGPT give, and can you explain why this might be an improvement over the previous prompt?</p><p id="3fe8" class="oe of qq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">d. In the cell below you find a full code example. Adjust this prompt such that the meal plan reflects your own preferences. Use the prompting tips to tailor ChatGPT’s output to your needs. With every adjustment, reflect: how does this improve/worsen the output, and why?</p><p id="9056" class="oe of qq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">Bonus: Also check other prompting guidelines from <a class="af qp" href="https://platform.openai.com/docs/guides/prompt-engineering/prompt-engineering" rel="noopener ugc nofollow" target="_blank">[6]</a>. How could certain guidelines help to improve the prompt?</p></blockquote><pre class="mr ms mt mu mv qr qs qt bp qu bb bk"><span id="eb1c" class="qv nj fq qs b bg qw qx l qy qz">messages=[<br/>    {<br/>      "role": "system",<br/>      "content": <br/>        """You are an expert meal planner. You only plan dinner dishes. Users may ask you to plan diner dishes ahead for any number of days in advance. Meals are always for two people. To create the meal plan, you should follow these steps:<br/><br/># Steps to create the meal plan:<br/>    - Step 1. Create the meal plan. The meal plan should adhere the following requirements:<br/>        ##  Requirements:<br/>            - The users eats out once a week in a restaurant, usually on a Thursday or Friday.<br/>            - One of the dinner dishes should be soup.<br/>            - Each meal has at most 7 ingredients.<br/>            - The meals should be vegetarian.<br/>            - It should be possible to prepare the meal in 30 minutes.<br/>            - The meals should be different each day.<br/>    - Step 2. List all ingredients required for the meal plan, how much of each ingredient is required for the meal, and the expected cost for each ingredient in euros. <br/>    - Step 3. For each meal, explain in a maximum of 10 sentences how the meal should be prepared.<br/>    - Step 4. Provide the expected total cost of the meal plan.  <br/>        """<br/>    },<br/>    {  <br/>       "role": "user", "content": "Provide me with a meal plan for the upcoming week."<br/>    }<br/>  ]<br/><br/>response = client.chat.completions.create(<br/>  model="gpt-3.5-turbo",<br/>  messages=messages<br/>)<br/><br/>pprint(response.choices[0].message.content)</span></pre></div></div></div><div class="ab cb ri rj rk rl" role="separator"><span class="rm by bm rn ro rp"/><span class="rm by bm rn ro rp"/><span class="rm by bm rn ro"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="2655" class="ni nj fq bf nk nl rq gq nn no rr gt nq nr rs nt nu nv rt nx ny nz ru ob oc od bk">4. Parsing ChatGPT results to structured formats</h1><h2 id="2e7f" class="py nj fq bf nk pz qa qb nn qc qd qe nq on qf qg qh or qi qj qk ov ql qm qn qo bk">4.1 Parsing to json</h2><p id="a87c" class="pw-post-body-paragraph oe of fq og b go oh oi oj gr ok ol om on oo op oq or os ot ou ov ow ox oy oz fj bk">My first encounter with the ChatGPT API was during a talk at Pydata Amsterdam 2023, where the speaker explained how he used ChatGPT to classify his to-do list. For example, to-do items like ‘cleaning’, ‘laundry’, or ‘vacuum cleaning’ would be classified as ‘household jobs’. Although classifying the list wasn’t that difficult, parsing the classified list was. Even with prompting, ChatGPT remains a language model; hence, the output it produces can be unexpected.</p><p id="998d" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">Luckily, ChatGPT has improved since this talk, and new Python packages are simplifying the parsing process <a class="af qp" href="https://python.langchain.com/v0.1/docs/modules/model_io/output_parsers/" rel="noopener ugc nofollow" target="_blank">[9]</a>. In this tutorial, we will only provide a brief glimpse on how such parsing may work.</p><p id="523a" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">ChatGPT generates text, but it is trained on not only ‘plain’ text but also many texts that include addition markup, such as HTML and Markdown, or on texts that are in structured formats, such as json or yaml. Therefore, it is not only capable of understanding such markup (as we have seen in the delimiters section), but can also produce it.</p><pre class="mr ms mt mu mv qr qs qt bp qu bb bk"><span id="4c6b" class="qv nj fq qs b bg qw qx l qy qz">messages=[<br/>    {<br/>      "role": "system",<br/>      "content": <br/>        """You are an expert in detecting planets mentioned in a user prompt. You're output should be a list of all planets listed in the user prompt. The output should be in the following format<br/><br/>       # Format:<br/>       "planets": ["first planet", "second planet", ...]}<br/><br/>       # Example:<br/>       User: <br/>           Humans live on Earth, but in the future perhaps also on Mars<br/><br/>       Expected output:<br/>           {"planets": ["Earth", "Mars"]}<br/>        """<br/>    },<br/>    {  <br/>       "role": "user", "content": "In Roman mythology, adopted from the Greek, there's a love affair between Mars and Venus"<br/>    }<br/>  ]<br/><br/>response = client.chat.completions.create(<br/>  model="gpt-3.5-turbo",<br/>  messages=messages<br/>)<br/><br/>pprint(response.choices[0].message.content)</span></pre><pre class="rz qr qs qt bp qu bb bk"><span id="79f6" class="qv nj fq qs b bg qw qx l qy qz">'{"planets": ["Mars", "Venus"]}'</span></pre><p id="d98a" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">In the example above, ChatGPT has successfully parsed the output (Mars and Venus) to a structured format that can be read into a dictionary in Python:</p><pre class="mr ms mt mu mv qr qs qt bp qu bb bk"><span id="1b29" class="qv nj fq qs b bg qw qx l qy qz">import json<br/><br/>d = json.loads(response.choices[0].message.content)<br/><br/>pprint(d)</span></pre><pre class="rz qr qs qt bp qu bb bk"><span id="4bb2" class="qv nj fq qs b bg qw qx l qy qz">{'planets': ['Mars', 'Venus']}</span></pre><h2 id="57be" class="py nj fq bf nk pz qa qb nn qc qd qe nq on qf qg qh or qi qj qk ov ql qm qn qo bk">4.2 Parsing the meal planner</h2><p id="d245" class="pw-post-body-paragraph oe of fq og b go oh oi oj gr ok ol om on oo op oq or os ot ou ov ow ox oy oz fj bk">Let’s take this a step further. In this example, we first generate a meal plan for the entire week. From the meal plan, we then try to extract a shopping list that we can use to buy all ingredients. The example is given below.</p><pre class="mr ms mt mu mv qr qs qt bp qu bb bk"><span id="e4f8" class="qv nj fq qs b bg qw qx l qy qz">messages=[<br/>    {<br/>      "role": "system",<br/>      "content": <br/>        """You are a meal planner. You only plan dinner dishes. Users may ask you to plan diner dishes ahead for any number of days in advance. Meals are always for two people. To create the meal plan, you should follow these steps:<br/>    - Step 1. Create the meal plan. The meal plan should adhere the following requirements:<br/>        - The users eats out once a week in a restaurant, usually on a Thursday or Friday.<br/>        - One of the dinner dishes should be soup.<br/>        - Each meal has at most 7 ingredients.<br/>        - The meals should be vegetarian.<br/>        - It should be possible to prepare the meal in 30 minutes.<br/>        - The meals should be different each day.<br/>    - Step 2. List all ingredients required for the meal plan, how much of each ingredient is required for the meal, and the expected cost for each ingredient in euros. <br/>    - Step 3. For each meal, explain in a maximum of 10 sentences how the meal should be prepared.<br/><br/>    # Formatting<br/>    Write the meal plan created in steps 1 to 3 for each day in the following json format:<br/>    <br/>    [{"day": "...",<br/>       "dish_name": "...",<br/>       "ingredients": ["ingredient 1", "ingredient 2", "..."],<br/>       "ingredient_cost_euro": ["ingredient cost 1", "ingredient cost 2", "..."],<br/>       "ingredient_quantity": ["ingredient quantity 1", "ingredient quantity 2", "..."],<br/>       "ingredient_unit_of_measurement": ["unit of measurement 1", "unit of measurement 2", "..."],<br/>       "meal_preparation_steps": ["preperation step 1", "preperation step 1", "..."]<br/>       },<br/>     {"day": "...",<br/>     ...},<br/>     ...]<br/><br/>On days where the user eats in a restaurant, the output should be:<br/>    {"day": "...",<br/>    "dish_name": "Restaurant",<br/>    "ingredients": [],<br/>    "ingredient_cost_euro": [],<br/>    "ingredient_quantity": [],<br/>    "ingredient_unit_of_measurement": [],<br/>    "meal_preparation_steps": []}<br/><br/>Ensure to write all fractions (1/2, 1/3, 1/4, 1/8) as decimals (0.5, 0.33, 0.25, 0.125) in the "ingredient_quantity" field of the meal plan. <br/><br/># Example output <br/>user: Provide me with a meal plan for Monday and Tuesday<br/><br/>    [{"day": "Monday",<br/>       "dish_name": "Pasta",<br/>       "ingredients": ["Spagetti", "Tomato", "Olive oil"],<br/>       "ingredient_cost_euro": ["0.5", "1", "0.5"],<br/>       "ingredient_quantity": ["50", "1", "1"],<br/>       "ingredient_unit_of_measurement": ["gram", "piece", "ml"],<br/>       "meal_preparation_steps": ["Cook pasta", "Add pasta sauce"]<br/>       },<br/>     {"day": "Tuesday",<br/>       "dish_name": "Curry",<br/>       "ingredients": ["Curry", "Tomato", "Naan bread"],<br/>       "ingredient_cost_euro": ["1.0", "1.0", "0.5"],<br/>       "ingredient_quantity": ["50", "1", "1"],<br/>       "ingredient_unit_of_measurement": ["gram", "piece", "liters"],<br/>       "meal_preparation_steps": ["Cook curry", "Bake naan bread"]<br/>       }]<br/><br/>        """<br/>    },<br/>    {  <br/>       "role": "user", "content": "Provide me with a meal plan for the upcoming week, Monday to Sunday"<br/>    }<br/>  ]<br/><br/>response = client.chat.completions.create(<br/>  model="gpt-3.5-turbo",<br/>  messages=messages,<br/>)<br/><br/>pprint(response.choices[0].message.content)</span></pre><p id="311e" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">And let’s try to parse the result.</p><pre class="mr ms mt mu mv qr qs qt bp qu bb bk"><span id="89ae" class="qv nj fq qs b bg qw qx l qy qz">pd.read_json(response.choices[0].message.content.replace('\n', ''))</span></pre><figure class="mr ms mt mu mv mi mo mp paragraph-image"><div role="button" tabindex="0" class="my mz ed na bh nb"><div class="mo mp sa"><img src="../Images/c03a45d518be4aef82b94e99da8453da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*91ZIRMNXtPic9OHq27HStw.png"/></div></div></figure><p id="c970" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">And let’s structure it into a more convenient format.</p><pre class="mr ms mt mu mv qr qs qt bp qu bb bk"><span id="534b" class="qv nj fq qs b bg qw qx l qy qz"># first remove all the \n characters that are in the response<br/>meal_plan = pd.read_json(response.choices[0].message.content.replace('\n', '')) # for some reason it provides the answer transposed.<br/><br/>ingredients = []<br/>ingredients_quantity = []<br/>ingredients_uom = []<br/>ingredients_cost = []<br/><br/>for i, l in meal_plan.iterrows():<br/>    ingredients += l["ingredients"]<br/>    ingredients_quantity += l["ingredient_quantity"]<br/>    ingredients_uom += l["ingredient_unit_of_measurement"]<br/>    ingredients_cost += l["ingredient_cost_euro"]<br/><br/>all_ingredients = (pd.DataFrame({"ingredients": ingredients,<br/>             "ingredients_q": ingredients_quantity,<br/>             "ingredients_uom": ingredients_uom,<br/>             "ingredients_cost": ingredients_cost})<br/>                .astype(dtype= {"ingredients":"string",<br/>             "ingredients_q": "float64",<br/>             "ingredients_uom": "string",<br/>             "ingredients_cost": "float64"}))</span></pre><p id="d80f" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">Lastly, let’s sum up the ingredients and quantities.</p><pre class="mr ms mt mu mv qr qs qt bp qu bb bk"><span id="428a" class="qv nj fq qs b bg qw qx l qy qz">(all_ingredients<br/> .groupby(["ingredients", "ingredients_uom"])<br/> .agg({'ingredients_q': ['sum', 'count'],<br/>       'ingredients_cost': 'sum'})<br/>)</span></pre><figure class="mr ms mt mu mv mi mo mp paragraph-image"><div class="mo mp sb"><img src="../Images/aef750a1eb8fe229956698c229595798.png" data-original-src="https://miro.medium.com/v2/resize:fit:1076/format:webp/1*3FZRvOB-MwBZSBFdMtA9bA.png"/></div></figure><blockquote class="rv rw rx"><p id="a0c5" class="oe of qq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk"><strong class="og fr">Exercise 4</strong><br/>Try to convert your meal plan created in exercise 3 into a shopping list using the same procedure.</p></blockquote><h1 id="ec06" class="ni nj fq bf nk nl nm gq nn no np gt nq nr ns nt nu nv nw nx ny nz oa ob oc od bk">6. Eet smakelijk (enjoy your meal)</h1><p id="605a" class="pw-post-body-paragraph oe of fq og b go oh oi oj gr ok ol om on oo op oq or os ot ou ov ow ox oy oz fj bk">So, there you are; you can go shopping or order the ingredients online. But perhaps the meal plan is not yet completely to your liking. Perhaps you would like it to be more spicy, or the ingredient costs are off, or you like to measure ginger in cm rather than inches. Just like any form of programming, prompting is another iterative process, and iteratively improving your prompts helps to better understand how ChatGPT (or any large language model) behaves and how to steer it to your own liking.</p><h1 id="c401" class="ni nj fq bf nk nl nm gq nn no np gt nq nr ns nt nu nv nw nx ny nz oa ob oc od bk">References &amp; notes</h1><p id="edee" class="pw-post-body-paragraph oe of fq og b go oh oi oj gr ok ol om on oo op oq or os ot ou ov ow ox oy oz fj bk">All dates are in dd-mm-YYYY format.</p><p id="a36f" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">[1] <a class="af qp" href="https://langchain.com/" rel="noopener ugc nofollow" target="_blank">https://langchain.com</a>. Last accessed: 10–05–2024.</p><p id="c243" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">[2] <a class="af qp" href="https://app.datacamp.com/learn/courses/intro-to-python-for-data-science" rel="noopener ugc nofollow" target="_blank">https://app.datacamp.com/learn/courses/intro-to-python-for-data-science</a>. Last accessed: 10–05–2024.</p><p id="be32" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">[3] <a class="af qp" href="https://chatgpt.com/" rel="noopener ugc nofollow" target="_blank">https://chatgpt.com</a>. Last accessed: 10–05–2024.</p><p id="af79" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">[4] The author of this article takes no responsibility for any cost (expected or unexpected) the reader might have when following the steps in this tutorial.</p><p id="747b" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">[5] Maximilian Vogel. (2023). ChatGPT, Next Level: Meet 10 Autonomous AI Agents: Auto-GPT, BabyAGI, AgentGPT, Microsoft Jarvis, ChaosGPT &amp; friends. <a class="af qp" href="https://medium.com/the-generator/chatgpts-next-level-is-agent-ai-auto-gpt-babyagi-agentgpt-microsoft-jarvis-friends-d354aa18f21" rel="noopener">https://medium.com/the-generator/chatgpts-next-level-is-agent-ai-auto-gpt-babyagi-agentgpt-microsoft-jarvis-friends-d354aa18f21</a> Last accessed: 11–07–2024.</p><p id="cfa4" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">[6] <a class="af qp" href="https://platform.openai.com/docs/guides/prompt-engineering/prompt-engineering" rel="noopener ugc nofollow" target="_blank">https://platform.openai.com/docs/guides/prompt-engineering/prompt-engineering</a>. Last accessed: 10–05–2024.</p><p id="02c4" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">[7] Teo S. (2023). How I Won Singapore’s GPT-4 Prompt Engineering Competition. <a class="af qp" href="https://medium.com/towards-data-science/how-i-won-singapores-gpt-4-prompt-engineering-competition-34c195a93d41" rel="noopener">https://medium.com/towards-data-science/how-i-won-singapores-gpt-4-prompt-engineering-competition-34c195a93d41</a>. Last accessed: 10–05–2024</p><p id="1d63" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">[8] Xu, Benfeng, et al. (2023). Expertprompting: Instructing large language models to be distinguished experts. <em class="qq">arXiv preprint arXiv:2305.14688</em>.</p><p id="3747" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">[9] <a class="af qp" href="https://python.langchain.com/v0.1/docs/modules/model_io/output_parsers/" rel="noopener ugc nofollow" target="_blank">https://python.langchain.com/v0.1/docs/modules/model_io/output_parsers/</a>. Last accessed: 12–07–2024.</p><p id="03fd" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">[10] <a class="af qp" href="https://nos.nl/artikel/2221580-willem-alexander-en-maxima-in-de-keuken-wie-bakt-de-beste-pannenkoeken" rel="noopener ugc nofollow" target="_blank">https://nos.nl/artikel/2221580-willem-alexander-en-maxima-in-de-keuken-wie-bakt-de-beste-pannenkoeken</a>. Last accessed: 19–09–2024</p><p id="2d63" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">[11] <a class="af qp" href="https://community.openai.com/t/incorrect-count-of-r-characters-in-the-word-strawberry/829618" rel="noopener ugc nofollow" target="_blank">https://community.openai.com/t/incorrect-count-of-r-characters-in-the-word-strawberry/829618</a>. Last accessed: 20–09–2024</p><p id="3d50" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">[12] Such as the recent o1-models: <a class="af qp" href="https://openai.com/o1/" rel="noopener ugc nofollow" target="_blank">https://openai.com/o1/</a>. Last accessed: 23–09–2024</p><p id="258b" class="pw-post-body-paragraph oe of fq og b go pa oi oj gr pb ol om on pc op oq or pd ot ou ov pe ox oy oz fj bk">[13] Brown, Tom B. et al. (2020)“Language models are few-shot learners.” <em class="qq">arXiv preprint arXiv:2005.14165</em>.</p></div></div></div></div>    
</body>
</html>