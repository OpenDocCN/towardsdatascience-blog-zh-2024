<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>A New Coefficient of Correlation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>A New Coefficient of Correlation</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-new-coefficient-of-correlation-64ae4f260310?source=collection_archive---------0-----------------------#2024-03-31">https://towardsdatascience.com/a-new-coefficient-of-correlation-64ae4f260310?source=collection_archive---------0-----------------------#2024-03-31</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><figure class="fr fs ft fu fv fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp fq"><img src="../Images/912615e9a2d430a15a89c8f349a0d9e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gqx-VHjMgoOvUbWanxBmBA.jpeg"/></div></div><figcaption class="gd ge gf fo fp gg gh bf b bg z dx">Image by Author</figcaption></figure><div><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hl hm hn ho hp ab"><div><div class="ab hq"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@tim.sumner?source=post_page---byline--64ae4f260310--------------------------------" rel="noopener follow"><div class="l hr hs by ht hu"><div class="l ed"><img alt="Tim Sumner" class="l ep by dd de cx" src="../Images/34225cf53f510e5002042bb1be00f423.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*LnDNDjXggGQVqNQQp-HpiQ.png"/><div class="hv by l dd de em n hw eo"/></div></div></a></div></div><div class="hx ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--64ae4f260310--------------------------------" rel="noopener follow"><div class="l hy hz by ht ia"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ib cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hv by l br ib em n hw eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="ic ab q"><div class="ab q id"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b ie if bk"><a class="af ag ah ai aj ak al am an ao ap aq ar ig" data-testid="authorName" href="https://medium.com/@tim.sumner?source=post_page---byline--64ae4f260310--------------------------------" rel="noopener follow">Tim Sumner</a></p></div></div></div><span class="ih ii" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b ie if dx"><button class="ij ik ah ai aj ak al am an ao ap aq ar il im in" disabled="">Follow</button></p></div></div></span></div></div><div class="l io"><span class="bf b bg z dx"><div class="ab cn ip iq ir"><div class="is it ab"><div class="bf b bg z dx ab iu"><span class="iv l io">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar ig ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--64ae4f260310--------------------------------" rel="noopener follow"><p class="bf b bg z iw ix iy iz ja jb jc jd bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="ih ii" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">10 min read</span><div class="je jf l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Mar 31, 2024</span></div></span></div></span></div></div></div><div class="ab cp jg jh ji jj jk jl jm jn jo jp jq jr js jt ju jv"><div class="h k w ea eb q"><div class="kl l"><div class="ab q km kn"><div class="pw-multi-vote-icon ed iv ko kp kq"><div class=""><div class="kr ks kt ku kv kw kx am ky kz la kq"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l lb lc ld le lf lg lh"><p class="bf b dy z dx"><span class="ks">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kr lk ll ab q ee lm ln" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lj"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count li lj">58</span></p></button></div></div></div><div class="ab q jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk"><div class="lo k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lp an ao ap il lq lr ls" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep lt cn"><div class="l ae"><div class="ab cb"><div class="lu lv lw lx ly gb ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lp an ao ap il lz ma ln mb mc md me mf s mg mh mi mj mk ml mm u mn mo mp"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lp an ao ap il lz ma ln mb mc md me mf s mg mh mi mj mk ml mm u mn mo mp"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lp an ao ap il lz ma ln mb mc md me mf s mg mh mi mj mk ml mm u mn mo mp"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><p id="6965" class="pw-post-body-paragraph mq mr gk ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn fj bk">What if you were told there exists a new way to measure the relationship between two variables just like correlation except possibly better. More specifically, in 2020 a paper was published titled <a class="af no" href="https://www.tandfonline.com/doi/full/10.1080/01621459.2020.1758115" rel="noopener ugc nofollow" target="_blank">A New Coefficient of Correlation</a>[1] introducing a new measure which equals 0 if and only if the two variables are independent, 1 if and only if one variable is a function of the other, and lastly has some nice theoretical properties allowing for hypothesis testing while practically making no assumptions about the data. Before we get into it, let us talk briefly about how more traditional correlation measures work.</p></div></div></div><div class="ab cb np nq nr ns" role="separator"><span class="nt by bm nu nv nw"/><span class="nt by bm nu nv nw"/><span class="nt by bm nu nv"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="77b3" class="nx ny gk bf nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou bk">Correlation Refresher</h1><p id="9d75" class="pw-post-body-paragraph mq mr gk ms b mt ov mv mw mx ow mz na nb ox nd ne nf oy nh ni nj oz nl nm nn fj bk">There are few tools that exist to help understand data that are more commonly used (and misused) than the popular correlation coefficient. Formally known as Pearson’s <em class="pa">r</em>, the sample correlation coefficient taught in nearly every introductory statistics/business class is arguably the number one tool every data professional must be familiar with. The reasons for this are many, with one being it is both easy to use and interpret. As a reminder, the sample correlation coefficient measures the <em class="pa">linear</em> relationship between exactly two variables and can be calculated using the following formula.</p><figure class="pc pd pe pf pg fw fo fp paragraph-image"><div class="fo fp pb"><img src="../Images/57f970498300bc5f6d77c4b1e821fc9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/1*m9DyBncgBbqz4avs64kCrA.png"/></div></figure><p id="4a2f" class="pw-post-body-paragraph mq mr gk ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn fj bk">As a final reminder, this value can range from -1 to +1 with negative values implying an inverse <em class="pa">linear</em> relationship between the two variables being measured and a positive one implying the opposite. Notice the emphasis so far being placed on measuring <em class="pa">linear</em> relationships. Linear relationships can be understood as the shape of a relationship being somewhat traceable using a straight line.</p><figure class="pc pd pe pf pg fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp ph"><img src="../Images/1de7100117d6ad7d60f2f6e3f771ba96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XaN13XEpyK_64kzCVXj9fg.png"/></div></div></figure><p id="82eb" class="pw-post-body-paragraph mq mr gk ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn fj bk">It should come as no surprise to most that it is rare to observe linear relationships in the real world. This is why other measures have been created over the decades such as Spearman’s <em class="pa">ρ </em>(rho) and Kendall’s <em class="pa">τ</em> (tau) to name a few. These newer measures are much better at identifying <em class="pa">monotonic </em>relationships and not just linear ones which makes them more robust since linear relationships are a specific type of monotonic relationship. Monotonic relationships can basically be understood as either always increasing or always decreasing.</p><figure class="pc pd pe pf pg fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp pi"><img src="../Images/55e9adb08198dfaf39f30e98c8fc562f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*u9gtsJxEGALN-DuxA8yx9g.png"/></div></div></figure><p id="34c4" class="pw-post-body-paragraph mq mr gk ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn fj bk">Most of the time correlation is used, it is used to try and identify not necessarily a linear or monotonic relationship between two variables of interest, but instead identify if there exists <strong class="ms gl">any</strong> relationship. This creates problems, for if relationships are neither linear nor monotonic, these current measures do not work very well. Note how the plots below all display clearly strong relationships between two variables, but commonly used correlation techniques are only good at identifying monotonic ones.</p><figure class="pc pd pe pf pg fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp pj"><img src="../Images/20b31200d27e0e763d1e8cd389c6b6e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cG4C1gevWhRxhLWmDIodrw.png"/></div></div></figure><p id="c5b8" class="pw-post-body-paragraph mq mr gk ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn fj bk">Despite having obvious shortcomings, these correlations are still being used to make many conclusions about all sorts of data. Is there any hope for identifying relationships that are even more complex than the ones shown above? Enter, the new coefficient <strong class="ms gl"><em class="pa">ξ</em> </strong>(pronounced “ksaai”).</p><p id="a897" class="pw-post-body-paragraph mq mr gk ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn fj bk">One last note before moving on, a paper was published in 2022 titled <a class="af no" href="https://www.tandfonline.com/doi/full/10.1080/00031305.2021.2004922" rel="noopener ugc nofollow" target="_blank">Myths About Linear and Monotonic Associations</a><strong class="ms gl">[2] </strong>related to the issue of stating which popular measure of correlation is preferred for which type of data. Earlier, I suggested that Pearson’s <em class="pa">r</em> is most appropriate for linear measures while Spearman’s <em class="pa">ρ</em> and Kendall’s <em class="pa">τ</em> were better for monotonic data. While this rule is a popular belief and common practice amongst many data professionals, this paper makes a point to say that this is not necessarily the case, and that the opposite can in fact be true under certain circumstances.</p></div></div></div><div class="ab cb np nq nr ns" role="separator"><span class="nt by bm nu nv nw"/><span class="nt by bm nu nv nw"/><span class="nt by bm nu nv"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="aefe" class="nx ny gk bf nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou bk">The Formula(s)</h1><p id="3e8e" class="pw-post-body-paragraph mq mr gk ms b mt ov mv mw mx ow mz na nb ox nd ne nf oy nh ni nj oz nl nm nn fj bk">Before introducing the formula, it is important to go over some needed prep-work. As we said earlier, correlation can be thought of as a way of measuring the relationship between two variables. Say we’re measuring the current correlation between <em class="pa">X</em> and <em class="pa">Y</em>. If a linear relationship does exist, it can be thought of as one that is mutually shared meaning the correlation between <em class="pa">X</em> and <em class="pa">Y</em> is always equal to the correlation between <em class="pa">Y</em> and <em class="pa">X</em>. With this new approach, however, we will no longer be measuring the linear relationship between <em class="pa">X</em> and <em class="pa">Y</em>, but instead our aim is to measure how much <em class="pa">Y</em> is a function of <em class="pa">X</em>. Understanding this subtle, but important distinction between traditional correlation techniques will make understanding the formulas much easier, for in general it is not necessarily the case anymore that <em class="pa">ξ</em>(<em class="pa">X</em>,<em class="pa">Y</em>) equals <em class="pa">ξ</em>(<em class="pa">Y</em>,<em class="pa">X</em>).</p><p id="b37b" class="pw-post-body-paragraph mq mr gk ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn fj bk">Sticking with the same train of thought, suppose we still wanted to measure how much <em class="pa">Y</em> is a function of <em class="pa">X</em>. Notice each data point is an ordered pair of both <em class="pa">X</em> and <em class="pa">Y</em>. First, we must sort the data as (<em class="pa">X</em>₍₁₎,<em class="pa">Y</em>₍₁₎),…,(<em class="pa">X</em>₍<em class="pa">ₙ</em>₎,<em class="pa">Y</em>₍<em class="pa">ₙ</em>₎) in a way that results in <em class="pa">X</em>₍₁₎ ≤ <em class="pa">X</em>₍₂₎≤ ⋯ ≤ <em class="pa">X</em>₍<em class="pa">ₙ</em>₎. Said clearly, we must sort the data according to <em class="pa">X</em>. We will then be able to create the variables <em class="pa">r</em>₁, <em class="pa">r</em>₂, … ,<em class="pa">rₙ</em> where <em class="pa">rᵢ</em> equals the rank of <em class="pa">Y</em>₍<em class="pa">ᵢ</em>₎. With these ranks now identified, we are ready to calculate.</p><p id="4ee3" class="pw-post-body-paragraph mq mr gk ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn fj bk">There are two formulas used depending on the type of data you are working with. If ties in your data are impossible (or extremely unlikely), we have</p><figure class="pc pd pe pf pg fw fo fp paragraph-image"><div class="fo fp pk"><img src="../Images/72709e76fb969c59a080dc3f90ff2c5d.png" data-original-src="https://miro.medium.com/v2/resize:fit:676/format:webp/1*iJqWaDv4NeOYIIlRoHLoWg.png"/></div></figure><p id="011a" class="pw-post-body-paragraph mq mr gk ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn fj bk">and if ties are allowed, we have</p><figure class="pc pd pe pf pg fw fo fp paragraph-image"><div class="fo fp pl"><img src="../Images/d79d81ee528615ba193f565a5ccdd458.png" data-original-src="https://miro.medium.com/v2/resize:fit:704/format:webp/1*7Z4dJyjSHAntVBAFOos4UQ.png"/></div></figure><p id="955d" class="pw-post-body-paragraph mq mr gk ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn fj bk">where <em class="pa">lᵢ </em>is defined as the number of <em class="pa">j</em> such that <em class="pa">Y</em>₍ <em class="pa">ⱼ</em>₎<em class="pa"> </em>≥ <em class="pa">Y</em>₍<em class="pa">ᵢ</em>₎. One last important note for when ties are allowed. In addition to using the second formula, to obtain the best estimate possible it is important to randomly sort the observed ties in a way that one value is chosen to be ranked higher/lower over another so that (<em class="pa">rᵢ</em>₊₁ — <em class="pa">rᵢ</em>) is never equal to zero just as before. The variable <em class="pa">lᵢ </em>is then just the number of observations <em class="pa">Y</em>₍<em class="pa">ᵢ</em>₎ is actually greater than or equal to.</p><p id="0ba6" class="pw-post-body-paragraph mq mr gk ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn fj bk">To not dive too much deeper into theory, it is also worth briefly pointing out this new correlation comes with some nice asymptotic theory behind it that makes it very easy to perform hypothesis testing without making any assumptions about the underlying distributions. This is because this method depends on the rank of the data, and not the values themselves making it a nonparametric statistic. If it is true that <em class="pa">X</em> and <em class="pa">Y</em> are independent and <em class="pa">Y</em> is continuous, then</p><figure class="pc pd pe pf pg fw fo fp paragraph-image"><div class="fo fp pm"><img src="../Images/ee6b33801af6510df90d304005faf3fd.png" data-original-src="https://miro.medium.com/v2/resize:fit:496/format:webp/1*jMfiFhmyqVlMpYCJPm6ApA.png"/></div></figure><p id="bf66" class="pw-post-body-paragraph mq mr gk ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn fj bk">What this means is that if you have a large enough sample size, then this correlation statistic approximately follows a normal distribution. This can be useful if you’d like to test the degree of independence between the two variables you are testing.</p></div></div></div><div class="ab cb np nq nr ns" role="separator"><span class="nt by bm nu nv nw"/><span class="nt by bm nu nv nw"/><span class="nt by bm nu nv"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="a95c" class="nx ny gk bf nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou bk">Code</h1><p id="276b" class="pw-post-body-paragraph mq mr gk ms b mt ov mv mw mx ow mz na nb ox nd ne nf oy nh ni nj oz nl nm nn fj bk">Along with the publishing of this new method, the R package <a class="af no" href="https://cran.r-project.org/web/packages/XICOR/index.html" rel="noopener ugc nofollow" target="_blank">XICOR </a>was released containing a few relevant functions including one called xicor() which easily calculates the statistic <em class="pa">ξ</em><strong class="ms gl"><em class="pa"> </em></strong>when <em class="pa">X</em> and <em class="pa">Y</em> vectors or matrices are provided as well as additional information like p-values for hypothesis testing. As with all articles I write, I will include original functions for R, Python, and Julia that you can simply copy and keep if you choose to. Here <em class="pa">X</em> and <em class="pa">Y</em> must either be a vector or an array, and for Python and Julia you may need to install the NumPy and Random package respectively.</p><p id="1978" class="pw-post-body-paragraph mq mr gk ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn fj bk">I’ll note that these three functions are written very simply and for introductory purposes. With that said, for any professional use I’d encourage more efficient functions produced from professional libraries or more efficient contributors. For example, <a class="af no" href="https://gist.github.com/itamarfaran/0cffce51cd0e3d78ddf509b72a9e702d" rel="noopener ugc nofollow" target="_blank">here</a> is a python function written by <a class="af no" href="https://medium.com/@itamar.faran" rel="noopener">Itamar Faran</a> that works much faster then the one provided below.</p><pre class="pc pd pe pf pg pn po pp bp pq bb bk"><span id="3077" class="pr ny gk po b bg ps pt l pu pv">## R Function ##<br/>xicor &lt;- function(X, Y, ties = TRUE){<br/>  n &lt;- length(X)<br/>  r &lt;- rank(Y[order(X)], ties.method = "random")<br/>  set.seed(42)<br/>  if(ties){<br/>    l &lt;- rank(Y[order(X)], ties.method = "max")<br/>    return( 1 - n*sum( abs(r[-1] - r[-n]) ) / (2*sum(l*(n - l))) )<br/>  } else {<br/>    return( 1 - 3 * sum( abs(r[-1] - r[-n]) ) / (n^2 - 1) )    <br/>  }<br/>}<br/><br/>## Python Function ##<br/>from numpy import array, random, arange<br/><br/>def xicor(X, Y, ties=True):<br/>    random.seed(42)<br/>    n = len(X)<br/>    order = array([i[0] for i in sorted(enumerate(X), key=lambda x: x[1])])<br/>    if ties:<br/>        l = array([sum(y &gt;= Y[order]) for y in Y[order]])<br/>        r = l.copy()<br/>        for j in range(n):<br/>            if sum([r[j] == r[i] for i in range(n)]) &gt; 1:<br/>                tie_index = array([r[j] == r[i] for i in range(n)])<br/>                r[tie_index] = random.choice(r[tie_index] - arange(0, sum([r[j] == r[i] for i in range(n)])), sum(tie_index), replace=False)<br/>        return 1 - n*sum( abs(r[1:] - r[:n-1]) ) / (2*sum(l*(n - l)))<br/>    else:<br/>        r = array([sum(y &gt;= Y[order]) for y in Y[order]])<br/>        return 1 - 3 * sum( abs(r[1:] - r[:n-1]) ) / (n**2 - 1)<br/><br/>## Julia Function ##<br/>import Random<br/>function xicor(X::AbstractVector, Y::AbstractVector, ties::Bool=true)<br/>    Random.seed!(42)<br/>    n = length(X)<br/>    if ties<br/>        l = [sum(y .&gt;= Y[sortperm(X)]) for y ∈ Y[sortperm(X)]]<br/>        r = copy(l)<br/>        for j ∈ 1:n<br/>            if sum([r[j] == r[i] for i ∈ 1:n]) &gt; 1<br/>                tie_index = [r[j] == r[i] for i ∈ 1:n]<br/>                r[tie_index] = Random.shuffle(r[tie_index] .- (0:sum([r[j] == r[i] for i ∈ 1:n])-1))<br/>            end<br/>        end<br/>        return 1 - n*sum( abs.(r[2:end] - r[1:n-1]) ) / (2*sum(l.*(n .- l)))<br/>    else<br/>        r = [sum(y .&gt;= Y[sortperm(X)]) for y ∈ Y[sortperm(X)]]<br/>        return 1 - 3 * sum( abs.(r[2:end] - r[1:end-1]) ) / (n^2 - 1)<br/>    end<br/>end</span></pre></div></div></div><div class="ab cb np nq nr ns" role="separator"><span class="nt by bm nu nv nw"/><span class="nt by bm nu nv nw"/><span class="nt by bm nu nv"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="04e3" class="nx ny gk bf nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou bk">Examples</h1><p id="a3ce" class="pw-post-body-paragraph mq mr gk ms b mt ov mv mw mx ow mz na nb ox nd ne nf oy nh ni nj oz nl nm nn fj bk">For a first look at the possible benefits of using this new formula, let us compare the calculated correlation values of a few simulated examples that highlight the key differences between each correlation method.</p><figure class="pc pd pe pf pg fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp pw"><img src="../Images/a8a4269bffb5296364640434f0e31391.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vs0HaGHFxYiXopOgrQFeqQ.png"/></div></div></figure><figure class="pc pd pe pf pg fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp px"><img src="../Images/8fa02f9c1e9a3a7dbcfdedf2fc0aced6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ufKktqYC7oF_RtoYwGmdWA.png"/></div></div></figure><figure class="pc pd pe pf pg fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp py"><img src="../Images/0e190a52521c829cf9e01844f51f4e11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kwM4rMI4wC-zKkvMt1g5-A.png"/></div></div></figure><p id="a39b" class="pw-post-body-paragraph mq mr gk ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn fj bk">Starting at the top, we can see correlations using this new method no longer tell you the direction of the relationship since values can no longer be negative. As expected, however, this value is closer to 1 as the relationship strengthens and closer to 0 the more it weakens just like the aforementioned methods.</p><p id="7061" class="pw-post-body-paragraph mq mr gk ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn fj bk">Moving on down is where things get exciting. It should be clear from the bottom four charts that this new approach is much more useful than traditional calculations at identifying significant relationships in general. Cases like these shown above are exactly the main motivation behind the research that led to this new formula since the second example shows Pearson’s <em class="pa">r</em> concludes there is no significant relationship between <em class="pa">X</em> and <em class="pa">Y</em> when there clearly exists a parabolic one, and the third example shows the same method concludes there’s a slight positive correlation when in reality the relationship appears to exhibit no upward trend.</p><p id="8bd1" class="pw-post-body-paragraph mq mr gk ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn fj bk">Up to this point, we’ve only looked at simulated data. Let us now go over some visual results using this new correlation method with a real-world example. Suppose we want to measure the level of independence between brain signals and time.</p><p id="8210" class="pw-post-body-paragraph mq mr gk ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn fj bk">The following data is a recording of brain activity measured in the form of BOLD signals using functional magnetic resonance imaging (fMRI) made available through the popular R package <a class="af no" href="https://www.rdocumentation.org/packages/astsa/versions/2.1" rel="noopener ugc nofollow" target="_blank">astsa</a>. To provide more context, this dataset contains the average response observable in eight various brain locations in the cortex, thalamus, and cerebellum across five subjects. Each subject was exposed to periodic brushing of the hand for 32 seconds and then paused for 32 seconds resulting in a signal period of 64 seconds. Data was then recorded every 2 seconds for 256 seconds total (<em class="pa">n</em> = 128).</p><figure class="pc pd pe pf pg fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp pz"><img src="../Images/0e00a97b0c6147d19c1ceacc63de68bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t0qkPnmi0bliA7kHp2HlaA.png"/></div></div></figure><p id="c383" class="pw-post-body-paragraph mq mr gk ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn fj bk">Suppose we wish to measure which of these three parts of the brain is most likely a function of time implying they are most involved when performing the prescribed stimulation. From the visual above, it appears that the Cortex signals are the least noisy, and one of the Thalamus’ signals are the noisiest, but let us quantify this using our new correlation statistic. The following table shows the correlation value of each of the eight measurements using the popular Pearson’s <em class="pa">r </em>and the new correlation <em class="pa">ξ</em>.</p><figure class="pc pd pe pf pg fw fo fp paragraph-image"><div class="fo fp qa"><img src="../Images/cf5b0498dc0c265072ed98c0d983bc75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*of63It-44hB8Gdh-6Ta-ew.png"/></div></figure><p id="d866" class="pw-post-body-paragraph mq mr gk ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn fj bk">The table above reveals the common method for correlation consistently shows each of these relationships to be negative or approximately zero implying there is little to no observable relationship, and if there is one it exhibits a downward trend. This is clearly not the case since some of these wavelengths exhibit visibly strong relationships with time, and all of them appear to have no trend.</p><p id="8fba" class="pw-post-body-paragraph mq mr gk ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn fj bk">Furthermore, the new correlation values do a much better job identifying which location is least noisy, which is the main point of this analysis. The results show that parts of the Cortex are most notably being used during the period of stimulation since those correlation values are the highest on average, but there are also parts of the Thalamus that appear involved as well, a result not so easily detectable using the standard approach.</p></div></div></div><div class="ab cb np nq nr ns" role="separator"><span class="nt by bm nu nv nw"/><span class="nt by bm nu nv nw"/><span class="nt by bm nu nv"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="e954" class="nx ny gk bf nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou bk">Conclusion</h1><p id="5ea1" class="pw-post-body-paragraph mq mr gk ms b mt ov mv mw mx ow mz na nb ox nd ne nf oy nh ni nj oz nl nm nn fj bk">There is more that can be done to continue the analysis we started, such as perform an official hypothesis test of independence using the asymptotic theory presented earlier, but the purpose of this report was to simply introduce the new measure and showcase how simple these computations can be and how these results can be used. If you are interested in learning more about the pros and cons of this approach, I would encourage you to read the official publication introducing the method found in the references below.</p><p id="1ce3" class="pw-post-body-paragraph mq mr gk ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn fj bk">This new approach is far from perfect, but it was created as a means of solving some of the most notable issues with the currently accepted approach. Since discovering it, I have been using it for my own personal research and it has proven very helpful.</p><p id="a05f" class="pw-post-body-paragraph mq mr gk ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn fj bk">Unless otherwise noted, all images, plots, and tables are by the author.</p><p id="b3bc" class="pw-post-body-paragraph mq mr gk ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn fj bk">[1] S. Chatterjee, <a class="af no" href="https://www.tandfonline.com/doi/full/10.1080/01621459.2020.1758115" rel="noopener ugc nofollow" target="_blank">A New Coefficient of Correlation</a> (2020), Journal of the American Statistical Association.</p><p id="4d27" class="pw-post-body-paragraph mq mr gk ms b mt mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn fj bk">[2] E. Heuvel and Z. Zhan, <a class="af no" href="https://www.tandfonline.com/doi/full/10.1080/00031305.2021.2004922" rel="noopener ugc nofollow" target="_blank">Myths About Linear and Monotonic Associations</a> (2022), The American Statistician.</p></div></div></div></div>    
</body>
</html>