# åˆ©ç”¨å› æœå›¾ä¿æŠ¤éœ€æ±‚é¢„æµ‹

> åŸæ–‡ï¼š[`towardsdatascience.com/safeguarding-demand-forecasting-with-causal-graphs-591511fc8e0e?source=collection_archive---------6-----------------------#2024-06-28`](https://towardsdatascience.com/safeguarding-demand-forecasting-with-causal-graphs-591511fc8e0e?source=collection_archive---------6-----------------------#2024-06-28)

## å› æœ AIï¼Œæ¢ç´¢å°†å› æœæ¨ç†èå…¥æœºå™¨å­¦ä¹ 

[](https://medium.com/@raz1470?source=post_page---byline--591511fc8e0e--------------------------------)![Ryan O'Sullivan](https://medium.com/@raz1470?source=post_page---byline--591511fc8e0e--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--591511fc8e0e--------------------------------)![Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--591511fc8e0e--------------------------------) [Ryan O'Sullivan](https://medium.com/@raz1470?source=post_page---byline--591511fc8e0e--------------------------------)

Â·å‘è¡¨äº [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--591511fc8e0e--------------------------------) Â·11 åˆ†é’Ÿé˜…è¯»Â·2024 å¹´ 6 æœˆ 28 æ—¥

--

![](img/04ae3f78a67df7e275299b9801cf319b.png)

å›¾ç‰‡æ¥è‡ª [Boris Dunand](https://unsplash.com/@borisdunand?utm_source=medium&utm_medium=referral) åœ¨ [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

# è¿™ç³»åˆ—æ–‡ç« çš„å†…å®¹æ˜¯ä»€ä¹ˆï¼Ÿ

æ¬¢è¿æ¥åˆ°æˆ‘çš„å› æœ AI ç³»åˆ—æ–‡ç« ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°†æ¢ç´¢å°†å› æœæ¨ç†èå…¥æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚ä½ å°†ä¼šçœ‹åˆ°åœ¨ä¸åŒå•†ä¸šèƒŒæ™¯ä¸‹çš„ä¸€äº›å®ç”¨åº”ç”¨ã€‚

åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†*åˆ©ç”¨å› æœ AI å¼ºåŒ–è¥é”€ç»„åˆå»ºæ¨¡*ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ç»§ç»­æ¢è®¨*åˆ©ç”¨å› æœå›¾ä¿æŠ¤éœ€æ±‚é¢„æµ‹*ã€‚

å¦‚æœä½ é”™è¿‡äº†ä¸Šä¸€ç¯‡å…³äºè¥é”€ç»„åˆå»ºæ¨¡çš„æ–‡ç« ï¼Œè¯·åœ¨è¿™é‡ŒæŸ¥çœ‹ï¼š

[](/enhancing-marketing-mix-modelling-with-causal-ai-77f638bce3a9?source=post_page-----591511fc8e0e--------------------------------) ## åˆ©ç”¨å› æœ AI å¼ºåŒ–è¥é”€ç»„åˆå»ºæ¨¡

### å› æœ AIï¼Œæ¢ç´¢å°†å› æœæ¨ç†èå…¥æœºå™¨å­¦ä¹ 

towardsdatascience.com

# ä»‹ç»

åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨å¦‚ä½•åˆ©ç”¨å› æœå›¾ä¿æŠ¤éœ€æ±‚é¢„æµ‹ï¼ˆæˆ–è€…è¯´ä»»ä½•é¢„æµ‹åº”ç”¨åœºæ™¯ï¼‰ä¸å—å½±å“ã€‚

**ä»¥ä¸‹é¢†åŸŸå°†è¢«æ¢ç´¢ï¼š**

+   å¿«é€Ÿçš„é¢„æµ‹å…¥é—¨ã€‚

+   ä»€ä¹ˆæ˜¯éœ€æ±‚é¢„æµ‹ï¼Ÿ

+   å› æœå›¾å¤ä¹ ã€‚

+   å› æœå›¾å¦‚ä½•ä¿æŠ¤éœ€æ±‚é¢„æµ‹ï¼Ÿ

+   ä¸€ä¸ª Python æ¡ˆä¾‹ç ”ç©¶ï¼Œè¯´æ˜å› æœå›¾å¦‚ä½•ä¿æŠ¤ä½ çš„é¢„æµ‹å…å—è™šå‡ç›¸å…³æ€§çš„å½±å“ã€‚

å®Œæ•´çš„ç¬”è®°æœ¬å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ï¼š

[](https://github.com/raz1470/causal_ai/blob/main/notebooks/safeguarding%20demand%20forecasting%20with%20causal%20graphs.ipynb?source=post_page-----591511fc8e0e--------------------------------) [## causal_ai/notebooks/safeguarding demand forecasting with causal graphs.ipynb at main Â·â€¦

### æœ¬é¡¹ç›®ä»‹ç»äº†å› æœ AI åŠå…¶å¦‚ä½•æ¨åŠ¨å•†ä¸šä»·å€¼ã€‚ - causal_ai/notebooks/safeguarding demandâ€¦

github.com](https://github.com/raz1470/causal_ai/blob/main/notebooks/safeguarding%20demand%20forecasting%20with%20causal%20graphs.ipynb?source=post_page-----591511fc8e0e--------------------------------)

# é¢„æµ‹

## é¢„æµ‹åŸºç¡€çŸ¥è¯†

æ—¶é—´åºåˆ—é¢„æµ‹æ˜¯åŸºäºå†å²è§‚å¯Ÿå€¼é¢„æµ‹æœªæ¥å€¼çš„è¿‡ç¨‹ã€‚

![](img/1b694d850081befe34ef0aec17da8522.png)

ç”¨æˆ·ç”Ÿæˆå›¾åƒ

ä¸ºäº†å¼€å§‹ï¼Œæœ‰ä¸€äº›æœ¯è¯­æ˜¯å€¼å¾—ç†Ÿæ‚‰çš„ï¼š

1.  **è‡ªç›¸å…³** â€” æ˜¯ä¸€ä¸ªåºåˆ—ä¸å…¶åœ¨ä¸åŒæ—¶é—´æ»åä¸‹çš„å‰æœŸå€¼çš„ç›¸å…³æ€§ã€‚å¸®åŠ©è¯†åˆ«æ˜¯å¦å­˜åœ¨è¶‹åŠ¿ã€‚

1.  **å¹³ç¨³** â€” æ˜¯æŒ‡åºåˆ—çš„ç»Ÿè®¡å±æ€§ï¼ˆä¾‹å¦‚å‡å€¼ã€æ–¹å·®ï¼‰éšæ—¶é—´ä¿æŒä¸å˜ã€‚æŸäº›é¢„æµ‹æ–¹æ³•å‡è®¾åºåˆ—æ˜¯å¹³ç¨³çš„ã€‚

1.  **å·®åˆ†** â€” æ˜¯å°†å½“å‰è§‚å¯Ÿå€¼å‡å»å‰ä¸€ä¸ªè§‚å¯Ÿå€¼ï¼Œç”¨ä»¥å°†éå¹³ç¨³åºåˆ—è½¬åŒ–ä¸ºå¹³ç¨³åºåˆ—ã€‚å¯¹äºå‡è®¾å¹³ç¨³æ€§çš„æ¨¡å‹ï¼Œè¿™æ˜¯ä¸€ä¸ªé‡è¦æ­¥éª¤ã€‚

1.  **å­£èŠ‚æ€§** â€” åœ¨å›ºå®šæ—¶é—´é—´éš”å†…å®šæœŸé‡å¤å‡ºç°çš„å‘¨æœŸï¼ˆä¾‹å¦‚ï¼Œæ¯æ—¥ã€æ¯å‘¨ã€æ¯å¹´ï¼‰ã€‚

1.  **è¶‹åŠ¿** â€” åºåˆ—ä¸­çš„é•¿æœŸå˜åŒ–ã€‚

1.  **æ»å** â€” è§‚å¯Ÿå€¼ä¸å…¶å‰ä¸€ä¸ªå€¼ä¹‹é—´çš„æ—¶é—´æ­¥æ•°ã€‚

1.  **æ®‹å·®** â€” é¢„æµ‹å€¼ä¸å®é™…å€¼ä¹‹é—´çš„å·®å¼‚ã€‚

1.  **ç§»åŠ¨å¹³å‡** â€” é€šè¿‡å¯¹å›ºå®šæ•°é‡çš„è¿‡å»è§‚å¯Ÿå€¼è¿›è¡Œå¹³å‡ï¼Œæ¥å¹³æ»‘çŸ­æœŸæ³¢åŠ¨ã€‚

1.  **æŒ‡æ•°å¹³æ»‘** â€” å°†æƒé‡åº”ç”¨äºè¿‡å»çš„è§‚å¯Ÿå€¼ï¼Œå¼ºè°ƒæœ€è¿‘çš„æ•°å€¼ã€‚

1.  **å­£èŠ‚æ€§åˆ†è§£** â€” æ˜¯å°†æ—¶é—´åºåˆ—åˆ†è§£ä¸ºå­£èŠ‚æ€§ã€è¶‹åŠ¿å’Œæ®‹å·®æˆåˆ†çš„è¿‡ç¨‹ã€‚

![](img/5a2ceb597aa90c76f0b68ab324cab690.png)

ç”¨æˆ·ç”Ÿæˆå›¾åƒ

æœ‰å¤šç§ä¸åŒçš„æ–¹æ³•å¯ç”¨äºé¢„æµ‹ï¼š

+   **ETSï¼ˆè¯¯å·®ã€è¶‹åŠ¿ã€å­£èŠ‚æ€§ï¼‰** â€” ä¸€ç§æŒ‡æ•°å¹³æ»‘æ–¹æ³•ï¼Œç”¨äºå»ºæ¨¡è¯¯å·®ã€è¶‹åŠ¿å’Œå­£èŠ‚æ€§æˆåˆ†ã€‚

+   **è‡ªå›å½’æ¨¡å‹ï¼ˆAR æ¨¡å‹ï¼‰** â€” å°†åºåˆ—çš„å½“å‰å€¼å»ºæ¨¡ä¸ºå…¶å‰æœŸå€¼çš„çº¿æ€§ç»„åˆã€‚

+   **ç§»åŠ¨å¹³å‡æ¨¡å‹ï¼ˆMA æ¨¡å‹ï¼‰** â€” å°†åºåˆ—çš„å½“å‰å€¼å»ºæ¨¡ä¸ºè¿‡å»é¢„æµ‹è¯¯å·®çš„çº¿æ€§ç»„åˆã€‚

+   **è‡ªå›å½’ç§¯åˆ†æ»‘åŠ¨å¹³å‡ï¼ˆARIMA æ¨¡å‹ï¼‰** â€” å°† AR å’Œ MA æ¨¡å‹ç»“åˆï¼Œé€šè¿‡å·®åˆ†ä½¿åºåˆ—å¹³ç¨³ã€‚

+   **çŠ¶æ€ç©ºé—´æ¨¡å‹** â€” å°†æ—¶é—´åºåˆ—åˆ†è§£ä¸ºè¯¸å¦‚è¶‹åŠ¿å’Œå­£èŠ‚æ€§ç­‰ç‹¬ç«‹æˆåˆ†ã€‚

+   **å±‚çº§æ¨¡å‹** â€” å¤„ç†å¦‚åœ°åŒºç­‰å±‚æ¬¡ç»“æ„æ•°æ®çš„æ–¹æ³•ã€‚

+   **çº¿æ€§å›å½’** â€” ä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªè‡ªå˜é‡ï¼ˆç‰¹å¾ï¼‰æ¥é¢„æµ‹å› å˜é‡ï¼ˆç›®æ ‡ï¼‰ã€‚

+   **æœºå™¨å­¦ä¹ ï¼ˆMLï¼‰** â€” ä½¿ç”¨æ›´åŠ çµæ´»çš„ç®—æ³•ï¼Œå¦‚æå‡æ³•ï¼Œæ¥æ•æ‰å¤æ‚çš„å…³ç³»ã€‚

å¦‚æœä½ æƒ³è¿›ä¸€æ­¥äº†è§£è¿™ä¸ªè¯é¢˜ï¼Œæˆ‘å¼ºçƒˆæ¨èä»¥ä¸‹èµ„æºï¼Œå®ƒè¢«å¹¿æ³›è®¤ä¸ºæ˜¯é¢„æµ‹çš„æƒå¨æŒ‡å—ï¼ˆä»¥ä¸‹ç‰ˆæœ¬æ˜¯å…è´¹çš„ğŸ˜€ï¼‰ï¼š

[](https://otexts.com/fpp3/?source=post_page-----591511fc8e0e--------------------------------) [## é¢„æµ‹ï¼šåŸç†ä¸å®è·µï¼ˆç¬¬ 3 ç‰ˆï¼‰

### ç¬¬ 3 ç‰ˆ

otexts.com](https://otexts.com/fpp3/?source=post_page-----591511fc8e0e--------------------------------)

åœ¨ä½¿ç”¨ Python åº”ç”¨ä¸€äº›é¢„æµ‹æ¨¡å‹æ—¶ï¼Œæˆ‘æ¨èæ¢ç´¢ Nixtlaï¼Œå®ƒæœ‰å¹¿æ³›å®ç°çš„æ¨¡å‹åˆ—è¡¨ï¼Œå¹¶ä¸”æä¾›æ˜“äºä½¿ç”¨çš„ APIï¼š

[](https://github.com/Nixtla?source=post_page-----591511fc8e0e--------------------------------) [## Nixtla

### å¼€æºæ—¶é—´åºåˆ—ç”Ÿæ€ç³»ç»Ÿã€‚Nixtla æœ‰ 35 ä¸ªå¯ç”¨çš„ä»£ç åº“ã€‚ä½ å¯ä»¥åœ¨ GitHub ä¸Šå…³æ³¨ä»–ä»¬çš„ä»£ç ã€‚

github.com](https://github.com/Nixtla?source=post_page-----591511fc8e0e--------------------------------)

## éœ€æ±‚é¢„æµ‹

é¢„æµ‹äº§å“çš„éœ€æ±‚éå¸¸é‡è¦ã€‚

+   å®ƒæœ‰åŠ©äºç®¡ç†ä½ çš„åº“å­˜ï¼Œé¿å…è¿‡åº¦æˆ–ä¸è¶³çš„åº“å­˜ã€‚

+   å®ƒå¯ä»¥ä¿æŒå®¢æˆ·æ»¡æ„ï¼Œç¡®ä¿äº§å“åœ¨å®¢æˆ·éœ€è¦æ—¶å¯ç”¨ã€‚

+   é™ä½æŒæœ‰æˆæœ¬å¹¶å‡å°‘æµªè´¹æ˜¯æˆæœ¬æ•ˆç›Šé«˜çš„åšæ³•ã€‚

+   å¯¹äºæˆ˜ç•¥è§„åˆ’è‡³å…³é‡è¦ã€‚

ä¿æŒéœ€æ±‚é¢„æµ‹çš„å‡†ç¡®æ€§è‡³å…³é‡è¦ â€” åœ¨ä¸‹ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†å¼€å§‹æ€è€ƒå› æœå›¾å¦‚ä½•ä¿éšœæˆ‘ä»¬çš„é¢„æµ‹å‡†ç¡®æ€§â€¦

# å› æœå›¾

## å› æœå›¾å›é¡¾

æˆ‘åœ¨æˆ‘çš„ç³»åˆ—æ–‡ç« ä¸­è®¨è®ºè¿‡å› æœå›¾å‡ æ¬¡ï¼Œä½†ä»¥é˜²ä½ éœ€è¦å¤ä¹ ï¼Œå¯ä»¥æŸ¥çœ‹æˆ‘ç¬¬ä¸€ç¯‡è¯¦ç»†è®¨è®ºå› æœå›¾çš„æ–‡ç« ï¼š

[](/using-causal-graphs-to-answer-causal-questions-5fd1dd82fa90?source=post_page-----591511fc8e0e--------------------------------) ## ä½¿ç”¨å› æœå›¾å›ç­”å› æœé—®é¢˜

### å› æœ AIï¼Œæ¢ç´¢å°†å› æœæ¨ç†ä¸æœºå™¨å­¦ä¹ ç›¸ç»“åˆ

towardsdatascience.com

## å› æœå›¾å¦‚ä½•ä¿éšœéœ€æ±‚é¢„æµ‹çš„å‡†ç¡®æ€§ï¼Ÿ

ä»¥ä¸‹é¢çš„å›¾ä¸ºä¾‹ï¼Œå‡è®¾æˆ‘ä»¬æƒ³é¢„æµ‹ç›®æ ‡å˜é‡ã€‚æˆ‘ä»¬å‘ç°æœ‰ 3 ä¸ªä¸ç›®æ ‡å˜é‡ç›¸å…³çš„å˜é‡ï¼Œå› æ­¤æˆ‘ä»¬å°†å®ƒä»¬ä½œä¸ºç‰¹å¾ã€‚ä¸ºä»€ä¹ˆåŒ…å«è™šå‡çš„ç›¸å…³æ€§ä¼šæˆä¸ºé—®é¢˜ï¼Ÿæˆ‘ä»¬åŒ…å«æ›´å¤šç‰¹å¾ä¸æ˜¯èƒ½æé«˜é¢„æµ‹å‡†ç¡®æ€§å—ï¼Ÿ

![](img/66b864fdc1fb8642ba0489ffac247f8a.png)

ç”¨æˆ·ç”Ÿæˆçš„å›¾ç‰‡

å—¯ï¼Œå…¶å®ä¸æ˜¯â€¦

åœ¨éœ€æ±‚é¢„æµ‹ä¸­ï¼Œä¸»è¦é—®é¢˜ä¹‹ä¸€æ˜¯æ•°æ®æ¼‚ç§»ã€‚æ•°æ®æ¼‚ç§»æœ¬èº«ä¸æ˜¯é—®é¢˜ï¼Œå¦‚æœç‰¹å¾ä¸ç›®æ ‡ä¹‹é—´çš„å…³ç³»ä¿æŒä¸å˜ã€‚ä½†æ˜¯ï¼Œå½“å…³ç³»ä¸å†ä¿æŒä¸å˜æ—¶ï¼Œæˆ‘ä»¬çš„é¢„æµ‹å‡†ç¡®æ€§å°±ä¼šä¸‹é™ã€‚

ä½†å› æœå›¾å¦‚ä½•å¸®åŠ©æˆ‘ä»¬å‘¢â€¦â€¦ è¿™ä¸ªæ¦‚å¿µæ˜¯ï¼Œè™šå‡ç›¸å…³æ€§æ›´å¯èƒ½å‘ç”Ÿæ¼‚ç§»ï¼Œå¹¶ä¸”ä¸€æ—¦å‘ç”Ÿæ¼‚ç§»ï¼Œå®ƒä»¬æ›´å¯èƒ½å¼•å‘é—®é¢˜ã€‚

è¿˜ä¸ç›¸ä¿¡å—ï¼Ÿå¥½çš„ï¼Œé‚£å°±è®©æˆ‘ä»¬è·³å…¥æ¡ˆä¾‹ç ”ç©¶å§ï¼

# æ¡ˆä¾‹ç ”ç©¶

## èƒŒæ™¯

ä½ çš„æœ‹å‹ä¹°äº†ä¸€è¾†å†°æ·‡æ·‹è½¦ã€‚ä»–ä»¬æ”¯ä»˜äº†å¤§é‡è´¹ç”¨ç»™ä¸€ä¸ªé¡¾é—®ï¼Œå»ºç«‹äº†ä¸€ä¸ªéœ€æ±‚é¢„æµ‹æ¨¡å‹ã€‚è¿™ä¸ªæ¨¡å‹åœ¨æœ€åˆå‡ ä¸ªæœˆè¿ä½œå¾—éå¸¸å¥½ï¼Œä½†åœ¨è¿‡å»å‡ ä¸ªæœˆé‡Œï¼Œä½ çš„æœ‹å‹ä¸€ç›´åœ¨ç¼ºè´§å†°æ·‡æ·‹ï¼ä»–ä»¬è®°å¾—ä½ çš„èŒä½æ˜¯â€œæ•°æ®ä»€ä¹ˆä»€ä¹ˆâ€å¹¶æ¥æ‰¾ä½ å¯»æ±‚å»ºè®®ã€‚

## åˆ›å»ºæ¡ˆä¾‹ç ”ç©¶æ•°æ®

è®©æˆ‘å…ˆè§£é‡Šä¸€ä¸‹æˆ‘æ˜¯å¦‚ä½•ä¸ºè¿™ä¸ªæ¡ˆä¾‹ç ”ç©¶åˆ›å»ºæ•°æ®çš„ã€‚æˆ‘åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„å› æœå›¾ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹å¾ï¼š

1.  å†°æ·‡æ·‹é”€å”®æ˜¯ç›®æ ‡èŠ‚ç‚¹ï¼ˆX0ï¼‰

1.  æµ·æ»¨è®¿é—®æ˜¯å†°æ·‡æ·‹é”€å”®çš„ç›´æ¥åŸå› ï¼ˆX1ï¼‰

1.  æ¸©åº¦æ˜¯å†°æ·‡æ·‹é”€å”®çš„é—´æ¥åŸå› ï¼ˆX2ï¼‰

1.  é²¨é±¼æ”»å‡»æ˜¯ä¸€ä¸ªè™šå‡ç›¸å…³ï¼ˆX3ï¼‰

![](img/8038224febe818d6a49a2d0980df047f.png)

ç”¨æˆ·ç”Ÿæˆçš„å›¾åƒ

ç„¶åæˆ‘ä½¿ç”¨äº†ä»¥ä¸‹æ•°æ®ç”Ÿæˆè¿‡ç¨‹ï¼š

![](img/087d0da8feedce2a5c4b85776f7c2157.png)

ç”¨æˆ·ç”Ÿæˆçš„å›¾åƒ

ä½ å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½å—å…¶è¿‡å»å€¼ã€å™ªå£°é¡¹ä»¥åŠç›´æ¥çˆ¶èŠ‚ç‚¹çš„å½±å“ã€‚ä¸ºäº†ç”Ÿæˆæ•°æ®ï¼Œæˆ‘ä½¿ç”¨äº†æ¥è‡ªæ—¶é—´åºåˆ—å› æœåˆ†æ Python åŒ… Tigramite çš„ä¸€ä¸ªæ–¹ä¾¿æ¨¡å—ï¼š

[](https://github.com/jakobrunge/tigramite/tree/master?source=post_page-----591511fc8e0e--------------------------------) [## GitHub - jakobrunge/tigramite: Tigramite æ˜¯ä¸€ä¸ªä¸“æ³¨äºæ—¶é—´åºåˆ—æ•°æ®çš„å› æœæ¨æ–­ Python åŒ…â€¦

### Tigramite æ˜¯ä¸€ä¸ªä¸“æ³¨äºæ—¶é—´åºåˆ—æ•°æ®çš„å› æœæ¨æ–­ Python åŒ…ã€‚Tigramite çš„æ–‡æ¡£å¯ä»¥åœ¨â€¦

github.com](https://github.com/jakobrunge/tigramite/tree/master?source=post_page-----591511fc8e0e--------------------------------)

Tigramite æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„åŒ…ï¼Œä½†è¿™æ¬¡æˆ‘ä¸ä¼šè¯¦ç»†ä»‹ç»å®ƒï¼Œå› ä¸ºå®ƒå€¼å¾—å†™ä¸€ç¯‡ç‹¬ç«‹çš„æ–‡ç« ï¼åœ¨ä¸‹é¢çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä½¿ç”¨ structural_causal_process æ¨¡å—ï¼ŒæŒ‰ç…§ä¸Šé¢çš„æ•°æ®ç”Ÿæˆè¿‡ç¨‹è¿›è¡Œæ“ä½œï¼š

```py
seed=42
np.random.seed(seed)

# create node lookup for channels
node_lookup = {0: 'ice cream sales',
               1: 'coastal visits',
               2: 'temperature',           
               3: 'shark attacks',
 }

# data generating process
def lin_f(x): 
    return x

links_coeffs = {0: [((0, -1), 0.2, lin_f), ((1, -1), 0.9, lin_f)],
                1: [((1, -1), 0.5, lin_f), ((2, -1), 1.2, lin_f)],
                2: [((2, -1), 0.7, lin_f)],
                3: [((3, -1), 0.2, lin_f), ((2, -1), 1.8, lin_f) ],      
}

# time series length
T = 1000

data, _ = toys.structural_causal_process(links_coeffs, T=T, seed=seed)
T, N = data.shape

# create var name lookup
var_names = [node_lookup[i] for i in sorted(node_lookup.keys())]

# initialize dataframe object, specify time axis and variable names
df = pp.DataFrame(data, 
                  datatime = {0:np.arange(len(data))}, 
                  var_names=var_names)
```

ç„¶åæˆ‘ä»¬å¯ä»¥å°†æ—¶é—´åºåˆ—å¯è§†åŒ–ï¼š

```py
tp.plot_timeseries(df)
plt.show()
```

![](img/176957d122740457eda755b7ea92f421.png)

ç”¨æˆ·ç”Ÿæˆçš„å›¾åƒ

ç°åœ¨ä½ å·²ç»ç†è§£äº†æˆ‘å¦‚ä½•åˆ›å»ºæ•°æ®ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å›åˆ°ä¸‹ä¸€èŠ‚çš„æ¡ˆä¾‹ç ”ç©¶ï¼

## ç†è§£æ•°æ®ç”Ÿæˆè¿‡ç¨‹

ä½ é¦–å…ˆè¦é€šè¿‡åˆ†ææ¨¡å‹ä¸­ä½¿ç”¨çš„æ•°æ®æ¥ç†è§£æ•°æ®ç”Ÿæˆè¿‡ç¨‹ã€‚æ¨¡å‹ä¸­åŒ…å«äº† 3 ä¸ªç‰¹å¾ï¼š

1.  æµ·æ»¨è®¿é—®

1.  æ¸©åº¦

1.  é²¨é±¼æ”»å‡»

ä¸ºäº†ç†è§£å› æœå›¾ï¼Œä½ å¯ä»¥ä½¿ç”¨ PCMCIï¼ˆTigramite ä¸­æœ‰å¾ˆå¥½çš„å®ç°ï¼‰ï¼Œè¿™æ˜¯ä¸€ç§é€‚åˆå› æœæ—¶é—´åºåˆ—å‘ç°çš„æ–¹æ³•ã€‚æˆ‘è¿™æ¬¡ä¸ä¼šè¯¦ç»†ä»‹ç» PCMCIï¼Œå› ä¸ºå®ƒéœ€è¦ä¸€ç¯‡ä¸“é—¨çš„æ–‡ç« ã€‚ä¸è¿‡ï¼Œå¦‚æœä½ å¯¹å› æœå‘ç°ä¸å¤ªç†Ÿæ‚‰ï¼Œå¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰çš„æ–‡ç« æ¥è·å¾—ä¸€ä¸ªå¾ˆå¥½çš„å…¥é—¨ï¼š

[](/making-causal-discovery-work-in-real-world-business-settings-80e80c5f66b8?source=post_page-----591511fc8e0e--------------------------------) ## ä½¿å› æœå‘ç°èƒ½å¤Ÿåœ¨ç°å®ä¸–ç•Œçš„å•†ä¸šç¯å¢ƒä¸­è¿ä½œ

### å› æœäººå·¥æ™ºèƒ½ï¼Œæ¢ç´¢å°†å› æœæ¨ç†é›†æˆåˆ°æœºå™¨å­¦ä¹ ä¸­çš„æ–¹æ³•

[towardsdatascience.com ![](img/ef72754fb775f028a38e302643adcd49.png)

ç”¨æˆ·ç”Ÿæˆçš„å›¾ç‰‡

ä» PCMCI è¾“å‡ºçš„å› æœå›¾å¦‚ä¸Šæ‰€ç¤ºã€‚ä»¥ä¸‹å‡ ç‚¹æ˜¾è€Œæ˜“è§ï¼š

1.  æµ·æ»¨è®¿é—®æ˜¯å†°æ·‡æ·‹é”€å”®çš„ç›´æ¥åŸå› 

1.  æ¸©åº¦æ˜¯å†°æ·‡æ·‹é”€å”®çš„é—´æ¥åŸå› 

1.  é²¨é±¼æ”»å‡»æ˜¯ä¸€ä¸ªè™šå‡ç›¸å…³æ€§

ä½ è´¨ç–‘ä»»ä½•æœ‰å¸¸è¯†çš„äººæ€ä¹ˆä¼šæŠŠé²¨é±¼æ”»å‡»ä½œä¸ºç‰¹å¾ï¼æŸ¥çœ‹æ–‡æ¡£åï¼Œä¼¼ä¹é¡¾é—®æ˜¯ä½¿ç”¨ ChatGPT è·å–äº†ä¸€ä¸ªå¾…è€ƒè™‘ç‰¹å¾çš„åˆ—è¡¨ï¼Œç„¶åä½¿ç”¨ autoML è®­ç»ƒäº†æ¨¡å‹ã€‚

æ‰€ä»¥ï¼Œå¦‚æœ ChatGPT å’Œ autoML è®¤ä¸ºé²¨é±¼æ”»å‡»åº”è¯¥åœ¨æ¨¡å‹ä¸­ï¼Œéš¾é“å®ƒä¸ä¼šé€ æˆä»»ä½•å±å®³å—ï¼Ÿ

## é¢„å¤„ç†æ¡ˆä¾‹ç ”ç©¶æ•°æ®

æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†ï¼Œä»¥ä½¿å…¶é€‚åˆè¿™ä¸ªæ¡ˆä¾‹ç ”ç©¶ã€‚ä¸ºäº†åˆ›å»ºç‰¹å¾ï¼Œæˆ‘ä»¬éœ€è¦è·å–æ¯ä¸€åˆ—çš„æ»åå€¼ï¼ˆæŸ¥çœ‹æ•°æ®ç”Ÿæˆè¿‡ç¨‹ä»¥ç†è§£ä¸ºä½•ç‰¹å¾éœ€è¦æ˜¯æ»åå€¼ï¼‰ï¼š

```py
# create dataframne
df_pd = pd.DataFrame(df.values[0], columns=var_names)

# calcuate lagged values for each column
lag_periods = 1 

for col in var_names:
    df_pd[f'{col}_lag{lag_periods}'] = df_pd[col].shift(lag_periods)

# remove 1st obervations where we don't have lagged values
df_pd = df_pd.iloc[1:, :]

df_pd
```

![](img/298d7e072e0a8fa2f6989842e6bd4ce1.png)

ç”¨æˆ·ç”Ÿæˆçš„å›¾ç‰‡

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›æ»åç‰¹å¾æ¥é¢„æµ‹å†°æ·‡æ·‹é”€å”®ï¼Œä½†åœ¨æ­¤ä¹‹å‰ï¼Œè®©æˆ‘ä»¬ç»™è™šå‡ç›¸å…³æ€§å¼•å…¥ä¸€äº›æ•°æ®æ¼‚ç§»ï¼š

```py
# function to introduce feature drift based on indexes
def introduce_feature_drift(df, start_idx, end_idx, drift_amount):
    drift_period = (df.index >= start_idx) & (df.index <= end_idx)
    df.loc[drift_period, 'shark attacks_lag1'] += np.linspace(0, drift_amount, drift_period.sum())
    return df

# introduce feature drift
df_pd = introduce_feature_drift(df_pd, start_idx=500, end_idx=999, drift_amount=50.0)

# visualise drift
plt.figure(figsize=(12, 6))
sns.lineplot(data=df_pd[['shark attacks_lag1']])
plt.title('Feature Drift Over Time')
plt.xlabel('Index')
plt.ylabel('Value')
plt.legend(['shark attacks_lag1'])
plt.show()
```

![](img/979c0b072e146bec980c912f27650c7d.png)

ç”¨æˆ·ç”Ÿæˆçš„å›¾ç‰‡

è®©æˆ‘ä»¬å›åˆ°æ¡ˆä¾‹ç ”ç©¶ï¼Œç†è§£æˆ‘ä»¬æ‰€çœ‹åˆ°çš„å†…å®¹ã€‚ä¸ºä»€ä¹ˆé²¨é±¼æ”»å‡»çš„æ•°é‡å‘ç”Ÿäº†å˜åŒ–ï¼Ÿä½ åšäº†ä¸€äº›ç ”ç©¶ï¼Œå‘ç°é²¨é±¼æ”»å‡»çš„åŸå› ä¹‹ä¸€æ˜¯å†²æµªäººæ•°çš„å¢åŠ ã€‚æœ€è¿‘å‡ ä¸ªæœˆï¼Œå†²æµªçš„æ™®åŠåº¦å¤§å¹…ä¸Šå‡ï¼Œå¯¼è‡´äº†é²¨é±¼æ”»å‡»çš„å¢åŠ ã€‚é‚£ä¹ˆï¼Œè¿™å¯¹å†°æ·‡æ·‹é”€å”®é¢„æµ‹æœ‰ä»€ä¹ˆå½±å“å‘¢ï¼Ÿ

## æ¨¡å‹è®­ç»ƒ

ä½ å†³å®šä½¿ç”¨ä¸é¡¾é—®ç›¸åŒçš„ç‰¹å¾é‡æ–°åˆ›å»ºæ¨¡å‹ï¼Œç„¶åä»…ä½¿ç”¨ç›´æ¥åŸå› ï¼š

```py
# use first 500 observations for training
df_train = df_pd.iloc[0:500, :]

# use last 100 observations for evaluation
df_test = df_pd.iloc[900:, :]

# set feature lists
X_causal_cols = ["ice cream sales_lag1", "coastal visits_lag1"]
X_spurious_cols = ["ice cream sales_lag1", "coastal visits_lag1", "temperature_lag1", "shark attacks_lag1"]

# create target, train and test sets
y_train = df_train['ice cream sales'].copy()
y_test = df_test['ice cream sales'].copy()
X_causal_train = df_train[X_causal_cols].copy()
X_causal_test = df_test[X_causal_cols].copy()
X_spurious_train = df_train[X_spurious_cols].copy()
X_spurious_test = df_test[X_spurious_cols].copy()
```

åªä½¿ç”¨ç›´æ¥åŸå› è®­ç»ƒçš„æ¨¡å‹åœ¨è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸Šéƒ½è¡¨ç°å¾—å¾ˆå¥½ã€‚

```py
# train and validate model
model_causal = RidgeCV()
model_causal = model_causal.fit(X_causal_train, y_train)
print(f'Coefficient: {model_causal.coef_}')

yhat_causal_train = model_causal.predict(X_causal_train)
yhat_causal_test = model_causal.predict(X_causal_test)

mse_train = mean_squared_error(y_train, yhat_causal_train)
mse_test = mean_squared_error(y_test, yhat_causal_test)
print(f"Mean Squared Error train: {round(mse_train, 2)}")
print(f"Mean Squared Error test: {round(mse_test, 2)}")

r2_train = r2_score(y_train, yhat_causal_train)
r2_test = r2_score(y_test, yhat_causal_test)
print(f"R2 train: {round(r2_train, 2)}")
print(f"R2 test: {round(r2_test, 2)}")
```

![](img/a99b661eb27182a3109420cb80d4d844.png)

ç”¨æˆ·ç”Ÿæˆçš„å›¾ç‰‡

ç„¶è€Œï¼Œå½“ä½ ä½¿ç”¨æ‰€æœ‰ç‰¹å¾è®­ç»ƒæ¨¡å‹æ—¶ï¼Œä½ ä¼šå‘ç°æ¨¡å‹åœ¨è®­ç»ƒé›†ä¸Šè¡¨ç°è‰¯å¥½ï¼Œä½†åœ¨æµ‹è¯•é›†ä¸Šå´è¡¨ç°ä¸ä½³ã€‚çœ‹èµ·æ¥ä½ å·²ç»æ‰¾åˆ°äº†é—®é¢˜æ‰€åœ¨ï¼

```py
# train and validate model
model_spurious = RidgeCV()
model_spurious = model_spurious.fit(X_spurious_train, y_train)
print(f'Coefficient: {model_spurious.coef_}')

yhat_spurious_train = model_spurious.predict(X_spurious_train)
yhat_spurious_test = model_spurious.predict(X_spurious_test)

mse_train = mean_squared_error(y_train, yhat_spurious_train)
mse_test = mean_squared_error(y_test, yhat_spurious_test)
print(f"Mean Squared Error train: {round(mse_train, 2)}")
print(f"Mean Squared Error test: {round(mse_test, 2)}")

r2_train = r2_score(y_train, yhat_spurious_train)
r2_test = r2_score(y_test, yhat_spurious_test)
print(f"R2 train: {round(r2_train, 2)}")
print(f"R2 test: {round(r2_test, 2)}") 
```

![](img/34b3554125a3463125a1508807f62962.png)

ç”¨æˆ·ç”Ÿæˆçš„å›¾ç‰‡

å½“æˆ‘ä»¬æ¯”è¾ƒä¸¤ä¸ªæ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šçš„é¢„æµ‹æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸ºä»€ä¹ˆä½ çš„æœ‹å‹ä¼šåœ¨å†°æ·‡æ·‹åº“å­˜ä¸Šå‡ºç°çŸ­ç¼ºï¼

```py
# combine results
df_comp = pd.DataFrame({
    'Index': np.arange(99),
    'Actual': y_test,
    'Causal prediction': yhat_causal_test,
    'Spurious prediction': yhat_spurious_test
})

# melt the DataFrame to long format for seaborn
df_melted = df_comp.melt(id_vars=['Index'], value_vars=['Actual', 'Causal prediction', 'Spurious prediction'], var_name='Series', value_name='Value')

# visualise results for test set
plt.figure(figsize=(12, 6))
sns.lineplot(data=df_melted, x='Index', y='Value', hue='Series')
plt.title('Actual vs Predicted')
plt.xlabel('Index')
plt.ylabel('Value')
plt.legend(title='Series')
plt.show()
```

![](img/4c4b584d2faa4298eb39573a56423033.png)

ç”¨æˆ·ç”Ÿæˆçš„å›¾ç‰‡

# ç»“è¯­

ä»Šå¤©ï¼Œæˆ‘ä»¬æ¢è®¨äº†åœ¨é¢„æµ‹æ¨¡å‹ä¸­åŒ…å«è™šå‡ç›¸å…³æ€§ä¼šå¸¦æ¥å¤šä¹ˆä¸¥é‡çš„å½±å“ã€‚æœ€åï¼Œè®©æˆ‘ä»¬æ€»ç»“ä¸€äº›æ€è€ƒï¼š

+   æœ¬æ–‡çš„ç›®çš„æ˜¯è®©ä½ å¼€å§‹æ€è€ƒå¦‚ä½•é€šè¿‡ç†è§£å› æœå›¾æ¥æ”¹å–„ä½ çš„é¢„æµ‹ã€‚

+   æˆ‘çŸ¥é“è¿™ä¸ªä¾‹å­æœ‰ç‚¹å¤¸å¼ ï¼ˆæˆ‘å¸Œæœ›å¸¸è¯†åœ¨è¿™ç§æƒ…å†µä¸‹èƒ½èµ·ä½œç”¨ï¼ï¼‰ï¼Œä½†å®ƒå¸Œæœ›èƒ½å¤Ÿè¯´æ˜é—®é¢˜ã€‚

+   å¦ä¸€ä¸ªæœ‰è¶£çš„ç‚¹æ˜¯é²¨é±¼æ”»å‡»çš„ç³»æ•°æ˜¯è´Ÿå€¼ã€‚è¿™æ˜¯å¦ä¸€ä¸ªé™·é˜±ï¼Œå› ä¸ºä»é€»è¾‘ä¸Šè®²ï¼Œæˆ‘ä»¬æœ¬æ¥ä¼šæœŸæœ›è¿™ç§è™šå‡ç›¸å…³æ€§æ˜¯æ­£å€¼ã€‚

+   ä¸­é•¿æœŸéœ€æ±‚é¢„æµ‹éå¸¸å›°éš¾â€”â€”ä½ é€šå¸¸éœ€è¦ä¸ºæ¯ä¸ªç‰¹å¾å»ºç«‹ä¸€ä¸ªé¢„æµ‹æ¨¡å‹ï¼Œä»¥ä¾¿èƒ½å¤Ÿé¢„æµ‹å¤šä¸ªæ—¶é—´æ­¥çš„æœªæ¥ã€‚ æœ‰è¶£çš„æ˜¯ï¼Œå› æœå›¾ï¼ˆç‰¹åˆ«æ˜¯ç»“æ„å› æœæ¨¡å‹ï¼‰éå¸¸é€‚åˆè§£å†³è¿™ä¸ªé—®é¢˜ã€‚

å¦‚æœä½ æƒ³ç»§ç»­æ·±å…¥äº†è§£å› æœ AIï¼Œè¯·å…³æ³¨æˆ‘â€”â€”åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨å¦‚ä½•æ¯”è¾ƒ CUPED å’ŒåŒé‡æœºå™¨å­¦ä¹ å¦‚ä½•å¸®åŠ©æ¨åŠ¨ä½ çš„å®éªŒã€‚
