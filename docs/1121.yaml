- en: Get Underlined Text from Any PDF with Python
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ä½¿ç”¨Pythonä»ä»»ä½•PDFä¸­æå–å¸¦ä¸‹åˆ’çº¿çš„æ–‡æœ¬
- en: åŸæ–‡ï¼š[https://towardsdatascience.com/get-underlined-text-from-any-pdf-b7b068ca3d64?source=collection_archive---------8-----------------------#2024-05-03](https://towardsdatascience.com/get-underlined-text-from-any-pdf-b7b068ca3d64?source=collection_archive---------8-----------------------#2024-05-03)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://towardsdatascience.com/get-underlined-text-from-any-pdf-b7b068ca3d64?source=collection_archive---------8-----------------------#2024-05-03](https://towardsdatascience.com/get-underlined-text-from-any-pdf-b7b068ca3d64?source=collection_archive---------8-----------------------#2024-05-03)
- en: A step-by-step guide to get underlined text as an array from PDF files.
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ä¸€æ­¥æ­¥æŒ‡å—ï¼Œæ•™ä½ å¦‚ä½•ä»PDFæ–‡ä»¶ä¸­æå–å¸¦ä¸‹åˆ’çº¿çš„æ–‡æœ¬å¹¶å°†å…¶ä½œä¸ºæ•°ç»„å¤„ç†ã€‚
- en: '[](https://medium.com/@sasha.korovkina2003?source=post_page---byline--b7b068ca3d64--------------------------------)[![Sasha
    Korovkina](../Images/14eac2bafa3c5b417b8aecdef61e6ac3.png)](https://medium.com/@sasha.korovkina2003?source=post_page---byline--b7b068ca3d64--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--b7b068ca3d64--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--b7b068ca3d64--------------------------------)
    [Sasha Korovkina](https://medium.com/@sasha.korovkina2003?source=post_page---byline--b7b068ca3d64--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/@sasha.korovkina2003?source=post_page---byline--b7b068ca3d64--------------------------------)[![Sasha
    Korovkina](../Images/14eac2bafa3c5b417b8aecdef61e6ac3.png)](https://medium.com/@sasha.korovkina2003?source=post_page---byline--b7b068ca3d64--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--b7b068ca3d64--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--b7b068ca3d64--------------------------------)
    [Sasha Korovkina](https://medium.com/@sasha.korovkina2003?source=post_page---byline--b7b068ca3d64--------------------------------)'
- en: Â·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--b7b068ca3d64--------------------------------)
    Â·5 min readÂ·May 3, 2024
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: Â·å‘å¸ƒäº [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--b7b068ca3d64--------------------------------)
    Â·é˜…è¯»æ—¶é—´ï¼š5åˆ†é’ŸÂ·2024å¹´5æœˆ3æ—¥
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '*ğŸ’¡ If you want to see the code for this project, check out my repository:*
    [***https://github.com/sasha-korovkina/pdfUnderlinedExtractor***](https://github.com/sasha-korovkina/pdfUnderlinedExtractor)'
  id: totrans-6
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '*ğŸ’¡ å¦‚æœä½ æƒ³æŸ¥çœ‹è¿™ä¸ªé¡¹ç›®çš„ä»£ç ï¼Œå¯ä»¥è®¿é—®æˆ‘çš„ä»“åº“ï¼š* [***https://github.com/sasha-korovkina/pdfUnderlinedExtractor***](https://github.com/sasha-korovkina/pdfUnderlinedExtractor)'
- en: PDF data extraction can be a real headache, and it gets even trickier when youâ€™re
    trying to snag underlined text â€” believe it or not, there arenâ€™t any go-to solutions
    or libraries that handle this out of the box. But donâ€™t worry, Iâ€™m here to show
    you how to tackle this.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: PDFæ•°æ®æå–å¯èƒ½æ˜¯ä¸€ä¸ªçœŸæ­£çš„éš¾é¢˜ï¼Œå°¤å…¶æ˜¯åœ¨ä½ å°è¯•æå–å¸¦ä¸‹åˆ’çº¿çš„æ–‡æœ¬æ—¶â€”â€”ä¿¡ä¸ä¿¡ç”±ä½ ï¼Œç›®å‰æ²¡æœ‰ç°æˆçš„è§£å†³æ–¹æ¡ˆæˆ–åº“å¯ä»¥ç›´æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚ä¸è¿‡åˆ«æ‹…å¿ƒï¼Œæˆ‘ä¼šæ•™ä½ å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚
- en: '![](../Images/285d98ef8529f8e087521cbade385672.png)'
  id: totrans-8
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/285d98ef8529f8e087521cbade385672.png)'
- en: Photo by [dlxmedia.hu](https://unsplash.com/@dlxmedia?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡æ¥æºï¼š[dlxmedia.hu](https://unsplash.com/@dlxmedia?utm_source=medium&utm_medium=referral)
    äº [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
- en: The Theory
  id: totrans-10
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ç†è®º
- en: Extracting underlined text from PDFs can take a few different paths. You might
    consider using OCR to detect text components with bottom lines or delve into PyMuPDFâ€™s
    markup capabilities. However, Iâ€™ve found that OCR tends to falter, suffering from
    inconsistency and low accuracy. PyMuPDF isnâ€™t my favorite either â€” it demands
    finicky parameter tuning, which is time-consuming. Plus, one wrong setting and
    you could lose a bunch of data.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: ä»PDFä¸­æå–å¸¦ä¸‹åˆ’çº¿çš„æ–‡æœ¬æœ‰å‡ ç§ä¸åŒçš„æ–¹æ³•ã€‚ä½ å¯ä»¥è€ƒè™‘ä½¿ç”¨OCRæ¥æ£€æµ‹å¸¦åº•çº¿çš„æ–‡æœ¬ç»„ä»¶ï¼Œæˆ–è€…æ·±å…¥ç ”ç©¶PyMuPDFçš„æ ‡è®°åŠŸèƒ½ã€‚ç„¶è€Œï¼Œæˆ‘å‘ç°OCRå¾€å¾€ä¼šå‡ºç°é—®é¢˜ï¼Œè¡¨ç°ä¸ºä¸ä¸€è‡´å’Œä½ç²¾åº¦ã€‚PyMuPDFæˆ‘ä¹Ÿä¸å¤ªå–œæ¬¢â€”â€”å®ƒéœ€è¦ç»†è‡´çš„å‚æ•°è°ƒä¼˜ï¼Œéå¸¸è€—æ—¶ã€‚è€Œä¸”ï¼Œå¦‚æœè®¾ç½®é”™è¯¯ï¼Œä½ å¯èƒ½ä¼šä¸¢å¤±å¤§é‡æ•°æ®ã€‚
- en: 'It is important to remember that PDFs are:'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: éœ€è¦è®°ä½çš„æ˜¯ï¼ŒPDFæ–‡ä»¶æ˜¯ï¼š
- en: '**Non-Structured Data:** PDF elements often lack grouping or categorization,
    which complicates efforts to search through the content systematically.'
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**éç»“æ„åŒ–æ•°æ®ï¼š** PDFå…ƒç´ é€šå¸¸ç¼ºä¹åˆ†ç»„æˆ–åˆ†ç±»ï¼Œè¿™ä½¿å¾—ç³»ç»Ÿåœ°æœç´¢å†…å®¹å˜å¾—æ›´åŠ å¤æ‚ã€‚'
- en: '**Text Formatting Recognition:** Detecting specific text formats such as bold
    or underlined is notoriously difficult in PDFs, as most Python libraries do not
    support this capability effectively.'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**æ–‡æœ¬æ ¼å¼è¯†åˆ«ï¼š** åœ¨PDFä¸­æ£€æµ‹ç‰¹å®šçš„æ–‡æœ¬æ ¼å¼ï¼Œå¦‚ç²—ä½“æˆ–ä¸‹åˆ’çº¿ï¼Œé€šå¸¸éå¸¸å›°éš¾ï¼Œå› ä¸ºå¤§å¤šæ•°Pythonåº“å¹¶æœªæœ‰æ•ˆæ”¯æŒè¿™ä¸€åŠŸèƒ½ã€‚'
- en: But fear not, as we have a strategy to resolve this.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†åˆ«æ€•ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªç­–ç•¥æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚
- en: The Strategy
  id: totrans-16
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ç­–ç•¥
- en: 'Convert the PDF to Structured XML: Start by transforming the PDF document into
    a structured XML format to facilitate easier data manipulation.'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å°†PDFè½¬æ¢ä¸ºç»“æ„åŒ–XMLï¼šé¦–å…ˆå°†PDFæ–‡æ¡£è½¬æ¢ä¸ºç»“æ„åŒ–XMLæ ¼å¼ï¼Œä»¥ä¾¿äºæ•°æ®å¤„ç†ã€‚
- en: 'Extract Desired Components: Identify and isolate the specific components from
    the XML that are relevant to our needs.'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æå–æ‰€éœ€ç»„ä»¶ï¼šä»XMLä¸­è¯†åˆ«å¹¶éš”ç¦»å‡ºä¸æˆ‘ä»¬éœ€æ±‚ç›¸å…³çš„ç‰¹å®šç»„ä»¶ã€‚
- en: Use OCR (Optical Character Recognition) on the extracted coordinates to get
    the underlined text data as an array.
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨OCRï¼ˆå…‰å­¦å­—ç¬¦è¯†åˆ«ï¼‰æŠ€æœ¯å¤„ç†æå–çš„åæ ‡ï¼Œè·å–ä¸‹åˆ’çº¿æ–‡æœ¬æ•°æ®ä½œä¸ºæ•°ç»„ã€‚
- en: 'Extract and Output Underlined Text: Finally, extract the underlined text from
    the document and display or print the results.'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æå–å¹¶è¾“å‡ºä¸‹åˆ’çº¿æ–‡æœ¬ï¼šæœ€åï¼Œä»æ–‡æ¡£ä¸­æå–ä¸‹åˆ’çº¿æ–‡æœ¬å¹¶æ˜¾ç¤ºæˆ–æ‰“å°ç»“æœã€‚
- en: The Code
  id: totrans-21
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ä»£ç 
- en: '**PDF to XML**'
  id: totrans-22
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**PDFè½¬XML**'
- en: We will use the **pdfquery** library, the most comprehensive PDF to XML converter
    which I have come across.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å°†ä½¿ç”¨**pdfquery**åº“ï¼Œè¿™æ˜¯æˆ‘é‡åˆ°çš„æœ€å…¨é¢çš„PDFè½¬XMLè½¬æ¢å™¨ã€‚
- en: 2\. **Studying the XML**
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 2\. **ç ”ç©¶XML**
- en: 'The XML has a few key components which we are interested in:'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: XMLä¸­æœ‰å‡ ä¸ªå…³é”®ç»„ä»¶æ˜¯æˆ‘ä»¬æ„Ÿå…´è¶£çš„ï¼š
- en: '*LTRect â€”* sometimes, the library would parse the underlined text as a rectangle
    of minimal width under the text'
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*LTRect â€”* æœ‰æ—¶ï¼Œåº“ä¼šå°†ä¸‹åˆ’çº¿æ–‡æœ¬è§£æä¸ºæ–‡æœ¬ä¸‹æ–¹çš„ä¸€ä¸ªæœ€å°å®½åº¦çŸ©å½¢'
- en: '*LTLine â€”* other times, it would recognise the outline as a separate line component.'
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*LTLine â€”* æœ‰æ—¶ï¼Œå®ƒä¼šå°†è½®å»“è¯†åˆ«ä¸ºä¸€ä¸ªç‹¬ç«‹çš„çº¿æ¡ç»„ä»¶ã€‚'
- en: '![](../Images/8608bd7c5289acf9d2f7d11e47b21416.png)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/8608bd7c5289acf9d2f7d11e47b21416.png)'
- en: This is what your output XML will look like. Image created by author.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å°±æ˜¯æ‚¨çš„è¾“å‡ºXMLçš„æ ·å­ã€‚å›¾åƒç”±ä½œè€…åˆ›å»ºã€‚
- en: 'LTRect component example:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: LTRectç»„ä»¶ç¤ºä¾‹ï¼š
- en: '[PRE0]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Therefore, by converting the whole document into XML format, we can replicate
    itâ€™s structure as XML components, letâ€™s do just that!
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: å› æ­¤ï¼Œé€šè¿‡å°†æ•´ä¸ªæ–‡æ¡£è½¬æ¢ä¸ºXMLæ ¼å¼ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ç»“æ„ä½œä¸ºXMLç»„ä»¶è¿›è¡Œå¤åˆ¶ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±è¿™ä¹ˆåšï¼
- en: Structure Replication
  id: totrans-33
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ç»“æ„å¤åˆ¶
- en: Now, we will re-create the structure of our document as bounding box coordinates.
    To do this, we will parse the XML to define the page, component boxes, lines and
    rectangles, and then draw them all on our canvas in 3 different colors.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œæˆ‘ä»¬å°†é‡æ–°åˆ›å»ºæ–‡æ¡£çš„ç»“æ„ä½œä¸ºè¾¹ç•Œæ¡†åæ ‡ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†è§£æXMLï¼Œå®šä¹‰é¡µé¢ã€ç»„ä»¶æ¡†ã€çº¿æ¡å’ŒçŸ©å½¢ï¼Œç„¶åç”¨ä¸‰ç§ä¸åŒçš„é¢œè‰²å°†å®ƒä»¬å…¨éƒ¨ç»˜åˆ¶åœ¨æˆ‘ä»¬çš„ç”»å¸ƒä¸Šã€‚
- en: PDF object visualization.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: PDFå¯¹è±¡å¯è§†åŒ–ã€‚
- en: 'Here is our inital PDF, it has been generated in Microsoft Word, by exporting
    a document with some underlines to the PDF file format:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯æˆ‘ä»¬çš„åˆå§‹PDFï¼Œå®ƒæ˜¯é€šè¿‡åœ¨Microsoft Wordä¸­ç”Ÿæˆçš„ï¼Œé€šè¿‡å¯¼å‡ºåŒ…å«ä¸€äº›ä¸‹åˆ’çº¿çš„æ–‡æ¡£ä¸ºPDFæ–‡ä»¶æ ¼å¼ï¼š
- en: '![](../Images/a80e9d4b25647cc24bf887bd82a7167b.png)'
  id: totrans-37
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a80e9d4b25647cc24bf887bd82a7167b.png)'
- en: Initial document with sample text. Image created by author.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: åˆå§‹æ–‡æ¡£ï¼ŒåŒ…å«ç¤ºä¾‹æ–‡æœ¬ã€‚å›¾åƒç”±ä½œè€…åˆ›å»ºã€‚
- en: 'After applying the algorithm above, here is the visual representation we get:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: åº”ç”¨ä¸Šè¿°ç®—æ³•åï¼Œè¿™å°±æ˜¯æˆ‘ä»¬å¾—åˆ°çš„è§†è§‰è¡¨ç¤ºï¼š
- en: '![](../Images/457a9ed2f8f94ae00805ad5a5400450f.png)'
  id: totrans-40
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/457a9ed2f8f94ae00805ad5a5400450f.png)'
- en: The box outline of the document Black â€” all document components, blue â€” underlined
    text. Image created by author.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: æ–‡æ¡£çš„æ¡†æ¶è½®å»“ï¼šé»‘è‰²â€”æ‰€æœ‰æ–‡æ¡£ç»„ä»¶ï¼Œè“è‰²â€”ä¸‹åˆ’çº¿æ–‡æœ¬ã€‚å›¾åƒç”±ä½œè€…åˆ›å»ºã€‚
- en: This image represents the structure of our document, where the black box is
    used to describe all components on the page, and the blue is used to describe
    the LTRect elements, hence the underlined text.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å¼ å›¾ç‰‡å±•ç¤ºäº†æˆ‘ä»¬æ–‡æ¡£çš„ç»“æ„ï¼Œå…¶ä¸­é»‘è‰²æ¡†ç”¨äºæè¿°é¡µé¢ä¸Šçš„æ‰€æœ‰ç»„ä»¶ï¼Œè“è‰²æ¡†ç”¨äºæè¿°LTRectå…ƒç´ ï¼Œå› æ­¤å‡ºç°äº†ä¸‹åˆ’çº¿æ–‡æœ¬ã€‚
- en: Text Overlay
  id: totrans-43
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ–‡æœ¬å åŠ 
- en: 'Now, letâ€™s visualize all of the text within the PDF in itâ€™s respective positions,
    with the following line of code:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€šè¿‡ä»¥ä¸‹ä»£ç è¡Œå°†PDFä¸­çš„æ‰€æœ‰æ–‡æœ¬å¯è§†åŒ–ï¼Œæ˜¾ç¤ºåœ¨å„è‡ªçš„ä½ç½®ä¸Šï¼š
- en: '[PRE1]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Here is the output:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯è¾“å‡ºç»“æœï¼š
- en: '![](../Images/5a5d3f146599aa71accb262a8f815427.png)'
  id: totrans-47
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/5a5d3f146599aa71accb262a8f815427.png)'
- en: PDF re-creation based on text location and underlines. Image created by author.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: åŸºäºæ–‡æœ¬ä½ç½®å’Œä¸‹åˆ’çº¿çš„PDFé‡æ–°åˆ›å»ºã€‚å›¾åƒç”±ä½œè€…åˆ›å»ºã€‚
- en: Note that the text is not exactly where it was in the original document, due
    to the difference in size and font of the mark-up language in the pdfquery library.
  id: totrans-49
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: è¯·æ³¨æ„ï¼Œç”±äºpdfqueryåº“ä¸­æ ‡è®°è¯­è¨€çš„å¤§å°å’Œå­—ä½“å·®å¼‚ï¼Œæ–‡æœ¬çš„ä½ç½®ä¸åŸå§‹æ–‡æ¡£ä¸­çš„ä½ç½®ä¸å®Œå…¨ä¸€è‡´ã€‚
- en: Co-Ordinate Extraction
  id: totrans-50
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: åæ ‡æå–
- en: As the result of our XML, we will have an array of coordinates of underlined
    regions, in my case I have called it underline_text.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œä¸ºXMLç»“æœï¼Œæˆ‘ä»¬å°†å¾—åˆ°ä¸€ç»„ä¸‹åˆ’çº¿åŒºåŸŸçš„åæ ‡æ•°ç»„ï¼Œåœ¨æˆ‘çš„æ¡ˆä¾‹ä¸­ï¼Œæˆ‘å°†å…¶å‘½åä¸ºunderline_textã€‚
- en: A piece of code which forms an array of coordinates of underlined text within
    the PDF file.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€æ®µå½¢æˆPDFæ–‡ä»¶ä¸­ä¸‹åˆ’çº¿æ–‡æœ¬åæ ‡æ•°ç»„çš„ä»£ç ã€‚
- en: Text Extraction
  id: totrans-53
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ–‡æœ¬æå–
- en: 'Hereâ€™s the process:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: è¿‡ç¨‹å¦‚ä¸‹ï¼š
- en: We identify the coordinate rectangles as previously determined.
  id: totrans-55
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬è¯†åˆ«å‡ºå…ˆå‰ç¡®å®šçš„åæ ‡çŸ©å½¢ã€‚
- en: We extract these sections from the PDF.
  id: totrans-56
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ä»PDFä¸­æå–è¿™äº›éƒ¨åˆ†ã€‚
- en: We apply Tesseract OCR to extract text from each extracted section.
  id: totrans-57
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬åº”ç”¨ Tesseract OCR ä»æ¯ä¸ªæå–çš„éƒ¨åˆ†ä¸­æå–æ–‡æœ¬ã€‚
- en: 'This method of extracting text from PDFs using coordinate rectangles and Tesseract
    OCR is effective for several reasons:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨åæ ‡çŸ©å½¢å’Œ Tesseract OCR ä» PDF ä¸­æå–æ–‡æœ¬çš„æ–¹æ³•ä¹‹æ‰€ä»¥æœ‰æ•ˆï¼Œæœ‰å‡ ä¸ªåŸå› ï¼š
- en: '**Precision in Text Extraction**: By identifying specific coordinate rectangles,
    the process targets only relevant areas of the PDF. This focused approach avoids
    unnecessary processing of the entire document and reduces errors related to extracting
    unwanted text.'
  id: totrans-59
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**æ–‡æœ¬æå–çš„ç²¾åº¦**ï¼šé€šè¿‡è¯†åˆ«ç‰¹å®šçš„åæ ‡çŸ©å½¢ï¼Œå¤„ç†è¿‡ç¨‹ä»…é’ˆå¯¹ PDF ä¸­çš„ç›¸å…³åŒºåŸŸã€‚è¿™ç§èšç„¦çš„æ–¹æ³•é¿å…äº†å¯¹æ•´ä¸ªæ–‡æ¡£çš„æ— è°“å¤„ç†ï¼Œå¹¶å‡å°‘äº†æå–ä¸éœ€è¦çš„æ–‡æœ¬æ—¶å‡ºç°çš„é”™è¯¯ã€‚'
- en: '**Efficiency**: Extracting predefined sections directly from the PDF is much
    faster than processing the entire document. This method saves computational resources
    and time, particularly useful when dealing with large documents.'
  id: totrans-60
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**æ•ˆç‡**ï¼šç›´æ¥ä» PDF ä¸­æå–é¢„å®šä¹‰éƒ¨åˆ†æ¯”å¤„ç†æ•´ä¸ªæ–‡æ¡£è¦å¿«å¾—å¤šã€‚è¿™ç§æ–¹æ³•èŠ‚çœäº†è®¡ç®—èµ„æºå’Œæ—¶é—´ï¼Œå°¤å…¶åœ¨å¤„ç†å¤§å‹æ–‡æ¡£æ—¶ç‰¹åˆ«æœ‰ç”¨ã€‚'
- en: '**Accuracy with OCR**: Tesseract OCR is a robust optical character recognition
    tool that can convert images of text into machine-readable text. By feeding it
    precise sections of text, it can perform more accurately as it deals with less
    background noise and formatting issues that might confuse the OCR process in larger,
    unsegmented documents.'
  id: totrans-61
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**OCR ç²¾åº¦**ï¼šTesseract OCR æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å…‰å­¦å­—ç¬¦è¯†åˆ«å·¥å…·ï¼Œèƒ½å¤Ÿå°†æ–‡æœ¬å›¾åƒè½¬æ¢ä¸ºæœºå™¨å¯è¯»çš„æ–‡æœ¬ã€‚é€šè¿‡å‘å…¶æä¾›ç²¾ç¡®çš„æ–‡æœ¬éƒ¨åˆ†ï¼Œå®ƒå¯ä»¥æ›´å‡†ç¡®åœ°æ‰§è¡Œä»»åŠ¡ï¼Œå› ä¸ºå®ƒå¤„ç†çš„æ–‡æœ¬èƒŒæ™¯å™ªå£°å’Œæ ¼å¼é—®é¢˜è¾ƒå°‘ï¼Œè¿™èƒ½é¿å…åœ¨è¾ƒå¤§ã€æœªåˆ†å‰²çš„æ–‡æ¡£ä¸­æ··æ·†
    OCR è¿‡ç¨‹ã€‚'
- en: 'And this is the code:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å°±æ˜¯ä»£ç ï¼š
- en: Code to extract underlined text from the PDF sections.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: ä» PDF éƒ¨åˆ†æå–ä¸‹åˆ’çº¿æ–‡æœ¬çš„ä»£ç ã€‚
- en: 'Make sure that you have tesseract installed on your system before running this
    function. For in-depth instructions, check out their official installation guide
    here: [https://github.com/tesseract-ocr/tessdoc/blob/main/Installation.md](https://github.com/tesseract-ocr/tessdoc/blob/main/Installation.md)
    or in my GitHub repository here: [https://github.com/sasha-korovkina/pdfUnderlinedExtractor](https://github.com/sasha-korovkina/pdfUnderlinedExtractor).'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿è¡Œæ­¤åŠŸèƒ½ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ çš„ç³»ç»Ÿä¸Šå·²å®‰è£… tesseractã€‚æœ‰å…³è¯¦ç»†è¯´æ˜ï¼Œè¯·æŸ¥çœ‹ä»–ä»¬çš„å®˜æ–¹å®‰è£…æŒ‡å—ï¼š[https://github.com/tesseract-ocr/tessdoc/blob/main/Installation.md](https://github.com/tesseract-ocr/tessdoc/blob/main/Installation.md)
    æˆ–è€…åœ¨æˆ‘çš„ GitHub ä»“åº“ä¸­æŸ¥çœ‹ï¼š[https://github.com/sasha-korovkina/pdfUnderlinedExtractor](https://github.com/sasha-korovkina/pdfUnderlinedExtractor)ã€‚
- en: Putting It All Togetherâ€¦
  id: totrans-65
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ•´åˆæ‰€æœ‰å†…å®¹â€¦
- en: 'Now, If we take any PDF file, like this example file:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬å–ä»»ä½• PDF æ–‡ä»¶ï¼Œä¾‹å¦‚è¿™ä¸ªç¤ºä¾‹æ–‡ä»¶ï¼š
- en: '![](../Images/b9c573eeffa8a19dd77c3dd3138bafec.png)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b9c573eeffa8a19dd77c3dd3138bafec.png)'
- en: The whole text of the test file. Image created by author.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: æµ‹è¯•æ–‡ä»¶çš„å®Œæ•´æ–‡æœ¬ã€‚å›¾ç‰‡ç”±ä½œè€…åˆ›å»ºã€‚
- en: 'We have some underlined words in this file:'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­æœ‰ä¸€äº›ä¸‹åˆ’çº¿çš„è¯è¯­ï¼š
- en: '![](../Images/60fb741f57fc777ffca8bcb4160942ab.png)'
  id: totrans-70
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/60fb741f57fc777ffca8bcb4160942ab.png)'
- en: ipsum and laboris are underlined here. Image created by author.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™é‡Œä¸‹åˆ’çº¿çš„å†…å®¹æ˜¯â€œipsumâ€å’Œâ€œlaborisâ€ã€‚å›¾ç‰‡ç”±ä½œè€…åˆ›å»ºã€‚
- en: 'After running the code described above, here is what we get:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿è¡Œä¸Šè¿°ä»£ç åï¼Œå¾—åˆ°çš„ç»“æœæ˜¯ï¼š
- en: '![](../Images/7ad6d67e67f7828203225fedc39034eb.png)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/7ad6d67e67f7828203225fedc39034eb.png)'
- en: An array of all underlined words in the document. Image created by author.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: æ–‡æ¡£ä¸­æ‰€æœ‰ä¸‹åˆ’çº¿è¯è¯­çš„æ•°ç»„ã€‚å›¾ç‰‡ç”±ä½œè€…åˆ›å»ºã€‚
- en: After getting this array, you can use these words for further processing!
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: å¾—åˆ°è¿™ä¸ªæ•°ç»„åï¼Œä½ å¯ä»¥å°†è¿™äº›è¯è¯­ç”¨äºè¿›ä¸€æ­¥å¤„ç†ï¼
- en: Enjoy using this script! Iâ€™d love to hear about any creative applications you
    come up with or if youâ€™d like to contribute. Let me know! â¤ï¸
  id: totrans-76
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: äº«å—ä½¿ç”¨è¿™ä¸ªè„šæœ¬çš„è¿‡ç¨‹å§ï¼æˆ‘å¾ˆä¹æ„å¬å¬ä½ æƒ³åˆ°çš„ä»»ä½•åˆ›é€ æ€§åº”ç”¨ï¼Œæˆ–è€…å¦‚æœä½ æƒ³è´¡çŒ®ä¸€äº›å†…å®¹ï¼Œè¯·å‘Šè¯‰æˆ‘ï¼â¤ï¸
