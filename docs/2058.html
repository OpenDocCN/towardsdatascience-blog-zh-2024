<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>DBSCAN, Explained in 5 Minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>DBSCAN, Explained in 5 Minutes</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/dbscan-explained-in-5-minutes-133f6a9766e4?source=collection_archive---------4-----------------------#2024-08-23">https://towardsdatascience.com/dbscan-explained-in-5-minutes-133f6a9766e4?source=collection_archive---------4-----------------------#2024-08-23</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="ba31" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">Fastest implementation in python🐍</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@alexroz?source=post_page---byline--133f6a9766e4--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Aleksei Rozanov" class="l ep by dd de cx" src="../Images/748b69bfaccf39c9aa568a9e6f41eec3.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*JISS93SvFnwE3NMNTl8HAQ.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--133f6a9766e4--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://medium.com/@alexroz?source=post_page---byline--133f6a9766e4--------------------------------" rel="noopener follow">Aleksei Rozanov</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--133f6a9766e4--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">5 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Aug 23, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj lc ld ab q ee le lf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count la lb">2</span></p></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lg k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lh an ao ap id li lj lk" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep ll cn"><div class="l ae"><div class="ab cb"><div class="lm ln lo lp lq lr ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk ml"><img src="../Images/e034fb66930bd44b034406ac41f56803.png" data-original-src="https://miro.medium.com/v2/resize:fit:1060/format:webp/1*JnBvz3A8_J99SVo-6tpZ8w.png"/></div><figcaption class="mt mu mv mj mk mw mx bf b bg z dx">Image by <a class="af my" href="https://medium.com/@alexroz" rel="noopener">author</a>.</figcaption></figure><p id="141b" class="pw-post-body-paragraph mz na fq nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk nv"><span class="l nw nx ny bo nz oa ob oc od ed">W</span>hat’s <strong class="nb fr">DBSCAN</strong> [1]? How to build it in python? There are many articles covering this topic, but I think the algorithm itself is so simple and intuitive that it’s possible to explain its idea in just <em class="oe">5 minutes</em>, so let’s try to do that.</p><blockquote class="of og oh"><p id="6ffa" class="mz na oe nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk">DBSCAN = Density-Based Spatial Clustering of Applications with Noise</p></blockquote><h2 id="779f" class="oi oj fq bf ok ol om on oo op oq or os ni ot ou ov nm ow ox oy nq oz pa pb pc bk">What does it mean?</h2><ol class=""><li id="3113" class="mz na fq nb b go pd nd ne gr pe ng nh ni pf nk nl nm pg no np nq ph ns nt nu pi pj pk bk">The algorithm searches for clusters inside the data based on <strong class="nb fr">the spatial distance between objects</strong>.</li><li id="2468" class="mz na fq nb b go pl nd ne gr pm ng nh ni pn nk nl nm po no np nq pp ns nt nu pi pj pk bk">The algorithm can <strong class="nb fr">identify outliers</strong> (noise).</li></ol><h2 id="c903" class="oi oj fq bf ok ol om on oo op oq or os ni ot ou ov nm ow ox oy nq oz pa pb pc bk">Why do you need DBSCAN at all???</h2><ul class=""><li id="53ee" class="mz na fq nb b go pd nd ne gr pe ng nh ni pf nk nl nm pg no np nq ph ns nt nu pq pj pk bk"><strong class="nb fr">Extract a new feature.</strong> If the dataset you’re dealing with is large, it might be helpful to find obvious clusters inside the data and work with each cluster separately (train different models for different clusters).</li><li id="d99d" class="mz na fq nb b go pl nd ne gr pm ng nh ni pn nk nl nm po no np nq pp ns nt nu pq pj pk bk"><strong class="nb fr">Compress the data.</strong> Often we have to deal with millions of rows, which is expensive computationally and time consuming. Clustering the data and then keeping only X% from each cluster <em class="oe">might save your wicked data science soul</em>. Therefore, you’ll <strong class="nb fr">keep the balance</strong> inside the dataset, but <strong class="nb fr">reduce its size</strong>.</li><li id="78b0" class="mz na fq nb b go pl nd ne gr pm ng nh ni pn nk nl nm po no np nq pp ns nt nu pq pj pk bk"><strong class="nb fr">Novelty detection.</strong> It’s been mentioned before that DBSCAN detects noise, but the noise might be a previously unknown feature of the dataset, which you can preserve and use in modeling.</li></ul><p id="9125" class="pw-post-body-paragraph mz na fq nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk">Then you may say: but there is the super-reliable and effective <strong class="nb fr">k-means</strong> algorithm.</p><div class="pr ps pt pu pv pw"><a rel="noopener follow" target="_blank" href="/semantic-segmentation-of-remote-sensing-imagery-using-k-means-e4c165d9218e?source=post_page-----133f6a9766e4--------------------------------"><div class="px ab ig"><div class="py ab co cb pz qa"><h2 class="bf fr hw z io qb iq ir qc it iv fp bk">Semantic Segmentation of Remote Sensing Imagery using k-Means</h2><div class="qd l"><h3 class="bf b hw z io qb iq ir qc it iv dx">From scratch in python🐍</h3></div><div class="qe l"><p class="bf b dy z io qb iq ir qc it iv dx">towardsdatascience.com</p></div></div><div class="qf l"><div class="qg l qh qi qj qf qk lr pw"/></div></div></a></div><p id="330c" class="pw-post-body-paragraph mz na fq nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk">Yes, but the sweetest part about DBSCAN is that it overcomes the drawbacks of k-means, and you don’t need to specify the number of clusters. <strong class="nb fr">DBSCAN detects clusters for you!</strong></p><p id="f015" class="pw-post-body-paragraph mz na fq nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk">DBSCAN has two components defined by a user: vicinity, or radius (<strong class="nb fr">𝜀</strong>), and the number of neighbors (<strong class="nb fr">N</strong>).</p><p id="add1" class="pw-post-body-paragraph mz na fq nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk">For a dataset consisting of some objects, the algorithm is based on the following ideas:</p><ol class=""><li id="9ff6" class="mz na fq nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu pi pj pk bk"><strong class="nb fr">Core objets</strong>. An object is called a core object if within distance <strong class="nb fr">𝜀</strong> it has <em class="oe">at least </em><strong class="nb fr">N</strong> other objects.</li><li id="bac6" class="mz na fq nb b go pl nd ne gr pm ng nh ni pn nk nl nm po no np nq pp ns nt nu pi pj pk bk">An non-core object lying within <strong class="nb fr">𝜀</strong>-vicinity of a core-point is called a <strong class="nb fr">border object</strong>.</li><li id="29fa" class="mz na fq nb b go pl nd ne gr pm ng nh ni pn nk nl nm po no np nq pp ns nt nu pi pj pk bk">A core object forms a <strong class="nb fr">cluster</strong> with all the core and border objects within <strong class="nb fr">𝜀</strong>-vicinity.</li><li id="0b49" class="mz na fq nb b go pl nd ne gr pm ng nh ni pn nk nl nm po no np nq pp ns nt nu pi pj pk bk">If an object is neither core or border, it’s called <strong class="nb fr">noise (outlier)</strong>. It doesn’t belong to any cluster.</li></ol><p id="5fbf" class="pw-post-body-paragraph mz na fq nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk">To implement DBSCAN it’s necessary to create a distance function. In this article we will be using the Euclidean distance:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk ql"><img src="../Images/2fd5387f00392750e94306d81375c782.png" data-original-src="https://miro.medium.com/v2/resize:fit:450/format:webp/0*0nEv6Ygk5MA391b7"/></div><figcaption class="mt mu mv mj mk mw mx bf b bg z dx">Image by <a class="af my" href="https://medium.com/@alexroz" rel="noopener">author</a>.</figcaption></figure><p id="10e4" class="pw-post-body-paragraph mz na fq nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk">The pseudo-code for our algorithm looks like this:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk qm"><img src="../Images/511de6d35f92eb58fad5b01d3ea2ee7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/0*jd0GKGzatKQuoHuR"/></div><figcaption class="mt mu mv mj mk mw mx bf b bg z dx">Image by [2].</figcaption></figure><blockquote class="of og oh"><p id="ec52" class="mz na oe nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk"><strong class="nb fr">As always the code of this article you can find on my </strong><a class="af my" href="https://github.com/alexxxroz/Medium/blob/main/DBSCAN.ipynb" rel="noopener ugc nofollow" target="_blank"><strong class="nb fr">GitHub</strong></a><strong class="nb fr">.</strong></p></blockquote><p id="cd48" class="pw-post-body-paragraph mz na fq nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk">Let’s begin with the distance function:</p><pre class="mm mn mo mp mq qn qo qp bp qq bb bk"><span id="6805" class="qr oj fq qo b bg qs qt l qu qv">def distances(object, data):<br/>  euclidean = []<br/>  for row in data: #iterating through all the objects in the dataset<br/>    d = 0<br/>    for i in range(data.shape[1]): #calculating sum of squared residuals for all the coords<br/>      d+=(row[i]-object[i])**2<br/>    euclidean.append(d**0.5) #taking a sqaure root<br/>  return np.array(euclidean)</span></pre><p id="eb36" class="pw-post-body-paragraph mz na fq nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk">Now let’s build the body of the algorithm:</p><pre class="mm mn mo mp mq qn qo qp bp qq bb bk"><span id="8a5a" class="qr oj fq qo b bg qs qt l qu qv">def DBSCAN(data, epsilon=0.5, N=3):<br/>  visited, noise = [], [] #lists to collect visited points and outliers<br/>  clusters = [] #list to collect clusters<br/>  for i in range(data.shape[0]): #iterating through all the points<br/>    if i not in visited: #getting in if the point's not visited<br/>      visited.append(i)<br/>      d = distances(data[i], data) #getting distances to all the other points<br/>      neighbors = list(np.where((d&lt;=epsilon)&amp;(d!=0))[0]) #getting the list of neighbors in the epsilon vicinity and removing distance = 0 (it's the point itself)<br/>      if len(neighbors)&lt;N: #if the number of object is less than N, it's an outlier<br/>        noise.append(i)<br/>      else:<br/>        cluster = [i] #otherwise it forms a new cluster<br/>        for neighbor in neighbors: #iterating trough all the neighbors of the point i<br/>          if neighbor not in visited: #if neighbor isn't visited<br/>            visited.append(neighbor)<br/>            d = distances(data[neighbor], data) #get the distances to other objects from the neighbor<br/>            neighbors_idx = list(np.where((d&lt;=epsilon)&amp;(d!=0))[0]) #getting neighbors of the neighbor<br/>            if len(neighbors_idx)&gt;=N: #if the neighbor has N or more neighbors, than it's a core point<br/>              neighbors += neighbors_idx #add neighbors of the neighbor to the neighbors of the ith object<br/>          if not any(neighbor in cluster for cluster in clusters):<br/>            cluster.append(neighbor) #if neighbor is not in clusters, add it there<br/>        clusters.append(cluster) #put the cluster into clusters list<br/><br/>  return clusters, noise</span></pre><p id="3b4c" class="pw-post-body-paragraph mz na fq nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk">Done!</p><p id="0154" class="pw-post-body-paragraph mz na fq nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk">Let’s check the correctness of our implementation and compare it with <strong class="nb fr">sklearn</strong>.</p><p id="bb76" class="pw-post-body-paragraph mz na fq nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk">Let’s generate some synthetic data:</p><pre class="mm mn mo mp mq qn qo qp bp qq bb bk"><span id="0a71" class="qr oj fq qo b bg qs qt l qu qv">X1 = [[x,y] for x, y in zip(np.random.normal(6,1, 2000), np.random.normal(0,0.5, 2000))]<br/>X2 = [[x,y] for x, y in zip(np.random.normal(10,2, 2000), np.random.normal(6,1, 2000))]<br/>X3 = [[x,y] for x, y in zip(np.random.normal(-2,1, 2000), np.random.normal(4,2.5, 2000))]<br/><br/>fig, ax = plt.subplots()<br/>ax.scatter([x[0] for x in X1], [y[1] for y in X1], s=40, c='#00b8ff', edgecolors='#133e7c', linewidth=0.5, alpha=0.8)<br/>ax.scatter([x[0] for x in X2], [y[1] for y in X2], s=40, c='#00ff9f', edgecolors='#0abdc6', linewidth=0.5, alpha=0.8)<br/>ax.scatter([x[0] for x in X3], [y[1] for y in X3], s=40, c='#d600ff', edgecolors='#ea00d9', linewidth=0.5, alpha=0.8)<br/>ax.spines[['right', 'top', 'bottom', 'left']].set_visible(False)<br/>ax.set_xticks([])<br/>ax.set_yticks([])<br/>ax.set_facecolor('black')<br/>ax.patch.set_alpha(0.7)</span></pre><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk qw"><img src="../Images/f27953128084bd76852f0b2e754604f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*5KtlKFCZhJTWAX4lzSI7SQ.png"/></div><figcaption class="mt mu mv mj mk mw mx bf b bg z dx">Image by <a class="af my" href="https://medium.com/@alexroz" rel="noopener">author</a>.</figcaption></figure><p id="c6db" class="pw-post-body-paragraph mz na fq nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk">Let’s apply our implementation and visualize the results:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk qw"><img src="../Images/f10fec3abef911cd001c387b1dee55a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*iomOCbP618MRlaxaC7FzDA.png"/></div><figcaption class="mt mu mv mj mk mw mx bf b bg z dx">Image by <a class="af my" href="https://medium.com/@alexroz" rel="noopener">author</a>.</figcaption></figure><p id="dac1" class="pw-post-body-paragraph mz na fq nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk">For sklearn implementation we got the same clusters:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk qw"><img src="../Images/727430787a45f9542b63737f659ca610.png" data-original-src="https://miro.medium.com/v2/resize:fit:1078/format:webp/1*nOpzMepgCDEfsZMovymwHg.png"/></div><figcaption class="mt mu mv mj mk mw mx bf b bg z dx">Image by <a class="af my" href="https://medium.com/@alexroz" rel="noopener">author</a>.</figcaption></figure><p id="f2f0" class="pw-post-body-paragraph mz na fq nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk">That’s it, they are identical. 5 minutes and we’re done! When you try DBSCANning yourself, don’t forget to tune epsilon and the number of neighbors since they highlt influence the final results.</p><p id="20fb" class="pw-post-body-paragraph mz na fq nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk">===========================================</p><p id="bd38" class="pw-post-body-paragraph mz na fq nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk"><strong class="nb fr">Reference:</strong></p><p id="1c4f" class="pw-post-body-paragraph mz na fq nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk">[1] Ester, M., Kriegel, H. P., Sander, J., &amp; Xu, X. (1996, August). Density-based spatial clustering of applications with noise. In <em class="oe">Int. Conf. knowledge discovery and data mining</em> (Vol. 240, №6).</p><p id="abe2" class="pw-post-body-paragraph mz na fq nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk">[2] Yang, Yang, et al. “An efficient DBSCAN optimized by arithmetic optimization algorithm with opposition-based learning.” <em class="oe">The journal of supercomputing</em> 78.18 (2022): 19566–19604.</p><p id="a859" class="pw-post-body-paragraph mz na fq nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk">===========================================</p><p id="b97d" class="pw-post-body-paragraph mz na fq nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk"><em class="oe">All my publications on Medium are free and open-access, that’s why I’d really appreciate if you followed me here!</em></p><p id="1366" class="pw-post-body-paragraph mz na fq nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk">P.s. I’m extremely passionate about (Geo)Data Science, ML/AI and Climate Change. So if you want to work together on some project pls contact me in <a class="af my" href="https://www.linkedin.com/in/alexxxroz/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>.</p><p id="5e37" class="pw-post-body-paragraph mz na fq nb b go nc nd ne gr nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu fj bk">🛰️Follow for more🛰️</p></div></div></div></div>    
</body>
</html>