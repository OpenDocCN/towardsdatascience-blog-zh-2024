<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Dunder Methods: The Hidden Gems of Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Dunder Methods: The Hidden Gems of Python</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/dunder-methods-the-hidden-gems-of-python-a234e29b192d?source=collection_archive---------0-----------------------#2024-11-30">https://towardsdatascience.com/dunder-methods-the-hidden-gems-of-python-a234e29b192d?source=collection_archive---------0-----------------------#2024-11-30</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="9fae" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">Real-world examples on how actively using special methods can simplify coding and improve readability.</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@federico.zabeo29?source=post_page---byline--a234e29b192d--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Federico Zabeo" class="l ep by dd de cx" src="../Images/387bdad1380d507c9ace1cbea24a694c.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*sFJYvDTOpYsTwYhn7KtXmg.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--a234e29b192d--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://medium.com/@federico.zabeo29?source=post_page---byline--a234e29b192d--------------------------------" rel="noopener follow">Federico Zabeo</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--a234e29b192d--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">8 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Nov 30, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj lc ld ab q ee le lf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count la lb">3</span></p></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lg k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lh an ao ap id li lj lk" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep ll cn"><div class="l ae"><div class="ab cb"><div class="lm ln lo lp lq lr ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><p id="91f3" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Dunder methods, though possibly a basic topic in Python, are something I have often noticed being understood only superficially, even by people who have been coding for quite some time.</p><p id="acac" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk"><strong class="ml fr">Disclaimer: </strong>This is a forgivable gap, as in most cases, actively using dunder methods “simply” speeds up and standardize tasks that can be done differently. Even when their use is essential, programmers are often unaware that they are writing special methods that belong to the broader category of dunder methods.</p><p id="7af4" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Anyway, if you code in Python and are not familiar with this topic, or if you happen to be a code geek intrigued by the more native aspects of a programming language like I am, this article might just be what you’re looking for.</p><h2 id="9fb9" class="nf ng fq bf nh ni nj nk nl nm nn no np ms nq nr ns mw nt nu nv na nw nx ny nz bk"><strong class="al">Appearances can deceive… even in Python!</strong></h2><p id="40fa" class="pw-post-body-paragraph mj mk fq ml b go oa mn mo gr ob mq mr ms oc mu mv mw od my mz na oe nc nd ne fj bk">If there is one thing I learned in my life is that not everything is what it seems like at a first look, and Python is no exception.</p><figure class="oi oj ok ol om on of og paragraph-image"><div role="button" tabindex="0" class="oo op ed oq bh or"><div class="of og oh"><img src="../Images/07c8e26ee7f55de29278f00feb2ff468.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*_Wt6GwCNJEfYDcGi"/></div></div><figcaption class="ot ou ov of og ow ox bf b bg z dx">Photo by <a class="af oy" href="https://unsplash.com/@ro_ka?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Robert Katzki</a> on <a class="af oy" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="487e" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Let us consider a seemingly simple example:</p><pre class="oi oj ok ol om oz pa pb bp pc bb bk"><span id="7da5" class="pd ng fq pa b bg pe pf l pg ph">class EmptyClass:<br/>    pass</span></pre><p id="c0a0" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">This is the “emptiest” custom class we can define in Python, as we did not define attributes or methods. It is so empty you would think you can do nothing with it.</p><p id="5213" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">However, this is not the case. For example, Python will not complain if you try to create an instance of this class or even compare two instances for equality:</p><pre class="oi oj ok ol om oz pa pb bp pc bb bk"><span id="892d" class="pd ng fq pa b bg pe pf l pg ph">empty_instance = EmptyClass()<br/>another_empty_instance = EmptyClass()<br/><br/>&gt;&gt;&gt; empty_instance == another_empty_instance<br/>False</span></pre><p id="f641" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Of course, this is not magic. Simply, leveraging a standard <strong class="ml fr"><em class="pi">object </em></strong>interface, any object in Python inherits some default attributes and methods that allow the user to always have a minimal set of possible interactions with it.</p><p id="6928" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">While these methods may seem hidden, they are not invisible. To access the available methods, including the ones assigned by Python itself, just use the <strong class="ml fr"><em class="pi">dir()</em></strong> built-in function. For our empty class, we get:</p><pre class="oi oj ok ol om oz pa pb bp pc bb bk"><span id="63bc" class="pd ng fq pa b bg pe pf l pg ph">&gt;&gt;&gt; dir(EmptyClass)<br/>['__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', <br/>'__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', <br/>'__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', <br/>'__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', <br/>'__str__', '__subclasshook__', '__weakref__']</span></pre><p id="6a39" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">It is these methods that can explain the behaviour we observed earlier. For example, since the class actually has an <strong class="ml fr"><em class="pi">__init__ </em></strong>method we should not be surprised that we can instantiate an object of the class.</p><h2 id="d81e" class="nf ng fq bf nh ni nj nk nl nm nn no np ms nq nr ns mw nt nu nv na nw nx ny nz bk"><strong class="al">Meet the Dunder Methods</strong></h2><p id="fa94" class="pw-post-body-paragraph mj mk fq ml b go oa mn mo gr ob mq mr ms oc mu mv mw od my mz na oe nc nd ne fj bk">All the methods shown in the last output belongs to the special group of — guess what — dunder methods. The term “dunder” is short for double underscore, referring to the double underscores at the beginning and end of these method names.</p><p id="f8ac" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">They are special for several reasons:</p><ol class=""><li id="bccd" class="mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne pj pk pl bk"><strong class="ml fr">They are built into every object</strong>: every Python object is equipped with a specific set of dunder methods determined by its type.</li><li id="9b85" class="mj mk fq ml b go pm mn mo gr pn mq mr ms po mu mv mw pp my mz na pq nc nd ne pj pk pl bk"><strong class="ml fr">They are invoked implicitly</strong>: many dunder methods are triggered automatically through interactions with Python’s native operators or built-in functions. For example, comparing two objects with <strong class="ml fr"><em class="pi">==</em></strong> is equivalent to calling their <strong class="ml fr"><em class="pi">__eq__</em></strong> method.</li><li id="1147" class="mj mk fq ml b go pm mn mo gr pn mq mr ms po mu mv mw pp my mz na pq nc nd ne pj pk pl bk"><strong class="ml fr">They are customizable</strong>: you can override existing dunder methods or define new ones for your classes to give them custom behavior while preserving their implicit invocation.</li></ol><p id="37c9" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">For most Python developers, the first dunder they encounter is <strong class="ml fr"><em class="pi">__init__</em></strong>, the constructor method. This method is automatically called when you create an instance of a class, using the familiar syntax <strong class="ml fr"><em class="pi">MyClass(*args, **kwargs)</em></strong> as a shortcut for explicitly calling <strong class="ml fr"><em class="pi">MyClass.__init__(*args, **kwargs).</em></strong></p><p id="c921" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Despite being the most commonly used, <strong class="ml fr"><em class="pi">__init__</em></strong> is also one of the most specialized dunder methods. It does not fully showcase the flexibility and power of dunder methods, which can allow you to redefine how your objects interact with native Python features.</p><h2 id="a25a" class="nf ng fq bf nh ni nj nk nl nm nn no np ms nq nr ns mw nt nu nv na nw nx ny nz bk">Make an object pretty</h2><p id="5587" class="pw-post-body-paragraph mj mk fq ml b go oa mn mo gr ob mq mr ms oc mu mv mw od my mz na oe nc nd ne fj bk">Let us define a class representing an item for sale in a shop and create an instance of it by specifying the name and price.</p><pre class="oi oj ok ol om oz pa pb bp pc bb bk"><span id="94b0" class="pd ng fq pa b bg pe pf l pg ph">class Item:<br/>    def __init__(self, name: str, price: float) -&gt; None:<br/>        self.name = name<br/>        self.price = price<br/><br/><br/>item = Item(name="Milk (1L)", price=0.99)</span></pre><p id="a71b" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">What happens if we try to display the content of the <em class="pi">item </em>variable? Right now, the best Python can do is tell us what type of object it is and where it is allocated in memory:</p><pre class="oi oj ok ol om oz pa pb bp pc bb bk"><span id="d216" class="pd ng fq pa b bg pe pf l pg ph">&gt;&gt;&gt; item<br/>&lt;__main__.Item at 0x00000226C614E870&gt;</span></pre><p id="37ae" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Let’s try to get a more informative and pretty output!</p><figure class="oi oj ok ol om on of og paragraph-image"><div role="button" tabindex="0" class="oo op ed oq bh or"><div class="of og pr"><img src="../Images/fd7e5e5454f250598838a4907fdd0424.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*OG_hDPXIFjiIWP9W"/></div></div><figcaption class="ot ou ov of og ow ox bf b bg z dx">Photo by <a class="af oy" href="https://unsplash.com/@shamblenstudios?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Shamblen Studios</a> on <a class="af oy" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="9fc7" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">To do that, we can override the <strong class="ml fr"><em class="pi">__repr__ </em></strong>dunder, which output will be exactly what gets printed when typing a class instance in the interactive Python console but also — as soon as the other dunder method <strong class="ml fr"><em class="pi">__str__</em></strong> is not override — when attempting a <strong class="ml fr"><em class="pi">print()</em></strong> call.</p><p id="259f" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk"><strong class="ml fr">Note</strong>: it is a common practice to have <strong class="ml fr"><em class="pi">__repr__</em></strong> provide the necessary syntax to recreate the printed instance. So in that latter case we expect the output to be <em class="pi">Item(name=”Milk (1L)”, price=0.99).</em></p><pre class="oi oj ok ol om oz pa pb bp pc bb bk"><span id="1b1a" class="pd ng fq pa b bg pe pf l pg ph">class Item:<br/>    def __init__(self, name: str, price: float) -&gt; None:<br/>        self.name = name<br/>        self.price = price<br/><br/>    def __repr__(self) -&gt; str:<br/>        return f"{self.__class__.__name__}('{self.name}', {self.price})"<br/><br/><br/>item = Item(name="Milk (1L)", price=0.99)<br/><br/>&gt;&gt;&gt; item # In this example it is equivalent also to the command: print(item)<br/>Item('Milk (1L)', 0.99)</span></pre><p id="c37c" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Nothing special, right? And you would be right: we could have implemented the same method and named it <em class="pi">my_custom_repr </em>without getting indo dunder methods. However, while anyone immediately understands what we mean with <strong class="ml fr"><em class="pi">print(item) </em></strong>or just <strong class="ml fr"><em class="pi">item</em></strong>, can we say the same for something like <strong class="ml fr"><em class="pi">item.my_custom_repr()</em></strong>?</p><p id="84a6" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk"><strong class="ml fr">Define interaction between an object and Python’s native operators</strong></p><p id="d9f4" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Imagine we want to create a new class<em class="pi">, Grocery</em>, that allows us to build a collection of <em class="pi">Item </em>along with their quantities.</p><p id="8318" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">In this case, we can use dunder methods for allowing some standard operations like:</p><ol class=""><li id="c65c" class="mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne pj pk pl bk">Adding a specific quantity of <em class="pi">Item </em>to the <em class="pi">Grocery </em>using the <strong class="ml fr"><em class="pi">+</em></strong> operator</li><li id="5bbd" class="mj mk fq ml b go pm mn mo gr pn mq mr ms po mu mv mw pp my mz na pq nc nd ne pj pk pl bk">Iterating directly over the <em class="pi">Grocery </em>class using a <strong class="ml fr"><em class="pi">for</em></strong> loop</li><li id="134b" class="mj mk fq ml b go pm mn mo gr pn mq mr ms po mu mv mw pp my mz na pq nc nd ne pj pk pl bk">Accessing a specific Item from the Grocery class using the bracket<strong class="ml fr"><em class="pi"> [] </em></strong>notation</li></ol><p id="d5da" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">To achieve this, we will <strong class="ml fr">define (</strong>we already see that<strong class="ml fr"> </strong>a generic class do not have these methods by default) the dunder methods <strong class="ml fr"><em class="pi">__add__</em></strong>, <strong class="ml fr"><em class="pi">__iter__</em></strong> and <strong class="ml fr"><em class="pi">__getitem__</em></strong> respectively.</p><pre class="oi oj ok ol om oz pa pb bp pc bb bk"><span id="e53f" class="pd ng fq pa b bg pe pf l pg ph">from typing import Optional, Iterator<br/>from typing_extensions import Self<br/><br/><br/>class Grocery:<br/><br/>    def __init__(self, items: Optional[dict[Item, int]] = None):<br/>        self.items = items or dict()<br/><br/>    def __add__(self, new_items: dict[Item, int]) -&gt; Self:<br/><br/>        new_grocery = Grocery(items=self.items)<br/><br/>        for new_item, quantity in new_items.items():<br/><br/>            if new_item in new_grocery.items:<br/>                new_grocery.items[new_item] += quantity<br/>            else:<br/>                new_grocery.items[new_item] = quantity<br/><br/>        return new_grocery<br/><br/>    def __iter__(self) -&gt; Iterator[Item]:<br/>        return iter(self.items)<br/><br/>    def __getitem__(self, item: Item) -&gt; int:<br/><br/>        if self.items.get(item):<br/>            return self.items.get(item)<br/>        else:<br/>            raise KeyError(f"Item {item} not in the grocery")</span></pre><p id="319a" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Let us initialize a <em class="pi">Grocery </em>instance and print the content of its main attribute, <em class="pi">items.</em></p><pre class="oi oj ok ol om oz pa pb bp pc bb bk"><span id="88ce" class="pd ng fq pa b bg pe pf l pg ph">item = Item(name="Milk (1L)", price=0.99)<br/>grocery = Grocery(items={item: 3})<br/><br/>&gt;&gt;&gt; print(grocery.items)<br/>{Item('Milk (1L)', 0.99): 3}</span></pre><p id="645f" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Then, we use the <strong class="ml fr"><em class="pi">+</em></strong> operator to add a new Item and verify the changes have taken effect.</p><pre class="oi oj ok ol om oz pa pb bp pc bb bk"><span id="6f03" class="pd ng fq pa b bg pe pf l pg ph">new_item = Item(name="Soy Sauce (0.375L)", price=1.99)<br/>grocery = grocery + {new_item: 1} + {item: 2}<br/><br/>&gt;&gt;&gt; print(grocery.items)<br/>{Item('Milk (1L)', 0.99): 5, Item('Soy Sauce (0.375L)', 1.99): 1}</span></pre><p id="ac09" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Friendly and explicit, right?</p><p id="9b2d" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">The<strong class="ml fr"><em class="pi"> __iter__ </em></strong>method allows us to loop through a <em class="pi">Grocery </em>object following the logic implemented in the method (i.e., implicitly the loop will iterate over the elements contained in the iterable attribute <em class="pi">items</em>).</p><pre class="oi oj ok ol om oz pa pb bp pc bb bk"><span id="9da6" class="pd ng fq pa b bg pe pf l pg ph">&gt;&gt;&gt; print([item for item in grocery])<br/>[Item('Milk (1L)', 0.99), Item('Soy Sauce (0.375L)', 1.99)]</span></pre><p id="4b11" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Similarly, accessing elements is handled by defining the <strong class="ml fr"><em class="pi">__getitem__</em></strong> dunder:</p><pre class="oi oj ok ol om oz pa pb bp pc bb bk"><span id="3e6f" class="pd ng fq pa b bg pe pf l pg ph">&gt;&gt;&gt; grocery[new_item]<br/>1<br/><br/>fake_item = Item("Creamy Cheese (500g)", 2.99)<br/>&gt;&gt;&gt; grocery[fake_item]<br/>KeyError: "Item Item('Creamy Cheese (500g)', 2.99) not in the grocery"</span></pre><p id="6242" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">In essence, we assigned some standard dictionary-like behaviours to our Grocery class while also allowing some operations that would not be natively available for this data type.</p><p id="100e" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk"><strong class="ml fr">Enhance functionality: make classes callable for simplicity and power.</strong></p><p id="6e66" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Let us wrap up this deep-dive on dunder methods with a final eample showcasing how they can be a powerful tool in our arsenal.</p><figure class="oi oj ok ol om on of og paragraph-image"><div role="button" tabindex="0" class="oo op ed oq bh or"><div class="of og ps"><img src="../Images/98a9fbb88437116ee9565a35777a3ad6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*VySYur0IfnoN_bok"/></div></div><figcaption class="ot ou ov of og ow ox bf b bg z dx">Photo by <a class="af oy" href="https://unsplash.com/@jccards?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Marek Studzinski</a> on <a class="af oy" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="5cac" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Imagine we have implemented a function that performs deterministic and slow calculations based on a certain input. To keep things simple, as an example we will use an identity function with a built-in <strong class="ml fr"><em class="pi">time.sleep</em></strong> of some seconds.</p><pre class="oi oj ok ol om oz pa pb bp pc bb bk"><span id="b77e" class="pd ng fq pa b bg pe pf l pg ph">import time <br/><br/><br/>def expensive_function(input):<br/>    time.sleep(5)<br/>    return input</span></pre><p id="a2c0" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">What happens if we run the function twice on the same input? Well, right now calculation would be executed twice, meaning that we twice get the same output waiting two time for the whole execution time (i.e., a total of 10 seconds).</p><pre class="oi oj ok ol om oz pa pb bp pc bb bk"><span id="a1ec" class="pd ng fq pa b bg pe pf l pg ph">start_time = time.time()<br/><br/>&gt;&gt;&gt; print(expensive_function(2))<br/>&gt;&gt;&gt; print(expensive_function(2))<br/>&gt;&gt;&gt; print(f"Time for computation: {round(time.time()-start_time, 1)} seconds")<br/>2<br/>2<br/>Time for computation: 10.0 seconds</span></pre><p id="1b91" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Does this make sense? Why should we do the same calculation (which leads to the same output) for the same input, especially if it’s a slow process?</p><p id="a2ae" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">One possible solution is to “wrap” the execution of this function inside the <strong class="ml fr"><em class="pi">__call__</em></strong> dunder method of a class.</p><p id="4bd9" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">This makes instances of the class callable just like functions — meaning we can use the straightforward syntax <strong class="ml fr"><em class="pi">my_class_instance(*args, **kwargs)</em></strong> — while also allowing us to use attributes as a cache to cut computation time.</p><p id="7aed" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">With this approach we also have the flexibility to create multiple process (i.e., class instances), each with its own local cache.</p><pre class="oi oj ok ol om oz pa pb bp pc bb bk"><span id="0276" class="pd ng fq pa b bg pe pf l pg ph">class CachedExpensiveFunction:<br/><br/>    def __init__(self) -&gt; None:<br/>        self.cache = dict()<br/><br/>    def __call__(self, input):<br/>        if input not in self.cache:<br/>            output = expensive_function(input=input)<br/>            self.cache[input] = output<br/>            return output<br/>        else:<br/>            return self.cache.get(input)<br/><br/><br/>start_time = time.time()<br/>cached_exp_func = CachedExpensiveFunction()<br/><br/>&gt;&gt;&gt; print(cached_exp_func(2))<br/>&gt;&gt;&gt; print(cached_exp_func(2))<br/>&gt;&gt;&gt; print(f"Time for computation: {round(time.time()-start_time, 1)} seconds")<br/>2<br/>2<br/>Time for computation: 5.0 seconds</span></pre><p id="d124" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">As expected, the function is cached after the first run, eliminating the need for the second computation and thus cutting the overall time in half.</p><p id="2c75" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">As above mentioned, we can even create separate instances of the class, each with its own cache, if needed.</p><pre class="oi oj ok ol om oz pa pb bp pc bb bk"><span id="ebc0" class="pd ng fq pa b bg pe pf l pg ph">start_time = time.time()<br/>another_cached_exp_func = CachedExpensiveFunction()<br/><br/>&gt;&gt;&gt; print(cached_exp_func(3))<br/>&gt;&gt;&gt; print(another_cached_exp_func (3))<br/>&gt;&gt;&gt; print(f"Time for computation: {round(time.time()-start_time, 1)} seconds")<br/>3<br/>3<br/>Time for computation: 10.0 seconds</span></pre><p id="5244" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Here we are! A simple yet powerful optimization trick made possible by dunder methods that not only reduces redundant calculations but also offers flexibility by allowing local, instance-specific caching.</p><h2 id="8e1b" class="nf ng fq bf nh ni nj nk nl nm nn no np ms nq nr ns mw nt nu nv na nw nx ny nz bk">My final considerations</h2><p id="0e2a" class="pw-post-body-paragraph mj mk fq ml b go oa mn mo gr ob mq mr ms oc mu mv mw od my mz na oe nc nd ne fj bk">Dunder methods are a broad and ever-evolving topic, and this writing does not aim to be an exhaustive resource on the subject (for this purpose, you can refer to the <a class="af oy" href="https://docs.python.org/3/reference/datamodel.html" rel="noopener ugc nofollow" target="_blank">3. Data model — Python 3.12.3 documentation</a>).</p><p id="32fe" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">My goal here was rather to explain clearly what they are and how they can be used effectively to handle some common use cases.</p><p id="457a" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">While they may not be mandatory for all programmers all the time, once I got a good grasp of how they work they have made a ton of difference for me and hopefully they may work for you as well.</p><p id="2045" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Dunder methods indeed are a way to avoid reinventing the wheel. They also align closely with Python’s philosophy, leading to a more concise, readable and convention-friendly code. And that never hurts, right?</p></div></div></div></div>    
</body>
</html>