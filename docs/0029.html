<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Generating Synthetic Descriptive Data in PySpark</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Generating Synthetic Descriptive Data in PySpark</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/methods-for-generating-synthetic-descriptive-data-c6678cc10aff?source=collection_archive---------16-----------------------#2024-01-04">https://towardsdatascience.com/methods-for-generating-synthetic-descriptive-data-c6678cc10aff?source=collection_archive---------16-----------------------#2024-01-04</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="e602" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">Use various data source types to quickly generate text data for artificial datasets.</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@mc12338?source=post_page---byline--c6678cc10aff--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Matt Collins" class="l ep by dd de cx" src="../Images/b28ac8100d6fb287e3fa6926eec7939a.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*1kVDqrw7GBUhBC852gYBVQ.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--c6678cc10aff--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://medium.com/@mc12338?source=post_page---byline--c6678cc10aff--------------------------------" rel="noopener follow">Matt Collins</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--c6678cc10aff--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">7 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Jan 4, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj lc ld ab q ee le lf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count la lb">2</span></p></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lg k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lh an ao ap id li lj lk" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep ll cn"><div class="l ae"><div class="ab cb"><div class="lm ln lo lp lq lr ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk ml"><img src="../Images/c14575928334898bcaeff52c63f7c0b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UrKmd4o1A0aMje6JfR5o4w.jpeg"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image generated with DALL-E 3</figcaption></figure><p id="8da4" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">In a <a class="af ny" href="https://medium.com/towards-data-science/create-many-to-one-relationships-between-columns-in-a-synthetic-table-with-pyspark-udfs-41e39d97c936" rel="noopener">previous article</a>, we explored creating many-to-one relationships between columns in a synthetic PySpark DataFrame. This DataFrame only consisted of Foreign Key information and we didn’t produce any textual information that might be useful in a demo DataSet.</p><p id="91bd" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">For anyone looking to populate an artificial dataset, it is likely you will want to produce descriptive data such as product information, location details, customer demographics, etc.</p><p id="f313" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">In this post, we’ll dig into a few sources that can be used to create synthetic text data at little effort and cost, and use the techniques to pull together a DataFrame containing customer details.</p><h1 id="a39d" class="nz oa fq bf ob oc od gq oe of og gt oh oi oj ok ol om on oo op oq or os ot ou bk">Why create an synthetic dataset?</h1><p id="90e3" class="pw-post-body-paragraph nc nd fq ne b go ov ng nh gr ow nj nk nl ox nn no np oy nr ns nt oz nv nw nx fj bk">Synthetic datasets are a great way to anonymously demonstrate your data product, such as a website or analytics platform. Allowing users and stakeholders to interact with example data, exposing meaningful analysis without breaching any privacy concerns with sensitive data.</p><p id="d979" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">It can also be great for exploring Machine Learning algorithms, allowing Data Scientists to train models in the case of limited real data.</p><p id="a510" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Performance testing Data Engineering pipeline activities is another great use case for synthetic data, giving teams the ability to ramp up the scale of data pushed through an infrastructure and identify weaknesses in the design, as well as benchmarking runtimes.</p><p id="3598" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">In my case, I’m currently creating an example dataset to performance-test some Power BI capabilities at high volumes, which I’ll be writing about in due course.</p><p id="4cdd" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">The dataset will contain sales data, including transaction amounts and other descriptive features such as store location, employee name and customer email address.</p><h1 id="10be" class="nz oa fq bf ob oc od gq oe of og gt oh oi oj ok ol om on oo op oq or os ot ou bk">Random characters</h1><p id="86c7" class="pw-post-body-paragraph nc nd fq ne b go ov ng nh gr ow nj nk nl ox nn no np oy nr ns nt oz nv nw nx fj bk">Starting off simple, we can use some built-in functionality to generate random text data. Importing the <em class="pa">random</em> and <em class="pa">string</em> Python modules, we can use the following simple function to create a random string of the desired length.</p><figure class="mm mn mo mp mq mr"><div class="pb io l ed"><div class="pc pd l"/></div></figure><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk pe"><img src="../Images/f5c3e3853d273114a21f52033204e2ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*v2lo5IBU-MTsJ0hUbAxSsg.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by Author: Screenshot of several examples of results</figcaption></figure><p id="771e" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">We can run this multiple times to generate enough data for our column, appending the information to a list.</p><p id="4431" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">We will review how to add this to our DataFrame further down this post.</p><h2 id="dc22" class="pf oa fq bf ob pg ph pi oe pj pk pl oh nl pm pn po np pp pq pr nt ps pt pu pv bk">Benefits and Limitations</h2><p id="9acc" class="pw-post-body-paragraph nc nd fq ne b go ov ng nh gr ow nj nk nl ox nn no np oy nr ns nt oz nv nw nx fj bk">This kind of data generation is very generic, with limited applications in demo datasets. That being said, it can be combined with other string generation techniques (such as concatenation) to give a bit more value at very little effort.</p><p id="ca58" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">This can be seen below for random usernames, with a base of a first name appended by an underscore and random characters:</p><figure class="mm mn mo mp mq mr"><div class="pb io l ed"><div class="pc pd l"/></div></figure><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk pw"><img src="../Images/c8517d9ff5eb3a9f5a9282474f70455c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6GFODQlt-OUoE6OM8BwJog.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by Author: Screenshot of several usernames created with random strings appended.</figcaption></figure><p id="4abc" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Example data points where this could be useful may include:</p><ul class=""><li id="bec2" class="nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx px py pz bk">Email addresses</li><li id="d4a7" class="nc nd fq ne b go qa ng nh gr qb nj nk nl qc nn no np qd nr ns nt qe nv nw nx px py pz bk">Passwords</li><li id="0d10" class="nc nd fq ne b go qa ng nh gr qb nj nk nl qc nn no np qd nr ns nt qe nv nw nx px py pz bk">Product codes</li><li id="9fd5" class="nc nd fq ne b go qa ng nh gr qb nj nk nl qc nn no np qd nr ns nt qe nv nw nx px py pz bk">Usernames</li></ul><h1 id="92ca" class="nz oa fq bf ob oc od gq oe of og gt oh oi oj ok ol om on oo op oq or os ot ou bk">APIs</h1><p id="eabd" class="pw-post-body-paragraph nc nd fq ne b go ov ng nh gr ow nj nk nl ox nn no np oy nr ns nt oz nv nw nx fj bk">APIs are a great source of information, and will likely be data sources when building your real Analytics platforms!</p><p id="9580" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">However, there are also many API endpoints worth querying for generic placeholder data that can give you more meaning for demo dashboards through representative data for various topics, such as currency rates.</p><p id="2546" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">If we want to retrieve geographical data for a field for a user’s country, we could generate this from the <a class="af ny" href="https://restcountries.com/" rel="noopener ugc nofollow" target="_blank">rest countries</a> API endpoint. This API is free to access and requires no sign-up to get started. Using the <em class="pa">requests</em> python module we’re up and running with a list of countries very quickly.</p><figure class="mm mn mo mp mq mr"><div class="pb io l ed"><div class="pc pd l"/></div></figure><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qf"><img src="../Images/b5dac3970e70b95dcbe8d60a20579702.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*93srjCGIGHKzFKDBbeZUSQ.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by Author: print(sample_countries) statement showing a sample of the shuffled results.</figcaption></figure><p id="5962" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk"><strong class="ne fr"><em class="pa">Note: You should always sense-check your outputs — this API request returns 250 results, which exceeds the real-life number of countries!</em></strong></p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qg"><img src="../Images/befb2f37181c4f9022dfae51979fe72f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iITJThV7JhyjCNW3b18Fcw.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by Author: Snippet of the pprint(sorted(countries_list)) statement, showing various “countries” associated with the United States.</figcaption></figure><h2 id="3d7d" class="pf oa fq bf ob pg ph pi oe pj pk pl oh nl pm pn po np pp pq pr nt ps pt pu pv bk">Benefits and Limitations</h2><p id="f35a" class="pw-post-body-paragraph nc nd fq ne b go ov ng nh gr ow nj nk nl ox nn no np oy nr ns nt oz nv nw nx fj bk">Getting data from APIs can vary in complexity and security requirements can be off-putting. The way data is requested can also vary, as can the format in which it returns. Documentation is produced by the provider themselves, which can also be a bottleneck worth considering.</p><p id="bb12" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">It is worth mentioning at this point that there are various packages created by developers to interact with APIs in simplified manners — we’ll talk about third-party Python libraries in the next section!</p><p id="bd3a" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">With all of that being said, there is plenty of rich data available for you to pull that may be utilised in customer-facing data products as well as for demo purposes.</p><h1 id="c33c" class="nz oa fq bf ob oc od gq oe of og gt oh oi oj ok ol om on oo op oq or os ot ou bk">Third-party packages</h1><p id="c6ab" class="pw-post-body-paragraph nc nd fq ne b go ov ng nh gr ow nj nk nl ox nn no np oy nr ns nt oz nv nw nx fj bk">There are also some great ready-made packages out there for us to use. This takes some of the heavy effort out of finding a source, processing and formatting the data ready for consumption.</p><p id="b64a" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk"><a class="af ny" href="https://faker.readthedocs.io/en/master/" rel="noopener ugc nofollow" target="_blank"><em class="pa">Faker</em></a> is one such example, with the ability to generate names, addresses, etc.</p><p id="8d20" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Install, import and use packages like this at your convenience!</p><figure class="mm mn mo mp mq mr"><div class="pb io l ed"><div class="pc pd l"/></div></figure><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk pe"><img src="../Images/c9fde8d06322cc6cf8fdc931cef243b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AOxkv9PTN1By_w0McJzn6Q.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by Author: Screenshot of several Faker generated names</figcaption></figure><h2 id="94f2" class="pf oa fq bf ob pg ph pi oe pj pk pl oh nl pm pn po np pp pq pr nt ps pt pu pv bk">Benefits and Limitations</h2><p id="4696" class="pw-post-body-paragraph nc nd fq ne b go ov ng nh gr ow nj nk nl ox nn no np oy nr ns nt oz nv nw nx fj bk">As much of the leg-work has been done for you by other developers, packages such as <em class="pa">Faker</em> can be very high-impact and low-cost (in both price and time).</p><p id="be8c" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">With just <em class="pa">Faker</em> in mind, we’ve already been able to generate generic and informative user data intuitively. Other libraries are available (often interacting with common APIs) to allow developers to easily pull useful through to their applications.</p><p id="87c3" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Blockers could lie within your organisation’s regulations around using third-party packages, licensing and maintainability of the package itself, so please be aware of possible restrictions here.</p><h1 id="13f1" class="nz oa fq bf ob oc od gq oe of og gt oh oi oj ok ol om on oo op oq or os ot ou bk">ChatGPT</h1><p id="86a0" class="pw-post-body-paragraph nc nd fq ne b go ov ng nh gr ow nj nk nl ox nn no np oy nr ns nt oz nv nw nx fj bk">It wouldn’t be fitting to overlook Large Language Models (LLMs) as they are a great asset in data generation.</p><p id="e197" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">A simple approach could be to get ChatGPT (or equivalent) to generate you a list of data points, such as possible customer names.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qh"><img src="../Images/fca72ada96922b20dad3cc47c19b5c79.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fg9XlChnYr9i0_0A8VstHg.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by Author: Asking ChatGPT for a list of names.</figcaption></figure><p id="f0dd" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">We can do one better and ask for the LLM to help build the random variable function itself. You can include details about data sources and even ask ChatGPT to write a function to interact with an API you have found.</p><p id="a5ac" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">An example here is requesting help with the <a class="af ny" href="https://www.boredapi.com/" rel="noopener ugc nofollow" target="_blank">bored</a> API, extracting the activity field and returning it for your own use:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qi"><img src="../Images/235b4db7b487fcdfe34a35b5d3a9bde1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HmNUz-SC53YhuyJoKNqXdw.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by Author: Asking ChatGPT for a random activity.</figcaption></figure><figure class="mm mn mo mp mq mr"><div class="pb io l ed"><div class="pc pd l"/></div></figure><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qj"><img src="../Images/aa33275bfb5ab9d86127ae4b04fe1c3a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J0QLdorULTaoepdtJ9zLGA.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by Author: Example result of ChatGPT generated function from bored API.</figcaption></figure><p id="d660" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk"><strong class="ne fr"><em class="pa">Note: Always check the output of your result to ensure an LLM generated function is working as expected.</em></strong></p><h2 id="489f" class="pf oa fq bf ob pg ph pi oe pj pk pl oh nl pm pn po np pp pq pr nt ps pt pu pv bk">Benefits and Limitations</h2><p id="8a65" class="pw-post-body-paragraph nc nd fq ne b go ov ng nh gr ow nj nk nl ox nn no np oy nr ns nt oz nv nw nx fj bk">Generative AI is showing its strengths in rapid data generation (prominently around content creation, as shown by <a class="af ny" href="https://www.gartner.com/en/doc/779868-emerging-tech-top-use-cases-for-generative-ai" rel="noopener ugc nofollow" target="_blank">this Gartner report</a>) and I expect to see more grounded approaches for this in populating example datasets next year. As such, it makes creation of various data points at scale accessible to users of various backgrounds and levels of technicality.</p><p id="297c" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">With that being said, reliability and consistency of LLMs is being heavily investigated at the same time. Depending on the type of data you need to populate, this may introduce rigorous checks into data quality and anonymity and determine whether or not this is the right tool for specific use cases.</p><h1 id="f317" class="nz oa fq bf ob oc od gq oe of og gt oh oi oj ok ol om on oo op oq or os ot ou bk">Putting this into a DataFrame</h1><p id="cb50" class="pw-post-body-paragraph nc nd fq ne b go ov ng nh gr ow nj nk nl ox nn no np oy nr ns nt oz nv nw nx fj bk">The approach we’ve taken across the previous sections is to generate our data ready to be processed into the DataFrame column of interest.</p><p id="fd30" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">There are a few choices of how to implement the synthetic data at this stage. UDFs are a neat way to apply a function for each row of the column and can help define uniqueness.</p><p id="7b98" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk"><a class="af ny" href="https://github.com/databrickslabs/dbldatagen" rel="noopener ugc nofollow" target="_blank">Databricks Labs Data Generator</a> is another great library that can help speed things up with distributed computing at the core of this data generation.</p><p id="b947" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Manipulating how we generate the lists of values to be populated, we can implement the <em class="pa">withColumn</em> PySpark function and combine this with our list data to produce our text column at great speed.</p><p id="9a2e" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">For our test case, we’ll use a combination of both of these approaches. We can use Databricks Labs Data Generator to create our DataFrame wireframe, populating 100 rows with a unique <em class="pa">Id</em> column, and any values we might not require to be unique, such as <em class="pa">Country</em>.</p><p id="34e9" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Other columns which we might wish to be distinct, such as the <em class="pa">Full Name</em> and <em class="pa">Username</em>, we can make use of a UDF to use the id column to access a unique name from the list we’ve created.</p><p id="97c5" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Putting it all together, we can create our DataFrame:</p><figure class="mm mn mo mp mq mr"><div class="pb io l ed"><div class="pc pd l"/></div></figure><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qk"><img src="../Images/b95dfec9c2964ac183945715b0cb2303.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*spZTGH7jOIReaNpiFspCwQ.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by Author: DataFrame</figcaption></figure><p id="9d74" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">A quick data profile shows that our <em class="pa">Full Name</em> and <em class="pa">Username</em> columns have completely unique values as desired!</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk ql"><img src="../Images/62726d1e14223a3cc0f25d04f6e293b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y1DylIGYOTXIlfXFwxmgrQ.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by Author: Data profile of Categorical columns showing 100 unique values for “Full Name” and “Username” columns</figcaption></figure><h1 id="5090" class="nz oa fq bf ob oc od gq oe of og gt oh oi oj ok ol om on oo op oq or os ot ou bk">Conclusion</h1><p id="84d3" class="pw-post-body-paragraph nc nd fq ne b go ov ng nh gr ow nj nk nl ox nn no np oy nr ns nt oz nv nw nx fj bk">We’ve outlined a variety of methods to generate textual synthetic data quickly, allowing us to accelerate our demonstrative dataset creation.</p><p id="636a" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">All the examples above can be extended, refined and tailored to your specific use-case.</p><p id="4a43" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Are there any tricks that I have missed? What are you using synthetic datasets for? Let me know in the comments!</p><p id="90fe" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Thanks for reading, and as always, feel free to find the code for your own use <a class="af ny" href="https://github.com/MattPCollins/SyntheticDimensionTableExamples" rel="noopener ugc nofollow" target="_blank">here</a>.</p></div></div></div></div>    
</body>
</html>