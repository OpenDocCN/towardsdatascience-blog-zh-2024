<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Watermarking for AI Text and Synthetic Proteins</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Watermarking for AI Text and Synthetic Proteins</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/watermarking-for-ai-text-and-synthetic-proteins-fighting-misinformation-and-bioterrorism-fd45be625dfe?source=collection_archive---------9-----------------------#2024-11-07">https://towardsdatascience.com/watermarking-for-ai-text-and-synthetic-proteins-fighting-misinformation-and-bioterrorism-fd45be625dfe?source=collection_archive---------9-----------------------#2024-11-07</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><figure class="fr fs ft fu fv fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp fq"><img src="../Images/285ec832e68ca552b538789de92bbab8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_S2lHpvzamkQ6DWcy9_6Wg.jpeg"/></div></div><figcaption class="gd ge gf fo fp gg gh bf b bg z dx">Image of colorful virus mutation by Nataliya Smirnova on <a class="af gi" href="https://unsplash.com/photos/a-group-of-colorful-butterflies-de3yM8H00vo" rel="noopener ugc nofollow" target="_blank">UnSplash</a></figcaption></figure><div/><div><h2 id="b4d7" class="pw-subtitle-paragraph hi gk gl bf b hj hk hl hm hn ho hp hq hr hs ht hu hv hw hx cq dx">Understanding AI applications in bio for machine learning engineers</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hy hz ia ib ic ab"><div><div class="ab id"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@meghanheintz?source=post_page---byline--fd45be625dfe--------------------------------" rel="noopener follow"><div class="l ie if by ig ih"><div class="l ed"><img alt="Meghan Heintz" class="l ep by dd de cx" src="../Images/9eaae6d3d8168086d83ff7100329c51f.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*Tespb9SFbU5QAxy8f7bhnA.png"/><div class="ii by l dd de em n ij eo"/></div></div></a></div></div><div class="ik ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--fd45be625dfe--------------------------------" rel="noopener follow"><div class="l il im by ig in"><div class="l ed"><img alt="Towards Data Science" class="l ep by br io cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="ii by l br io em n ij eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="ip ab q"><div class="ab q iq"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b ir is bk"><a class="af ag ah ai aj ak al am an ao ap aq ar it" data-testid="authorName" href="https://medium.com/@meghanheintz?source=post_page---byline--fd45be625dfe--------------------------------" rel="noopener follow">Meghan Heintz</a></p></div></div></div><span class="iu iv" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b ir is dx"><button class="iw ix ah ai aj ak al am an ao ap aq ar iy iz ja" disabled="">Follow</button></p></div></div></span></div></div><div class="l jb"><span class="bf b bg z dx"><div class="ab cn jc jd je"><div class="jf jg ab"><div class="bf b bg z dx ab jh"><span class="ji l jb">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar it ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--fd45be625dfe--------------------------------" rel="noopener follow"><p class="bf b bg z jj jk jl jm jn jo jp jq bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="iu iv" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">7 min read</span><div class="jr js l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Nov 7, 2024</span></div></span></div></span></div></div></div><div class="ab cp jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki"><div class="h k w ea eb q"><div class="ky l"><div class="ab q kz la"><div class="pw-multi-vote-icon ed ji lb lc ld"><div class=""><div class="le lf lg lh li lj lk am ll lm ln ld"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l lo lp lq lr ls lt lu"><p class="bf b dy z dx"><span class="lf">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao le lx ly ab q ee lz ma" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lw"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count lv lw">2</span></p></button></div></div></div><div class="ab q kj kk kl km kn ko kp kq kr ks kt ku kv kw kx"><div class="mb k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al mc an ao ap iy md me mf" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep mg cn"><div class="l ae"><div class="ab cb"><div class="mh mi mj mk ml gb ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al mc an ao ap iy mm mn ma mo mp mq mr ms s mt mu mv mw mx my mz u na nb nc"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al mc an ao ap iy mm mn ma mo mp mq mr ms s mt mu mv mw mx my mz u na nb nc"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al mc an ao ap iy mm mn ma mo mp mq mr ms s mt mu mv mw mx my mz u na nb nc"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><p id="3b11" class="pw-post-body-paragraph nd ne gl nf b hj ng nh ni hm nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Misinformation and bioterrorism are not new threats, but the scale and ease with which they can be unleashed has rapidly increased. LLMs make the creation of <a class="af gi" href="https://open.clemson.edu/mfh_reports/7/" rel="noopener ugc nofollow" target="_blank">autonomous chatbots</a> intent on sowing discord trivial, while generative protein design models dramatically expand the population of actors capable of committing <a class="af gi" href="https://press.asimov.com/articles/dna-screening" rel="noopener ugc nofollow" target="_blank">biowarfare</a>. The tools we will need as a society to combat these ills are varied but one important component will be our ability to detect their presence. That is where <em class="nz">watermarking</em> comes in.</p><p id="7b05" class="pw-post-body-paragraph nd ne gl nf b hj ng nh ni hm nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Watermarking or digital watermarking, unlike the physical watermark that holds your child’s school pictures ransom, is a secret signal used to identify ownership. Effective watermarks must be robust, withstanding modifications while remaining undetectable without specialized methods. They are routinely used in various creative domains, from protecting copyrighted digital images and videos to ensuring the integrity of documents. If we can develop effective watermarking techniques for GenAI, we can gain a powerful tool in the fight against misinformation and bioterrorism.</p><p id="fb9b" class="pw-post-body-paragraph nd ne gl nf b hj ng nh ni hm nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">In our <a class="af gi" href="https://medium.com/@meghanheintz/list/understanding-ai-applications-in-bio-for-ml-engineers-7b9e9551bb7f" rel="noopener">series</a>, we’ve explored how other generative text and biology breakthroughs have relied on related architectural breakthroughs and current watermarking proposals are no different. Google announced <a class="af gi" href="https://www.nature.com/articles/s41586-024-08025-4" rel="noopener ugc nofollow" target="_blank">SynthID-Text</a>, a production-ready text watermarking scheme deployed as part of Gemini in October 2024. Their method modifies the final sampling procedure or inference by applying a secret randomized function and so does the <a class="af gi" href="https://www.biorxiv.org/content/10.1101/2024.05.02.591928v1.full.pdf" rel="noopener ugc nofollow" target="_blank">generative protein design watermarking proposal</a> from the team at the University of Maryland, College Park.</p></div></div></div><div class="ab cb oa ob oc od" role="separator"><span class="oe by bm of og oh"/><span class="oe by bm of og oh"/><span class="oe by bm of og"/></div><div class="fj fk fl fm fn"><div class="fw"><div class="ab cb"><div class="mh oi mi oj mj ok cf ol cg om ci bh"><div class="on oo op oq or ab kz"><figure class="lw fw os ot ou ov ow paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><img src="../Images/30872b035f04d87a16ec188a40299e80.png" data-original-src="https://miro.medium.com/v2/resize:fit:966/format:webp/1*wAyqpC0rLcGP2qOvWJ-AcA.jpeg"/></div></figure><figure class="lw fw ox ot ou ov ow paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><img src="../Images/9e464a2dae90abb6d5560c8c114a2a93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1036/format:webp/1*1AfdgNMl2TzKrRlSQ0MzeA.jpeg"/></div><figcaption class="gd ge gf fo fp gg gh bf b bg z dx oy ed oz pa">(Left) An early example of misinformation from the Roman Empire, <a class="af gi" href="https://simple.wikipedia.org/wiki/Battle_of_Actium#/media/File:Castro_Battle_of_Actium.jpg" rel="noopener ugc nofollow" target="_blank">The Battle of Actium by Lorenzo A. Castro</a>, which was painted as part of a propaganda campaign following Caesar’s death. (Right) The first biosecurity incident this author remembers, the <a class="af gi" href="https://en.wikipedia.org/wiki/2001_anthrax_attacks" rel="noopener ugc nofollow" target="_blank">2001 Anthrax mail attacks</a>. Coincidentally, also an example of misinformation given the perpetrator was trying to frame Muslims.</figcaption></figure></div></div></div></div><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="0c17" class="pb pc gl bf pd pe pf hl pg ph pi ho pj pk pl pm pn po pp pq pr ps pt pu pv pw bk">Key Desired Qualities in Watermarking</h1><p id="cf22" class="pw-post-body-paragraph nd ne gl nf b hj px nh ni hm py nk nl nm pz no np nq qa ns nt nu qb nw nx ny fj bk"><strong class="nf gm">Robustness</strong> — it should withstand perturbations of the watermarked text/structure.</p><p id="a68e" class="pw-post-body-paragraph nd ne gl nf b hj ng nh ni hm nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">If an end user can simply swap a few words before publishing or the protein can undergo mutations and become undetectable, the watermark is insufficient.</p><p id="ead6" class="pw-post-body-paragraph nd ne gl nf b hj ng nh ni hm nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><strong class="nf gm">Detectability</strong> — it should be reliably detected by special methods but not otherwise.</p><p id="9205" class="pw-post-body-paragraph nd ne gl nf b hj ng nh ni hm nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">For text, if the watermark can be detected without secret keys, it likely means the text is so distorted it sounds strange to the reader. For protein design, if it can be detected nakedly, it could lead to a degradation in design quality.</p><h1 id="7f89" class="pb pc gl bf pd pe pf hl pg ph pi ho pj pk pl pm pn po pp pq pr ps pt pu pv pw bk">Watermarking text and Synthtext-ID</h1><p id="6308" class="pw-post-body-paragraph nd ne gl nf b hj px nh ni hm py nk nl nm pz no np nq qa ns nt nu qb nw nx ny fj bk">Let’s <strong class="nf gm">delve</strong> into this topic. If you are like me and spend too much time on <a class="af gi" href="https://x.com/JeremyNguyenPhD/status/1774021645709295840" rel="noopener ugc nofollow" target="_blank">Twitter</a>, you are already aware that many people realize ChatGPT overuses certain words. One of those is “delve” and its overuse is being used to analyze how frequently <a class="af gi" href="https://www.medrxiv.org/content/10.1101/2024.05.14.24307373v2.full-text" rel="noopener ugc nofollow" target="_blank">academic articles</a> are written by or with the help of ChatGPT. This is itself a sort of “fragile” watermarking because it can help us identify text written by an LLM. However, as this becomes common knowledge, finding and replacing instances of “delve” is too easy. But the idea behind SynthText-ID is there, we can tell the difference between AI and human written text by the probability of words selected.</p><figure class="on oo op oq or fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp qc"><img src="../Images/2e0e368c6108ad47a07caea5cc20fbd6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*V4I_TXoo9RmmOuc1"/></div></div><figcaption class="gd ge gf fo fp gg gh bf b bg z dx"><a class="af gi" href="https://www.medrxiv.org/content/10.1101/2024.05.14.24307373v2.full-text" rel="noopener ugc nofollow" target="_blank">Delving into PubMed Records: Some Terms in Medical Writing Have Drastically Changed after the Arrival of ChatGPT</a></figcaption></figure><p id="4e76" class="pw-post-body-paragraph nd ne gl nf b hj ng nh ni hm nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">SynthText-ID uses “tournament sampling” to modify the probability of a token being selected according to a random watermarking function. This is an efficient method for watermarking because it can be done during inference without changing the training procedure. This method improves upon <a class="af gi" rel="noopener" target="_blank" href="/what-is-gumbel-softmax-7f6d9cdcb90e">Gumble Sampling</a>, which adds random perturbation to the LLM’s probability distribution before the sampling step.</p><p id="f643" class="pw-post-body-paragraph nd ne gl nf b hj ng nh ni hm nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">In the paper’s example, the sequence “my favorite tropical fruit is” can be completed satisfactorily with any token from a set of candidate tokens (mango, durian, lychee etc). These candidates are sampled from the LLMs probability distribution conditioned on the preceding text. The winning token is selected after a bracket is constructed and each token pair is scored using a watermarking function based on a context window and a watermarking key. This process introduces a statistical signature into the generated text to be measured later.</p><figure class="on oo op oq or fw fo fp paragraph-image"><div class="fo fp qd"><img src="../Images/046beaccc13fe2d19af424f81d9d2165.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/0*8pf3AjFHA6vWuS_U.png"/></div><figcaption class="gd ge gf fo fp gg gh bf b bg z dx">Tournament Sampling example from Scalable watermarking for identifying large language model outputs demonstrating the tournament sampling technique. <a class="af gi" href="https://www.nature.com/articles/s41586-024-08025-4#MOESM1" rel="noopener ugc nofollow" target="_blank">Dathathri, S., See, A., Ghaisas, S., Huang, P., McAdam, R., Welbl, J., … &amp; Kohli, P. (2024). Scalable watermarking for identifying large language model outputs. <em class="qe">Nature, 631</em>(7624), 755–759</a></figcaption></figure><p id="45de" class="pw-post-body-paragraph nd ne gl nf b hj ng nh ni hm nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">To detect the watermark, each token is scored with the watermarking function, and the higher the mean score, the more likely the text came from an LLM. A simple threshold is applied to predict the text’s origin.</p><p id="e449" class="pw-post-body-paragraph nd ne gl nf b hj ng nh ni hm nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">The strength of this signature is controlled by a few factors:</p><ul class=""><li id="168a" class="nd ne gl nf b hj ng nh ni hm nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny qf qg qh bk">The number of rounds (m) in the tournament (typically m=30) where each round strengthens the signature (and also decreases the score variance).</li><li id="1898" class="nd ne gl nf b hj qi nh ni hm qj nk nl nm qk no np nq ql ns nt nu qm nw nx ny qf qg qh bk">The entropy of the LLM. Low entropy models don’t allow enough randomness for the tournament to select candidates which score highly. <em class="nz">FWIW this seems like a big issue to the author who has never used any setting other than temperature=0 with ChatGPT.</em></li><li id="1fef" class="nd ne gl nf b hj qi nh ni hm qj nk nl nm qk no np nq ql ns nt nu qm nw nx ny qf qg qh bk">The length of the text; longer sequences contain more evidence and thus the statistical certainty increases.</li><li id="5492" class="nd ne gl nf b hj qi nh ni hm qj nk nl nm qk no np nq ql ns nt nu qm nw nx ny qf qg qh bk">Whether a non-distortionary and distortionary configuration is used.</li></ul><p id="0974" class="pw-post-body-paragraph nd ne gl nf b hj ng nh ni hm nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Distortion refers to the emphasis placed on preserving text quality versus detection. The non-distortionary configuration prioritizes the quality of the text, trading off detectability. The distortionary configuration does the opposite. The distortionary configuration uses more than two tokens in each tournament match, thus allowing for more wiggle room to select the highest-scoring tokens. Google says they will implement a non-distortionary version of this algorithm in Gemini.</p><p id="a1b8" class="pw-post-body-paragraph nd ne gl nf b hj ng nh ni hm nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">The non-distortionary version reaches a TPR (True Positive Rate) approaching 90% with a False Positive rate of 1% for 400 token sequences, this is roughly 1–2 paragraphs. A (non-paid) tweet or X post is limited to 280 characters or about 70–100 tokens. The TPR at that length is only about 50% which calls into question how effective this method will be in the wild. <em class="nz">Maybe it will be great for catching lazy college students but not foreign actors during elections?</em></p><figure class="on oo op oq or fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp qn"><img src="../Images/974488bdfd75a3bcd670c133215adc62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7K4AkW33f2qyC5gVw-9zSQ.png"/></div></div><figcaption class="gd ge gf fo fp gg gh bf b bg z dx">Watermark detectability is measured using the true-positive rate (TPR) when the false-positive rate (FPR) is set to 1% for SynthText-ID and Gumble Sampling. <a class="af gi" href="https://www.nature.com/articles/s41586-024-08025-4#MOESM1" rel="noopener ugc nofollow" target="_blank">Dathathri, S., See, A., Ghaisas, S., Huang, P., McAdam, R., Welbl, J., … &amp; Kohli, P. (2024). Scalable watermarking for identifying large language model outputs. <em class="qe">Nature, 631</em>(7624), 755–759</a></figcaption></figure><h1 id="6cc6" class="pb pc gl bf pd pe pf hl pg ph pi ho pj pk pl pm pn po pp pq pr ps pt pu pv pw bk">Watermarking Generative Proteins and Biosecurity</h1><p id="ff24" class="pw-post-body-paragraph nd ne gl nf b hj px nh ni hm py nk nl nm pz no np nq qa ns nt nu qb nw nx ny fj bk">Biosecurity is a word you may have started hearing a lot more frequently after Covid. We will likely never definitively know if the virus came from a wet market or a lab leak. But, with better watermarking tools and biosecurity practices, we might be able to trace the next potential pandemic back to a specific researcher. There are existing database logging methods for this purpose, but the hope is that generative protein watermarking would enable tracing even for new or modified sequences that might not match existing hazardous profiles and that watermarks would be more robust to mutations. This would also come with the benefit of enhanced privacy for researchers and simplifications to the IP process.</p><p id="ea27" class="pw-post-body-paragraph nd ne gl nf b hj ng nh ni hm nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">When a text is distorted by the watermarking process, it could confuse the reader or just sound weird. More seriously, distortions in generative protein design could render the protein utterly worthless or functionally distinct. To avoid distortion, the watermark must not alter the overall statistical properties of the designed proteins.</p><p id="642b" class="pw-post-body-paragraph nd ne gl nf b hj ng nh ni hm nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">The watermarking process is similar enough to SynthText-ID. Instead of modifying the token probability distribution, the amino acid residue probability distribution is adjusted. This is done via an unbiased reweighting function (Gumble Sampling, instead of tournament sampling) which takes the original probability distribution of residues and transforms it based on a watermark code derived from the researcher’s private key. Gumble sampling is considered unbiased because it is specifically designed to approximate the maximum of a set of values in a way that maintains the statistical properties of the original distribution without introducing systematic errors; or on average the introduced noise cancels out.</p><figure class="on oo op oq or fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp qo"><img src="../Images/14be44d35960ebbef7bc29fed5d25f2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vtQOgdzo3EWVGh-dLNcN2w.png"/></div></div><figcaption class="gd ge gf fo fp gg gh bf b bg z dx">(a) The existing biosecruity process where IGSC logs all sequences sent for DNA synthesis. (b) The proposed watermarking process which adds noise unbiased noise using Gumble Sampling. (c ) How researchers can use their private keys to watermark proteins and help the IGSC identify suspicious proteins. <a class="af gi" href="https://www.biorxiv.org/content/10.1101/2024.05.02.591928v1.full.pdf" rel="noopener ugc nofollow" target="_blank">Chen, Y., Hu, Z., Wu, Y., Chen, R., Jin, Y., Chen, W., &amp; Huang, H. (2024). Enhancing Biosecurity with Watermarked Protein Design. <em class="qe">bioRxiv</em>.</a></figcaption></figure><p id="087a" class="pw-post-body-paragraph nd ne gl nf b hj ng nh ni hm nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">The researchers validated that the reweighting function was unbiased through experimental validation with proteins designed by <a class="af gi" href="https://www.science.org/doi/10.1126/science.add2187" rel="noopener ugc nofollow" target="_blank">ProteinMPNN</a>, a deep learning–based protein sequence design model. Then the pLDDT or predicted local distance difference test is predicted using <a class="af gi" href="https://github.com/facebookresearch/esm" rel="noopener ugc nofollow" target="_blank">ESMFold</a> (Evolutionary Scale Modeling) before and after watermarking. Results show no change in performance.</p><figure class="on oo op oq or fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp qp"><img src="../Images/8011317d932da19c3bacfbe92bed70fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aVCTaliE0WqAulbNwW_Hvw.png"/></div></div><figcaption class="gd ge gf fo fp gg gh bf b bg z dx">The blue and red represent the original ProteinMPNN and watermarked ProteinMPNN, respectively. Each violin plot contains 3,000 pLDDT scores from 60 different monomer design tasks while each task has 50 different designs demonstrating no change. <a class="af gi" href="https://www.biorxiv.org/content/10.1101/2024.05.02.591928v1.full.pdf" rel="noopener ugc nofollow" target="_blank">Chen, Y., Hu, Z., Wu, Y., Chen, R., Jin, Y., Chen, W., &amp; Huang, H. (2024). Enhancing Biosecurity with Watermarked Protein Design. <em class="qe">bioRxiv</em>.</a></figcaption></figure><p id="0911" class="pw-post-body-paragraph nd ne gl nf b hj ng nh ni hm nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Similar to detection with low-temperature LLM settings, detection is more difficult when there are only a few possible high-quality designs. The resulting low entropy makes it difficult to embed a detectable watermark without introducing noticeable changes. However, this limitation may be less dire than the similar limitation for LLMs. Low entropy design tasks may only have a few proteins in the protein space that can satisfy the requirements. That makes them easier to track using existing database methods.</p><h1 id="48b7" class="pb pc gl bf pd pe pf hl pg ph pi ho pj pk pl pm pn po pp pq pr ps pt pu pv pw bk">Takeaways</h1><ul class=""><li id="2bf1" class="nd ne gl nf b hj px nh ni hm py nk nl nm pz no np nq qa ns nt nu qb nw nx ny qf qg qh bk">Watermarking methods for LLMs and Protein Designs are improving but still need to improve! (Can’t rely on them to detect bot armies!)</li><li id="06a8" class="nd ne gl nf b hj qi nh ni hm qj nk nl nm qk no np nq ql ns nt nu qm nw nx ny qf qg qh bk">Both approaches focus on modifying the sampling procedure; which is important because it means we don’t need to edit the training process and their application is computationally efficient.</li><li id="5c77" class="nd ne gl nf b hj qi nh ni hm qj nk nl nm qk no np nq ql ns nt nu qm nw nx ny qf qg qh bk">The temperature and length of text are important factors concerning the detectability of watermarks. The current method (SynthText-ID) is only about 90% TPR for 1–2 paragraph length sequences at 1% FPR.</li><li id="6090" class="nd ne gl nf b hj qi nh ni hm qj nk nl nm qk no np nq ql ns nt nu qm nw nx ny qf qg qh bk">Some proteins have limited possible structures and those are harder to watermark. However, existing methods should be able to detect those sequences using databases.</li></ul></div></div></div></div>    
</body>
</html>