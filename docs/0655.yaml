- en: Revolutionize Web Browsing with AI
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ç”¨AIå½»åº•æ”¹å˜ç½‘é¡µæµè§ˆ
- en: åŸæ–‡ï¼š[https://towardsdatascience.com/revolutionize-web-browsing-with-ai-5d5f6ce5f5df?source=collection_archive---------4-----------------------#2024-03-10](https://towardsdatascience.com/revolutionize-web-browsing-with-ai-5d5f6ce5f5df?source=collection_archive---------4-----------------------#2024-03-10)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://towardsdatascience.com/revolutionize-web-browsing-with-ai-5d5f6ce5f5df?source=collection_archive---------4-----------------------#2024-03-10](https://towardsdatascience.com/revolutionize-web-browsing-with-ai-5d5f6ce5f5df?source=collection_archive---------4-----------------------#2024-03-10)
- en: Unlock Interactive Online Experiences Using GPT-4V and Puppeteer
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ä½¿ç”¨GPT-4Vå’ŒPuppeteerè§£é”äº’åŠ¨åœ¨çº¿ä½“éªŒ
- en: '[](https://medium.com/@bianbianzhu123?source=post_page---byline--5d5f6ce5f5df--------------------------------)[![Tianyi
    Li](../Images/40fce472f42c650daa1433641bf732df.png)](https://medium.com/@bianbianzhu123?source=post_page---byline--5d5f6ce5f5df--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--5d5f6ce5f5df--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--5d5f6ce5f5df--------------------------------)
    [Tianyi Li](https://medium.com/@bianbianzhu123?source=post_page---byline--5d5f6ce5f5df--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/@bianbianzhu123?source=post_page---byline--5d5f6ce5f5df--------------------------------)[![Tianyi
    Li](../Images/40fce472f42c650daa1433641bf732df.png)](https://medium.com/@bianbianzhu123?source=post_page---byline--5d5f6ce5f5df--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--5d5f6ce5f5df--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--5d5f6ce5f5df--------------------------------)
    [Tianyi Li](https://medium.com/@bianbianzhu123?source=post_page---byline--5d5f6ce5f5df--------------------------------)'
- en: Â·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--5d5f6ce5f5df--------------------------------)
    Â·23 min readÂ·Mar 10, 2024
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: Â·å‘è¡¨äº [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--5d5f6ce5f5df--------------------------------)
    Â·23åˆ†é’Ÿé˜…è¯»Â·2024å¹´3æœˆ10æ—¥
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: 'Authors: [Tianyi Li](https://medium.com/u/4092d7367010?source=post_page---user_mention--5d5f6ce5f5df--------------------------------),
    [Selina Li](https://medium.com/u/7b9ea39b0d79?source=post_page---user_mention--5d5f6ce5f5df--------------------------------)'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: ä½œè€…ï¼š[Tianyi Li](https://medium.com/u/4092d7367010?source=post_page---user_mention--5d5f6ce5f5df--------------------------------)ï¼Œ[Selina
    Li](https://medium.com/u/7b9ea39b0d79?source=post_page---user_mention--5d5f6ce5f5df--------------------------------)
- en: '![](../Images/5534a8ac0a28ede1472534e7d922e9d6.png)'
  id: totrans-7
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/5534a8ac0a28ede1472534e7d922e9d6.png)'
- en: Image generated by the author with DALLÂ·E
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡ç”±ä½œè€…ä½¿ç”¨DALLÂ·Eç”Ÿæˆ
- en: Â· [Introduction](#ced3)
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: Â· [ä»‹ç»](#ced3)
- en: Â· [Potential Use Cases](#b5c4)
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: Â· [æ½œåœ¨çš„ä½¿ç”¨æ¡ˆä¾‹](#b5c4)
- en: Â· [High-level Workflow](#efe3)
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: Â· [é«˜çº§å·¥ä½œæµ](#efe3)
- en: Â· [Architecture](#2455)
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: Â· [æ¶æ„](#2455)
- en: âˆ˜ [Starting Out](#1813)
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: âˆ˜ [å¼€å§‹ä½¿ç”¨](#1813)
- en: âˆ˜ [Pick the Right Path](#3fd7)
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: âˆ˜ [é€‰æ‹©æ­£ç¡®çš„è·¯å¾„](#3fd7)
- en: âˆ˜ [IT IS A LOOP!](#ce07)
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: âˆ˜ [è¿™æ˜¯ä¸€ä¸ªå¾ªç¯ï¼](#ce07)
- en: âˆ˜ [Directory Structure](#30b8)
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: âˆ˜ [ç›®å½•ç»“æ„](#30b8)
- en: âˆ˜ [Browser Controller Service](#c456)
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: âˆ˜ [æµè§ˆå™¨æ§åˆ¶æœåŠ¡](#c456)
- en: âˆ˜ [Element Annotation Service](#d19c)
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: âˆ˜ [å…ƒç´ æ³¨é‡ŠæœåŠ¡](#d19c)
- en: Â· [Conclusion](#b379)
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: Â· [ç»“è®º](#b379)
- en: Introduction
  id: totrans-20
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ä»‹ç»
- en: 'Imagine you are keen on attending an AI event in your city this month, but
    you have specific criteria in mind, perhaps related to timing or the focus of
    the event. Normally, this would involve the following process:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: å‡è®¾ä½ éå¸¸æƒ³å‚åŠ æœ¬æœˆåœ¨ä½ æ‰€åœ¨åŸå¸‚ä¸¾åŠçš„AIæ´»åŠ¨ï¼Œä½†ä½ å¿ƒä¸­æœ‰ä¸€äº›ç‰¹å®šçš„æ ‡å‡†ï¼Œå¯èƒ½ä¸æ´»åŠ¨çš„æ—¶é—´å®‰æ’æˆ–é‡ç‚¹å†…å®¹æœ‰å…³ã€‚é€šå¸¸ï¼Œè¿™å°†æ¶‰åŠä»¥ä¸‹è¿‡ç¨‹ï¼š
- en: Launching a web search with terms like â€œAI events in [your city] this month.â€
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨è¯¸å¦‚â€œæœ¬æœˆ[ä½ çš„åŸå¸‚]çš„AIäº‹ä»¶â€ä¹‹ç±»çš„å…³é”®è¯å¯åŠ¨ç½‘ç»œæœç´¢ã€‚
- en: Sifting through search results to find a link that seems promising.
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä»æœç´¢ç»“æœä¸­ç­›é€‰å‡ºçœ‹èµ·æ¥æœ‰æ½œåŠ›çš„é“¾æ¥ã€‚
- en: Navigating the chosen website to determine its relevance, possibly needing to
    delve deeper through additional links.
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æµè§ˆæ‰€é€‰ç½‘ç«™ä»¥ç¡®å®šå…¶ç›¸å…³æ€§ï¼Œå¯èƒ½éœ€è¦é€šè¿‡å…¶ä»–é“¾æ¥è¿›ä¸€æ­¥æ·±å…¥äº†è§£ã€‚
- en: After much back and forth, finally pinpointing the event that fits your criteria
    and noting its details for your calendar.
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç»è¿‡åå¤æ¨æ•²ï¼Œæœ€ç»ˆæ‰¾åˆ°äº†ç¬¦åˆä½ æ ‡å‡†çš„æ´»åŠ¨ï¼Œå¹¶å°†å…¶è¯¦ç»†ä¿¡æ¯è®°å½•åˆ°æ—¥å†ä¸­ã€‚
- en: 'If we break down the above process, it basically involves steps that can be
    categorized into the following:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæˆ‘ä»¬åˆ†è§£ä¸Šè¿°è¿‡ç¨‹ï¼Œå®ƒåŸºæœ¬ä¸Šæ¶‰åŠçš„æ­¥éª¤å¯ä»¥å½’ç±»ä¸ºä»¥ä¸‹å‡ ç±»ï¼š
- en: Control the browser, such as go to a URL, click on a link, go back, etc.
  id: totrans-27
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æ§åˆ¶æµè§ˆå™¨ï¼Œæ¯”å¦‚è®¿é—®ç½‘å€ã€ç‚¹å‡»é“¾æ¥ã€è¿”å›ç­‰ã€‚
- en: Browse through the content of a page
  id: totrans-28
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æµè§ˆé¡µé¢å†…å®¹
- en: Make decisions based on the content of that page, such as determining which
    link is relevant to your query.
  id: totrans-29
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æ ¹æ®é¡µé¢å†…å®¹åšå‡ºå†³ç­–ï¼Œä¾‹å¦‚ç¡®å®šå“ªä¸ªé“¾æ¥ä¸ä½ çš„æŸ¥è¯¢ç›¸å…³ã€‚
- en: By utilizing the emerging Large Language Model (LLM) technology, now we are
    able to **automate the whole process through a LLM powered AI Agent**.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: é€šè¿‡åˆ©ç”¨æ–°å…´çš„å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰æŠ€æœ¯ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥é€šè¿‡ä¸€ä¸ª**LLMé©±åŠ¨çš„AIä»£ç†è‡ªåŠ¨åŒ–æ•´ä¸ªè¿‡ç¨‹**ã€‚
- en: Enter the AI agent, it does exactly what you do as we described above.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: è¿›å…¥AIä»£ç†ï¼Œå®ƒæ­£å¦‚æˆ‘ä»¬ä¸Šé¢æ‰€æè¿°çš„é‚£æ ·ï¼Œåšç€ä½ æ‰€åšçš„ä¸€åˆ‡ã€‚
- en: '**Browser Control**: the AI uses tools like `Puppeteer` to navigate the internet.
    Think of Puppeteer as the AI''s hands, allowing it to open tabs, click on links,
    and navigate web pages with ease.'
  id: totrans-32
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**æµè§ˆå™¨æ§åˆ¶**ï¼šAIä½¿ç”¨åƒ`Puppeteer`è¿™æ ·çš„å·¥å…·æ¥æµè§ˆäº’è”ç½‘ã€‚å¯ä»¥æŠŠPuppeteerçœ‹ä½œæ˜¯AIçš„åŒæ‰‹ï¼Œå®ƒèƒ½è½»æ¾åœ°æ‰“å¼€æ ‡ç­¾é¡µã€ç‚¹å‡»é“¾æ¥ï¼Œå¹¶åœ¨ç½‘é¡µä¹‹é—´å¯¼èˆªã€‚'
- en: '**Content Browsing**: Think of this as the AIâ€™s eyes. `Puppeteer` can take
    screenshots of web pages, and feed them to the AI.'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**å†…å®¹æµè§ˆ**ï¼šå¯ä»¥æŠŠè¿™ä¸ªçœ‹ä½œæ˜¯AIçš„çœ¼ç›ã€‚`Puppeteer`èƒ½å¤Ÿæ‹æ‘„ç½‘é¡µæˆªå›¾ï¼Œå¹¶å°†å…¶ä¼ é€’ç»™AIã€‚'
- en: '**Decision-Making**: This is where the AIâ€™s brain, powered by Large Language
    Models (LLM), comes into play. It assesses the screenshot of each page, analyzing
    the image, determining relevance and deciding on the next steps, mimicking human
    judgment.'
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**å†³ç­–åˆ¶å®š**ï¼šè¿™æ˜¯AIçš„å¤§è„‘å‘æŒ¥ä½œç”¨çš„åœ°æ–¹ï¼Œå€ŸåŠ©å¤§å‹è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ã€‚å®ƒè¯„ä¼°æ¯ä¸ªé¡µé¢çš„æˆªå›¾ï¼Œåˆ†æå›¾åƒï¼Œåˆ¤æ–­ç›¸å…³æ€§å¹¶å†³å®šä¸‹ä¸€æ­¥ï¼Œæ¨¡æ‹Ÿäººç±»åˆ¤æ–­ã€‚'
- en: In this article, we will explore and build an AI agent that utilizes the power
    of the `gpt-4-vision-preview` model from OpenAI. The model can **analyze images**
    and provide textual responses.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†æ¢ç´¢å¹¶æ„å»ºä¸€ä¸ªåˆ©ç”¨OpenAIçš„`gpt-4-vision-preview`æ¨¡å‹çš„AIä»£ç†ã€‚è¯¥æ¨¡å‹å¯ä»¥**åˆ†æå›¾åƒ**å¹¶æä¾›æ–‡æœ¬å›å¤ã€‚
- en: This agent will be able to interact with the user, control a web browser, and
    process data. Weâ€™ll explore its structure and how it works.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªä»£ç†å°†èƒ½å¤Ÿä¸ç”¨æˆ·äº’åŠ¨ï¼Œæ§åˆ¶ç½‘é¡µæµè§ˆå™¨ï¼Œå¹¶å¤„ç†æ•°æ®ã€‚æˆ‘ä»¬å°†æ¢è®¨å®ƒçš„ç»“æ„ä»¥åŠå¦‚ä½•å·¥ä½œã€‚
- en: This article is inspired by a youtube video [GPT4V + Puppeteer = AI agent browse
    web like human? ğŸ¤–](https://www.youtube.com/watch?v=IXRkmqEYGZA&t=184s) from [AI
    Jason](https://www.youtube.com/@AIJasonZ).
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: æœ¬æ–‡çš„çµæ„Ÿæ¥æºäºä¸€ä¸ªYouTubeè§†é¢‘ [GPT4V + Puppeteer = AIä»£ç†åƒäººç±»ä¸€æ ·æµè§ˆç½‘é¡µï¼ŸğŸ¤–](https://www.youtube.com/watch?v=IXRkmqEYGZA&t=184s)ï¼Œç”±[AI
    Jason](https://www.youtube.com/@AIJasonZ)å‘å¸ƒã€‚
- en: '**All the code shown in this article can be found in this Github repo** [**AI
    Web Agent**](https://github.com/bianbianzhu/ai-web-agent/tree/main/agent)**.**'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '**æœ¬æ–‡ä¸­å±•ç¤ºçš„æ‰€æœ‰ä»£ç éƒ½å¯ä»¥åœ¨è¿™ä¸ªGithubä»“åº“ä¸­æ‰¾åˆ°** [**AI Web Agent**](https://github.com/bianbianzhu/ai-web-agent/tree/main/agent)**.**'
- en: Potential Use Cases
  id: totrans-39
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: æ½œåœ¨çš„ä½¿ç”¨æ¡ˆä¾‹
- en: Pairing with Text to speech, it can allow people with visual impairments to
    browse the web.
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸æ–‡æœ¬è½¬è¯­éŸ³é…å¯¹ï¼Œå®ƒå¯ä»¥å¸®åŠ©è§†åŠ›éšœç¢è€…æµè§ˆç½‘é¡µã€‚
- en: Quickly locate a product on an E-commerce website.
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¿«é€Ÿå®šä½ç”µå­å•†åŠ¡ç½‘ç«™ä¸Šçš„äº§å“ã€‚
- en: Auto-browse websites with dynamic loading contents (e.g. Real Estate listings)
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è‡ªåŠ¨æµè§ˆå…·æœ‰åŠ¨æ€åŠ è½½å†…å®¹çš„ç½‘ç«™ï¼ˆä¾‹å¦‚æˆ¿åœ°äº§åˆ—è¡¨ï¼‰
- en: Auto-browse websites requiring personal logins (e.g. LinkedIn, Instagram, Facebook)
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è‡ªåŠ¨æµè§ˆéœ€è¦ä¸ªäººç™»å½•çš„ç½‘ç«™ï¼ˆä¾‹å¦‚ LinkedInã€Instagramã€Facebookï¼‰
- en: Take online quiz and tests
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å‚åŠ åœ¨çº¿æµ‹éªŒå’Œæµ‹è¯•
- en: Play web games
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç©ç½‘é¡µæ¸¸æˆ
- en: Online seats / tickets grabbing
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åœ¨çº¿æŠ¢åº§/æŠ¢ç¥¨
- en: Automated application feature testing
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è‡ªåŠ¨åŒ–åº”ç”¨åŠŸèƒ½æµ‹è¯•
- en: High-level Workflow
  id: totrans-48
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: é«˜å±‚æ¬¡å·¥ä½œæµç¨‹
- en: '![](../Images/586a1f94e2d077c069b61fadefe44de0.png)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/586a1f94e2d077c069b61fadefe44de0.png)'
- en: The flowchart showing the high-level workflow of the agent.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: æ˜¾ç¤ºä»£ç†é«˜å±‚æ¬¡å·¥ä½œæµç¨‹çš„æµç¨‹å›¾ã€‚
- en: First user raises a question to the agent.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œç”¨æˆ·å‘ä»£ç†æå‡ºé—®é¢˜ã€‚
- en: Upon receiving the question, GPT-4V is going to return a URL as an entry point
    of the web searching. The URL can be specified by the user as part of the question;
    and if not specified, by default it will be a Google search on key words extracted
    by GPT from userâ€™s question.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æ¥æ”¶åˆ°é—®é¢˜åï¼ŒGPT-4Vå°†è¿”å›ä¸€ä¸ªURLä½œä¸ºç½‘é¡µæœç´¢çš„å…¥å£ã€‚è¯¥URLå¯ä»¥ç”±ç”¨æˆ·åœ¨é—®é¢˜ä¸­æŒ‡å®šï¼›å¦‚æœæœªæŒ‡å®šï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒå°†æ˜¯GPTä»ç”¨æˆ·é—®é¢˜ä¸­æå–çš„å…³é”®è¯è¿›è¡ŒGoogleæœç´¢ã€‚
- en: Upon receiving the URL, puppeteer will open the URL in webpage. It will highlight
    all interactive elements on the page such as links, clicks, buttons, and then
    take a screenshot of the page and return it.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æ¥æ”¶åˆ°URLåï¼ŒPuppeteerå°†æ‰“å¼€è¯¥URLçš„ç½‘é¡µã€‚å®ƒä¼šé«˜äº®æ˜¾ç¤ºé¡µé¢ä¸Šçš„æ‰€æœ‰äº’åŠ¨å…ƒç´ ï¼Œå¦‚é“¾æ¥ã€ç‚¹å‡»ã€æŒ‰é’®ï¼Œç„¶åæˆªå›¾å¹¶è¿”å›ã€‚
- en: Upon receiving the screenshot, GPT-4V will look into the page and process the
    highlighted information. As a brain, GPT will decide if it has already got a good
    answer to userâ€™s questions.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æ¥æ”¶åˆ°æˆªå›¾åï¼ŒGPT-4Vå°†æŸ¥çœ‹é¡µé¢å¹¶å¤„ç†é«˜äº®æ˜¾ç¤ºçš„ä¿¡æ¯ã€‚ä½œä¸ºå¤§è„‘ï¼ŒGPTå°†å†³å®šæ˜¯å¦å·²ç»å¾—åˆ°äº†ä¸€ä¸ªå¥½çš„ç­”æ¡ˆæ¥å›ç­”ç”¨æˆ·çš„é—®é¢˜ã€‚
- en: If there is a good answer, GPT will provide the answer back to the user.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæœ‰ä¸€ä¸ªå¥½çš„ç­”æ¡ˆï¼ŒGPTä¼šå°†ç­”æ¡ˆè¿”å›ç»™ç”¨æˆ·ã€‚
- en: If not, GPT-4V will decide which URL or click to visit for the next step. Puppeteer
    will again opens the new URL, highlight the interactive elements and take a screenshot
    for further processing.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœæ²¡æœ‰ï¼ŒGPT-4V å°†å†³å®šä¸‹ä¸€ä¸ªæ­¥éª¤åº”è®¿é—®å“ªä¸ª URL æˆ–ç‚¹å‡»å“ªä¸ªå…ƒç´ ã€‚Puppeteer å°†å†æ¬¡æ‰“å¼€æ–°çš„ URLï¼Œçªå‡ºæ˜¾ç¤ºäº¤äº’å…ƒç´ ï¼Œå¹¶æˆªå–å±å¹•æˆªå›¾ä»¥ä¾›è¿›ä¸€æ­¥å¤„ç†ã€‚
- en: This process will repeat until GPT decides it has got a good answer for the
    user.
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªè¿‡ç¨‹å°†åå¤è¿›è¡Œï¼Œç›´åˆ° GPT å†³å®šå®ƒå·²ä¸ºç”¨æˆ·æ‰¾åˆ°äº†ä¸€ä¸ªå¥½çš„ç­”æ¡ˆã€‚
- en: Architecture
  id: totrans-58
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: æ¶æ„
- en: 'As we are now clear on how the AI agent works, letâ€™s take a look at the architecture
    of the agent. The agent is structured as follows:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: æ—¢ç„¶æˆ‘ä»¬ç°åœ¨å·²ç»äº†è§£äº† AI ä»£ç†æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬çœ‹çœ‹ä»£ç†çš„æ¶æ„ã€‚ä»£ç†çš„ç»“æ„å¦‚ä¸‹ï¼š
- en: '![](../Images/5a8375fa18a3f3434a9572dbdf104d0b.png)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/5a8375fa18a3f3434a9572dbdf104d0b.png)'
- en: Overview of the agentâ€™s architecture
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: ä»£ç†æ¶æ„æ¦‚è§ˆ
- en: This architecture may look complex at first, but itâ€™s actually quite simple
    once you understand the different components and how they work together. Letâ€™s
    break it down.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ç§æ¶æ„ä¹ä¸€çœ‹å¯èƒ½å¾ˆå¤æ‚ï¼Œä½†ä¸€æ—¦ç†è§£äº†ä¸åŒç»„ä»¶åŠå…¶å¦‚ä½•ååŒå·¥ä½œï¼Œå…¶å®éå¸¸ç®€å•ã€‚æˆ‘ä»¬æ¥é€æ­¥è§£æã€‚
- en: Starting Out
  id: totrans-63
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å¼€å§‹
- en: This is the starting point of the workflow. The user interacts with the agent
    by providing a prompt which clarifies the task (`user task prompt`). At the same
    time, the agent gets some default instructions (`system prompt`), about how it
    should do its job. These instructions tell the agent what its role is, how to
    format its answers, and other important info.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯å·¥ä½œæµç¨‹çš„èµ·ç‚¹ã€‚ç”¨æˆ·é€šè¿‡æä¾›æ˜ç¡®ä»»åŠ¡çš„æç¤ºï¼ˆ`user task prompt`ï¼‰ä¸ä»£ç†è¿›è¡Œäº¤äº’ã€‚åŒæ—¶ï¼Œä»£ç†è·å¾—ä¸€äº›é»˜è®¤æŒ‡ä»¤ï¼ˆ`system prompt`ï¼‰ï¼Œå‘Šè¯‰å®ƒå¦‚ä½•æ‰§è¡Œä»»åŠ¡ã€‚è¿™äº›æŒ‡ä»¤å‘Šè¯‰ä»£ç†å®ƒçš„è§’è‰²æ˜¯ä»€ä¹ˆï¼Œå¦‚ä½•æ ¼å¼åŒ–å›ç­”ï¼Œä»¥åŠå…¶ä»–é‡è¦ä¿¡æ¯ã€‚
- en: 'Hereâ€™s a simple view of the starting point:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯èµ·å§‹ç‚¹çš„ä¸€ä¸ªç®€å•è§†å›¾ï¼š
- en: '![](../Images/fffb4608e71295968f9cdae12e5bada0.png)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/fffb4608e71295968f9cdae12e5bada0.png)'
- en: The initial step
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: åˆå§‹æ­¥éª¤
- en: 'The example of the `user task prompt` might be:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: '`user task prompt` çš„ç¤ºä¾‹å¯èƒ½æ˜¯ï¼š'
- en: '[PRE0]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'And hereâ€™s what the system prompt might look like:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯ç³»ç»Ÿæç¤ºå¯èƒ½çš„æ ·å­ï¼š
- en: '![](../Images/dd728c47d52c1476b78ddd1a127ed3d6.png)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/dd728c47d52c1476b78ddd1a127ed3d6.png)'
- en: A typical system prompt that provides context for the agent.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€ä¸ªå…¸å‹çš„ç³»ç»Ÿæç¤ºï¼Œæä¾›ä»£ç†çš„ä¸Šä¸‹æ–‡ã€‚
- en: 'Credit: [JayZeeDesign](https://github.com/JayZeeDesign/Scrape-anything---Web-AI-agent)'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: è‡´è°¢ï¼š[JayZeeDesign](https://github.com/JayZeeDesign/Scrape-anything---Web-AI-agent)
- en: 'The system prompt is crucial because they help the agent decide how to act.
    The three main areas are highlighted in different colors:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: ç³»ç»Ÿæç¤ºéå¸¸å…³é”®ï¼Œå› ä¸ºå®ƒä»¬å¸®åŠ©ä»£ç†å†³å®šå¦‚ä½•è¡ŒåŠ¨ã€‚ä»¥ä¸‹ä¸‰ä¸ªä¸»è¦é¢†åŸŸç”¨ä¸åŒé¢œè‰²æ ‡å‡ºï¼š
- en: What is the role of the agent. (Aqua)
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä»£ç†çš„è§’è‰²æ˜¯ä»€ä¹ˆã€‚ï¼ˆæ°´ç»¿è‰²ï¼‰
- en: How the agent should present its answers. (Red)
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä»£ç†åº”è¯¥å¦‚ä½•å‘ˆç°å…¶ç­”æ¡ˆã€‚ï¼ˆçº¢è‰²ï¼‰
- en: Extra instructions to help the agent. (Yellow)
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: é¢å¤–çš„æŒ‡ä»¤ï¼Œå¸®åŠ©ä»£ç†æ‰§è¡Œä»»åŠ¡ã€‚ï¼ˆé»„è‰²ï¼‰
- en: The prompts are then sent to the openai service, which is responsible for generating
    responses.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åï¼Œè¿™äº›æç¤ºä¼šå‘é€åˆ° OpenAI æœåŠ¡ï¼Œè¯¥æœåŠ¡è´Ÿè´£ç”Ÿæˆå›ç­”ã€‚
- en: 'Based on these prompts, the agentâ€™s response will be shaped into only 3 types:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: æ ¹æ®è¿™äº›æç¤ºï¼Œä»£ç†çš„å›ç­”å°†è¢«æ•´ç†æˆä»… 3 ç§ç±»å‹ï¼š
- en: '`{ "url": "https://www.example.com" }` - The agent wants to navigate to a specific
    webpage.'
  id: totrans-80
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`{ "url": "https://www.example.com" }` - ä»£ç†å¸Œæœ›å¯¼èˆªåˆ°ä¸€ä¸ªç‰¹å®šçš„ç½‘é¡µã€‚'
- en: '`{ "click": "text on a button" }` - The agent wants to click on a specific
    element on the page.'
  id: totrans-81
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`{ "click": "text on a button" }` - ä»£ç†å¸Œæœ›ç‚¹å‡»é¡µé¢ä¸Šçš„ç‰¹å®šå…ƒç´ ã€‚'
- en: '`regular message` - The agent has finished the task and extracted the required
    information to the user.'
  id: totrans-82
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`regular message` - ä»£ç†å·²å®Œæˆä»»åŠ¡å¹¶å°†æ‰€éœ€ä¿¡æ¯æå–ç»™ç”¨æˆ·ã€‚'
- en: For the initial conversation, the response would normally be a Google search
    url, such as `https://www.google.com/search?q=AI+events+in+Melbourne+March`. This
    response would then trigger the browser-controller service to navigate to the
    URL.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºåˆå§‹å¯¹è¯ï¼Œå›ç­”é€šå¸¸ä¼šæ˜¯ä¸€ä¸ª Google æœç´¢ URLï¼Œä¾‹å¦‚ `https://www.google.com/search?q=AI+events+in+Melbourne+March`ã€‚ç„¶åï¼Œè¯¥å›ç­”ä¼šè§¦å‘æµè§ˆå™¨æ§åˆ¶æœåŠ¡ï¼Œå¯¼èˆªåˆ°è¯¥
    URLã€‚
- en: '**Code implementation of the starting point**'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: '**èµ·å§‹ç‚¹çš„ä»£ç å®ç°**'
- en: '[PRE1]'
  id: totrans-85
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: The following function creates the interface in the terminal for the user to
    input their query.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: ä»¥ä¸‹å‡½æ•°åœ¨ç»ˆç«¯ä¸­åˆ›å»ºç”¨æˆ·è¾“å…¥æŸ¥è¯¢çš„ç•Œé¢ã€‚
- en: '[PRE2]'
  id: totrans-87
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'And you may notice the `promptMap` object in the code. It is a map of functions
    that returns all the prompts. Making it a function allows the prompts to be dynamic
    and change based on the context of the conversation. Here is an example:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ å¯èƒ½ä¼šæ³¨æ„åˆ°ä»£ç ä¸­çš„ `promptMap` å¯¹è±¡ã€‚å®ƒæ˜¯ä¸€ä¸ªè¿”å›æ‰€æœ‰æç¤ºçš„å‡½æ•°æ˜ å°„ã€‚å°†å…¶è®¾ä¸ºå‡½æ•°ä½¿å¾—è¿™äº›æç¤ºå…·æœ‰åŠ¨æ€æ€§ï¼Œå¯ä»¥æ ¹æ®å¯¹è¯çš„ä¸Šä¸‹æ–‡å‘ç”Ÿå˜åŒ–ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š
- en: '[PRE3]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: An important note is that to allow the LLM to have the `memory` of the conversation,
    we need to always push the new prompts to the message array and send the whole
    array to the LLM. This could cause the explosion of the tokens. Use the `max_tokens`
    parameter to build the safe net.
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€ä¸ªé‡è¦çš„æ³¨æ„äº‹é¡¹æ˜¯ï¼Œä¸ºäº†è®©LLMèƒ½å¤Ÿè®°ä½å¯¹è¯çš„`memory`ï¼Œæˆ‘ä»¬éœ€è¦å§‹ç»ˆå°†æ–°çš„æç¤ºæ¨é€åˆ°æ¶ˆæ¯æ•°ç»„ä¸­ï¼Œå¹¶å°†æ•´ä¸ªæ•°ç»„å‘é€ç»™LLMã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´ä»¤ç‰Œæ•°æš´å¢ã€‚ä½¿ç”¨`max_tokens`å‚æ•°æ¥å»ºç«‹å®‰å…¨ç½‘ã€‚
- en: Below is how to use the openai service to generate the response.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸‹é¢æ˜¯å¦‚ä½•ä½¿ç”¨openaiæœåŠ¡ç”Ÿæˆå“åº”çš„æ–¹æ³•ã€‚
- en: '[PRE4]'
  id: totrans-92
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: And of course, to use `openai` service, you need to have the `openai` package
    installed and the API key. Here is a seperate file to handle the openai service.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: å½“ç„¶ï¼Œè¦ä½¿ç”¨`openai`æœåŠ¡ï¼Œä½ éœ€è¦å®‰è£…`openai`åŒ…å¹¶é…ç½®APIå¯†é’¥ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶æ¥å¤„ç†openaiæœåŠ¡ã€‚
- en: '[PRE5]'
  id: totrans-94
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Pick the Right Path
  id: totrans-95
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: é€‰æ‹©æ­£ç¡®çš„è·¯å¾„
- en: As we mentioned earlier, the LLM response will be shaped into only 3 types.
    Each of these types will trigger a different browser-controller service to act
    accordingly.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚å‰æ‰€è¿°ï¼ŒLLMå“åº”å°†ä»…è¢«å¡‘é€ æˆä¸‰ç§ç±»å‹ä¸­çš„ä¸€ç§ã€‚æ¯ç§ç±»å‹éƒ½ä¼šè§¦å‘ä¸åŒçš„æµè§ˆå™¨æ§åˆ¶æœåŠ¡è¿›è¡Œç›¸åº”çš„æ“ä½œã€‚
- en: '![](../Images/6ca654ab4349b5e66c39e9985ead90bc.png)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/6ca654ab4349b5e66c39e9985ead90bc.png)'
- en: Agent choosing the optimal path guided by LLM feedback.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: ä»£ç†ç¨‹åºæ ¹æ®LLMçš„åé¦ˆé€‰æ‹©æœ€ä½³è·¯å¾„ã€‚
- en: '**URL Response Flow**'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: '**URLå“åº”æµ**'
- en: '**Response format { â€œurlâ€: â€œ**[**https://www.example.com**](https://www.example.com)**"
    }**'
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**å“åº”æ ¼å¼ { â€œurlâ€: â€œ**[**https://www.example.com**](https://www.example.com)**"
    }**'
- en: '**Indicate that the agent should navigate to a specific webpage.**'
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**æŒ‡ç¤ºä»£ç†ç¨‹åºå¯¼èˆªåˆ°ç‰¹å®šç½‘é¡µã€‚**'
- en: '**This response would trigger the following steps in the script:**'
  id: totrans-102
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**æ­¤å“åº”å°†è§¦å‘è„šæœ¬ä¸­çš„ä»¥ä¸‹æ­¥éª¤ï¼š**'
- en: Extract the URL from the response
  id: totrans-103
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä»å“åº”ä¸­æå–URL
- en: Opens a browser using Puppeteer and navigates to the URL
  id: totrans-104
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä½¿ç”¨Puppeteeræ‰“å¼€æµè§ˆå™¨å¹¶å¯¼èˆªåˆ°URL
- en: The agent then takes a screenshot of the page and sends it with another special
    instruction prompt back to the LLM to analyze the content of the page and decide
    on the next steps.
  id: totrans-105
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ç„¶åï¼Œä»£ç†ç¨‹åºä¼šæˆªå›¾å¹¶é€šè¿‡å¦ä¸€ä¸ªç‰¹æ®ŠæŒ‡ä»¤æç¤ºå‘é€ç»™LLMï¼Œåˆ†æé¡µé¢å†…å®¹å¹¶å†³å®šä¸‹ä¸€æ­¥æ“ä½œã€‚
- en: '![](../Images/97229ad5607b2a6fcf9d24c47a1fe5a3.png)'
  id: totrans-106
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/97229ad5607b2a6fcf9d24c47a1fe5a3.png)'
- en: Processing flow for â€˜urlâ€™ response messages.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: â€˜urlâ€™å“åº”æ¶ˆæ¯çš„å¤„ç†æµç¨‹ã€‚
- en: '**Click Response Flow**'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: '**ç‚¹å‡»å“åº”æµ**'
- en: '**Response format { â€œclickâ€: â€œtext on a buttonâ€ }**'
  id: totrans-109
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**å“åº”æ ¼å¼ { â€œclickâ€: â€œæŒ‰é’®ä¸Šçš„æ–‡æœ¬â€ }**'
- en: '**Indicate that the agent should click on a specific element on the page.**'
  id: totrans-110
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**æŒ‡ç¤ºä»£ç†ç¨‹åºç‚¹å‡»é¡µé¢ä¸Šçš„ç‰¹å®šå…ƒç´ ã€‚**'
- en: '**The agent will undergo the following steps:**'
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ä»£ç†ç¨‹åºå°†æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š**'
- en: Extract the link text from the response
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä»å“åº”ä¸­æå–é“¾æ¥æ–‡æœ¬
- en: The agent then uses Puppeteer to find the element with the matching text and
    clicks on it
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ç„¶åï¼Œä»£ç†ç¨‹åºä½¿ç”¨PuppeteeræŸ¥æ‰¾åŒ¹é…æ–‡æœ¬çš„å…ƒç´ å¹¶ç‚¹å‡»å®ƒ
- en: The agent takes a screenshot of the page and sends it with another special instruction
    prompt back to the LLM to analyze the content of the page and decide on the next
    steps.
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ä»£ç†ç¨‹åºä¼šæˆªå›¾å¹¶é€šè¿‡å¦ä¸€ä¸ªç‰¹æ®ŠæŒ‡ä»¤æç¤ºå‘é€ç»™LLMï¼Œåˆ†æé¡µé¢å†…å®¹å¹¶å†³å®šä¸‹ä¸€æ­¥æ“ä½œã€‚
- en: '![](../Images/a2d29ca66285afcabd6ea669bf885bc1.png)'
  id: totrans-115
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a2d29ca66285afcabd6ea669bf885bc1.png)'
- en: Processing flow for â€˜clickâ€™ response messages.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: â€˜clickâ€™å“åº”æ¶ˆæ¯çš„å¤„ç†æµç¨‹ã€‚
- en: Letâ€™s take a look at the `special instruction prompt` that the agent sends to
    the LLM after taking a screenshot of the page.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬æ¥çœ‹çœ‹ä»£ç†ç¨‹åºåœ¨æˆªå›¾é¡µé¢åå‘é€ç»™LLMçš„`ç‰¹æ®ŠæŒ‡ä»¤æç¤º`ã€‚
- en: '![](../Images/ff292db3f933db519ba4f04613fe2010.png)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/ff292db3f933db519ba4f04613fe2010.png)'
- en: 'Credit: [JayZeeDesign](https://github.com/JayZeeDesign/Scrape-anything---Web-AI-agent)'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: æ¥æºï¼š[JayZeeDesign](https://github.com/JayZeeDesign/Scrape-anything---Web-AI-agent)
- en: This prompt basically tells the LLM to analyze the screenshot of the page and
    decide on the next steps. The response format should be exactly as we mentioned
    in the system prompt. With LLMs, itâ€™s often necessary to reiterate rules or guidelines
    to ensure consistent performance.
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªæç¤ºåŸºæœ¬ä¸Šå‘Šè¯‰å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰åˆ†æé¡µé¢çš„æˆªå›¾å¹¶å†³å®šä¸‹ä¸€æ­¥æ“ä½œã€‚å“åº”æ ¼å¼åº”è¯¥ä¸æˆ‘ä»¬åœ¨ç³»ç»Ÿæç¤ºä¸­æåˆ°çš„å®Œå…¨ä¸€è‡´ã€‚å¯¹äºLLMï¼Œé€šå¸¸éœ€è¦åå¤è¯´æ˜è§„åˆ™æˆ–æŒ‡å—ï¼Œä»¥ç¡®ä¿ä¸€è‡´çš„è¡¨ç°ã€‚
- en: '**Regular Message Flow â€” Regular message**'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: '**å¸¸è§„æ¶ˆæ¯æµ â€” å¸¸è§„æ¶ˆæ¯**'
- en: Indicate that the agent has finished the task and extracted the required information
    to the user.
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æŒ‡ç¤ºä»£ç†ç¨‹åºå·²å®Œæˆä»»åŠ¡å¹¶å‘ç”¨æˆ·æå–æ‰€éœ€ä¿¡æ¯ã€‚
- en: This is normally the end of the current task.
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¿™é€šå¸¸æ˜¯å½“å‰ä»»åŠ¡çš„ç»“æŸã€‚
- en: The agent will simply display the information to the user.
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä»£ç†ç¨‹åºå°†ç®€å•åœ°å‘ç”¨æˆ·å±•ç¤ºä¿¡æ¯ã€‚
- en: '**Code implementation of the path selection**'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: '**è·¯å¾„é€‰æ‹©çš„ä»£ç å®ç°**'
- en: '[PRE6]'
  id: totrans-126
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: A function that converts the **plain string response** from the LLM to the defined
    type.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€ä¸ªå°†LLMçš„**çº¯æ–‡æœ¬å“åº”**è½¬æ¢ä¸ºå®šä¹‰ç±»å‹çš„å‡½æ•°ã€‚
- en: '[PRE7]'
  id: totrans-128
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'To implement the `Path Selection`, the code should have the following backbone:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: è¦å®ç° `è·¯å¾„é€‰æ‹©`ï¼Œä»£ç åº”å…·æœ‰ä»¥ä¸‹éª¨æ¶ç»“æ„ï¼š
- en: '[PRE8]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: IT IS A LOOP!
  id: totrans-131
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å®ƒæ˜¯ä¸€ä¸ªå¾ªç¯ï¼
- en: Now, we are clear on the different paths the agent can take. One thing to note
    is that the agent will keep looping through these steps until the task is completed
    and respond with a regular message.
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œæˆ‘ä»¬æ¸…æ¥šäº†ä»£ç†å¯ä»¥é‡‡å–çš„ä¸åŒè·¯å¾„ã€‚éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œä»£ç†ä¼šä¸€ç›´å¾ªç¯è¿™äº›æ­¥éª¤ï¼Œç›´åˆ°ä»»åŠ¡å®Œæˆå¹¶å“åº”å¸¸è§„æ¶ˆæ¯ã€‚
- en: 'An example of the loop is like:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: å¾ªç¯çš„ç¤ºä¾‹å¦‚ä¸‹ï¼š
- en: '![](../Images/cece81855a5ee85556bb1ccc9b2efffb.png)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/cece81855a5ee85556bb1ccc9b2efffb.png)'
- en: The agent workflow is a loop!
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: ä»£ç†å·¥ä½œæµæ˜¯ä¸€ä¸ªå¾ªç¯ï¼
- en: The URL or Click Response Flow will be fired multiple times until the agent
    has found the answer.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: URL æˆ–ç‚¹å‡»å“åº”æµå°†å¤šæ¬¡è§¦å‘ï¼Œç›´åˆ°ä»£ç†æ‰¾åˆ°ç­”æ¡ˆã€‚
- en: 'To implement the loop, the code should have the following structure:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: è¦å®ç°å¾ªç¯ï¼Œä»£ç åº”å…·æœ‰ä»¥ä¸‹ç»“æ„ï¼š
- en: first, a helper function to determine when to stop the loop.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ªè¾…åŠ©å‡½æ•°æ¥åˆ¤æ–­ä½•æ—¶åœæ­¢å¾ªç¯ã€‚
- en: '[PRE9]'
  id: totrans-139
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Then, the main loop function.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åæ˜¯ä¸»å¾ªç¯å‡½æ•°ã€‚
- en: '[PRE10]'
  id: totrans-141
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: As you may notice, we didnâ€™t specify the regular message flow in the loop. This
    is because the regular message does not trigger any browser-controller service.
    It simply ends the loop and displays the message to the user, basically a `console.log`
    statement. Of course, you can add more logic to the regular message flow such
    as saving the message to a csv file, etc.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: æ­£å¦‚ä½ å¯èƒ½æ³¨æ„åˆ°çš„ï¼Œæˆ‘ä»¬æ²¡æœ‰åœ¨å¾ªç¯ä¸­æŒ‡å®šå¸¸è§„æ¶ˆæ¯æµã€‚è¿™æ˜¯å› ä¸ºå¸¸è§„æ¶ˆæ¯ä¸ä¼šè§¦å‘ä»»ä½•æµè§ˆå™¨æ§åˆ¶æœåŠ¡ã€‚å®ƒåªæ˜¯ç»“æŸå¾ªç¯å¹¶å‘ç”¨æˆ·æ˜¾ç¤ºæ¶ˆæ¯ï¼ŒåŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ª `console.log`
    è¯­å¥ã€‚å½“ç„¶ï¼Œä½ å¯ä»¥åœ¨å¸¸è§„æ¶ˆæ¯æµä¸­æ·»åŠ æ›´å¤šçš„é€»è¾‘ï¼Œä¾‹å¦‚å°†æ¶ˆæ¯ä¿å­˜åˆ° CSV æ–‡ä»¶ä¸­ç­‰ã€‚
- en: '[PRE11]'
  id: totrans-143
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Directory Structure
  id: totrans-144
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ç›®å½•ç»“æ„
- en: After understanding the main flow of the agent, letâ€™s take a look at the directory
    structure of the agent.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨äº†è§£äº†ä»£ç†çš„ä¸»è¦æµç¨‹ä¹‹åï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ä»£ç†çš„ç›®å½•ç»“æ„ã€‚
- en: '[PRE12]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '`agent.ts`: This is the main script for our agent. It orchestrates the other
    services and is responsible for the main execution flow of the agent. It contains
    the starting point, the main loop, and the path selection logic.'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: '`agent.ts`ï¼šè¿™æ˜¯æˆ‘ä»¬ä»£ç†çš„ä¸»è„šæœ¬ã€‚å®ƒåè°ƒå…¶ä»–æœåŠ¡ï¼Œè´Ÿè´£ä»£ç†çš„ä¸»è¦æ‰§è¡Œæµç¨‹ã€‚å®ƒåŒ…å«èµ·å§‹ç‚¹ã€ä¸»å¾ªç¯å’Œè·¯å¾„é€‰æ‹©é€»è¾‘ã€‚'
- en: '`services/`: This directory contains various services used by the agent. Each
    service is responsible for a specific task.'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: '`services/`ï¼šè¯¥ç›®å½•åŒ…å«ä»£ç†ä½¿ç”¨çš„å„ç§æœåŠ¡ã€‚æ¯ä¸ªæœåŠ¡è´Ÿè´£ä¸€ä¸ªç‰¹å®šä»»åŠ¡ã€‚'
- en: 'browser-controller.ts: This service controls the browser using Puppeteer. It
    can navigate to pages, interact with elements, and take screenshots.'
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: browser-controller.tsï¼šè¯¥æœåŠ¡ä½¿ç”¨ Puppeteer æ§åˆ¶æµè§ˆå™¨ã€‚å®ƒå¯ä»¥æµè§ˆé¡µé¢ã€ä¸å…ƒç´ äº¤äº’ä»¥åŠæˆªå›¾ã€‚
- en: 'data-transformer.ts: This service transforms data for the agent. It can format
    data, clean it, and prepare it for further processing.'
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: data-transformer.tsï¼šè¯¥æœåŠ¡ä¸ºä»£ç†è½¬æ¢æ•°æ®ã€‚å®ƒå¯ä»¥æ ¼å¼åŒ–æ•°æ®ã€æ¸…æ´—æ•°æ®ï¼Œå¹¶å‡†å¤‡è¿›ä¸€æ­¥å¤„ç†ã€‚
- en: 'element-annotator.ts: This service annotates HTML elements for the agent. It
    can highlight elements, add unique identifiers to them, and more.'
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: element-annotator.tsï¼šè¯¥æœåŠ¡ä¸ºä»£ç†æ³¨é‡Š HTML å…ƒç´ ã€‚å®ƒå¯ä»¥é«˜äº®æ˜¾ç¤ºå…ƒç´ ï¼Œç»™å…ƒç´ æ·»åŠ å”¯ä¸€æ ‡è¯†ç¬¦ç­‰ã€‚
- en: 'openai.ts: This service interfaces with the OpenAI API.'
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: openai.tsï¼šè¯¥æœåŠ¡ä¸ OpenAI API è¿›è¡Œæ¥å£å¯¹æ¥ã€‚
- en: 'prompt-map.ts: This service maps user prompts to actions. It can determine
    what action the agent should take based on the userâ€™s input.'
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: prompt-map.tsï¼šè¯¥æœåŠ¡å°†ç”¨æˆ·æç¤ºæ˜ å°„åˆ°å…·ä½“æ“ä½œã€‚å®ƒå¯ä»¥æ ¹æ®ç”¨æˆ·è¾“å…¥åˆ¤æ–­ä»£ç†åº”è¯¥é‡‡å–çš„è¡ŒåŠ¨ã€‚
- en: 'user-prompt-interface.ts: This service interfaces with the user to get prompts.
    It can read user input and pass it to the agent.'
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: user-prompt-interface.tsï¼šè¯¥æœåŠ¡ä¸ç”¨æˆ·æ¥å£ï¼Œä»¥è·å–æç¤ºã€‚å®ƒå¯ä»¥è¯»å–ç”¨æˆ·è¾“å…¥å¹¶å°†å…¶ä¼ é€’ç»™ä»£ç†ã€‚
- en: '`utils.ts`: This file contains utility functions used by the agent. These functions
    are used throughout the agent code to perform common tasks.'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: '`utils.ts`ï¼šè¯¥æ–‡ä»¶åŒ…å«ä»£ç†ä½¿ç”¨çš„å·¥å…·å‡½æ•°ã€‚è¿™äº›å‡½æ•°åœ¨ä»£ç†ä»£ç ä¸­ç”¨äºæ‰§è¡Œå¸¸è§ä»»åŠ¡ã€‚'
- en: For the full code implementation, please refer to the [Ai Web Agent](https://github.com/bianbianzhu/ai-web-agent).
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: æœ‰å…³å®Œæ•´ä»£ç å®ç°ï¼Œè¯·å‚é˜… [Ai Web Agent](https://github.com/bianbianzhu/ai-web-agent)ã€‚
- en: Browser Controller Service
  id: totrans-157
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æµè§ˆå™¨æ§åˆ¶æœåŠ¡
- en: Now, letâ€™s dive into how the agent controls the browser â€” how its hands work.
    A library called `Puppeteer` is used here. It provides a high-level API over the
    Chrome DevTools Protocol. See the [Puppeteer documentation](https://pptr.dev/)
    for more details.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ·±å…¥äº†è§£ä»£ç†å¦‚ä½•æ§åˆ¶æµè§ˆå™¨â€”â€”å®ƒçš„â€œæ‰‹â€æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚è¿™é‡Œä½¿ç”¨äº†ä¸€ä¸ªåä¸º `Puppeteer` çš„åº“ã€‚å®ƒæä¾›äº†ä¸€ä¸ªåŸºäº Chrome DevTools
    åè®®çš„é«˜çº§ APIã€‚è¯¦ç»†ä¿¡æ¯è¯·å‚è§ [Puppeteer æ–‡æ¡£](https://pptr.dev/)ã€‚
- en: Essentially, Puppeteer gets called after the agent receives a response from
    the LLM. Under different paths as we mentioned above, Puppeteer will execute different
    actions.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: æœ¬è´¨ä¸Šï¼ŒPuppeteer ä¼šåœ¨ä»£ç†ä» LLM æ¥æ”¶åˆ°å“åº”åè¢«è°ƒç”¨ã€‚åœ¨æˆ‘ä»¬ä¸Šé¢æåˆ°çš„ä¸åŒè·¯å¾„ä¸‹ï¼ŒPuppeteer ä¼šæ‰§è¡Œä¸åŒçš„æ“ä½œã€‚
- en: 'Overall, the browser-controller service is responsible for the following:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: æ€»ä½“è€Œè¨€ï¼Œæµè§ˆå™¨æ§åˆ¶å™¨æœåŠ¡è´Ÿè´£ä»¥ä¸‹ä»»åŠ¡ï¼š
- en: Navigating to a URL
  id: totrans-161
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å¯¼èˆªåˆ°ä¸€ä¸ª URL
- en: Clicking on a link
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ç‚¹å‡»ä¸€ä¸ªé“¾æ¥
- en: Taking a screenshot of the page
  id: totrans-163
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æˆªå–é¡µé¢æˆªå›¾
- en: '![](../Images/3a30655d1ff49b52ff7e6a8eaa31cb5f.png)'
  id: totrans-164
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3a30655d1ff49b52ff7e6a8eaa31cb5f.png)'
- en: The tasks that Puppeteer would do in the workflow.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: Puppeteer åœ¨å·¥ä½œæµç¨‹ä¸­æ‰§è¡Œçš„ä»»åŠ¡ã€‚
- en: There is, in fact, another step taken before the agent takes a screenshot of
    the page â€” `Highlighting interactive elements`. We have separated this service
    into a different file to make the code more modular and easier to maintain. It
    will be discussed in the next section.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: å®é™…ä¸Šï¼Œåœ¨ä»£ç†æˆªå›¾é¡µé¢ä¹‹å‰ï¼Œè¿˜æœ‰ä¸€ä¸ªæ­¥éª¤ â€” `é«˜äº®äº¤äº’å…ƒç´ `ã€‚æˆ‘ä»¬å°†è¿™ä¸ªæœåŠ¡åˆ†ç¦»åˆ°å¦ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œä»¥ä½¿ä»£ç æ›´åŠ æ¨¡å—åŒ–ï¼Œå¹¶ä¸”æ˜“äºç»´æŠ¤ã€‚å®ƒå°†åœ¨ä¸‹ä¸€éƒ¨åˆ†è®¨è®ºã€‚
- en: '**Code implementation of the browser-controller service**'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: '**æµè§ˆå™¨æ§åˆ¶å™¨æœåŠ¡çš„ä»£ç å®ç°**'
- en: Step 1 â€” Initialize the browser and open a new tab
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: æ­¥éª¤ 1 â€” åˆå§‹åŒ–æµè§ˆå™¨å¹¶æ‰“å¼€ä¸€ä¸ªæ–°æ ‡ç­¾é¡µ
- en: '[PRE13]'
  id: totrans-169
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: Based on different response flows, the agent would either navigate to a URL
    and take a screenshot, or click on a link which triggers a navigation and take
    a screenshot.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
  zh: æ ¹æ®ä¸åŒçš„å“åº”æµç¨‹ï¼Œä»£ç†è¦ä¹ˆå¯¼èˆªåˆ°ä¸€ä¸ª URL å¹¶æˆªå›¾ï¼Œè¦ä¹ˆç‚¹å‡»ä¸€ä¸ªé“¾æ¥è§¦å‘å¯¼èˆªå¹¶æˆªå›¾ã€‚
- en: 'Step 2 â€” `URL Response Flow`: Navigate to a URL and take a screenshot'
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: æ­¥éª¤ 2 â€” `URL å“åº”æµç¨‹`ï¼šå¯¼èˆªåˆ°ä¸€ä¸ª URL å¹¶æˆªå›¾
- en: '[PRE14]'
  id: totrans-172
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: The `waitAndScreenshot` function
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: '`waitAndScreenshot`å‡½æ•°'
- en: '[PRE15]'
  id: totrans-174
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: The screenshot is simply taken by calling `page.screenshot()`. You may change
    the configuration to meet your needs.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: æˆªå›¾æ˜¯é€šè¿‡è°ƒç”¨`page.screenshot()`ç®€å•å®Œæˆçš„ã€‚ä½ å¯ä»¥æ ¹æ®éœ€è¦æ›´æ”¹é…ç½®ã€‚
- en: The `waitTillHTMLRendered` function
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: '`waitTillHTMLRendered`å‡½æ•°'
- en: As shown, the navigation to the URL is done via `page.goto()`. This method utilizes
    the `waitUntil` option for the page load. After the page is loaded, the agent
    takes a screenshot. It is very crucial to wait for all the visual content to be
    loaded before taking the screenshot to ensure the agent gets the full info of
    the page.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚å›¾æ‰€ç¤ºï¼Œå¯¼èˆªåˆ° URL æ˜¯é€šè¿‡`page.goto()`å®Œæˆçš„ã€‚è¯¥æ–¹æ³•åˆ©ç”¨`waitUntil`é€‰é¡¹æ¥ç­‰å¾…é¡µé¢åŠ è½½ã€‚é¡µé¢åŠ è½½å®Œæ¯•åï¼Œä»£ç†ä¼šæˆªå›¾ã€‚åœ¨æˆªå›¾ä¹‹å‰ï¼Œç­‰å¾…æ‰€æœ‰è§†è§‰å†…å®¹åŠ è½½å®Œæ¯•æ˜¯è‡³å…³é‡è¦çš„ï¼Œä»¥ç¡®ä¿ä»£ç†èƒ½å¤Ÿè·å–é¡µé¢çš„å®Œæ•´ä¿¡æ¯ã€‚
- en: Unfortunately, in many cases, the `waitUntil` in `GoToOptions` (page.goto())
    is not enough to wait for the page to load completely (especially with dynamic
    loading content), so we need to use the custom function `waitTillHTMLRendered`.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸å¹¸çš„æ˜¯ï¼Œåœ¨è®¸å¤šæƒ…å†µä¸‹ï¼Œ`GoToOptions`ä¸­çš„`waitUntil`ï¼ˆpage.goto()ï¼‰ä¸è¶³ä»¥ç­‰å¾…é¡µé¢å®Œå…¨åŠ è½½ï¼ˆç‰¹åˆ«æ˜¯åŠ¨æ€åŠ è½½çš„å†…å®¹ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä½¿ç”¨è‡ªå®šä¹‰å‡½æ•°`waitTillHTMLRendered`ã€‚
- en: 'This function basically checks if the page is still loading via `document.readyState`
    or if there is a loading indicator on the page. If the page is still loading,
    the function will call `waitTillHTMLRendered` to undertake a comprehensive check:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªå‡½æ•°åŸºæœ¬ä¸Šé€šè¿‡`document.readyState`æ£€æŸ¥é¡µé¢æ˜¯å¦ä»åœ¨åŠ è½½ï¼Œæˆ–è€…é¡µé¢ä¸Šæ˜¯å¦æœ‰åŠ è½½æŒ‡ç¤ºå™¨ã€‚å¦‚æœé¡µé¢ä»åœ¨åŠ è½½ï¼Œå‡½æ•°å°†è°ƒç”¨`waitTillHTMLRendered`è¿›è¡Œå…¨é¢æ£€æŸ¥ï¼š
- en: It checks the HTML size every second.
  id: totrans-180
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æ¯ç§’æ£€æŸ¥ä¸€æ¬¡ HTML å¤§å°ã€‚
- en: If the HTML size remains the same for 3 consecutive seconds, it assumes the
    page has finished loading.
  id: totrans-181
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å¦‚æœ HTML å¤§å°è¿ç»­ 3 ç§’é’Ÿä¿æŒä¸å˜ï¼Œåˆ™å‡å®šé¡µé¢å·²åŠ è½½å®Œæ¯•ã€‚
- en: Throw error if the page is still loading after 30 seconds (timeout).
  id: totrans-182
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å¦‚æœé¡µé¢åœ¨ 30 ç§’åä»åœ¨åŠ è½½ï¼ˆè¶…æ—¶ï¼‰ï¼Œåˆ™æŠ›å‡ºé”™è¯¯ã€‚
- en: 'The flowchart below shows the logic of the `waitTillHTMLRendered` function:'
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: ä»¥ä¸‹æµç¨‹å›¾å±•ç¤ºäº†`waitTillHTMLRendered`å‡½æ•°çš„é€»è¾‘ï¼š
- en: '![](../Images/5620f6b1b199b44699cdf9b89410420e.png)'
  id: totrans-184
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/5620f6b1b199b44699cdf9b89410420e.png)'
- en: Flowchart of function `waitTillHTMLRendered.`
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: '`waitTillHTMLRendered`å‡½æ•°çš„æµç¨‹å›¾ã€‚'
- en: 'To have a better understanding of the `waitAndScreenshot` function, let''s
    take a look at the log of the function in action:'
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†æ›´å¥½åœ°ç†è§£`waitAndScreenshot`å‡½æ•°ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹è¯¥å‡½æ•°è¿è¡Œæ—¶çš„æ—¥å¿—ï¼š
- en: '![](../Images/76781d17a83b9de376b0b37229a00f7c.png)'
  id: totrans-187
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/76781d17a83b9de376b0b37229a00f7c.png)'
- en: Logs capturing dynamic content rendering.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: æ•è·åŠ¨æ€å†…å®¹æ¸²æŸ“çš„æ—¥å¿—ã€‚
- en: After the page is **completely** loaded, all interactive elements are highlighted
    and a screenshot is taken.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨é¡µé¢**å®Œå…¨**åŠ è½½åï¼Œæ‰€æœ‰äº¤äº’å…ƒç´ è¢«é«˜äº®æ˜¾ç¤ºå¹¶æˆªå›¾ã€‚
- en: '[PRE16]'
  id: totrans-190
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'Step 2 (cont.) â€” `Click Response Flow`: The `clickNavigationAndScreenshot`
    function'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: æ­¥éª¤ 2ï¼ˆç»­ï¼‰ â€” `ç‚¹å‡»å“åº”æµç¨‹`ï¼š`clickNavigationAndScreenshot`å‡½æ•°
- en: This function is used to click on a specific element on the page and wait for
    the page to load completely and then take a screenshot. For the `click` action,
    it utilizes another function called `clickOnLink`.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: è¯¥å‡½æ•°ç”¨äºç‚¹å‡»é¡µé¢ä¸Šçš„ç‰¹å®šå…ƒç´ ï¼Œç­‰å¾…é¡µé¢å®Œå…¨åŠ è½½åå†æˆªå›¾ã€‚å¯¹äº`click`æ“ä½œï¼Œå®ƒä½¿ç”¨äº†å¦ä¸€ä¸ªåä¸º`clickOnLink`çš„å‡½æ•°ã€‚
- en: '[PRE17]'
  id: totrans-193
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: The `clickOnLink` function
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: '`clickOnLink`å‡½æ•°'
- en: This function loops through all the elements with the `gpt-link-text` attribute
    (unique identifier received during element annotation) and clicks on the one that
    matches the link text provided by the LLM.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªåŠŸèƒ½ä¼šéå†æ‰€æœ‰å¸¦æœ‰`gpt-link-text`å±æ€§çš„å…ƒç´ ï¼ˆè¿™æ˜¯å…ƒç´ æ³¨é‡Šè¿‡ç¨‹ä¸­è·å¾—çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼‰ï¼Œå¹¶ç‚¹å‡»ä¸LLMæä¾›çš„é“¾æ¥æ–‡æœ¬åŒ¹é…çš„å…ƒç´ ã€‚
- en: '[PRE18]'
  id: totrans-196
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Element Annotation Service
  id: totrans-197
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å…ƒç´ æ³¨é‡ŠæœåŠ¡
- en: Letâ€™s look deeper into the `highlightInteractiveElements` function that is called
    inside `waitAndScreenshot`.
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬æ›´æ·±å…¥åœ°äº†è§£`highlightInteractiveElements`å‡½æ•°ï¼Œå®ƒåœ¨`waitAndScreenshot`å†…éƒ¨è¢«è°ƒç”¨ã€‚
- en: It is a service that annotates the interactive HTML elements for the agent.
    It can highlight elements with a `red bounding box` and add unique identifiers
    to them.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯ä¸€ä¸ªä¸ºä»£ç†æ³¨é‡Šäº¤äº’å¼HTMLå…ƒç´ çš„æœåŠ¡ã€‚å®ƒå¯ä»¥ç”¨`çº¢è‰²è¾¹æ¡†`çªå‡ºæ˜¾ç¤ºå…ƒç´ ï¼Œå¹¶ä¸ºå®ƒä»¬æ·»åŠ å”¯ä¸€æ ‡è¯†ç¬¦ã€‚
- en: Imagine giving your AI agent a special pair of glasses that lets it see the
    interactive spots on a website â€” the buttons, links, and fields â€” like glowing
    treasures on a treasure map.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: æƒ³è±¡ä¸€ä¸‹ï¼Œç»™ä½ çš„AIä»£ç†é…ä¸Šä¸€å‰¯ç‰¹æ®Šçš„çœ¼é•œï¼Œè®©å®ƒèƒ½çœ‹åˆ°ç½‘ç«™ä¸Šçš„äº¤äº’ç‚¹â€”â€”æŒ‰é’®ã€é“¾æ¥å’Œå­—æ®µâ€”â€”å°±åƒå®è—å›¾ä¸Šçš„å‘å…‰å®è—ä¸€æ ·ã€‚
- en: Thatâ€™s essentially what the `highlightInteractiveElements` function does. It's
    like a highlighter for the digital world, sketching red boxes around clickable
    items and tagging them with digital nametags.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™åŸºæœ¬ä¸Šå°±æ˜¯`highlightInteractiveElements`å‡½æ•°çš„ä½œç”¨ã€‚å®ƒå°±åƒæ•°å­—ä¸–ç•Œä¸­çš„è§å…‰ç¬”ï¼Œåœ¨å¯ç‚¹å‡»çš„é¡¹ç›®å‘¨å›´ç”»ä¸Šçº¢æ¡†ï¼Œå¹¶ç”¨æ•°å­—æ ‡ç­¾æ ‡è®°å®ƒä»¬ã€‚
- en: '**With the annotation, the accuracy of the agentâ€™s interpretation of the image
    is largely improved**. This concept is called `Set-of-Mark Prompting`.'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: '**é€šè¿‡æ³¨é‡Šï¼Œä»£ç†å¯¹å›¾åƒçš„ç†è§£å‡†ç¡®æ€§å¾—åˆ°äº†å¤§å¹…æå‡**ã€‚è¿™ä¸ªæ¦‚å¿µå«åš`Set-of-Mark Prompting`ã€‚'
- en: 'Here is an example of the annotated screenshot:'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯æ³¨é‡Šæˆªå›¾çš„ä¸€ä¸ªç¤ºä¾‹ï¼š
- en: '![](../Images/b85a7f190d2179f011cdda31a784a805.png)'
  id: totrans-204
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b85a7f190d2179f011cdda31a784a805.png)'
- en: E-commerce site with interactive elements highlighted in red. Image from Officeworks
    website.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: ç”µå­å•†åŠ¡ç½‘ç«™ï¼Œäº¤äº’å…ƒç´ è¢«çº¢è‰²é«˜äº®æ˜¾ç¤ºã€‚å›¾åƒæ¥è‡ªOfficeworksç½‘ç«™ã€‚
- en: 'There is a research paper discussing the importance of this topic in detail:
    [Set-of-Mark Prompting](https://arxiv.org/abs/2310.11441).'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: æœ‰ä¸€ç¯‡ç ”ç©¶è®ºæ–‡è¯¦ç»†è®¨è®ºäº†è¿™ä¸ªè¯é¢˜çš„é‡è¦æ€§ï¼š[Set-of-Mark Prompting](https://arxiv.org/abs/2310.11441)ã€‚
- en: 'Hereâ€™s how it performs:'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: ä»¥ä¸‹æ˜¯å®ƒçš„æ‰§è¡Œæ–¹å¼ï¼š
- en: It starts by removing any old digital nametags (html attribute `gpt-link-text`)
    that might confuse our AI.
  id: totrans-208
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å®ƒé¦–å…ˆç§»é™¤å¯èƒ½ä¼šæ··æ·†æˆ‘ä»¬AIçš„æ—§æ•°å­—æ ‡ç­¾ï¼ˆhtmlå±æ€§`gpt-link-text`ï¼‰ã€‚
- en: Then, it lights up every clickable thing it finds with a red outline to help
    the AI spot where to â€˜clickâ€™.
  id: totrans-209
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: ç„¶åï¼Œå®ƒä¼šç”¨çº¢è‰²è½®å»“çªå‡ºæ˜¾ç¤ºå®ƒå‘ç°çš„æ¯ä¸ªå¯ç‚¹å‡»çš„å†…å®¹ï¼Œå¸®åŠ©AIè¯†åˆ«åº”è¯¥â€œç‚¹å‡»â€å“ªé‡Œã€‚
- en: Each interactive element gets a unique nametag. This tag/attribute will be used
    to identify the element that Puppeteer can later interact with.
  id: totrans-210
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æ¯ä¸ªäº¤äº’å…ƒç´ éƒ½ä¼šæœ‰ä¸€ä¸ªç‹¬ç‰¹çš„æ ‡ç­¾ã€‚è¿™ä¸ªæ ‡ç­¾/å±æ€§å°†ç”¨äºæ ‡è¯†Puppeteerç¨åå¯ä»¥ä¸ä¹‹äº’åŠ¨çš„å…ƒç´ ã€‚
- en: 'One key detail to remember is when dealing with puppeteer or any other testing
    framework that programmatically interacts with the web, the element with a link
    text may not be visible. Here is a simple example:'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: éœ€è¦è®°ä½çš„ä¸€ä¸ªå…³é”®ç»†èŠ‚æ˜¯ï¼Œå½“å¤„ç†Puppeteeræˆ–ä»»ä½•å…¶ä»–ä»¥ç¼–ç¨‹æ–¹å¼ä¸ç½‘é¡µäº¤äº’çš„æµ‹è¯•æ¡†æ¶æ—¶ï¼Œå¸¦æœ‰é“¾æ¥æ–‡æœ¬çš„å…ƒç´ å¯èƒ½ä¸å¯è§ã€‚è¿™é‡Œæ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š
- en: '[PRE19]'
  id: totrans-212
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'The parent div is hidden, so the link is not visible. This element should be
    excluded. Recursive checking the parent element is necessary to ensure the element
    is visible. See below graph for the logic:'
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: çˆ¶divè¢«éšè—ï¼Œæ‰€ä»¥é“¾æ¥ä¸å¯è§ã€‚è¿™ä¸ªå…ƒç´ åº”è¯¥è¢«æ’é™¤ã€‚éœ€è¦é€’å½’æ£€æŸ¥çˆ¶å…ƒç´ ä»¥ç¡®ä¿è¯¥å…ƒç´ å¯è§ã€‚è¯·å‚è§ä¸‹å›¾ä¸­çš„é€»è¾‘ï¼š
- en: '![](../Images/171f42e9c803a67604cb42a80db2a9c2.png)'
  id: totrans-214
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/171f42e9c803a67604cb42a80db2a9c2.png)'
- en: Flowchart of function isElementVisible.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: '`isElementVisible`å‡½æ•°çš„æµç¨‹å›¾ã€‚'
- en: Code implementation of the `highlightInteractiveElements` function
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: '`highlightInteractiveElements`å‡½æ•°çš„ä»£ç å®ç°'
- en: '[PRE20]'
  id: totrans-217
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: Conclusion
  id: totrans-218
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ç»“è®º
- en: In this article, we have gone through the architecture of the AI agent, the
    code implementation of each step, and some concepts behind the design, such as
    Set-of-Mark Prompting. The agent is an elegant system that requires careful orchestration
    of different services to work effectively, and currently it has plenty of issues
    and limitations. If you have any questions or suggestions, please feel free to
    reach out to me. I would be happy to discuss this topic further.
  id: totrans-219
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬æ¢è®¨äº†AIä»£ç†çš„æ¶æ„ã€æ¯ä¸ªæ­¥éª¤çš„ä»£ç å®ç°ä»¥åŠè®¾è®¡èƒŒåçš„æŸäº›æ¦‚å¿µï¼Œå¦‚Set-of-Mark Promptingã€‚è¯¥ä»£ç†æ˜¯ä¸€ä¸ªä¼˜é›…çš„ç³»ç»Ÿï¼Œéœ€è¦ç²¾å¿ƒåè°ƒä¸åŒçš„æœåŠ¡æ‰èƒ½æœ‰æ•ˆè¿è¡Œï¼Œç›®å‰ä»å­˜åœ¨è®¸å¤šé—®é¢˜å’Œå±€é™æ€§ã€‚å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·éšæ—¶ä¸æˆ‘è”ç³»ã€‚æˆ‘å¾ˆæ„¿æ„è¿›ä¸€æ­¥è®¨è®ºè¿™ä¸ªè¯é¢˜ã€‚
- en: Enjoyed This Story?
  id: totrans-220
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å–œæ¬¢è¿™ä¸ªæ•…äº‹å—ï¼Ÿ
- en: '**Jason Li** ([Tianyi Li](https://medium.com/u/4092d7367010), [LinkedIn](https://www.linkedin.com/in/tianyi-li-jason/))
    is a Full-stack Developer working at [Mindset Health](https://www.mindsethealth.com/)
    in Melbourne Australia. Jason is passionate about AI, front-end development and
    space related technologies.'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: '**Jason Li**ï¼ˆ[Tianyi Li](https://medium.com/u/4092d7367010)ï¼Œ[LinkedIn](https://www.linkedin.com/in/tianyi-li-jason/)ï¼‰æ˜¯ä½äºæ¾³å¤§åˆ©äºšå¢¨å°”æœ¬çš„
    [Mindset Health](https://www.mindsethealth.com/) çš„å…¨æ ˆå¼€å‘å·¥ç¨‹å¸ˆã€‚Jason å¯¹äººå·¥æ™ºèƒ½ã€å‰ç«¯å¼€å‘å’Œä¸ç©ºé—´ç›¸å…³çš„æŠ€æœ¯å……æ»¡çƒ­æƒ…ã€‚'
- en: '**Selina Li** ([Selina Li](https://medium.com/u/7b9ea39b0d79), [LinkedIn](https://www.linkedin.com/in/selina-zhuohang-li-3b7355120/))
    is a Principal Data Engineer working at [Officeworks](https://www.officeworks.com.au/)
    in Melbourne Australia. Selina is passionate about AI/ML, data engineering and
    investment.'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: '**Selina Li**ï¼ˆ[Selina Li](https://medium.com/u/7b9ea39b0d79)ï¼Œ[LinkedIn](https://www.linkedin.com/in/selina-zhuohang-li-3b7355120/)ï¼‰æ˜¯ä½äºæ¾³å¤§åˆ©äºšå¢¨å°”æœ¬çš„
    [Officeworks](https://www.officeworks.com.au/) çš„é¦–å¸­æ•°æ®å·¥ç¨‹å¸ˆã€‚Selina å¯¹äººå·¥æ™ºèƒ½/æœºå™¨å­¦ä¹ ã€æ•°æ®å·¥ç¨‹å’ŒæŠ•èµ„å……æ»¡çƒ­æƒ…ã€‚'
- en: Jason and Selina would love to explore technologies to help people achieve their
    goals.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
  zh: Jason å’Œ Selina å¸Œæœ›æ¢ç´¢æŠ€æœ¯ï¼Œå¸®åŠ©äººä»¬å®ç°ä»–ä»¬çš„ç›®æ ‡ã€‚
- en: '*Unless otherwise noted, all images are by the authors.*'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: '*é™¤éå¦æœ‰è¯´æ˜ï¼Œæ‰€æœ‰å›¾ç‰‡å‡ç”±ä½œè€…æä¾›ã€‚*'
