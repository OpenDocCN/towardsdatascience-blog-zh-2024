<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Maximize Savings on Your Unused Fabric Capacities</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Maximize Savings on Your Unused Fabric Capacities</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/maximize-savings-on-your-unused-fabric-capacity-4c74b12505fd?source=collection_archive---------16-----------------------#2024-07-29">https://towardsdatascience.com/maximize-savings-on-your-unused-fabric-capacity-4c74b12505fd?source=collection_archive---------16-----------------------#2024-07-29</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="31a1" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">Automate your Microsoft Fabric capacity state with Azure Logic Apps</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://chrystasantos.medium.com/?source=post_page---byline--4c74b12505fd--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Christabelle Santos" class="l ep by dd de cx" src="../Images/20c287bf86da286ed1307f49b7b932ca.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*6wlSApjA2CeQ6Pi9XZ6anQ.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--4c74b12505fd--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://chrystasantos.medium.com/?source=post_page---byline--4c74b12505fd--------------------------------" rel="noopener follow">Christabelle Santos</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--4c74b12505fd--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">9 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Jul 29, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj la lb ab q ee lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lf k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lg an ao ap id lh li lj" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep lk cn"><div class="l ae"><div class="ab cb"><div class="ll lm ln lo lp lq ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><p id="984c" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk"><em class="ne">Disclaimer: This post will not cover what Microsoft Fabric is or how to use it.</em></p><blockquote class="nf ng nh"><p id="b934" class="mi mj ne mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk"><a class="af ni" href="https://learn.microsoft.com/en-gb/fabric/get-started/microsoft-fabric-overview" rel="noopener ugc nofollow" target="_blank">Fabric</a> is a unified data platform that offers shared experiences, architecture, governance, compliance and billing. Capacities provide the computing power that drives all these experiences. You can read more about fabric capacities <a class="af ni" href="https://blog.fabric.microsoft.com/en-US/blog/fabric-capacities-everything-you-need-to-know-about-whats-new-and-whats-coming/" rel="noopener ugc nofollow" target="_blank">here</a>.</p></blockquote><p id="fa5a" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Imagine this: your Fabric trial is ending, and you’re still in the proof-of-concept phase to determine if Fabric is the right option for you. Managing your capacity efficiently is crucial, as you don’t want to incur unnecessary costs for unused capacity, especially during these testing or evaluation periods.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt ed nu bh nv"><div class="nj nk nl"><img src="../Images/2de4885cb7856c4e1b9a7376d4324a1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kcU_kcYLnpMD33l-8DxYLg.jpeg"/></div></div><figcaption class="nx ny nz nj nk oa ob bf b bg z dx">Photo by <a class="af ni" href="https://unsplash.com/@kmuza?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash" rel="noopener ugc nofollow" target="_blank">Carlos Muza</a> on <a class="af ni" href="https://unsplash.com/photos/laptop-computer-on-glass-top-table-hpjSkU2UYSU?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4513" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">If you’re already using Fabric for production workloads, the strategy we will be discussing in this post won’t work for you, as you’ll likely require some available capacity at all times to support those workloads. You might be more interested in learning how <a class="af ni" href="https://learn.microsoft.com/en-us/fabric/data-warehouse/compute-capacity-smoothing-throttling" rel="noopener ugc nofollow" target="_blank">smoothing and throttling processes work in Fabric</a> to estimate your costs and <a class="af ni" href="https://learn.microsoft.com/en-us/fabric/enterprise/metrics-app" rel="noopener ugc nofollow" target="_blank">how to use the capacity metrics app to monitor them</a>.</p><p id="fd4c" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">For the rest of you who are still working in non-production environments, I’ll show you how to automatically pause your Fabric capacity when it’s not needed. This is particularly useful if you’re testing capabilities but won’t be running tests 24/7. So, how can you ensure you don’t forget to pause your capacity?</p><p id="7ca8" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">You might be wondering, what does it mean to pause your Fabric capacity? Is this even possible? The answer is yes, and I’ll show you how.</p><p id="d5d1" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">When we create a <a class="af ni" href="https://learn.microsoft.com/en-us/fabric/enterprise/buy-subscription#buy-an-azure-sku" rel="noopener ugc nofollow" target="_blank">Fabric capacity in the Azure portal</a>, we will see something like this, where you have an option to pause your capacity, so you’re not being charged for not using it.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt ed nu bh nv"><div class="nj nk oc"><img src="../Images/fd95fd5f6de0a7e321972e7a92572e37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RqEFTTs2KtKb-eGcA3t76w.jpeg"/></div></div></figure><p id="a318" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">But what if you forget to pause it for a couple of days?</p><p id="3ce7" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">That could lead to a significantly higher Azure bill. To prevent this, let’s create an automated way to pause your Fabric capacity.</p></div></div></div><div class="ab cb od oe of og" role="separator"><span class="oh by bm oi oj ok"/><span class="oh by bm oi oj ok"/><span class="oh by bm oi oj"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h2 id="a36a" class="ol om fq bf on oo op oq or os ot ou ov mr ow ox oy mv oz pa pb mz pc pd pe pf bk">Azure Logic Apps to the rescue</h2><p id="ec05" class="pw-post-body-paragraph mi mj fq mk b go pg mm mn gr ph mp mq mr pi mt mu mv pj mx my mz pk nb nc nd fj bk">To accomplish this, we will be first creating a logic app in Azure, preferably within the same resource group as your Fabric capacity.</p><p id="6570" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">You can follow the instructions from <a class="af ni" href="https://learn.microsoft.com/en-us/azure/logic-apps/quickstart-create-example-consumption-workflow#create-a-consumption-logic-app-resource" rel="noopener ugc nofollow" target="_blank">here</a> to create your logic app. Be sure to choose the <code class="cx pl pm pn po b"><strong class="mk fr">Consumption</strong></code> plan type instead of the <code class="cx pl pm pn po b"><strong class="mk fr">Standard</strong></code> plan type, as it is easier to use for beginners and you’ll only pay for what you use.</p><p id="335a" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Before we begin designing the logic app, we need to grant the logic app access to modify the state of your Fabric capacity, as security is of the utmost importance. To enable this, navigate to the <code class="cx pl pm pn po b"><strong class="mk fr">Settings &gt; Identity</strong></code> option of your logic app, and turn on the system-assigned managed identity.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt ed nu bh nv"><div class="nj nk pp"><img src="../Images/ac978584d2ed96c68798d679dedda09a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VUXAq_7OhijZBZ9qym-DiQ.png"/></div></div></figure><p id="75d7" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Managed identities provide an automatically managed identity in Entra ID for applications to use when connecting to resources that support Entra ID authentication, without the need to store credentials in your code. This will allow the newly created logic app to securely interact with your Fabric capacity without needing explicit credentials.</p><p id="e3aa" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Once we’ve enabled the managed identity, we need to give this identity read and write permission on your fabric capacity. In order to this, we will navigate back to our fabric capacity resource.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt ed nu bh nv"><div class="nj nk pq"><img src="../Images/80942363c392d88c25736bcaa5f62beb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TOlfzRYJKCi6lENkLh2uxw.png"/></div></div></figure><p id="80cf" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">On the <code class="cx pl pm pn po b"><strong class="mk fr">Add Role Assignment</strong></code> page, select the <code class="cx pl pm pn po b"><strong class="mk fr">Contributor</strong></code> role under <code class="cx pl pm pn po b"><strong class="mk fr">Privileged administrator roles</strong></code>, as this role provides both read and write access to the Fabric capacity. Then, click <code class="cx pl pm pn po b"><strong class="mk fr">Next</strong></code>.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt ed nu bh nv"><div class="nj nk pr"><img src="../Images/39732f1204db5ac4cc59a85074d6a454.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TLYJN3xlMTRe5a3V87iWEQ.png"/></div></div></figure><p id="3197" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">On the next page, select the managed identity of your logic app. Ensure it appears under <code class="cx pl pm pn po b"><strong class="mk fr">Selected members</strong></code>, then click <code class="cx pl pm pn po b"><strong class="mk fr">Select</strong></code>, followed by <code class="cx pl pm pn po b"><strong class="mk fr">Next</strong></code>. On the final page, simply click <code class="cx pl pm pn po b"><strong class="mk fr">Review + assign</strong></code>.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt ed nu bh nv"><div class="nj nk ps"><img src="../Images/9200d051d374e05698d53943c990f40f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dpOs61qvEBDJaN4i9fNNkA.png"/></div></div></figure><p id="b74b" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">With that, we have successfully granted our logic app the necessary permissions to perform its task! Now, let’s begin. We have five easy steps to build this workflow, which should be followed preferably in order.</p></div></div></div><div class="ab cb od oe of og" role="separator"><span class="oh by bm oi oj ok"/><span class="oh by bm oi oj ok"/><span class="oh by bm oi oj"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="04e0" class="pt om fq bf on pu pv gq or pw px gt ov py pz qa qb qc qd qe qf qg qh qi qj qk bk">Designing the logic app</h1><p id="2a49" class="pw-post-body-paragraph mi mj fq mk b go pg mm mn gr ph mp mq mr pi mt mu mv pj mx my mz pk nb nc nd fj bk">To start, navigate to the <code class="cx pl pm pn po b"><strong class="mk fr">Logic app designer</strong></code>, located under the<strong class="mk fr"> </strong><code class="cx pl pm pn po b"><strong class="mk fr">Development Tools</strong></code><strong class="mk fr"> </strong>setting in your logic app resource.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt ed nu bh nv"><div class="nj nk ql"><img src="../Images/076ff08af77cdb2d55546cf7477a85ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GH7qaTat2F111z8vX2gsyg.jpeg"/></div></div></figure><h2 id="105b" class="ol om fq bf on oo op oq or os ot ou ov mr ow ox oy mv oz pa pb mz pc pd pe pf bk">Create Parameters</h2><p id="e825" class="pw-post-body-paragraph mi mj fq mk b go pg mm mn gr ph mp mq mr pi mt mu mv pj mx my mz pk nb nc nd fj bk">Before we start adding triggers and actions, we need to define some parameters that will be used with our HTTP request actions later.</p><p id="abb0" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">We will need to build our parameters as mentioned below by replacing <code class="cx pl pm pn po b">your-subscription-id</code>,<strong class="mk fr"> </strong><code class="cx pl pm pn po b">your-resource-group-name</code><strong class="mk fr"> </strong>and <code class="cx pl pm pn po b">your-fabric-capacity-name</code> with your corresponding subscription ID, resource group name and fabric capacity name values. The first one parameter is to get the status of your Fabric capacity:</p><pre class="nm nn no np nq qm po qn bp qo bb bk"><span id="9610" class="qp om fq po b bg qq qr l qs qt">Name          : $getfabricstatus<br/>Type          : String <br/>Default Value : https://management.azure.com/subscriptions/your-subscription-id/resourceGroups/your-resource-group-name/providers/Microsoft.Fabric/capacities/your-fabric-capacity-name?api-version=2023-11-01</span></pre><p id="ac90" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">And the second one is to pause your Fabric capacity:</p><pre class="nm nn no np nq qm po qn bp qo bb bk"><span id="7cf5" class="qp om fq po b bg qq qr l qs qt">Name          : $pausefabriccapacity<br/>Type          : String<br/>Default Value : https://management.azure.com/subscriptions/your-subscription-id/resourceGroups/your-resource-group-name/providers/Microsoft.Fabric/capacities/your-fabric-capacity-name/suspend?api-version=2023-11-01</span></pre><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt ed nu bh nv"><div class="nj nk qu"><img src="../Images/4f8158b9e17f2fac85648d3148881552.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ny7cBBU47Eg_xjV32oOpGw.png"/></div></div></figure><p id="fd96" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Make sure to save the logic app design at this stage to ensure your parameters are saved.</p><h2 id="c899" class="ol om fq bf on oo op oq or os ot ou ov mr ow ox oy mv oz pa pb mz pc pd pe pf bk"><strong class="al">Create Recurrence Schedule Trigger</strong></h2><p id="ddb0" class="pw-post-body-paragraph mi mj fq mk b go pg mm mn gr ph mp mq mr pi mt mu mv pj mx my mz pk nb nc nd fj bk">Once we have our parameters created, we can start the design of our logic app. When we create a logic app, we will always start with adding a trigger. This will define how often the logic app runs. You can set it to run daily, weekly, or at any other interval that suits your needs. This ensures that the logic app checks the status of your Fabric capacity at regular intervals.</p><p id="7bbb" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">To do this, click the <code class="cx pl pm pn po b"><strong class="mk fr">Add Trigger</strong></code> button located in the center of the canvas as indicated in the image below.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt ed nu bh nv"><div class="nj nk qv"><img src="../Images/03090a65196f339f688b22f8b7fa7280.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GZY9wuR3pMO_JQnKSvbQug.png"/></div></div></figure><p id="5fdd" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">The <code class="cx pl pm pn po b"><strong class="mk fr">Add a trigger</strong></code> pane will open on the right side of the page. Here, you can search for the Schedule trigger and select the <code class="cx pl pm pn po b"><strong class="mk fr">Recurrence</strong></code> option from the two available choices.</p><p id="a034" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">You can then fill out the requested information according to your preference. In the image below, I have set up a recurring trigger to activate every weekday (Monday to Friday) at 12:00 PM and 6:00 PM in my time zone.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt ed nu bh nv"><div class="nj nk qw"><img src="../Images/68799174d1f34639c6e5cb4b64a65de1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eAm84yVJTOGMH-3OGL_q4g.png"/></div></div></figure><h2 id="2595" class="ol om fq bf on oo op oq or os ot ou ov mr ow ox oy mv oz pa pb mz pc pd pe pf bk"><strong class="al">Add HTTP Action</strong></h2><p id="5ae6" class="pw-post-body-paragraph mi mj fq mk b go pg mm mn gr ph mp mq mr pi mt mu mv pj mx my mz pk nb nc nd fj bk">Next, we will add an HTTP action. This action will make an HTTP request to the Fabric API to check the current status of your capacity. Configure the HTTP action with the appropriate method (GET, POST, etc.), URL, and authentication details to securely access the Fabric API.</p><p id="4ae5" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Remember when we created the managed identity and assigned it the Contributor role? This is where we will utilize the read permission provided by the Contributor role.</p><p id="2123" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Click <code class="cx pl pm pn po b"><strong class="mk fr">Add an action</strong></code> as indicated below to find the HTTP action we will be using in this step.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt ed nu bh nv"><div class="nj nk qx"><img src="../Images/8da41efa71450f98de26775c0c39c408.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oEAVZuIFBZRme3kRb4Mpxw.png"/></div></div></figure><p id="3ea3" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Search for the HTTP action in the search bar, and select the first option from the three available under the HTTP action on the <code class="cx pl pm pn po b"><strong class="mk fr">Add an action</strong></code> pane.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt ed nu bh nv"><div class="nj nk qy"><img src="../Images/eb5690bb8aa9ba006c15568bc78ec8a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ALfOFZ6fpBkHhlvNHbIqrQ.png"/></div></div></figure><p id="f577" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Click the lightning icon to open the drop-down list of previously created parameters, and select the first parameter, <code class="cx pl pm pn po b">$getfabricstatus</code>, for the URI field. In the method field, choose <code class="cx pl pm pn po b">GET</code>.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt ed nu bh nv"><div class="nj nk qz"><img src="../Images/9017f1d9bca6a22a772507fa801da827.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jJONgz-FOVliSGooNY7U1Q.png"/></div></div></figure><p id="efb9" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Then scroll to the bottom of the pane and add the <code class="cx pl pm pn po b">Authentication</code> options in the <code class="cx pl pm pn po b"><strong class="mk fr">Advanced parameters</strong></code> section. This will add an Authentication section right below and select the following options:</p><pre class="nm nn no np nq qm po qn bp qo bb bk"><span id="788e" class="qp om fq po b bg qq qr l qs qt">Authentication Type : Managed Identity<br/>Managed Identity    : System-assigned managed identity</span></pre><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt ed nu bh nv"><div class="nj nk ra"><img src="../Images/ba8cc0f46be2213f06ef37bd20da8878.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xQtJ9T3eNrMgF0kaOD4vBw.png"/></div></div></figure><p id="1865" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">And with that we can securely query the status of the fabric capacity using the managed identity we had created previously.</p><h2 id="318b" class="ol om fq bf on oo op oq or os ot ou ov mr ow ox oy mv oz pa pb mz pc pd pe pf bk"><strong class="al">Add Parse JSON Action</strong></h2><p id="8ade" class="pw-post-body-paragraph mi mj fq mk b go pg mm mn gr ph mp mq mr pi mt mu mv pj mx my mz pk nb nc nd fj bk">Once we receive a response from the Fabric API, use the Parse JSON action to process the data. The API request from the previous step will return a lot of information, and it’s up to us to choose which data points to work with. The Parse JSON action helps us extract specific details from the JSON response, such as the current status of the Fabric capacity.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt ed nu bh nv"><div class="nj nk rb"><img src="../Images/1dfa2b7cd84d57b43a98dc9224be94e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9zJ3r0JzLHASTae6wPQRQA.png"/></div></div></figure><p id="057e" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">To configure this action correctly, provide a sample JSON payload or schema in the <code class="cx pl pm pn po b"><strong class="mk fr">Schema</strong></code> section, which is provided below for you to copy. For the <code class="cx pl pm pn po b"><strong class="mk fr">Content</strong></code> field, click the lightning icon again and select <code class="cx pl pm pn po b">Body</code> from the output of the previous step.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt ed nu bh nv"><div class="nj nk rc"><img src="../Images/5233bd47b7cbc9739dd306ed3d6bdbad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lAri42KYDXbRfmZrjqbTBA.png"/></div></div></figure><pre class="nm nn no np nq qm po qn bp qo bb bk"><span id="0b7f" class="qp om fq po b bg qq qr l qs qt">Content: Body<br/>Schema: <br/>{<br/>    "properties": {<br/>        "id": {<br/>            "type": "string"<br/>        },<br/>        "location": {<br/>            "type": "string"<br/>        },<br/>        "name": {<br/>            "type": "string"<br/>        },<br/>        "properties": {<br/>            "properties": {<br/>                "administration": {<br/>                    "properties": {<br/>                        "members": {<br/>                            "items": {<br/>                                "type": "string"<br/>                            },<br/>                            "type": "array"<br/>                        }<br/>                    },<br/>                    "type": "object"<br/>                },<br/>                "mode": {<br/>                    "type": "string"<br/>                },<br/>                "provisioningState": {<br/>                    "type": "string"<br/>                },<br/>                "state": {<br/>                    "type": "string"<br/>                }<br/>            },<br/>            "type": "object"<br/>        },<br/>        "sku": {<br/>            "properties": {<br/>                "name": {<br/>                    "type": "string"<br/>                },<br/>                "tier": {<br/>                    "type": "string"<br/>                }<br/>            },<br/>            "type": "object"<br/>        },<br/>        "tags": {<br/>            "properties": {},<br/>            "type": "object"<br/>        },<br/>        "type": {<br/>            "type": "string"<br/>        }<br/>    },<br/>    "type": "object"<br/>}</span></pre><h2 id="c510" class="ol om fq bf on oo op oq or os ot ou ov mr ow ox oy mv oz pa pb mz pc pd pe pf bk"><strong class="al">Add Condition Action</strong></h2><p id="4d14" class="pw-post-body-paragraph mi mj fq mk b go pg mm mn gr ph mp mq mr pi mt mu mv pj mx my mz pk nb nc nd fj bk">And now for our second-to-last action, we will add a Condition action to evaluate the status from the parsed JSON data. This condition will determine whether the Fabric capacity needs to be paused. For example, we will be setting the condition to check if the capacity status is not “paused.”</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt ed nu bh nv"><div class="nj nk rd"><img src="../Images/42df78484e3235e2cb646149ba3a83ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pORUH0yFU_ETHVKa4926HA.png"/></div></div></figure><p id="1937" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">To configure the Condition action, we will again use the lightning icon, to find the <code class="cx pl pm pn po b">Body state</code> option from the output of the previous step.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt ed nu bh nv"><div class="nj nk re"><img src="../Images/888a8eecfb71b65deaaca1c6ef83df83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gv7v3q5c_tnLYzBPloEMTw.png"/></div></div></figure><p id="60f2" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Then we will need to change the <code class="cx pl pm pn po b">is equal to</code> to <code class="cx pl pm pn po b">is not equal to</code> and add the value of <code class="cx pl pm pn po b">Paused</code>. The final result should look something like this:</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt ed nu bh nv"><div class="nj nk rf"><img src="../Images/3b02f9f34fdeea2122e10a6178d4fca7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TNyK-qnaSUFktzA1f_3M0g.png"/></div></div></figure><p id="3563" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">If the condition is true (meaning the capacity is not paused), you can add actions in the True section to pause the capacity. If the condition is false (meaning the capacity is already paused), you can leave the False section empty or add a notification action to log that no action was needed.</p><p id="70ad" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">In our case, we will add our final action, which will be another HTTP action, to the True section. This action will use the second parameter we defined, <code class="cx pl pm pn po b">$pausefabriccapacity</code>.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt ed nu bh nv"><div class="nj nk rg"><img src="../Images/0ed2ddcfc9eead33dae0d732c602be1c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2y2K_PTOCtIpN1ss-aGNiQ.png"/></div></div></figure><p id="c422" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Follow the same steps as for the previous HTTP action, but this time, use the <code class="cx pl pm pn po b">$pausefabriccapacity</code> parameter and select the <code class="cx pl pm pn po b">POST</code> method instead of the <code class="cx pl pm pn po b">GET</code> method.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt ed nu bh nv"><div class="nj nk rh"><img src="../Images/3dd9e871d9b8563efab275f6005e3f75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PE7jA5ZyO9Gm0BFu0-TwiQ.png"/></div></div></figure><h2 id="f500" class="ol om fq bf on oo op oq or os ot ou ov mr ow ox oy mv oz pa pb mz pc pd pe pf bk">Important! Don’t forget to change the authentication settings as we did for the last HTTP action; otherwise, you might encounter an authentication error.</h2><p id="bc00" class="pw-post-body-paragraph mi mj fq mk b go pg mm mn gr ph mp mq mr pi mt mu mv pj mx my mz pk nb nc nd fj bk">And with that, we are done with designing our logic app, and after some edits to the names of the steps, we should have a logic app configuration that looks like below.</p><figure class="nm nn no np nq nr nj nk paragraph-image"><div role="button" tabindex="0" class="ns nt ed nu bh nv"><div class="nj nk ri"><img src="../Images/610f40025fb9701f22429f677c008c06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KfGJWM3iFOqmH2lkyDXfZA.png"/></div></div></figure><p id="6650" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">After completing the setup, it’s important to test your logic app to ensure it functions as expected. Run a test, and once it executes successfully, verify that your Fabric capacity has indeed paused. This confirmation step is important to ensure that the automation works correctly and will help prevent unnecessary Azure charges.</p><p id="1846" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">With this setup, you now know how to automate the pausing of your Fabric capacity, giving you peace of mind and more control over your capacities.</p><p id="8f7e" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Happy machine learning and data analyzing with Fabric!</p><p id="346b" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk"><em class="ne">Note: All images, unless explicitly mentioned, are taken by the author.</em></p></div></div></div></div>    
</body>
</html>