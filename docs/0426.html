<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Stream Ordering: How And Why a Geo-Scientist Sometimes Needed to Rank Rivers on a Map</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Stream Ordering: How And Why a Geo-Scientist Sometimes Needed to Rank Rivers on a Map</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/stream-ordering-how-and-why-a-geo-scientist-sometimes-needed-to-rank-rivers-on-a-map-360dce356df5?source=collection_archive---------4-----------------------#2024-02-14">https://towardsdatascience.com/stream-ordering-how-and-why-a-geo-scientist-sometimes-needed-to-rank-rivers-on-a-map-360dce356df5?source=collection_archive---------4-----------------------#2024-02-14</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="e260" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx"><strong class="al">Learn how to obtain Strahler or Shreve order on vector layer</strong></h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@mik.sarafanov?source=post_page---byline--360dce356df5--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Mikhail Sarafanov" class="l ep by dd de cx" src="../Images/88869a3c6f664785c90539dd7aab6d74.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*JNxCRynMIF6RlfCIh-0PHg.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--360dce356df5--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://medium.com/@mik.sarafanov?source=post_page---byline--360dce356df5--------------------------------" rel="noopener follow">Mikhail Sarafanov</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--360dce356df5--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">6 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Feb 14, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj la lb ab q ee lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lf k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lg an ao ap id lh li lj" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep lk cn"><div class="l ae"><div class="ab cb"><div class="ll lm ln lo lp lq ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj mk"><img src="../Images/b6d08cd7cac722dd95e78caad843f3e4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tQ4DCElYsRVsUkn-id8dOw.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Preview image (by author)</figcaption></figure><p id="0770" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">Dear reader, in this article, I would like to dive into one exciting hydrological topic. I will start with the picture:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj nx"><img src="../Images/860173911eb3c2ea27e50b39ae2388a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Bf8fEM2HvgyICigaaY-IQ.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Figure 1. River depiction on the map in two versions (a vs b) (image by author)</figcaption></figure><blockquote class="ny nz oa"><p id="58ac" class="nb nc ob nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">Disclaimer: this article is written both for geographers who face the problem of ranking river vector layer using geoinformation systems (GIS) and for people who have sometimes seen “nice rivers” on a map but do not know exactly how they are made. We will together sequentially explore how spatial data are represented in GIS applications, the way the structure of river networks can be analysed, and what visualisation techniques can be used.</p></blockquote><p id="4eaf" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">Now the question is: Which map looks prettier? — For me, the one on the bottom (b).</p><p id="6255" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">Actually, the second visualisation is more correct from a common sense point of view as well. The more tributaries flowing into the riverbed, the wider and fuller the river will be. For example, one of the largest rivers in the world, the Nile, at its source (high in the mountains), barely resembles a powerful river at its mouth: with each kilometer of the way to the sea, the river absorbs more and more tributaries and becomes more and more full-flowing.</p><p id="82c8" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">The map shown above (Figure 1b) was prepared on the basis of structural information on the river network. In this post I would like to discuss in which ways this additional information about rivers can be obtained and what tools can be used for this purpose.</p><h2 id="b112" class="oc od fq bf oe of og oh oi oj ok ol om nk on oo op no oq or os ns ot ou ov ow bk"><strong class="al">What is the river</strong></h2><p id="a863" class="pw-post-body-paragraph nb nc fq nd b go ox nf ng gr oy ni nj nk oz nm nn no pa nq nr ns pb nu nv nw fj bk">Let’s start by explaining how information about rivers is represented. In cartography and geo-sciences, rivers are represented as a linear vector layer: each river section is represented as a line with some characteristics. For example, the length of the section, its geographic coordinates (geometry of the object), ground type, average depth, flow velocity, etc. (Animation 1).</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj pc"><img src="../Images/55068a35de90356381313aa1ade96dac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GBvI-EUw9961CVG82NY5ug.gif"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Animation 1. Linear vector layer for spatial objects. Important note: The geometries of individual linear segments can be defined not by two points, but by a great number of points (by author)</figcaption></figure><p id="307a" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">So, generally, if you see a river on a map, you see a set of these simple <a class="af pd" href="https://en.wikipedia.org/wiki/Geometric_primitive" rel="noopener ugc nofollow" target="_blank">geometric primitives</a> (individual rows in attrbute table) assembled into one big system. Different colours can be used to visualise stored characteristics (Figure 2).</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj pc"><img src="../Images/1c5302b9689deb29c28beeec5131de7d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nm238rHDBZP3XkQf5jvb1w.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Figure 2. Visualisation of the river sections using colours (image by author)</figcaption></figure><p id="1756" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">Either programming languages or specialised applications such as <a class="af pd" href="https://desktop.arcgis.com/en/index.html" rel="noopener ugc nofollow" target="_blank">ArcGIS</a> (proprietary software) or <a class="af pd" href="https://qgis.org/en/site/forusers/download.html" rel="noopener ugc nofollow" target="_blank">QGIS</a> (open-source) are used for visualisation.</p><h2 id="31c5" class="oc od fq bf oe of og oh oi oj ok ol om nk on oo op no oq or os ns ot ou ov ow bk"><strong class="al">River structure</strong></h2><p id="33c9" class="pw-post-body-paragraph nb nc fq nd b go ox nf ng gr oy ni nj nk oz nm nn no pa nq nr ns pb nu nv nw fj bk">Such information in the attributes table on rivers can be collected in different ways: from remote sensing data, expeditions, gauges, and hydrological stations. However, information about the river structure is usually assigned by the specialist at the very last moment, when he or she sees on the map what the whole system looks like. For example, a researcher can themselves add a new column to the vector layer description in which they assign a rank to each river segment (Figure 3).</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj pc"><img src="../Images/44b3f232e3f8edf3ee8868145d211fa3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1AVONjbuRd6vV2WVW2eRgA.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Figure 3. Adding new field and visualise it using size (image by author)</figcaption></figure><p id="c374" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">Now we can see that the picture resembles the map from the beginning of the article (Figure 1b). But the question arises: what principle can be used to assign such values? — the answer is: a lot. There are several generally accepted systems for ranking watercourses in hydrology — see the <a class="af pd" href="https://en.wikipedia.org/wiki/Stream_order" rel="noopener ugc nofollow" target="_blank">Stream order wiki page</a> or paper <a class="af pd" href="https://link.springer.com/referenceworkentry/10.1007/3-540-31060-6_355" rel="noopener ugc nofollow" target="_blank">Stream orders</a>. Below are a few approaches that I have used myself during the work (Figure 4).</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj pc"><img src="../Images/9f67eff28fcf357c19220ae1925efb8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*q5MI4ubuOzjgq0_AHBIBNQ.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Figure 4. Several approaches of stream ordering in hydrology (image by author)</figcaption></figure><h2 id="a185" class="oc od fq bf oe of og oh oi oj ok ol om nk on oo op no oq or os ns ot ou ov ow bk"><strong class="al">For what reason</strong></h2><p id="f833" class="pw-post-body-paragraph nb nc fq nd b go ox nf ng gr oy ni nj nk oz nm nn no pa nq nr ns pb nu nv nw fj bk">Now it is time to answer the question of the purpose of such ranking systems. We can distinguish two reasons:</p><ul class=""><li id="407b" class="nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw pe pf pg bk">Visualisation — using rank as an attribute of the size of a linear object on the map, it is possible to create nice maps (Figure 1);</li><li id="e228" class="nb nc fq nd b go ph nf ng gr pi ni nj nk pj nm nn no pk nq nr ns pl nu nv nw pe pf pg bk">Further analysis.</li></ul><p id="d916" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">Knowledge of river network structure can be combined with other characteristics for further analysis, e.g. to identify the following patterns (Figure 5).</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj pc"><img src="../Images/08030d53fc988b7eea3d1fe7e26893f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y6lI8CEE5vQvTNtHBF1X5g.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Figure 5. Flow velocity dependence on Shreve order (image by author)</figcaption></figure><h2 id="4559" class="oc od fq bf oe of og oh oi oj ok ol om nk on oo op no oq or os ns ot ou ov ow bk"><strong class="al">How to assign stream orders using existing tools</strong></h2><p id="05e4" class="pw-post-body-paragraph nb nc fq nd b go ox nf ng gr oy ni nj nk oz nm nn no pa nq nr ns pb nu nv nw fj bk">It is difficult to rank large systems manually, so specialised tools have been created for stream ordering. There are two fundamentally different ways:</p><ul class=""><li id="4c93" class="nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw pe pf pg bk">Stream ordering using raster data (digital elevation model);</li><li id="3eb5" class="nb nc fq nd b go ph nf ng gr pi ni nj nk pj nm nn no pk nq nr ns pl nu nv nw pe pf pg bk">Stream ordering on vector layers.</li></ul><p id="6447" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">Above, we have described how we can assign ranks to vector layers. However, spatial data are often represented in another format — as rasters (matrices) (Figure 6). Digital elevation models (matrices where each pixel has a specific size, such as 90 by 90 metres, for example, and an elevation value above the sea level surface that is stored in each cell of that matrix) are particularly commonly used.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj pc"><img src="../Images/c0caa3bc20ec5ffa801383943e028a75.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1n5kzMV-CW-WJ7XVRYA1Fg.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Figure 6. Digital elevation model (DEM) as raster layer. Often used to calculate flow direction and then stream order (image by author)</figcaption></figure><p id="f5f5" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">The raster layer (digital elevation model — DEM) is used to calculate the flow direction matrix and flow accumulation. <a class="af pd" href="https://pro.arcgis.com/en/pro-app/latest/tool-reference/spatial-analyst/stream-order.htm" rel="noopener ugc nofollow" target="_blank">The Stream Order (Spatial Analyst) tool in ArcGIS</a>, for example, works according to this principle. In this post I will not describe in detail how such an algorithm works, as there are quite nice visualisations and descriptions in the official documentation (please check <a class="af pd" href="https://pro.arcgis.com/en/pro-app/latest/help/analysis/raster-functions/flow-direction-raster-function.htm" rel="noopener ugc nofollow" target="_blank">Flow Direction function</a> page if you want to know more). Below I have listed some of the tools you can use to get an Strahler order using raster data:</p><ul class=""><li id="ec14" class="nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw pe pf pg bk">ArcGIS: <a class="af pd" href="https://www.youtube.com/watch?v=NrBUd_cFXxc" rel="noopener ugc nofollow" target="_blank">Stream Order from a Digital Elevation Model (DEM) using ArcGIS</a>;</li><li id="8004" class="nb nc fq nd b go ph nf ng gr pi ni nj nk pj nm nn no pk nq nr ns pl nu nv nw pe pf pg bk">QGIS: <a class="af pd" href="https://www.youtube.com/watch?v=mZKQI4kkAdQ" rel="noopener ugc nofollow" target="_blank">Calculate Strahler Stream Orders in QGIS</a>;</li><li id="3fb3" class="nb nc fq nd b go ph nf ng gr pi ni nj nk pj nm nn no pk nq nr ns pl nu nv nw pe pf pg bk">GRASS: <a class="af pd" href="https://grass.osgeo.org/grass82/manuals/addons/r.stream.order.html" rel="noopener ugc nofollow" target="_blank">r.stream.order tool</a>.</li></ul><p id="f9f2" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">However, this all requires a lot of raster data manipulation. What should you do if you already have a vector layer? (This can happen if you have, for example, a vector layer of the river network loaded from OpenStreetMap.) I’ll tell you next!</p><h2 id="98fc" class="oc od fq bf oe of og oh oi oj ok ol om nk on oo op no oq or os ns ot ou ov ow bk"><strong class="al">How to obtain Shreve, Strahler and Topological order on vector layer using QGIS</strong></h2><p id="6083" class="pw-post-body-paragraph nb nc fq nd b go ox nf ng gr oy ni nj nk oz nm nn no pa nq nr ns pb nu nv nw fj bk">During our work four years ago, my colleagues and I came up with an algorithm that allows us to calculate <strong class="nd fr">Shreve</strong>, <strong class="nd fr">Strahler</strong>, and <strong class="nd fr">Topological </strong>order based only on the vector layer and the final point (the point where the river system ends and flows into a lake / sea / ocean). The first version of the algorithm is described in my first article on medium: “<a class="af pd" href="https://medium.com/swlh/the-algorithm-for-ranking-the-segments-of-the-river-network-for-geographic-information-analysis-b25cffb0d167" rel="noopener">The Algorithm for Ranking the Segments of the River Network for Geographic Information Analysis Based on Graphs</a>” (wiping away a tear of nostalgia). Recently, I finally got around to writing some clearer <a class="af pd" href="https://linesranking.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">documentation</a> for it and preparing a plugin update.</p><p id="d490" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">In QGIS for stream ordering, the <a class="af pd" href="https://plugins.qgis.org/plugins/lines_ranking/" rel="noopener ugc nofollow" target="_blank">Lines Ranking</a> plugin can be used. To use, it will require loading a vector layer, reprojecting it into the desired metric projection, and assigning a final point (you can just click on the map) — the following result will be obtained (Figure 7).</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj pm"><img src="../Images/6974d9721fa58198b9fdc5ccf7030004.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rhRJ1CYUjpv5_fFh4Y2xiw.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Figure 7. Topological stream order for Ob river using vector layer and QGIS Lines Ranking Plugin</figcaption></figure><p id="e8fd" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">Now you, dear reader, have dived a little deeper into the topic of stream ordering in hydrology and learned how to use different tools to get it from raw data (raster or vector). Once there is information about the river’s structure, you can prepare beautiful and clear visualisations, or continue the analysis by combining the obtained information with other characteristics.</p><p id="f7c8" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">Useful links:</p><ul class=""><li id="77d3" class="nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw pe pf pg bk">Lines ranking plugin documentation: <a class="af pd" href="https://linesranking.readthedocs.io/en/latest/?badge=latest" rel="noopener ugc nofollow" target="_blank">https://linesranking.readthedocs.io/en/latest</a></li><li id="a225" class="nb nc fq nd b go ph nf ng gr pi ni nj nk pj nm nn no pk nq nr ns pl nu nv nw pe pf pg bk">Repository with source code of the plugin: <a class="af pd" href="https://github.com/ChrisLisbon/QGIS_LinesRankingPlugin" rel="noopener ugc nofollow" target="_blank">https://github.com/ChrisLisbon/QGIS_LinesRankingPlugin</a></li></ul><p id="c49b" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">The talk on stream ordering in hydrology was presented by <a class="af pd" href="https://github.com/Dreamlone" rel="noopener ugc nofollow" target="_blank">Mikhail Sarafanov</a></p></div></div></div></div>    
</body>
</html>