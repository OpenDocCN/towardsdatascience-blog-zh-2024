<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Chi-Squared Test: Revealing Hidden Patterns in Your Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Chi-Squared Test: Revealing Hidden Patterns in Your Data</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/chi-squared-test-revealing-hidden-patterns-in-your-data-d939df2dda71?source=collection_archive---------7-----------------------#2024-06-25">https://towardsdatascience.com/chi-squared-test-revealing-hidden-patterns-in-your-data-d939df2dda71?source=collection_archive---------7-----------------------#2024-06-25</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="9bab" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">Unlock hidden patterns in your data with the chi-squared test in Python.</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://vitorihaldijiran.medium.com/?source=post_page---byline--d939df2dda71--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Vito Rihaldijiran" class="l ep by dd de cx" src="../Images/bc704b6dbbe4c36c5d35d1b83810094f.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*g5pkpZz6G8Mtu1g8Gc_VJA.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--d939df2dda71--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://vitorihaldijiran.medium.com/?source=post_page---byline--d939df2dda71--------------------------------" rel="noopener follow">Vito Rihaldijiran</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--d939df2dda71--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">10 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Jun 25, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj la lb ab q ee lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lf k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lg an ao ap id lh li lj" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep lk cn"><div class="l ae"><div class="ab cb"><div class="ll lm ln lo lp lq ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj mk"><img src="../Images/6a3380b236178c0c749075f855497151.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_zazOuiuJ0E9vRsn3mmx0A.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Cover Photo by <a class="af nb" href="https://unsplash.com/@swafie" rel="noopener ugc nofollow" target="_blank">Sulthan Auliya</a> on <a class="af nb" href="https://unsplash.com/photos/people-walking-on-brown-wooden-bridge-during-daytime-wTaJBslvJnE" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure></div></div></div><div class="ab cb nc nd ne nf" role="separator"><span class="ng by bm nh ni nj"/><span class="ng by bm nh ni nj"/><span class="ng by bm nh ni"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="d3b4" class="nk nl fq bf nm nn no gq np nq nr gt ns nt nu nv nw nx ny nz oa ob oc od oe of bk">Part 1: What is Chi-Squared Test?</h1><p id="530e" class="pw-post-body-paragraph og oh fq oi b go oj ok ol gr om on oo op oq or os ot ou ov ow ox oy oz pa pb fj bk">When discussing hypothesis testing, there are many approaches we can take, depending on the particular cases. Common tests like the z-test and t-test are the go-to methods to test our hypotheses (null and alternative hypotheses). The metric we want to test differs depending on the problem. Usually, in generating hypotheses, we involve <strong class="oi fr">population mean</strong> or <strong class="oi fr">population proportion</strong> as the metric to state them. Let’s say we want to test whether the population proportion of the students who took the math test who got 75 is more than 80%. Let the null hypothesis be denoted by H0, and the alternative hypothesis be denoted by H1; we generate the hypotheses by:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div class="mi mj pc"><img src="../Images/d0a645205f21f6f34c71e0eb5698339f.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*IfgAHxMtU170OPf5XO3YZA.png"/></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Figure 1: Example of generating hypotheses by Author</figcaption></figure><p id="6f2c" class="pw-post-body-paragraph og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb fj bk">After that, we should see our data, whether the population variance is known or unknown, to decide which test statistic formula we should use. In this case, we use z-statistic for proportion formula. To calculate the test statistics from our sample, first, we estimate the population proportion by dividing the total number of students who got 75 by the total number of students who participated in the test. After that, we plug in the estimated proportion to calculate the test statistic using the test statistic formula. Then, we determine from the test statistic result if it will reject or fail to reject the null hypothesis by comparing it with the rejection region or p-value.</p><p id="24e6" class="pw-post-body-paragraph og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb fj bk">But what if we want to test different cases? What if we make inferences about the proportion of the group of students (e.g., class A, B, C, etc.) variable in our dataset? What if we want to test if there is any association between groups of students and their preparation before the exam (are they doing extra courses outside school or not)? Is it independent or not? <strong class="oi fr">What if we want to test categorical data and infer their population in our dataset?</strong> To test that, we’ll be using <strong class="oi fr">the chi-squared test.</strong></p><p id="7471" class="pw-post-body-paragraph og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb fj bk">The chi-squared test is crafted to help us draw conclusions about categorical data that fall into different categories. It compares each category’s observed frequencies (counts) to the expected frequencies under the null hypothesis. Denoted as X², chi-squared has a distribution, namely <strong class="oi fr">chi-squared distribution</strong>, allowing us to determine the significance of the observed deviations from expected values.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj pi"><img src="../Images/9cdc98f962c9990f5185ea61424821ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3IEsJ5bq7qMzVC44"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Figure 2: Chi-Squared Distribution made in Matplotlib by Author</figcaption></figure><p id="b532" class="pw-post-body-paragraph og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb fj bk">The plot describes the continuous distribution of each degree of freedom in the chi-squared test. In the chi-squared test, to prove whether we will reject or fail to reject the null hypothesis, we don’t use the z or t table to decide, but we use <strong class="oi fr">the chi-squared table</strong>. <strong class="oi fr">It lists probabilities of selected significance level and degree of freedom of chi-squared.</strong> There are two types of chi-squared tests, <strong class="oi fr">the chi-squared goodness-of-fit test and the chi-squared test of a contingency table.</strong> Each of these types has a different purpose when tackling the hypothesis test. In parallel with the theoretical approach of each test, I’ll show you how to demonstrate those two tests in practical examples.</p><h1 id="3544" class="nk nl fq bf nm nn pj gq np nq pk gt ns nt pl nv nw nx pm nz oa ob pn od oe of bk">Part 2: <strong class="al">Chi-squared goodness-of-fit test</strong></h1><p id="6586" class="pw-post-body-paragraph og oh fq oi b go oj ok ol gr om on oo op oq or os ot ou ov ow ox oy oz pa pb fj bk">This is the first type of the chi-squared test. This test analyzes <strong class="oi fr">a group of categorical data from a single categorical variable with k categories.</strong> It is used to specifically explain the proportion of observations in each category within the population. For example, we surveyed 1000 students who got at least 75 on their math test. We observed that from 5 groups of students (Class A to E), the distribution is like this:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div class="mi mj po"><img src="../Images/ab3c9d31ce3c710e622f3f4abead1d6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:548/format:webp/1*VFaP0QZoi0OwZoPfxMWt-A.png"/></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Figure 3: Dummy data generated randomly by Author</figcaption></figure><p id="ecf9" class="pw-post-body-paragraph og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb fj bk">We will do it in both manual and Python ways. Let’s start with the manual one.</p><h2 id="f49b" class="pp nl fq bf nm pq pr ps np pt pu pv ns op pw px py ot pz qa qb ox qc qd qe qf bk">Form Hypotheses</h2><p id="b245" class="pw-post-body-paragraph og oh fq oi b go oj ok ol gr om on oo op oq or os ot ou ov ow ox oy oz pa pb fj bk">As we know, we have already surveyed 1000 students. I want to test whether the population proportions in each class are equal. The hypotheses will be:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div class="mi mj qg"><img src="../Images/b1fa58b6bfca983a32904e8a42e5f14d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/format:webp/1*anws6O14OBY8pfke5PAjKQ.png"/></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Figure 4: Hypotheses of Students who at least got 75 from 5 classes by Author</figcaption></figure><h2 id="ce78" class="pp nl fq bf nm pq pr ps np pt pu pv ns op pw px py ot pz qa qb ox qc qd qe qf bk">Test Statistic</h2><p id="06be" class="pw-post-body-paragraph og oh fq oi b go oj ok ol gr om on oo op oq or os ot ou ov ow ox oy oz pa pb fj bk">The test statistic formula for the chi-squared goodness-of-fit test is like this:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div class="mi mj qh"><img src="../Images/be69f1998740ae95c4796aeabfaffb09.png" data-original-src="https://miro.medium.com/v2/resize:fit:536/format:webp/1*1Fjx4zoz5M9uu9XRPzG5zg.png"/></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Figure 5: The Chi-squared goodness-of-fit test by Author</figcaption></figure><p id="c6c1" class="pw-post-body-paragraph og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb fj bk">Where:</p><ul class=""><li id="5e86" class="og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb qi qj qk bk">k: number of categories</li><li id="b205" class="og oh fq oi b go ql ok ol gr qm on oo op qn or os ot qo ov ow ox qp oz pa pb qi qj qk bk">fi: observed counts</li><li id="7cc2" class="og oh fq oi b go ql ok ol gr qm on oo op qn or os ot qo ov ow ox qp oz pa pb qi qj qk bk">ei: expected counts</li></ul><p id="aa41" class="pw-post-body-paragraph og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb fj bk">We already have the number of categories (5 from Class A to E) and the observed counts, but we don’t have the expected counts yet. To calculate that, we should reflect on our hypotheses. In this case, I assume that all class proportions are the same, which is 20%. We will make another column in the dataset named <strong class="oi fr">Expected</strong>. We calculate it by multiplying the total number of observations by the proportion we choose:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div class="mi mj qq"><img src="../Images/6d961b485520d45133d289f2cf3bb888.png" data-original-src="https://miro.medium.com/v2/resize:fit:1088/format:webp/1*X9Ol5144iKxGMy70rYNrqg.png"/></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Figure 6: Calculate expected Counts by Author</figcaption></figure><p id="420e" class="pw-post-body-paragraph og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb fj bk">Now we plug in the formula like this for each observed and expected value:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qr"><img src="../Images/9215305d09b7e7014bed3877f696c6f1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sfmhM6TWsBJDsjKiag0ifA.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Figure 7: Calculate Test Statistic of goodness-of-fit test by Author</figcaption></figure><p id="ef39" class="pw-post-body-paragraph og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb fj bk">We already have the test statistic result. But how do we decide whether it will reject or fail to reject the null hypothesis?</p><h2 id="5bfc" class="pp nl fq bf nm pq pr ps np pt pu pv ns op pw px py ot pz qa qb ox qc qd qe qf bk">Decision Rule</h2><p id="5d33" class="pw-post-body-paragraph og oh fq oi b go oj ok ol gr om on oo op oq or os ot ou ov ow ox oy oz pa pb fj bk">As mentioned above, we’ll use <strong class="oi fr">the chi-squared table</strong> to compare the test statistic. Remember that a small test statistic supports the null hypothesis, whereas a significant test statistic supports the alternative hypothesis. So, we should reject the null hypothesis when the test statistic is substantial (meaning this is an upper-tailed test). Because we do this manually, we use the rejection region to decide whether it will reject or fail to reject the null hypothesis. The rejection region is defined as below:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div class="mi mj qs"><img src="../Images/bead4f25d65752d1aed05bc1f9466d58.png" data-original-src="https://miro.medium.com/v2/resize:fit:372/format:webp/1*4uvTijwJSCJWb-C3mewJQg.png"/></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Figure 8: Rejection Region of goodness-of-fit test by Author</figcaption></figure><p id="1d2a" class="pw-post-body-paragraph og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb fj bk">Where:</p><ul class=""><li id="7ab1" class="og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb qi qj qk bk">α: Significance Level</li><li id="3c6d" class="og oh fq oi b go ql ok ol gr qm on oo op qn or os ot qo ov ow ox qp oz pa pb qi qj qk bk">k: number of categories</li></ul><p id="760b" class="pw-post-body-paragraph og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb fj bk">The rule of thumb is: <strong class="oi fr">If our test statistic is more significant than the chi-squared table value we look up, we reject the null hypothesis.</strong> We’ll use the significance level of 5% and look at the chi-squared table. The value of chi-squared with a 5% significance level and degrees of freedom of 4 (five categories minus 1), we get 9.49. Because our test statistic is way more significant than the chi-squared table value (<strong class="oi fr">70.52 &gt; 9.49</strong>), <strong class="oi fr">we reject the null hypothesis at a 5% significance level</strong>. Now, you already know how to perform the chi-squared goodness-of-fit test!</p><h2 id="77a4" class="pp nl fq bf nm pq pr ps np pt pu pv ns op pw px py ot pz qa qb ox qc qd qe qf bk">Python Approach</h2><p id="18e0" class="pw-post-body-paragraph og oh fq oi b go oj ok ol gr om on oo op oq or os ot ou ov ow ox oy oz pa pb fj bk">This is the Python approach to the chi-squared goodness-of-fit test using SciPy:</p><pre class="ml mm mn mo mp qt qu qv bp qw bb bk"><span id="1c57" class="qx nl fq qu b bg qy qz l ra rb">import pandas as pd<br/>from scipy.stats import chisquare<br/><br/># Define the student data<br/>data = {<br/>    'Class': ['A', 'B', 'C', 'D', 'E'],<br/>    'Observed': [157, 191, 186, 163, 303]<br/>}<br/><br/># Transform dictionary into dataframe<br/>df = pd.DataFrame(data)<br/><br/># Define the null and alternative hypotheses<br/>null_hypothesis = "p1 = 20%, p2 = 20%, p3 = 20%, p4 = 20%, p5 = 20%"<br/>alternative_hypothesis = "The population proportions do not match the given proportions"<br/><br/># Calculate the total number of observations and the expected count for each category<br/>total_count = df['Observed'].sum()<br/>expected_count = total_count / len(df)  # As there are 5 categories<br/><br/># Create a list of observed and expected counts<br/>observed_list = df['Observed'].tolist()<br/>expected_list = [expected_count] * len(df)<br/><br/># Perform the Chi-Squared goodness-of-fit test<br/>chi2_stat, p_val = chisquare(f_obs=observed_list, f_exp=expected_list)<br/><br/># Print the results<br/>print(f"\nChi2 Statistic: {chi2_stat:.2f}")<br/>print(f"P-value: {p_val:.4f}")<br/><br/># Print the conclusion<br/>if p_val &lt; 0.05:<br/>    print("Reject the null hypothesis: The population proportions do not match the given proportions.")<br/>else:<br/>    print("Fail to reject the null hypothesis: The population proportions match the given proportions.")</span></pre><p id="1b43" class="pw-post-body-paragraph og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb fj bk">Using the p-value, we also got the same result. <strong class="oi fr">We reject the null hypothesis at a 5% significance level.</strong></p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj rc"><img src="../Images/548532944c62584afaa5160b7148dc6a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tzwPor0OsO3oSfQpDeggUg.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Figure 9: Result of goodness-of-fit test using Python by Author</figcaption></figure><h1 id="310e" class="nk nl fq bf nm nn pj gq np nq pk gt ns nt pl nv nw nx pm nz oa ob pn od oe of bk">Part 3: <strong class="al">Chi-squared test of a contingency table</strong></h1><p id="d52b" class="pw-post-body-paragraph og oh fq oi b go oj ok ol gr om on oo op oq or os ot ou ov ow ox oy oz pa pb fj bk">We already know how to make inferences about the proportion of one categorical variable. But what if I want to test whether two categorical variables are independent?</p><p id="8fdb" class="pw-post-body-paragraph og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb fj bk">To test that, we use the chi-squared test of the contingency table. We will utilize the contingency table to calculate the test statistic value. A contingency table is a cross-tabulation table that classifies counts summarizing the combined distribution of two categorical variables, each having a finite number of categories. From this table, you <strong class="oi fr">can determine if the distribution of one categorical variable is consistent across all categories of the other categorical variable.</strong></p><p id="7b42" class="pw-post-body-paragraph og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb fj bk">I will explain how to do it manually and using Python. In this example, we sampled 1000 students who got at least 75 on their math test. I want to test whether the variable of a group of students and the variable of the students who have taken the supplementary course (Taken or Not) outside the school before the test is independent. The distribution is like this:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div class="mi mj rd"><img src="../Images/44abbca48de586e0ae86f479668fcde7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1296/format:webp/1*ZKj6C6wm25gowko2NiOxbQ.png"/></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Figure 10: Dummy data of contingency table generated randomly by Author</figcaption></figure><h2 id="256a" class="pp nl fq bf nm pq pr ps np pt pu pv ns op pw px py ot pz qa qb ox qc qd qe qf bk">Form Hypotheses</h2><p id="f7a8" class="pw-post-body-paragraph og oh fq oi b go oj ok ol gr om on oo op oq or os ot ou ov ow ox oy oz pa pb fj bk">To generate these hypotheses is very simple. We define the hypotheses as:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div class="mi mj re"><img src="../Images/6c33a1416a69a0306775a2595754c026.png" data-original-src="https://miro.medium.com/v2/resize:fit:964/format:webp/1*8hoYYbtAjieiDYEUO5lFqw.png"/></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Figure 11: Generate hypotheses of contingency table test by Author</figcaption></figure><h2 id="79c3" class="pp nl fq bf nm pq pr ps np pt pu pv ns op pw px py ot pz qa qb ox qc qd qe qf bk">Test Statistic</h2><p id="47b0" class="pw-post-body-paragraph og oh fq oi b go oj ok ol gr om on oo op oq or os ot ou ov ow ox oy oz pa pb fj bk">This is the hardest part. In handling real data, I suggest you use Python or other statistical software directly because the calculation is too complicated if we do it manually. But because we want to know the approach from the formula, let’s do the manual calculation. The test statistic of this test is:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div class="mi mj rf"><img src="../Images/96b7f74d54a971e5946e5faeb0485f88.png" data-original-src="https://miro.medium.com/v2/resize:fit:632/format:webp/1*s-otRSVPHH9gBqYoDBTZrQ.png"/></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Figure 12: The Chi-squared contingency table formula by Author</figcaption></figure><p id="20f7" class="pw-post-body-paragraph og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb fj bk">Where:</p><ul class=""><li id="b089" class="og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb qi qj qk bk">r = number of rows</li><li id="46ec" class="og oh fq oi b go ql ok ol gr qm on oo op qn or os ot qo ov ow ox qp oz pa pb qi qj qk bk">c = number of columns</li><li id="a2d8" class="og oh fq oi b go ql ok ol gr qm on oo op qn or os ot qo ov ow ox qp oz pa pb qi qj qk bk">fij: the observed counts</li><li id="0a83" class="og oh fq oi b go ql ok ol gr qm on oo op qn or os ot qo ov ow ox qp oz pa pb qi qj qk bk">eij = (i th row total * j th row total)/sample size</li></ul><p id="b136" class="pw-post-body-paragraph og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb fj bk"><strong class="oi fr">Recall Figure 9,</strong> those values are just observed ones. Before we use the test statistic formula, we should calculate <strong class="oi fr">the expected counts.</strong> We do that by:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj rg"><img src="../Images/87179b6dad4b93d25c2bef66723f2b7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U8JU58hjWXAMmBNZE9pkCg.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Figure 13: Expected Counts of the contingency table by Author</figcaption></figure><p id="309f" class="pw-post-body-paragraph og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb fj bk">Now we get the observed and expected counts. After that, we will calculate the test statistic by:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj rh"><img src="../Images/faca90513a4e55f9a574ec968eaf1e34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hg9HcNK7fRINDi1mdyMG3A.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Figure 14: Calculate Test Statistic of contingency table test by Author</figcaption></figure><h2 id="c663" class="pp nl fq bf nm pq pr ps np pt pu pv ns op pw px py ot pz qa qb ox qc qd qe qf bk">Decision Rule</h2><p id="0e70" class="pw-post-body-paragraph og oh fq oi b go oj ok ol gr om on oo op oq or os ot ou ov ow ox oy oz pa pb fj bk">We already have the test statistic; now we compare it with the rejection region. The rejection region for the contingency table test is defined by:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div class="mi mj ri"><img src="../Images/cf8f70795ac8d2430cce63bf3bbaa379.png" data-original-src="https://miro.medium.com/v2/resize:fit:486/format:webp/1*UYzGif8wq4iPIvIp5XaxXA.png"/></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Figure 15: Rejection Region of contingency table test by Author</figcaption></figure><p id="dd0e" class="pw-post-body-paragraph og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb fj bk">Where:</p><ul class=""><li id="2bb3" class="og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb qi qj qk bk">α: Significance Level</li><li id="0cf2" class="og oh fq oi b go ql ok ol gr qm on oo op qn or os ot qo ov ow ox qp oz pa pb qi qj qk bk">r = number of rows</li><li id="d3ae" class="og oh fq oi b go ql ok ol gr qm on oo op qn or os ot qo ov ow ox qp oz pa pb qi qj qk bk">c = number of columns</li></ul><p id="4d20" class="pw-post-body-paragraph og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb fj bk">The rule of thumb is the same as the goodness-of-fit test: <strong class="oi fr">If our test statistic is more significant than the chi-squared table value we look up, we reject the null hypothesis.</strong> We will use the significance level of 5%. Because the total row is 5 and the total column is 2, we look up the value of chi-squared with a 5% significance level and degrees of freedom of (5–1) * (2–1) = 4, and we get 15.5. Because the test statistic is lower than the chi-squared table value (<strong class="oi fr">22.9758 &gt; 15.5</strong>), <strong class="oi fr">we reject the null hypothesis at a 5% significance level.</strong></p><h2 id="c87e" class="pp nl fq bf nm pq pr ps np pt pu pv ns op pw px py ot pz qa qb ox qc qd qe qf bk">Python Approach</h2><p id="f769" class="pw-post-body-paragraph og oh fq oi b go oj ok ol gr om on oo op oq or os ot ou ov ow ox oy oz pa pb fj bk">This is the Python approach to the chi-squared contingency table test using SciPy:</p><pre class="ml mm mn mo mp qt qu qv bp qw bb bk"><span id="2e66" class="qx nl fq qu b bg qy qz l ra rb">import pandas as pd<br/>from scipy.stats import chi2_contingency<br/><br/># Create the dataset<br/>data = {<br/>    'Class': ['group A', 'group B', 'group C', 'group D', 'group E'],<br/>    'Taken Course': [91, 131, 117, 75, 197],<br/>    'Not Taken Course': [66, 60, 69, 88, 106]<br/>}<br/><br/># Create a DataFrame<br/>df = pd.DataFrame(data)<br/>df.set_index('Class', inplace=True)<br/><br/># Perform the Chi-Squared test for independence<br/>chi2_stat, p_val, dof, expected = chi2_contingency(df)<br/><br/># Print the results<br/>print("Expected Counts:")<br/>print(pd.DataFrame(expected, index=df.index, columns=df.columns))<br/>print(f"\nChi2 Statistic: {chi2_stat:.4f}")<br/>print(f"P-value: {p_val:.4f}")<br/><br/># Print the conclusion<br/>if p_val &lt; 0.05:<br/>    print("\nReject the null hypothesis: The variables are not independent")<br/>else:<br/>    print("\nFail to reject the null hypothesis: The variables are independent")</span></pre><p id="0e4e" class="pw-post-body-paragraph og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb fj bk">Using the p-value, we also got the same result. <strong class="oi fr">We reject the null hypothesis at a 5% significance level.</strong></p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj rj"><img src="../Images/e48df9dbf370c9f5be67ae058b06a54b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eIywpwpbh06urTwVg-N9DA.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Figure 16: Result of contingency table test using Python by Author</figcaption></figure><p id="173e" class="pw-post-body-paragraph og oh fq oi b go pd ok ol gr pe on oo op pf or os ot pg ov ow ox ph oz pa pb fj bk">Now that you understand how to conduct hypothesis tests using the chi-square test method, it’s time to apply this knowledge to your own data. Happy experimenting!</p><h1 id="00f0" class="nk nl fq bf nm nn pj gq np nq pk gt ns nt pl nv nw nx pm nz oa ob pn od oe of bk">Part 4: Conclusion</h1><p id="93f8" class="pw-post-body-paragraph og oh fq oi b go oj ok ol gr om on oo op oq or os ot ou ov ow ox oy oz pa pb fj bk">The chi-squared test is a powerful statistical method that helps us understand the relationships and distributions within categorical data. Forming the problem and proper hypotheses before jumping into the test itself is crucial. A large sample is also vital in conducting a chi-squared test; for instance, it works well for sizes down to 5,000 (Bergh, 2015), as small sample sizes can lead to inaccurate results. To interpret results correctly, choose the right significance level and compare the chi-square statistic to the critical value from the chi-square distribution table or the p-value.</p><h1 id="d6f3" class="nk nl fq bf nm nn pj gq np nq pk gt ns nt pl nv nw nx pm nz oa ob pn od oe of bk">Reference</h1><ul class=""><li id="7c49" class="og oh fq oi b go oj ok ol gr om on oo op oq or os ot ou ov ow ox oy oz pa pb qi qj qk bk">G. Keller, <a class="af nb" href="https://books.google.com.au/books/about/Statistics_for_Management_and_Economics.html?id=oM8tvgAACAAJ&amp;redir_esc=y" rel="noopener ugc nofollow" target="_blank">Statistics for Management and Economics</a>, 11th ed., Chapter 15, Cengage Learning (2017).</li><li id="3bdb" class="og oh fq oi b go ql ok ol gr qm on oo op qn or os ot qo ov ow ox qp oz pa pb qi qj qk bk">Daniel, Bergh. (2015). Chi-Squared Test of Fit and Sample Size-A Comparison between a Random Sample Approach and a Chi-Square Value Adjustment Method.. Journal of applied measurement, 16(2):204–217.</li></ul></div></div></div></div>    
</body>
</html>