<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>LOESS in Rust</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>LOESS in Rust</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/loess-in-rust-2e22f58c81d4?source=collection_archive---------7-----------------------#2024-08-12">https://towardsdatascience.com/loess-in-rust-2e22f58c81d4?source=collection_archive---------7-----------------------#2024-08-12</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="fcd2" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">It’s time to port the Python LOESS code to Rust.</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@joao.figueira?source=post_page---byline--2e22f58c81d4--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="João Paulo Figueira" class="l ep by dd de cx" src="../Images/54e4176f66e4ab0324d86ec71d8b033d.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*KhSF0xxPYqlN4Y6vnClBQQ.png"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--2e22f58c81d4--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://medium.com/@joao.figueira?source=post_page---byline--2e22f58c81d4--------------------------------" rel="noopener follow">João Paulo Figueira</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--2e22f58c81d4--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">5 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Aug 12, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj lc ld ab q ee le lf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count la lb">1</span></p></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lg k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lh an ao ap id li lj lk" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep ll cn"><div class="l ae"><div class="ab cb"><div class="lm ln lo lp lq lr ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk ml"><img src="../Images/199267c891b0dc1dd794f992bbc5a653.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*xPnPFUcgc5JCjF2X"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Photo by <a class="af nc" href="https://unsplash.com/@foxxmd?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Matt Foxx</a> on <a class="af nc" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="f7f8" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Over five years ago, counting from this writing, I published my most successful article here on Medium. That article grew from the need to filter a particularly noisy sensor’s data from a telematics data stream. Concretely, it was a torque sensor connected to a truck’s drive shaft and the noise needed to go. LOESS was the answer, hence that article.</p><div class="nz oa ob oc od oe"><a rel="noopener follow" target="_blank" href="/loess-373d43b03564?source=post_page-----2e22f58c81d4--------------------------------"><div class="of ab ig"><div class="og ab co cb oh oi"><h2 class="bf fr hw z io oj iq ir ok it iv fp bk">LOESS</h2><div class="ol l"><h3 class="bf b hw z io oj iq ir ok it iv dx">Smoothing data using local regression</h3></div><div class="om l"><p class="bf b dy z io oj iq ir ok it iv dx">towardsdatascience.com</p></div></div><div class="on l"><div class="oo l op oq or on os lr oe"/></div></div></a></div><p id="1909" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">By then, I was neck-deep in Python, and the project required Spark, so implementing the algorithm in Python was a no-brainer. Times change, though, and now I use Rust more frequently and decided to have a go at translating the old code. This article describes the porting process and my choices when rewriting the code. You should read the original article and the reference material to learn more about the algorithm. Here, we will focus on the intricacies of writing matrix code in Rust, replacing the earlier <a class="af nc" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank">NumPy</a> implementation as closely as possible.</p><h1 id="529d" class="ot ou fq bf ov ow ox gq oy oz pa gt pb pc pd pe pf pg ph pi pj pk pl pm pn po bk">Rust Numerical Computing</h1><p id="670a" class="pw-post-body-paragraph nd ne fq nf b go pp nh ni gr pq nk nl nm pr no np nq ps ns nt nu pt nw nx ny fj bk">Being a firm believer in not reinventing the wheel, I searched for the recommended Rust crates to replace my use of <a class="af nc" href="https://numpy.org/" rel="noopener ugc nofollow" target="_blank">NumPy</a> in the original Python code, and it didn’t take long to find <a class="af nc" href="https://nalgebra.org/" rel="noopener ugc nofollow" target="_blank"><strong class="nf fr">nalgebra</strong></a>.</p><blockquote class="pu pv pw"><p id="35ea" class="nd ne px nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><strong class="nf fr">nalgebra</strong> is meant to be a general-purpose, low-dimensional, linear algebra library, with an optimized set of tools for computer graphics and physics.</p></blockquote><p id="48d6" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Although we will not do any physics or computer graphics, we fit the low dimensionality requirement like a glove.</p><h2 id="1bd1" class="py ou fq bf ov pz qa qb oy qc qd qe pb nm qf qg qh nq qi qj qk nu ql qm qn qo bk">Differences</h2><p id="b632" class="pw-post-body-paragraph nd ne fq nf b go pp nh ni gr pq nk nl nm pr no np nq ps ns nt nu pt nw nx ny fj bk">When converting the Python code to Rust, I met some difficulties that took me a while to sort out. When using NumPy in Python, we use all the features that both language and library provide to improve the code’s expressiveness and readability. Rust is more verbose than Python, and, at the time of this writing (version 0.33.0), the <strong class="nf fr">nalgebra</strong> crate still misses some features that help improve its expressiveness. Terseness is a challenge.</p><p id="2b65" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">My first hurdle was indexing arrays using other arrays. With NumPy, you can index an array using another array of integers or booleans. In the first case, each element of the indexing array is an index into the source array, and the indexer may have a dimension equal to or smaller than the data array. In the case of boolean indexing, the indexer must have the same size as the data, and each element must state whether to include the corresponding data element. This feature is handy when using boolean expressions to select data.</p><p id="171e" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Handy as it is, I used this feature throughout the Python code:</p><pre class="mm mn mo mp mq qp qq qr bp qs bb bk"><span id="19ef" class="qt ou fq qq b bg qu qv l qw qx"># Python<br/>xx = self.n_xx[min_range]</span></pre><p id="2044" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Here, the <code class="cx qy qz ra qq b">min_range</code> variable in an integer array containing the subset of indices to retrieve from the <code class="cx qy qz ra qq b">self.n_xx</code> array.</p><p id="1307" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Try as I might, I could not find a solution in the Rust crate that mimics the NumPy indexing, so I had to implement one. After a couple of tries and benchmarks, I reached the final version. This solution was straightforward and effective.</p><pre class="mm mn mo mp mq qp qq qr bp qs bb bk"><span id="6ca7" class="qt ou fq qq b bg qu qv l qw qx">// Rust<br/>fn select_indices(values: &amp;DVector&lt;f64&gt;,<br/>                  indices: &amp;DVector&lt;usize&gt;) -&gt; DVector&lt;f64&gt; {<br/>    indices.map(|i| values[i])<br/>}</span></pre><p id="7651" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">The map expression is quite simple, but using the function name is more expressive, so I replaced the Python code above with the corresponding Rust one:</p><pre class="mm mn mo mp mq qp qq qr bp qs bb bk"><span id="b628" class="qt ou fq qq b bg qu qv l qw qx">// Rust<br/>let xx = select_indices(&amp;self.xx, min_range);</span></pre><p id="4a1b" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">There is also no built-in method to create a vector from a range of integers. Although easy to do with <strong class="nf fr">nalgebra</strong>, the code becomes a bit long:</p><pre class="mm mn mo mp mq qp qq qr bp qs bb bk"><span id="9288" class="qt ou fq qq b bg qu qv l qw qx">// Rust<br/>range = DVector::&lt;usize&gt;::from_iterator(window, 0..window);</span></pre><p id="28f2" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">We can avoid much of this ceremony if we fix the vector and array sizes during compilation, but we have no such luck here as the dimensions are unknown. The corresponding Python code is more terse:</p><pre class="mm mn mo mp mq qp qq qr bp qs bb bk"><span id="291b" class="qt ou fq qq b bg qu qv l qw qx"># Python<br/>np.arange(0, window)</span></pre><p id="d544" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">This terseness also extends to other areas, such as when filling a matrix row-wise. In Python, we can do something like this:</p><pre class="mm mn mo mp mq qp qq qr bp qs bb bk"><span id="0d85" class="qt ou fq qq b bg qu qv l qw qx"># Python<br/>for i in range(1, degree + 1):<br/>    xm[:, i] = np.power(self.n_xx[min_range], i)</span></pre><p id="d375" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">As of this writing, I found no better way of doing the same thing with <strong class="nf fr">nalgebra</strong> than this:</p><pre class="mm mn mo mp mq qp qq qr bp qs bb bk"><span id="942b" class="qt ou fq qq b bg qu qv l qw qx">// Rust<br/>for i in 1..=degree {<br/>    for j in 0..window {<br/>        xm[(j, i)] = self.xx[min_range[j]].powi(i as i32);<br/>    }<br/>}</span></pre><p id="eaee" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Maybe something hidden in the package is waiting to be discovered that will help here in terms of conciseness.</p><p id="ffc2" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Finally, I found the <strong class="nf fr">nalgebra</strong> documentation relatively sparse. We can expect this from a relatively young Rust crate that holds much promise for the future.</p><h2 id="7d0f" class="py ou fq bf ov pz qa qb oy qc qd qe pb nm qf qg qh nq qi qj qk nu ql qm qn qo bk">The Upside</h2><p id="2933" class="pw-post-body-paragraph nd ne fq nf b go pp nh ni gr pq nk nl nm pr no np nq ps ns nt nu pt nw nx ny fj bk">The best comes at the end—the raw performance. I invite you to try running both versions of the same code (the GitHub repository links are below) and compare their performances. On my 2019 MacBook Pro 2.6 GHz 6-Core Intel Core i7, the <em class="px">release</em> version of the Rust code runs in under 200 <em class="px">microseconds</em>, while the Python code runs in under 5 <em class="px">milliseconds</em>.</p><h1 id="e2f9" class="ot ou fq bf ov ow ox gq oy oz pa gt pb pc pd pe pf pg ph pi pj pk pl pm pn po bk">Conclusion</h1><p id="0d75" class="pw-post-body-paragraph nd ne fq nf b go pp nh ni gr pq nk nl nm pr no np nq ps ns nt nu pt nw nx ny fj bk">This project was another exciting and educative Python-to-Rust port of my old code. While converting from the well-known Python control structures to Rust gets more accessible by the day, the <strong class="nf fr">NumPy</strong> conversion to <strong class="nf fr">nalgebra</strong> was more of a challenge. The Rust package shows much promise but needs more documentation and online support. I would warmly welcome a more thorough user guide.</p><p id="f912" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Rust is more ceremonious than Python but performs much better when properly used. I will keep using Python for my daily work when building prototypes and in discovery mode, but I will turn to Rust for performance and memory safety when moving to production. We can even mix and match both using crates like <a class="af nc" href="https://pyo3.rs/v0.15.1/" rel="noopener ugc nofollow" target="_blank">PyO3</a>, so this is a win-win scenario.</p><p id="fa51" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><em class="px">Rust rocks!</em></p><h1 id="c6bc" class="ot ou fq bf ov ow ox gq oy oz pa gt pb pc pd pe pf pg ph pi pj pk pl pm pn po bk">References</h1><p id="6acc" class="pw-post-body-paragraph nd ne fq nf b go pp nh ni gr pq nk nl nm pr no np nq ps ns nt nu pt nw nx ny fj bk"><a class="af nc" href="https://github.com/joaofig/loess-rs" rel="noopener ugc nofollow" target="_blank">joaofig/loess-rs: An implementation of the LOESS / LOWESS algorithm in Rust. (github.com)</a></p><p id="02fa" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><a class="af nc" href="https://github.com/joaofig/pyloess" rel="noopener ugc nofollow" target="_blank">joaofig/pyloess: A simple implementation of the LOESS algorithm using numpy (github.com)</a></p><h1 id="3c4a" class="ot ou fq bf ov ow ox gq oy oz pa gt pb pc pd pe pf pg ph pi pj pk pl pm pn po bk">Credits</h1><p id="f35a" class="pw-post-body-paragraph nd ne fq nf b go pp nh ni gr pq nk nl nm pr no np nq ps ns nt nu pt nw nx ny fj bk">I used <a class="af nc" href="https://app.grammarly.com/" rel="noopener ugc nofollow" target="_blank">Grammarly</a> to review the writing and accepted several of its rewriting suggestions.</p><p id="5ee9" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><a class="af nc" href="https://www.jetbrains.com/ai/" rel="noopener ugc nofollow" target="_blank">JetBrains’ AI</a> assistant helped me write some of the code, and I also used it to learn Rust. It has become a staple of my everyday work with both Rust and Python. Unfortunately, support for <strong class="nf fr">nalgebra</strong> is still short.</p></div></div></div><div class="ab cb rb rc rd re" role="separator"><span class="rf by bm rg rh ri"/><span class="rf by bm rg rh ri"/><span class="rf by bm rg rh"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="fff2" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">João Paulo Figueira is a Data Scientist at <a class="af nc" href="https://tblx.io/" rel="noopener ugc nofollow" target="_blank">tb.lx by Daimler Truck</a> in Lisbon, Portugal.</p></div></div></div></div>    
</body>
</html>