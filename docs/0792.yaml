- en: De-Nesting Google Analytics Data in BigQuery
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/de-nesting-google-analytics-data-in-bigquery-f01a76cd8126?source=collection_archive---------9-----------------------#2024-03-26](https://towardsdatascience.com/de-nesting-google-analytics-data-in-bigquery-f01a76cd8126?source=collection_archive---------9-----------------------#2024-03-26)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: The proper way to flat tables
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@martin.weitzmann?source=post_page---byline--f01a76cd8126--------------------------------)[![Martin
    Weitzmann](../Images/c1d8ddc6db774465126c9aff1eab7ae2.png)](https://medium.com/@martin.weitzmann?source=post_page---byline--f01a76cd8126--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--f01a76cd8126--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--f01a76cd8126--------------------------------)
    [Martin Weitzmann](https://medium.com/@martin.weitzmann?source=post_page---byline--f01a76cd8126--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--f01a76cd8126--------------------------------)
    ·5 min read·Mar 26, 2024
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/158e6047cc9d047d88417790e20962d6.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo of Singapore by [Mike Enerio](https://unsplash.com/@mikeenerio?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: 'BigQuery is an analytics engine optimized to crunch pre-joined (or: nested)
    data. Sub-relations make sense in analytical scenarios because we don’t want to
    deal with joins over bigger datasets — just imagine daily year-over-year comparisons
    over the last 3 years, aggregating Terabytes of data — but with joins adding another
    layer of complexity.'
  prefs: []
  type: TYPE_NORMAL
- en: A sub-relation, or sub-table, is usually implemented as an array of structs.
    The array as a list-like data type provides rows, the struct, similar to a map
    or dictionary, provides columns. The sub-schema is consistent throughout the table
    — in contrast to JSON types who can change their schema from row to row.
  prefs: []
  type: TYPE_NORMAL
- en: '[](/https-medium-com-martin-weitzmann-bigquery-sql-on-nested-data-cf9589c105f4?source=post_page-----f01a76cd8126--------------------------------)
    [## BigQuery: SQL on Nested Data'
  prefs: []
  type: TYPE_NORMAL
- en: BigQuery can be very powerful because nested data means working on pre-joined
    tables. But analysts struggle to use its…
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/https-medium-com-martin-weitzmann-bigquery-sql-on-nested-data-cf9589c105f4?source=post_page-----f01a76cd8126--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: The only other engine going down this route of nested data seems to be [AWS
    Redshift Spectrum](https://docs.aws.amazon.com/redshift/latest/dg/nested-data-use-cases.html).
    Yet, if we want to use Google Analytics (GA) data in another system you’d almost
    always want to de-join the data to have flat tables, because capabilities to aggregate
    or change arrays of structs are quite limited. Most analytical database engines
    seem to optimize for…
  prefs: []
  type: TYPE_NORMAL
