<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Can Neural Networks Formulate Shock Wave?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Can Neural Networks Formulate Shock Wave?</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/can-neural-networks-formulate-shock-wave-147bb75d0715?source=collection_archive---------4-----------------------#2024-04-04">https://towardsdatascience.com/can-neural-networks-formulate-shock-wave-147bb75d0715?source=collection_archive---------4-----------------------#2024-04-04</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="59e2" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">How we build a PINN for inviscid Burgers Equation with shock formulation</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@vanillaxiangshuyang?source=post_page---byline--147bb75d0715--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Shuyang Xiang" class="l ep by dd de cx" src="../Images/36a5fd18fd9b7b88cb41094f09b83882.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*Q-6F64L3h4jxYNYPiqHVaQ.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--147bb75d0715--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://medium.com/@vanillaxiangshuyang?source=post_page---byline--147bb75d0715--------------------------------" rel="noopener follow">Shuyang Xiang</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--147bb75d0715--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">6 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Apr 4, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj la lb ab q ee lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lf k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lg an ao ap id lh li lj" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep lk cn"><div class="l ae"><div class="ab cb"><div class="ll lm ln lo lp lq ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><h1 id="4e59" class="mi mj fq bf mk ml mm gq mn mo mp gt mq mr ms mt mu mv mw mx my mz na nb nc nd bk">PINN on Shock Waves</h1><p id="3344" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk"><strong class="ng fr">Physics-informed neural networks</strong> (<strong class="ng fr">PINNs</strong>) are a special type of neural networks. They estimate solutions to partial differential equations by incorporating the governing physical laws of a given dataset into the learning process.</p><p id="6f72" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">An example of such an equation is the inviscid Burgers’ equation, a prototype for conservation laws that can develop shock waves.</p><figure class="oi oj ok ol om on of og paragraph-image"><div class="of og oh"><img src="../Images/db32daff6b729cd7c952efddb61d7dbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*Tj8SK837D7PHTRKGm4Snwg.gif"/></div><figcaption class="op oq or of og os ot bf b bg z dx">Image from <a class="af ou" href="https://en.wikipedia.org/wiki/Burgers%27_equation" rel="noopener ugc nofollow" target="_blank">wikipedia</a>: Inviscid Burgers Equation in two space variables up until the time of shock formation.</figcaption></figure><p id="7774" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">The current literature struggles to effectively tackle this issue. As shock waves are not continuous solutions, they only satisfy the equations in a weak sense. <strong class="ng fr">Continuous Time Models</strong> that depend solely on training samples, like the algorithmic differentiation method, cannot capture shock waves. These methods are only applicable to cases of functional regularity.</p><p id="1f8e" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">One could attempt to use <strong class="ng fr">Discrete Time Models</strong> where neural networks and time discretization work together to help the model formulate shocks. However, this method somewhat diminishes the advantages of Physics-informed Neural Networks (PINNs) and reverts to traditional numerical methods. This can be challenging for someone who understands equations but is not familiar with numerical solutions.</p><p id="8a5b" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">In this article, I will address the limitations of existing Continuous Time Models of PINN methods for the Burgers equation. I will introduce calculations for discontinuity and weak solutions based on algorithmic differentiation, enabling the equation to capture shocks. This article might inspire those who are interested in the intersection of neural networks and physics-based modeling, especially in domains related to conservation laws.</p><p id="a7bd" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">However, it should be noted that this method has only shown promising results for one of the simplest one-dimensional hyperbolic equations. Whether it can be extended to higher dimensions or more complex equations is an aspect that the author has not explored, and I invite readers to contribute their own ideas and resources on this topic.</p><h1 id="1214" class="mi mj fq bf mk ml mm gq mn mo mp gt mq mr ms mt mu mv mw mx my mz na nb nc nd bk">PINN: Continuous Time Models for Burgers</h1><p id="8b31" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">According to the original <a class="af ou" href="https://arxiv.org/pdf/1711.10561.pdf" rel="noopener ugc nofollow" target="_blank">paper</a>: “Physics Informed Neural Networks (PINNs) are trained to solve supervised learning tasks whilst respecting any given laws of physics, described by general nonlinear partial differential equations (PDEs). ”</p><p id="407a" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">These PDEs take the following form in general [1]:</p><p id="eecb" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">ut + N [u] = 0, x ∈ Ω, t ∈ [0, T],</p><p id="abfb" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">where u(t, x) represents the solution, N [·] is a nonlinear differential operator, and Ω is a subset of the d-dimensional space.</p><p id="6da6" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">Let’s denote by</p><p id="b2e1" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">L(u) = ut + N [u].</p><p id="c677" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">It can be immediately seen that f=0 if u is the solution of the equation. We will construct the solution u as a neural network</p><p id="6800" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">u = neural_net(t,x;weights)</p><p id="cb98" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">where the inputs are the time and space variables. We determine the weights by minimizing the mean square error of f (as is said before, L(u) should be close to 0 if u is the solution of the equation) and certain initial and boundary conditions. For more details, please refer to the original paper.</p><p id="c30c" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">Now, let’s consider the 1-dimensional inviscid Burgers Equation:</p><figure class="oi oj ok ol om on of og paragraph-image"><div class="of og ov"><img src="../Images/438341126c6d5a88b69547e4c5d5b42f.png" data-original-src="https://miro.medium.com/v2/resize:fit:472/format:webp/0*F9_-nsoUKjkS6X_L"/></div><figcaption class="op oq or of og os ot bf b bg z dx">Inviscid burgers equation</figcaption></figure><p id="95df" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">The solution to the equation, adhering to the initial condition, can be constructed implicitly using the <a class="af ou" href="https://en.wikipedia.org/wiki/Method_of_characteristics" rel="noopener ugc nofollow" target="_blank">method of characteristics</a>, that is, u=f(x-ut) with the characteristic curve x(t)= x0+f(x0)t. We see from the formula that the characteristics x(t) are straight lines without the same slope, so if there exists two points x1, x2 such that x1+f(x1)t= x2+f(x2)t at a finite time t, we will see the intersectfion of two characteristics and the wave breaks [2].</p><p id="c716" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">The following code is inspired by the git repository <a class="af ou" href="https://github.com/okada39/pinn_burgers" rel="noopener ugc nofollow" target="_blank">pinn-burgers</a>. Here, a viscous Burgers’ equation is considered for 𝜈&gt;0. The equation is proven to have a globally defined smooth solution, given that the initial condition is a smooth function growing like o(|x|) at infinity [3].</p><figure class="oi oj ok ol om on of og paragraph-image"><div class="of og ow"><img src="../Images/53cc03415a2a21967c67c8870036a817.png" data-original-src="https://miro.medium.com/v2/resize:fit:248/format:webp/1*XmtcH7MaMosAqjj8fw0E8g.png"/></div><figcaption class="op oq or of og os ot bf b bg z dx">viscous Burgers’ equation</figcaption></figure><p id="9c56" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">We will express u(t,x) as neural_net(t,x;weights) with the aim to minimize the mean square error of L(u) (in this case, ut+uux) and the initial and boundary condition. If the solution to the equation is smooth, TensorFlow can be naturally used to write the following code to compute the desired unknowns:</p><pre class="oi oj ok ol om ox oy oz bp pa bb bk"><span id="e2d9" class="pb mj fq oy b bg pc pd l pe pf">with tf.GradientTape() as g:<br/>    g.watch(x)<br/>    u = neural_net(x)<br/>du_dtx = g.batch_jacobian(u, x)<br/>du_dt = du_dtx[..., 0]<br/>du_dx = du_dtx[..., 1]</span></pre><p id="8700" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">The L(u) (in the code, we call it u_eqn) will be define simply as:</p><pre class="oi oj ok ol om ox oy oz bp pa bb bk"><span id="666c" class="pb mj fq oy b bg pc pd l pe pf">u_eqn = du_dt+ u*du_dt # (1)</span></pre><p id="1312" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">The issue is that the equation ut + uux only holds true in the weak sense. This means that it may not be useful to consider the values of ut and ux when shock waves form as they will explode. The equation only applies in an integrated form. Common Python packages like TensorFlow or PyTorch provide APIs for neural networks and differentiation algorithms but don’t offer weak sense solutions. Therefore, we need to reconfigure the formula of L(u) to compel the neural network to form the shock wave.</p><h1 id="c118" class="mi mj fq bf mk ml mm gq mn mo mp gt mq mr ms mt mu mv mw mx my mz na nb nc nd bk">Introduction of Shock</h1><p id="740c" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">We’re introducing the Rankine–Hugoniot conditions, also known as Rankine–Hugoniot jump conditions or relations. These describe the relationship between states on either side of a shock wave. For the Burgers equation, the Rankine–Hugoniot condition appears as: 1/2[[𝑢²]]=𝑠[[𝑢]]. The brackets [[ ]] represent the difference between the right-hand side and left-hand side values, while ‘s’ is the shock propagation velocity.</p><p id="d295" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">Considering a specific space variable ‘x’, we aim to closely examine the left or right limits, i.e., u(x±) in cases of discontinuity. Here’s the relevant code:</p><pre class="oi oj ok ol om ox oy oz bp pa bb bk"><span id="ac84" class="pb mj fq oy b bg pc pd l pe pf">delta = 1e-3<br/>xl = x - delta<br/>xr= x  + delta<br/>with tf.GradientTape() as g:<br/>   g.watch(x)<br/>    u = neural_net(x)<br/>    ul = neural_net(xl)<br/>    ur = neural_net(xr)<br/><br/>du_dtx = g.batch_jacobian(u, x)<br/>du_dt = du_dtx[..., 0]<br/>du_dx = du_dtx[..., 1]</span></pre><p id="1e0c" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">We define a small delta and calculate the value of the solution on both the left and right sides of the space variable x, up to a delta.</p><p id="6077" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">Following this, we redefine the function L(u) as :</p><pre class="oi oj ok ol om ox oy oz bp pa bb bk"><span id="9069" class="pb mj fq oy b bg pc pd l pe pf"> <br/>   term1 = du_dt + u * du_dx<br/>   term2 = (ul + ur) / 2<br/>   condition = tf.less(du_dt, 1e3)<br/>   u_eqn = tf.where(condition, term1, term2) # (2)</span></pre><p id="97c9" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">We use the regular form of the equation when the value of du_dt is finite (specifically, smaller than a sufficiently large value), and we use the Rankine–Hugoniot condition when the value of du_dt is infinite.</p><h1 id="1a7a" class="mi mj fq bf mk ml mm gq mn mo mp gt mq mr ms mt mu mv mw mx my mz na nb nc nd bk">Experiment</h1><p id="2861" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">Let’s consider the Burgers equation with an initial condition of sin(πx) on the interval [-1, 1]. The solution can be expressed as u=sin(π(x-ut)), and a shock forms when t=1. Using formula (1), we derive the following solution:</p><figure class="oi oj ok ol om on of og paragraph-image"><div class="of og pg"><img src="../Images/091063661f41358dd888e4c627d52a52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8DU-4VisNmtPpvV1UlCj7w.png"/></div><figcaption class="op oq or of og os ot bf b bg z dx">Image by author: Solution of Burgers Equation using formula (1)</figcaption></figure><p id="dee0" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">The model has struggled to find the correct answer without being informed about what a shock is. However, if we switch to formula (2), we obtain the following solution:</p><figure class="oi oj ok ol om on of og paragraph-image"><div class="of og pg"><img src="../Images/ce521d21ba2d9a221ac0677dd8dbf1cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tKiVO_63tpOlQJYz_YwBKQ.png"/></div><figcaption class="op oq or of og os ot bf b bg z dx">Image by author: Solution of Burgers Equation using formula (2)</figcaption></figure><p id="34b5" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">You can see that the model successfully captures the shock wave at t=1.</p><h1 id="3b01" class="mi mj fq bf mk ml mm gq mn mo mp gt mq mr ms mt mu mv mw mx my mz na nb nc nd bk">Conclusion</h1><p id="0328" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">Physics-informed neural networks (PINNs) can estimate solutions to partial differential equations by incorporating physical laws into their learning process. However, they often have difficulties with discontinuous solutions such as shock waves. I propose calculations for weak solutions that allow the Burgers equation to capture shocks. It’s important to note that while the 1-D Burgers Equation is a simple use case, this method may not be applicable to more complex equations without deeper consideration.</p><h1 id="d9d5" class="mi mj fq bf mk ml mm gq mn mo mp gt mq mr ms mt mu mv mw mx my mz na nb nc nd bk">Reference</h1><p id="6d08" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">[1] M. Raissi, P. Perdikaris, G.E. Karniadakis,<br/>Physics-informed neural networks: A deep learning framework for solving forward and inverse problems involving nonlinear partial differential equations, Journal of Computational Physics,Volume 378,2019, Pages 686–707.</p><p id="9bc2" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">[2] A. Salih, Inviscid Burgers’ Equation. Lecture notes. Department of Aerospace Engineering Indian Institute of Space Science and Technology.</p><p id="d0f3" class="pw-post-body-paragraph ne nf fq ng b go oa ni nj gr ob nl nm nn oc np nq nr od nt nu nv oe nx ny nz fj bk">[3] J Unterberger, Global existence for strong solutions of viscous Burgers equation. March 2015. Control and Cybernetics 46(2).</p></div></div></div></div>    
</body>
</html>