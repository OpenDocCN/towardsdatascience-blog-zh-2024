- en: How to Merge Data Frames by The Nearest Match in Pandas? Use merge_asof.
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/how-to-merge-data-frames-by-the-nearest-match-in-pandas-use-merge-asof-12e5a3a0a204?source=collection_archive---------4-----------------------#2024-02-18](https://towardsdatascience.com/how-to-merge-data-frames-by-the-nearest-match-in-pandas-use-merge-asof-12e5a3a0a204?source=collection_archive---------4-----------------------#2024-02-18)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: PANDAS
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A short post about a useful function in Pandas, merge_asof. It’s one of the
    most used tools in Pandas when dealing with time series data.
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://jianan-lin.medium.com/?source=post_page---byline--12e5a3a0a204--------------------------------)[![Yufeng](../Images/8b1a4c165aaac045ea819f850017b7cd.png)](https://jianan-lin.medium.com/?source=post_page---byline--12e5a3a0a204--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--12e5a3a0a204--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--12e5a3a0a204--------------------------------)
    [Yufeng](https://jianan-lin.medium.com/?source=post_page---byline--12e5a3a0a204--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--12e5a3a0a204--------------------------------)
    ·5 min read·Feb 18, 2024
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/79c188ebf09394b6df392cd725d66ef9.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Stephen Phillips - Hostreviews.co.uk](https://unsplash.com/@hostreviews?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: Merging data frames is one of the most frequent manipulations in data science.
    Most of the data merging focuses on the exact merge, where a row from the left
    and that from the right data frames must have index/values in common. However,
    sometimes we don’t want the exact match but the nearest match in merging data
    frames, especially in the time series analysis.
  prefs: []
  type: TYPE_NORMAL
- en: For example, we have a data frame of the S&P 500 index per day and another data
    frame of the weather in New York City per day. We want to know whether the weather
    in NYC can affect the next day’s S&P 500 index.
  prefs: []
  type: TYPE_NORMAL
- en: Note that the market is closed on weekends and holidays, so we want to make
    sure that the weather info we collect for each day’s S&P 500 index is its most
    recent business day.
  prefs: []
  type: TYPE_NORMAL
- en: To finish the task described above, we need to use one Pandas function, `merge_asof`
    instead of `merge`.
  prefs: []
  type: TYPE_NORMAL
- en: In this short post, I’ll briefly go over how to use this function with codes
    in Python. Hope it’s helpful to you.
  prefs: []
  type: TYPE_NORMAL
