- en: How to Implement Graph RAG Using Knowledge Graphs and Vector Databases
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 如何使用知识图谱和向量数据库实现图谱增强生成（Graph RAG）
- en: 原文：[https://towardsdatascience.com/how-to-implement-graph-rag-using-knowledge-graphs-and-vector-databases-60bb69a22759?source=collection_archive---------0-----------------------#2024-09-06](https://towardsdatascience.com/how-to-implement-graph-rag-using-knowledge-graphs-and-vector-databases-60bb69a22759?source=collection_archive---------0-----------------------#2024-09-06)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://towardsdatascience.com/how-to-implement-graph-rag-using-knowledge-graphs-and-vector-databases-60bb69a22759?source=collection_archive---------0-----------------------#2024-09-06](https://towardsdatascience.com/how-to-implement-graph-rag-using-knowledge-graphs-and-vector-databases-60bb69a22759?source=collection_archive---------0-----------------------#2024-09-06)
- en: '![](../Images/bb57df531853e6ba435c6662113afbce.png)'
  id: totrans-2
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/bb57df531853e6ba435c6662113afbce.png)'
- en: Image by author
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 图片由作者提供
- en: A Step-by-Step Tutorial on Implementing Retrieval-Augmented Generation (RAG),
    Semantic Search, and Recommendations
  id: totrans-4
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 实现检索增强生成（RAG）、语义搜索和推荐的分步教程
- en: '[](https://stevehedden.medium.com/?source=post_page---byline--60bb69a22759--------------------------------)[![Steve
    Hedden](../Images/af7bec4a191ab857eccd885dd89e88b4.png)](https://stevehedden.medium.com/?source=post_page---byline--60bb69a22759--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--60bb69a22759--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--60bb69a22759--------------------------------)
    [Steve Hedden](https://stevehedden.medium.com/?source=post_page---byline--60bb69a22759--------------------------------)'
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://stevehedden.medium.com/?source=post_page---byline--60bb69a22759--------------------------------)[![Steve
    Hedden](../Images/af7bec4a191ab857eccd885dd89e88b4.png)](https://stevehedden.medium.com/?source=post_page---byline--60bb69a22759--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--60bb69a22759--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--60bb69a22759--------------------------------)
    [Steve Hedden](https://stevehedden.medium.com/?source=post_page---byline--60bb69a22759--------------------------------)'
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--60bb69a22759--------------------------------)
    ·39 min read·Sep 6, 2024
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: ·发布于 [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--60bb69a22759--------------------------------)
    ·阅读时长 39 分钟·2024年9月6日
- en: --
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '*The accompanying code for this tutorial is* [*here.*](https://github.com/SteveHedden/kg_llm)'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: '*本教程的相关代码可以在* [*这里找到。*](https://github.com/SteveHedden/kg_llm)'
- en: 'My [last blog post](https://medium.com/towards-data-science/how-to-implement-knowledge-graphs-and-large-language-models-llms-together-at-the-enterprise-level-cf2835475c47)
    was about how to implement knowledge graphs (KGs) and Large Language Models (LLMs)
    together at the enterprise level. In that post, I went through the two ways KGs
    and LLMs are interacting right now: LLMs as tools to build KGs; and KGs as inputs
    into LLM or GenAI applications. The diagram below shows the two sides of integrations
    and the different ways people are using them together.'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 我的[上一篇博客](https://medium.com/towards-data-science/how-to-implement-knowledge-graphs-and-large-language-models-llms-together-at-the-enterprise-level-cf2835475c47)讲述了如何在企业级别上将知识图谱（KGs）和大型语言模型（LLMs）结合使用。在那篇文章中，我讨论了当前知识图谱和大型语言模型互动的两种方式：将大型语言模型作为工具来构建知识图谱；以及将知识图谱作为输入应用于大型语言模型或生成式AI应用程序。下面的图示展示了这两种集成方式及人们如何将它们结合使用的不同方式。
- en: '![](../Images/a8660e076ec5e3ba690aac08a47eceac.png)'
  id: totrans-10
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a8660e076ec5e3ba690aac08a47eceac.png)'
- en: Image by author
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 图片由作者提供
- en: 'In this post, I will focus on one popular way KGs and LLMs are being used together:
    RAG using a knowledge graph, sometimes called [Graph RAG](https://www.ontotext.com/knowledgehub/fundamentals/what-is-graph-rag/),
    [GraphRAG](https://microsoft.github.io/graphrag/), [GRAG](https://arxiv.org/abs/2405.16506),
    or [Semantic RAG](https://www.poolparty.biz/semantic-retrieval-augmented-generation).
    Retrieval-Augmented Generation (RAG) is about **retrieving** relevant information
    to **augment** a prompt that is sent to an LLM, which **generates** a response.
    The idea is that, rather than sending your prompt directly to an LLM, which was
    not trained on your data, you can supplement your prompt with the relevant information
    needed for the LLM to answer your prompt accurately. The example I used in my
    previous post is copying a job description and my resume into ChatGPT to write
    a cover letter. The LLM is able to provide a much more relevant response to my
    prompt, ‘write me a cover letter,’ if I give it my resume and the description
    of the job I am applying for. Since knowledge graphs are built to store knowledge,
    they are a perfect way to store internal data and supplement LLM prompts with
    additional context, improving the accuracy and contextual understanding of the
    responses.'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在这篇文章中，我将聚焦于知识图谱和大语言模型（LLMs）共同使用的一种流行方式：使用知识图谱的 RAG，有时称为 [图谱 RAG](https://www.ontotext.com/knowledgehub/fundamentals/what-is-graph-rag/)、[GraphRAG](https://microsoft.github.io/graphrag/)、[GRAG](https://arxiv.org/abs/2405.16506)
    或 [语义 RAG](https://www.poolparty.biz/semantic-retrieval-augmented-generation)。检索增强生成（RAG）是通过**检索**相关信息来**增强**发送给大语言模型（LLM）的提示，然后由
    LLM **生成**响应。其核心思想是，与你直接将提示发送给没有经过你数据训练的 LLM 相比，你可以通过补充相关信息来增强提示，从而帮助 LLM 更准确地回答你的问题。我在之前的文章中举的例子是，将职位描述和我的简历复制到
    ChatGPT 中，让它写一封求职信。如果我提供简历和我申请的职位描述，大语言模型将能为我的提示“写一封求职信”提供一个更相关的回答。由于知识图谱是专门用于存储知识的，因此它们是存储内部数据并通过额外上下文补充
    LLM 提示的理想方式，从而提高回答的准确性和上下文理解。
- en: What is important, and I think often misunderstood, is that RAG and RAG using
    a KG (Graph RAG) are methodologies for combining technologies, not a product or
    technology themselves. No one invented, owns, or has a monopoly on Graph RAG.
    Most people can see the potential that these two technologies have when combined,
    however, and there are [more](https://arxiv.org/pdf/2311.07509) and [more](https://arxiv.org/pdf/2405.11706)
    studies proving the benefits of combining them.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 重要的是，我认为常常被误解的一点是，RAG 和使用知识图谱的 RAG（图谱 RAG）是将技术结合起来的方案，而不是某种产品或技术本身。没有人发明、拥有或垄断图谱
    RAG。大多数人能够看到这两项技术结合后所能带来的潜力，而且有越来越多的 [研究](https://arxiv.org/pdf/2311.07509) 和
    [研究](https://arxiv.org/pdf/2405.11706) 证明了将它们结合的好处。
- en: 'Generally, there are three ways of using a KG for the retrieval part of RAG:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，使用知识图谱（KG）进行检索的 RAG（检索增强生成）有三种方式：
- en: '**Vector-based retrieval:** Vectorize your KG and store it in a vector database.
    If you then vectorize your natural language prompt, you can find vectors in the
    vector database that are most similar to your prompt. Since these vectors correspond
    to entities in your graph, you can return the most ‘relevant’ entities in the
    graph given a natural language prompt. *Note that you can do vector-based retrieval
    without a graph. That is actually the original way RAG was implemented, sometimes
    called Baseline RAG. You’d vectorize your SQL database or content and retrieve
    it at query time.*'
  id: totrans-15
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**基于向量的检索：** 对你的知识图谱进行向量化并将其存储在向量数据库中。如果你将自然语言提示进行向量化，你可以在向量数据库中找到与提示最相似的向量。由于这些向量对应于图谱中的实体，你可以根据自然语言提示返回图谱中最“相关”的实体。*请注意，你可以在没有图谱的情况下进行基于向量的检索。这实际上是
    RAG 最初实现的方式，有时称为基线 RAG。你可以对 SQL 数据库或内容进行向量化，并在查询时检索它。*'
- en: '**Prompt-to-query retrieval:** Use an LLM to write a SPARQL or Cypher query
    for you, use the query against your KG, and then use the returned results to augment
    your prompt.'
  id: totrans-16
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**提示到查询的检索：** 使用大语言模型（LLM）为你编写一个 SPARQL 或 Cypher 查询，将该查询应用于你的知识图谱（KG），然后使用返回的结果来增强你的提示。'
- en: '**Hybrid (vector + SPARQL):** You can combine these two approaches in all kinds
    of interesting ways. In this tutorial, I will demonstrate some of the ways you
    can combine these methods. I will primarily focus on using vectorization for the
    initial retrieval and then SPARQL queries to refine the results.'
  id: totrans-17
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**混合（向量 + SPARQL）：** 你可以将这两种方法以各种有趣的方式结合起来。在本教程中，我将演示一些你可以结合这些方法的方式。我将主要聚焦于使用向量化进行初步检索，然后使用
    SPARQL 查询来精炼结果。'
- en: There are, however, many ways of combining vector databases and KGs for search,
    similarity, and RAG. This is just an illustrative example to highlight the pros
    and cons of each individually and the benefits of using them together. The way
    I am using them together here — vectorization for initial retrieval and then SPARQL
    for filtering — is not unique. I have seen this implemented elsewhere. A good
    example I have heard anecdotally was from someone at a large furniture manufacturer.
    He said the vector database might recommend a lint brush to people buying couches,
    but the knowledge graph would understand materials, properties, and relationships
    and would ensure that the lint brush is not recommended to people buying leather
    couches.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，有很多方法可以将向量数据库和KG结合起来进行搜索、相似性和RAG。这只是一个示例，用于突出每种方法的优缺点，以及它们结合使用的好处。我在这里使用它们的方式——初始检索时使用向量化，然后用SPARQL进行过滤——并不独特。我曾在其他地方看到过类似的实现。有一个来自大型家具制造商的例子，我曾听说过。他说，向量数据库可能会向购买沙发的人推荐一把衣物刷，但知识图谱会理解材料、属性和关系，并确保不会向购买皮沙发的人推荐衣物刷。
- en: 'In this tutorial I will:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 在本教程中，我将：
- en: Vectorize a dataset into a vector database to test semantic search, similarity
    search, and RAG *(vector-based retrieval)*
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将数据集向量化为向量数据库，以测试语义搜索、相似性搜索和RAG *(基于向量的检索)*
- en: Turn the data into a KG to test semantic search, similarity search, and RAG
    *(prompt-to-query retrieval, though really more like query retrieval since I’m
    just using SPARQL directly rather than having an LLM turn my natural language
    prompt into a SPARQL query)*
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将数据转化为KG以测试语义搜索、相似性搜索和RAG *(提示到查询检索，实际上更像是查询检索，因为我只是直接使用SPARQL，而不是让LLM将我的自然语言提示转化为SPARQL查询)*
- en: Vectorize dataset with tags and URIs from the knowledge graph into a vector
    database (what I’ll refer to as a “vectorized knowledge graph”) and test semantic
    search, similarity, and RAG *(hybrid)*
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将带有标签和URI的知识图谱数据集向量化为向量数据库（我将其称为“向量化知识图谱”），并测试语义搜索、相似性和RAG *(混合型)*
- en: The goal is to illustrate the differences between KGs and vector databases for
    these capabilities and to show some of the ways they can work together. Below
    is a high-level overview of how, together, vector databases and knowledge graphs
    can execute advanced queries.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 目标是阐明KG和向量数据库在这些功能上的差异，并展示它们如何协同工作。以下是向量数据库和知识图谱如何联合执行高级查询的高级概述。
- en: '![](../Images/bb57df531853e6ba435c6662113afbce.png)'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/bb57df531853e6ba435c6662113afbce.png)'
- en: Image by author
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 图片由作者提供
- en: 'If you don’t feel like reading any further, here is the TL;DR:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你不想继续阅读，下面是总结：
- en: Vector databases can run semantic searches, similarity calculations and some
    basic forms of RAG pretty well with a few caveats. The first caveat is that the
    data I am using contains abstracts of journal articles, i.e. it has a good amount
    of unstructured text associated with it. Vectorization models are trained primarily
    on unstructured data and so perform well when given chunks of text associated
    with entities.
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 向量数据库可以很好地进行语义搜索、相似性计算和一些基本的RAG操作，但也有一些前提条件。第一个前提是，我所使用的数据包含期刊文章的摘要，也就是说，它与相当大量的非结构化文本相关联。向量化模型主要针对非结构化数据进行训练，因此在处理与实体相关的文本片段时表现良好。
- en: That being said, there is very little overhead in getting your data into a vector
    database and ready to be queried. If you have a dataset with some unstructured
    data in it, you can vectorize and start searching in 15 minutes.
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 话虽如此，将数据导入向量数据库并准备好进行查询的开销非常小。如果你有一个包含一些非结构化数据的数据集，你可以在15分钟内完成向量化并开始搜索。
- en: Not surprisingly, one of the biggest drawbacks of using a vector database alone
    is the lack of explainability. The response might have three good results and
    one that doesn’t make much sense, and there is no way to know why that fourth
    result is there.
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不出所料，单独使用向量数据库的最大缺点之一是缺乏可解释性。结果可能有三个很好的结果和一个不太合理的结果，但无法知道为什么这个第四个结果会出现。
- en: The chance of unrelated content being returned by a vector database is a nuisance
    for search and similarity, but a huge problem for RAG. If you’re augmenting your
    prompt with four articles and one of them is about a completely unrelated topic,
    the response from the LLM is going to be misleading. This is often referred to
    as ‘context poisoning’.
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 向量数据库返回无关内容的几率对于搜索和相似性而言是一个麻烦，但对于RAG来说是一个巨大的问题。如果你在提示中增加了四篇文章，而其中一篇完全与主题无关，LLM的回应就会误导人。这通常被称为“上下文污染”。
- en: What is especially dangerous about context poisoning is that the response isn’t
    necessarily factually inaccurate, and it isn’t based on an inaccurate piece of
    data, it’s just using the wrong data to answer your question. The example I found
    in this tutorial is for the prompt, “therapies for mouth neoplasms.” One of the
    retrieved articles was about a study conducted on therapies for rectal cancer,
    which was sent to the LLM for summarization. I’m no doctor but I’m pretty sure
    the rectum’s not part of the mouth. The LLM accurately summarized the study and
    the effects of different therapy options on both mouth and rectal cancer, but
    didn’t always mention type of cancer. The user would therefore be unknowingly
    reading an LLM describe different treatment options for rectal cancer, after having
    asked the LLM to describe treatments for mouth cancer.
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 上下文污染的特别危险之处在于，响应不一定在事实上不准确，而且它并不是基于错误的数据，而是使用了错误的数据来回答你的问题。我在本教程中找到的一个例子是关于提示词“口腔肿瘤的治疗方法”。其中一篇检索到的文章是关于直肠癌治疗的研究，并被发送到LLM进行总结。我不是医生，但我敢肯定直肠并不属于口腔的一部分。LLM准确地总结了该研究以及不同治疗方法对口腔癌和直肠癌的影响，但并不总是提到癌症类型。因此，用户在请求LLM描述口腔癌治疗方法后，会在不知情的情况下阅读到LLM描述直肠癌治疗方法的内容。
- en: The degree to which KGs can do semantic search and similarity search well is
    a function of the quality of your metadata and the controlled vocabularies the
    metadata connects to. In the example dataset in this tutorial, the journal articles
    have all been tagged already with topical terms. These terms are part of a rich
    controlled vocabulary, the [Medical Subject Headings](https://www.ncbi.nlm.nih.gov/mesh/)
    (MeSH) from the National Institutes of Health. Because of that, we can do semantic
    search and similarity relatively easily out of the box.
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: KG在语义搜索和相似性搜索中能够做得好与否，取决于元数据的质量以及元数据所连接的受控词汇表的质量。在本教程中的示例数据集中，期刊文章已经被标记了相关的主题词。这些词是一个丰富的受控词汇的一部分，即来自美国国立卫生研究院的[医学主题词](https://www.ncbi.nlm.nih.gov/mesh/)（MeSH）。因此，我们可以非常轻松地进行语义搜索和相似性搜索。
- en: There is likely some benefit of vectorizing a KG directly into a vector database
    to use as your knowledge base for RAG, but I didn’t do that for this tutorial.
    I just vectorized the data in tabular format but added a column for a URI for
    each article so I could connect the vectors back to the KG.
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将KG直接向量化到向量数据库中，用作RAG的知识库，可能会带来一定的好处，但我在本教程中并没有这样做。我只是将数据以表格格式向量化，但为每篇文章添加了一列URI，以便将向量与KG连接起来。
- en: 'One of the biggest strengths of using a KG for semantic search, similarity,
    and RAG is in explainability. You can always explain why certain results were
    returned: they were tagged with certain concepts or had certain metadata properties.'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用KG进行语义搜索、相似性搜索和RAG的最大优势之一在于可解释性。你总是可以解释为什么某些结果被返回：它们被标记了某些概念或具有某些元数据属性。
- en: Another benefit of the KG that I did not foresee is something sometimes called,
    “enhanced data enrichment” or “[graph as an expert](https://www.ontotext.com/knowledgehub/fundamentals/what-is-graph-rag/)”
    — you can use the KG to expand or refine your search terms. For example, you can
    find similar terms, narrower terms, or terms related to your search term in specific
    ways, to expand or refine your query. For example, I might start with searching
    for “mouth cancer,” but based on my KG terms and relationships, refine my search
    to “gingival neoplasms and palatal neoplasms.”
  id: totrans-35
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我没有预料到KG的另一个好处是有时被称为“增强数据丰富”或“[图谱作为专家](https://www.ontotext.com/knowledgehub/fundamentals/what-is-graph-rag/)”——你可以使用KG来扩展或细化你的搜索词。例如，你可以找到类似的术语、更窄的术语，或以特定方式与搜索词相关的术语，从而扩展或细化你的查询。例如，我可能会从搜索“口腔癌”开始，但根据我的KG术语和关系，将搜索细化为“牙龈肿瘤和腭部肿瘤”。
- en: One of the biggest obstacles to getting started with using a KG is that you
    need to build a KG. That being said, there are many ways to use LLMs to speed
    up the construction of a KG (figure 1 above).
  id: totrans-36
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用知识图谱（KG）的最大障碍之一是你需要构建一个KG。话虽如此，有许多方法可以使用大型语言模型（LLM）加速KG的构建（见上图1）。
- en: One downside of using a KG alone is that you’ll need to write SPARQL queries
    to do everything. Hence the popularity of prompt-to-query retrieval described
    above.
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 单独使用KG的一个缺点是你需要编写SPARQL查询才能完成所有操作。因此，上面提到的从提示到查询的检索方法才会受到欢迎。
- en: The results from using Jaccard similarity on terms to find similar articles
    in the knowledge graph were poor. Without specification, the KG returned articles
    that had overlapping tags such as, “Aged”, “Male”, and “Humans”, that are probably
    not nearly as relevant as “Treatment Options” or “Mouth Neoplasms”.
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Jaccard相似度在术语上找到类似文章的结果较差。如果没有特定的过滤，KG会返回一些具有重叠标签的文章，例如“老年”，“男性”和“人类”，这些标签可能远不如“治疗选项”或“口腔肿瘤”相关。
- en: Another issue I faced was that Jaccard similarity took forever (like 30 minutes)
    to run. I don’t know if there is a better way to do this (open to suggestions)
    but I am guessing that it is just very computationally intensive to find overlapping
    tags between an article and 9,999 other articles.
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我遇到的另一个问题是，Jaccard相似度的计算需要很长时间（大约30分钟）。我不确定是否有更好的方法来实现这一点（欢迎提出建议），但我猜测，找到文章与9,999篇其他文章之间的重叠标签本身就是一种非常计算密集型的操作。
- en: Since the example prompts I used in this tutorial were something simple like
    ‘summarize these articles’ — the accuracy of the response from the LLM (for both
    the vector-based and KG-based retrieval methods) was much more dependent on the
    retrieval than the generation. What I mean is that as long as you give the LLM
    the relevant context, it is very unlikely that the LLM is going to mess up a simple
    prompt like ‘summarize’. This would be very different if our prompts were more
    complicated questions of course.
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 由于本教程中我使用的示例提示非常简单，比如“总结这些文章”，因此LLM的回答准确性（无论是基于向量的还是基于KG的检索方法）更多取决于检索结果，而不是生成过程。我的意思是，只要给LLM提供相关的上下文，它就不太可能在类似“总结”这样简单的提示上出错。当然，如果我们的提示更为复杂，这种情况会有所不同。
- en: 'Using the vector database for the initial search and then the KG for filtering
    provided the best results. This is somewhat obvious —you wouldn’t filter to get
    worse results. But that’s the point: it’s not that the KG necessarily improves
    results by itself, it’s that the KG provides you the ability to control the output
    to optimize your results.'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用向量数据库进行初步搜索，再使用KG进行过滤，提供了最佳的结果。这是显而易见的——你不会过滤掉更差的结果。但这就是重点：并不是说KG本身一定能改善结果，而是KG为你提供了控制输出的能力，从而优化结果。
- en: Filtering results using the KG can improve the accuracy and relevancy based
    on the prompt, but it can also be used to customize results based on the person
    writing the prompt. For example, we may want to use similarity search to find
    similar articles to recommend to a user, but we’d only want to recommend articles
    that that person has access to. The KG allows for query-time access control.
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用知识图谱（KG）过滤结果可以提高基于提示的准确性和相关性，但它也可以根据编写提示的人来定制结果。例如，我们可能希望使用相似度搜索来找到类似的文章并推荐给用户，但我们只希望推荐该用户可以访问的文章。KG允许在查询时进行访问控制。
- en: KGs can also help reduce the likelihood of context poisoning. In the RAG example
    above, we can search for ‘therapies for mouth neoplasms,’ in the vector database,
    but then filter for only articles that are tagged with mouth neoplasms (or related
    concepts).
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 知识图谱（KG）还可以帮助减少上下文污染的可能性。在上面的RAG示例中，我们可以在向量数据库中搜索“口腔肿瘤的治疗方法”，然后过滤出仅标记为口腔肿瘤（或相关概念）的文章。
- en: I only focused on a simple implementation in this tutorial where we sent the
    prompt directly to the vector database and then filter the results using the graph.
    There are far better ways of doing this. For example, you could extract entities
    from the prompt that align with your controlled vocabulary and enrich them (with
    synonyms and narrower terms) using the graph; you could parse the prompt into
    semantic chunks and send them separately to the vector database; you could turn
    the RDF data into text before vectorizing so the language model understands it
    better, etc. Those are topics for future blog posts.
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在本教程中，我只关注了一个简单的实现方式，即直接将提示发送到向量数据库，然后使用图形过滤结果。实际上有更好的方法。例如，您可以从提示中提取与受控词汇对齐的实体，并通过图谱对它们进行丰富（包括同义词和更窄的术语）；您可以将提示解析成语义块，并将它们分别发送到向量数据库；您可以在向量化之前将RDF数据转化为文本，以便语言模型更好地理解等等。这些内容将是未来博客文章的主题。
- en: 'Step 1: Vector-based retrieval'
  id: totrans-45
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第一步：基于向量的检索
- en: 'The diagram below shows the plan at a high level. We want to vectorize the
    abstracts and titles from journal articles into a vector database to run different
    queries: semantic search, similarity search, and a simple version of RAG. For
    semantic search, we will test a term like ‘mouth neoplasms’ — the vector database
    should return articles relevant to this topic. For similarity search, we will
    use the ID of a given article to find its nearest neighbors in the vector space
    i.e. the articles most similar to this article. Finally, vector databases allow
    for a form of RAG where we can supplement a prompt like, “please explain this
    like you would to someone without a medical degree,” with an article.'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 下图展示了高层次的计划。我们希望将期刊文章的摘要和标题向量化到一个向量数据库中，以运行不同的查询：语义搜索、相似性搜索和RAG的简化版本。对于语义搜索，我们将测试一个术语，比如“口腔肿瘤”——向量数据库应该返回与此主题相关的文章。对于相似性搜索，我们将使用给定文章的ID来查找其在向量空间中的最近邻，即与该文章最相似的文章。最后，向量数据库允许一种形式的RAG，我们可以用一篇文章来补充一个提示，比如“请像对一个没有医学学位的人解释这篇文章一样”。
- en: '![](../Images/e466e1c2961bfa2db76099214cf93fe0.png)'
  id: totrans-47
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e466e1c2961bfa2db76099214cf93fe0.png)'
- en: Image by author
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 作者提供的图片
- en: 'I’ve decided to use [this](https://www.kaggle.com/datasets/owaiskhan9654/pubmed-multilabel-text-classification)
    dataset of 50,000 research articles from the PubMed repository (License [CC0:
    Public Domain](https://creativecommons.org/publicdomain/zero/1.0/)). This dataset
    contains the title of the articles, their abstracts, as well as a field for metadata
    tags. These tags are from the Medical Subject Headings (MeSH) controlled vocabulary
    thesaurus. For the purposes of this part of the tutorial, we are only going to
    use the abstracts and the titles. This is because we are trying to compare a vector
    database with a knowledge graph and the strength of the vector database is in
    its ability to ‘understand’ unstructured data without rich metadata. I only used
    the top 10,000 rows of the data, just to make the calculations run faster.'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 我决定使用来自PubMed存储库的50,000篇研究文章的[这个](https://www.kaggle.com/datasets/owaiskhan9654/pubmed-multilabel-text-classification)数据集（许可证[CC0：公共领域](https://creativecommons.org/publicdomain/zero/1.0/))。这个数据集包含文章的标题、摘要以及元数据标签字段。这些标签来自医学主题词表（MeSH）受控词汇表。为了本部分教程的目的，我们将仅使用摘要和标题。原因是我们正在尝试将向量数据库与知识图谱进行比较，向量数据库的优势在于其能够“理解”没有丰富元数据的非结构化数据。我只使用了前10,000行数据，这样可以加快计算速度。
- en: '[Here](https://weaviate.io/developers/weaviate/quickstart) is Weaviate’s official
    quickstart tutorial. I also found [this](/getting-started-with-weaviate-a-beginners-guide-to-search-with-vector-databases-14bbb9285839)
    article helpful in getting started.'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: '[这里](https://weaviate.io/developers/weaviate/quickstart)是Weaviate的官方快速入门教程。我还发现[这篇](/getting-started-with-weaviate-a-beginners-guide-to-search-with-vector-databases-14bbb9285839)文章对入门非常有帮助。'
- en: '[PRE0]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Then we can establish a connection to our Weaviate cluster:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们可以建立与Weaviate集群的连接：
- en: '[PRE1]'
  id: totrans-53
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: Before we vectorize the data into the vector database, we must define the schema.
    Here is where we define which columns from the csv we want to vectorize. As mentioned,
    for the purposes of this tutorial, to start, I only want to vectorize the title
    and abstract columns.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 在将数据向量化到向量数据库之前，我们必须定义模式。在这里，我们定义从csv中哪些列需要向量化。如前所述，本教程的目的，开始时我只希望向量化标题和摘要列。
- en: '[PRE2]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Then we push this schema to our Weaviate cluster:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们将这个模式推送到我们的Weaviate集群：
- en: '[PRE3]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: You can check that this worked by looking directly in your Weaviate cluster.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以通过直接查看你的Weaviate集群来确认这一点。
- en: Now that we have established the schema, we can write all of our data into the
    vector database.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经建立了模式，我们可以将所有数据写入向量数据库。
- en: '[PRE4]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'To check that the data went into the cluster, you can run this:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 为了检查数据是否已经进入集群，你可以运行以下命令：
- en: '[PRE5]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: For some reason, only 9997 of my rows were vectorized. ¯\_(ツ)_/¯
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 不知为何，我的行数只有9997行被向量化。¯\_(ツ)_/¯
- en: Semantic search using vector database
  id: totrans-64
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用向量数据库进行语义搜索
- en: When we talk about semantics in the vector database, we mean that the terms
    are vectorized into the vector space using the LLM API which has been trained
    on lots of unstructured content. This means that the vector takes the context
    of the terms into consideration. For example, if the term Mark Twain is mentioned
    many times near the term Samuel Clemens in the training data, the vectors for
    these two terms should be close to each other in the vector space. Likewise, if
    the term Mouth Cancer appears together with Mouth Neoplasms many times in the
    training data, we would expect the vector for an article about Mouth Cancer to
    be near an article about Mouth Neoplasms in the vector space.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们谈论向量数据库中的语义时，我们指的是通过大规模无结构内容训练的LLM API将术语向量化到向量空间中。这意味着向量会考虑术语的上下文。例如，如果在训练数据中，术语“马克·吐温”与术语“塞缪尔·克莱门斯”多次一起出现，那么这两个术语的向量应该在向量空间中相互接近。同样，如果“口腔癌”一词与“口腔肿瘤”一词在训练数据中多次一起出现，我们会期望关于口腔癌的文章的向量在向量空间中靠近关于口腔肿瘤的文章的向量。
- en: 'You can check that it worked by running a simple query:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以通过运行一个简单的查询来检查是否成功：
- en: '[PRE6]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Here are the results:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是搜索结果：
- en: '**Article 1:** *“Gingival metastasis as first sign of multiorgan dissemination
    of epithelioid malignant mesothelioma.”* This article is about a study conducted
    on people who had malignant mesothelioma (a form of lung cancer) that spread to
    their gums. The study was to test the effects of different treatments (chemotherapy,
    decortication, and radiotherapy) on the cancer. This seems like an appropriate
    article to return — it is about gingival neoplasms, a subset of mouth neoplasms.'
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文章 1：** *“牙龈转移作为表皮样恶性间皮瘤多脏器传播的首个信号。”* 这篇文章讲述的是一项研究，研究对象是那些患有恶性间皮瘤（肺癌的一种形式）并且癌症扩散到牙龈的患者。该研究旨在测试不同治疗方法（化疗、切除术和放疗）对癌症的影响。这似乎是一个合适的文章返回——它是关于牙龈肿瘤的，属于口腔肿瘤的一个子集。'
- en: '**Article 2:** *“Myoepithelioma of minor salivary gland origin. Light and electron
    microscopical study.”* This article is about a tumor that was removed from a 14-year-old
    boy’s gum, had spread to part of the upper jaw, and was composed of cells which
    originated in the salivary gland. This also seems like an appropriate article
    to return — it is about a neoplasm that was removed from a boy’s mouth.'
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文章 2：** *“小腺体来源的肌上皮瘤。光学与电子显微镜研究。”* 这篇文章讲述的是一例14岁男孩的肿瘤，该肿瘤从他的牙龈移除，并且扩展到上颌的一部分，且该肿瘤的细胞来源于唾液腺。这个文章似乎也是一个合适的返回——它是关于从男孩的口腔中移除的肿瘤。'
- en: '**Article 3:** *“Metastatic neuroblastoma in the mandible. Report of a case.”*
    This article is a case study of a 5-year-old boy who had cancer in his lower jaw.
    This is about cancer, but technically not mouth cancer — mandibular neoplasms
    (neoplasms in the lower jaw) are not a subset of mouth neoplasms.'
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文章 3：** *“下颌骨的转移性神经母细胞瘤。病例报告。”* 这篇文章是关于一名5岁男孩在下颌骨发现癌症的病例研究。这是关于癌症的，但技术上讲，它不是口腔癌——下颌肿瘤（下颌骨的肿瘤）不是口腔肿瘤的子集。'
- en: This is what we mean by semantic search — none of these articles have the word
    ‘mouth’ anywhere in their titles or abstracts. The first article is about gingival
    (gums) neoplasms, a subset of mouth neoplasms. The second article is about a gingival
    neoplasms that originated in the subject’s salivary gland, both subsets of mouth
    neoplasms. The third article is about mandibular neoplasms — which is, technically,
    according to the MeSH vocabulary **not** a subset of mouth neoplasms. Still, the
    vector database knew that a mandible is close to a mouth.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是我们所说的语义搜索——这些文章的标题或摘要中没有出现“口腔”这个词。第一篇文章是关于牙龈（口腔周围的组织）肿瘤的，它是口腔肿瘤的一种子集。第二篇文章讲述的是一种来源于口腔腺体的牙龈肿瘤，也是口腔肿瘤的子集。第三篇文章是关于下颌肿瘤的——从技术上讲，根据医学主题词（MeSH）词汇表，**这不是**口腔肿瘤的子集。然而，向量数据库知道，下颌骨靠近口腔。
- en: Similarity search using vector database
  id: totrans-73
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用向量数据库进行相似性搜索
- en: 'We can also use the vector database to find similar articles. I chose an article
    that was returned using the mouth neoplasms query above titled, *“Gingival metastasis
    as first sign of multiorgan dissemination of epithelioid malignant mesothelioma.”*
    Using the ID for that article, I can query the vector database for all similar
    entities:'
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 我们还可以使用向量数据库来查找相似的文章。我选择了一篇之前通过口腔肿瘤查询返回的文章，标题为*“牙龈转移作为表皮样恶性间皮瘤多脏器传播的首个信号。”*
    使用该文章的ID，我可以查询向量数据库中所有相似的实体：
- en: '[PRE7]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: The results are ranked in order of similarity. Similarity is calculated as distance
    in the vector space. As you can see, the top result is the Gingival article —
    this article is the most similar article to itself.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 结果按相似度排名。相似度是通过向量空间中的距离计算的。正如你所看到的，排名第一的结果是牙龈文章——这篇文章与其自身最为相似。
- en: 'The other articles are:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 其他文章包括：
- en: '**Article 4***: “Feasability study of screening for malignant lesions in the
    oral cavity targeting tobacco users.”* This is about mouth cancer, but about how
    to get tobacco smokers to sign up for screenings rather than on the ways they
    were treated.'
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第4篇文章**：“针对烟草使用者筛查口腔恶性病变的可行性研究。”* 这篇文章讨论的是口腔癌，但重点是如何让吸烟者参与筛查，而不是他们的治疗方式。'
- en: '**Article 5:** *"Extended Pleurectomy and Decortication for Malignant Pleural
    Mesothelioma Is an Effective and Safe Cytoreductive Surgery in the Elderly."*
    This article is about a study on treating pleural mesothelioma (cancer in the
    lungs) with pleurectomy and decortication (surgery to remove cancer from the lungs)
    in the elderly. So this is similar in that it is about treatments for mesothelioma,
    but not about gingival neoplasms.'
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第5篇文章：** *“扩展性胸膜切除术和剥除术治疗恶性胸膜间皮瘤：老年人有效且安全的细胞减灭手术。”* 这篇文章是关于在老年人中用胸膜切除术和剥除术（手术去除肺部癌症）治疗胸膜间皮瘤（肺部癌症）的一项研究。因此，它在治疗恶性间皮瘤方面类似，但与牙龈肿瘤无关。'
- en: '**Article 3 (from above):** *“Metastatic neuroblastoma in the mandible. Report
    of a case.”* Again, this is the article about the 5-year-old boy who had cancer
    in his lower jaw. This is about cancer, but technically not mouth cancer, and
    this is not really about treatment outcomes like the gingival article.'
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第3篇文章（如上所述）：** *“下颌骨转移性神经母细胞瘤。病例报告。”* 这篇文章讲的是一名5岁男孩下颌骨患癌的案例。虽然它讨论的是癌症，但技术上来说并不是口腔癌，并且它也不像牙龈文章那样聚焦于治疗结果。'
- en: All of these articles, one could argue, are similar to our original gingival
    article. It is difficult to assess how similar they are and to therefore assess
    how well the similarity search performed because that is largely a matter of what
    the user means by similar. Were you interested in other articles about treatments
    for mesothelioma and the fact that the first article is about how it spread to
    the gums is irrelevant? In that case, **Article 5** is the most similar. Or are
    you interested in reducing any type of mouth cancer, whether through treatment
    or prevention? In that case, **Article 4** is the most similar. One drawback of
    the vector database, is that it is a black box — we have no idea why these articles
    were returned.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 可以说，所有这些文章与我们最初的牙龈文章都很相似。很难评估它们的相似度，因此也很难评估相似度搜索的效果，因为这在很大程度上取决于用户对“相似”的定义。你是否对其他关于间皮瘤治疗的文章感兴趣，并且认为第一篇文章关于其如何扩展到牙龈的部分无关紧要？如果是那样的话，**第5篇文章**是最相似的。还是你对任何类型的口腔癌感兴趣，不论是通过治疗还是预防？如果是那样的话，**第4篇文章**是最相似的。向量数据库的一个缺点是，它是一个黑箱——我们无法知道这些文章为何会被返回。
- en: Retrieval-Augmented Generation (RAG) using a vector database
  id: totrans-82
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用向量数据库的检索增强生成（RAG）
- en: Here is how you can use the vector database to retrieve results which are then
    sent to an LLM for summarization — an example of RAG.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是如何使用向量数据库检索结果，并将其发送给大语言模型（LLM）进行总结的过程——这是RAG的一个示例。
- en: '[PRE8]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'You can see the response below:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以看到以下的响应：
- en: '"Sure! This article is talking about a case where a person had a type of cancer
    called epithelioid malignant mesothelioma. This cancer usually starts in the lining
    of the lungs or abdomen. However, in this case, the first sign of the cancer spreading
    to other parts of the body was seen in the gums (gingiva). This is called gingival
    metastasis.\n\nMetastasis means that cancer cells have spread from the original
    tumor to other parts of the body. In this case, the cancer had spread to the gums
    before spreading to other organs. This is important because it shows that the
    cancer was already advanced and had spread to multiple organs before it was even
    detected.\n\nOverall, this article highlights the importance of early detection
    and monitoring of cancer, as well as the potential for cancer to spread to unexpected
    parts of the body."'
  id: totrans-86
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: “当然！这篇文章讲述了一个案例，一名患者患有一种叫做上皮型恶性间皮瘤的癌症。该癌症通常起源于肺部或腹部的衬里。然而，在这种情况下，癌症扩散到身体其他部位的第一个迹象是在牙龈（牙龈）中发现。这被称为牙龈转移。\n\n转移是指癌细胞从原发肿瘤扩散到身体其他部位。在这个案例中，癌症首先扩散到牙龈，然后才扩散到其他器官。这很重要，因为它表明癌症已经很晚期，并且在被发现之前已经扩散到多个器官。\n\n总体而言，这篇文章强调了早期发现和癌症监测的重要性，以及癌症可能扩散到身体意想不到部位的潜力。”
- en: I am actually disappointed by this response. The abstract clearly explains that
    this is a study that follows 13 patients with metastatic malignant mesothelioma
    that underwent different treatments and the outcomes. The RAG output describes
    the article as about ‘a person’ and doesn’t mention the study at all.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 我实际上对这个回应感到失望。摘要明确解释了这是一个跟踪13名接受不同治疗的恶性间皮瘤转移患者及其结果的研究。RAG的输出将文章描述为“一个人”，根本没有提到这项研究。
- en: Rather than just summarize one article, let’s try to summarize several. In this
    next example, we use the same search term as above (Mouth Neoplasms) and then
    send the top three articles along with a prompt, ‘Summarize the key information
    here in bullet points. Make it understandable to someone without a medical degree,’
    to an LLM.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 与其仅仅总结一篇文章，不如尝试总结几篇。在这个例子中，我们使用与上面相同的搜索词（口腔肿瘤），然后将前三篇文章连同一个提示发送给LLM，提示内容是：“以要点形式总结这里的关键信息。让没有医学学位的人也能理解。”
- en: '[PRE9]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'Here are the results:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 这是结果：
- en: '[PRE10]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: This looks better to me than the previous response — it mentions the study conducted
    in **Article 1**, the treatments, and the outcomes. The second to last bullet
    is about the *“Myoepithelioma of minor salivary gland origin. Light and electron
    microscopical study,”* article and seems to be an accurate one line description.
    The final bullet is about **Article 3** referenced above, and, again, seems to
    be an accurate one line description.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 对我来说，这比之前的回应看起来更好——它提到了**文章1**中进行的研究、治疗和结果。倒数第二个要点是关于*“小型唾液腺来源的肌上皮瘤。光学和电子显微镜研究”*的文章，似乎是一个准确的一行描述。最后一个要点是关于上面提到的**文章3**，再次看起来是一个准确的一行描述。
- en: 'Step 2: use a knowledge graph for data retrieval'
  id: totrans-93
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤2：使用知识图谱进行数据检索
- en: 'Here is a high-level overview of how we use a knowledge graph for semantic
    search, similarity search, and RAG:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是我们如何使用知识图谱进行语义搜索、相似性搜索和RAG的高级概览：
- en: '![](../Images/7625e519cdfa5e2d9290ba765ec43526.png)'
  id: totrans-95
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/7625e519cdfa5e2d9290ba765ec43526.png)'
- en: Image by author
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 图片由作者提供
- en: The first step of using a knowledge graph to retrieve your data is to turn your
    data into RDF format. The code below creates classes and properties for all of
    the data types, and then populates it with instances of articles and MeSH terms.
    I have also created properties for date published and access level and populated
    them with random values just as a demonstration.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 使用知识图谱检索数据的第一步是将数据转换为RDF格式。下面的代码为所有数据类型创建类和属性，然后使用文章和MeSH术语的实例填充数据。我还创建了发布日期和访问级别的属性，并用随机值填充它们，作为演示。
- en: '[PRE11]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Semantic search using a knowledge graph
  id: totrans-99
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用知识图谱进行语义搜索
- en: Now we can test semantic search. The word semantic is slightly different in
    the context of knowledge graphs, however. In the knowledge graph, we are relying
    on the tags associated with the documents and their relationships in the MeSH
    taxonomy for the semantics. For example, an article might be about Salivary Neoplasms
    (cancer in the salivary glands) but still be tagged with the term Mouth Neoplasms.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以测试语义搜索。然而，“语义”这个词在知识图谱的语境中略有不同。在知识图谱中，我们依赖于与文档关联的标签以及它们在MeSH分类法中的关系来表示语义。例如，一篇文章可能是关于唾液腺肿瘤（唾液腺的癌症），但仍然被标记为“口腔肿瘤”。
- en: Rather than query all articles tagged with Mouth Neoplasms, we will also look
    for any concept narrower than Mouth Neoplasms. The MeSH vocabulary contains definitions
    of terms but it also contains relationships like broader and narrower.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 我们不仅查询所有标记为“口腔肿瘤”的文章，还会查找任何比“口腔肿瘤”更狭义的概念。MeSH词汇表包含术语的定义，也包含类似“更广义”和“更狭义”的关系。
- en: '[PRE12]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Below are all of the alternative names and narrower concepts for Mouth Neoplasms.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是“口腔肿瘤”的所有替代名称和更狭义的概念。
- en: '![](../Images/1c30892d8e9629891ef3cf1da34f904c.png)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1c30892d8e9629891ef3cf1da34f904c.png)'
- en: Image by author
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 作者提供的图片
- en: 'We turn this into a flat list of terms:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将其转换为一个平面术语列表：
- en: '[PRE13]'
  id: totrans-107
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'Then we turn the terms into MeSH URIs so we can incorporate them into our SPARQL
    query:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们将这些术语转化为MeSH URI，以便将其纳入我们的SPARQL查询中：
- en: '[PRE14]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'Then we write a SPARQL query to find all articles that are tagged with ‘Mouth
    Neoplasms’, its alternative name, ‘Cancer of Mouth,’ or any of the narrower terms:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们编写一个SPARQL查询，查找所有标记为“口腔肿瘤”、其替代名称“口腔癌”或任何更狭义术语的文章：
- en: '[PRE15]'
  id: totrans-111
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'The articles returned are:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 返回的文章包括：
- en: '**Article 2 (from above):** *“Myoepithelioma of minor salivary gland origin.
    Light and electron microscopical study.”*'
  id: totrans-113
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第二篇文章（见上文）：** *“小唾液腺来源的肌上皮瘤。光学显微镜和电子显微镜研究。”*'
- en: '**Article 4 (from above):** “Feasability study of screening for malignant lesions
    in the oral cavity targeting tobacco users.”'
  id: totrans-114
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第四篇文章（见上文）：** “针对烟草使用者筛查口腔恶性病变的可行性研究。”'
- en: '**Article 6:** *“Association between expression of embryonic lethal abnormal
    vision-like protein HuR and cyclooxygenase-2 in oral squamous cell carcinoma.”*
    This article is about a study to determine whether the presence of a protein called
    HuR is linked to a higher level of cyclooxygenase-2, which plays a role in cancer
    development and the spread of cancer cells. Specifically, the study was focused
    on oral squamous cell carcinoma, a type of mouth cancer.'
  id: totrans-115
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第六篇文章：** *“胚胎致死异常视蛋白HuR与口腔鳞状细胞癌中环氧合酶-2表达的关系。”* 这篇文章是一项研究，旨在确定名为HuR的蛋白质是否与环氧合酶-2的高水平有关，后者在癌症的发展和癌细胞的扩散中起着作用。具体来说，这项研究关注的是口腔鳞状细胞癌，这是一种口腔癌。'
- en: These results are not dissimilar to what we got from the vector database. Each
    of these articles is about mouth neoplasms. What is nice about the knowledge graph
    approach is that we do get explainability — we know exactly why these articles
    were chosen. Article 2 is tagged with “Gingival Neoplasms”, and “Salivary Gland
    Neoplasms.” Articles 4 and 6 are both tagged with “Mouth Neoplasms.” Since Article
    2 is tagged with 2 matching terms from our search terms, it is ranked highest.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 这些结果与我们从向量数据库中获得的结果相似。每一篇文章都涉及口腔肿瘤。知识图谱方法的优点是我们能够获得可解释性——我们确切知道为什么这些文章被选中。文章2标记了“牙龈肿瘤”和“唾液腺肿瘤”。文章4和6都标记了“口腔肿瘤”。由于文章2标记了我们搜索术语中的两个匹配术语，它排名最高。
- en: Similarity search using a knowledge graph
  id: totrans-117
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用知识图谱进行相似性搜索
- en: 'Rather than using a vector space to find similar articles, we can rely on the
    tags associated with articles. There are different ways of doing similarity using
    tags, but for this example, I will use a common method: Jaccard Similarity. We
    will use the gingival article again for comparison across methods.'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 与其使用向量空间查找相似文章，我们可以依赖与文章相关联的标签。使用标签进行相似性匹配有多种方法，但在这个例子中，我将使用一种常见的方法：Jaccard相似度。我们将再次使用牙龈文章来进行不同方法之间的比较。
- en: '[PRE16]'
  id: totrans-119
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'The results are below. Since we are searching on the Gingival article again,
    that is the most similar article, which is what we would expect. The other results
    are:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下。由于我们再次搜索了关于牙龈的文章，它是最相似的文章，这也是我们预期的。其他结果包括：
- en: '**Article 7:** *“Calcific tendinitis of the vastus lateralis muscle. A report
    of three cases.”* This article is about calcific tendinitis (calcium deposits
    forming in tendons) in the vastus lateralis muscle (a muscle in the thigh). This
    has nothing to do with mouth neoplasms.'
  id: totrans-121
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第七篇文章：** *“股外侧肌的钙化性肌腱炎。三例报告。”* 这篇文章讲述的是股外侧肌（大腿的肌肉）中的钙化性肌腱炎（肌腱中钙质沉积）。这与口腔肿瘤无关。'
- en: '**Overlapping terms:** Tomography, Aged, Male, Humans, X-Ray computed'
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**重叠术语：** 断层扫描、老年、男性、人类、X射线计算机断层扫描'
- en: '**Article 8:** *“What is the optimal duration of androgen deprivation therapy
    in prostate cancer patients presenting with prostate specific antigen levels.”*
    This article is about how long prostate cancer patients should receive a specific
    treatment (androgen deprivataion therapy). This is about a treatment for cancer
    (radiotherapy), but not mouth cancer.'
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文章8：** *“前列腺癌患者在出现前列腺特异性抗原水平时，雄激素剥夺治疗的最佳持续时间是什么？”* 这篇文章讨论了前列腺癌患者应该接受多长时间的特定治疗（雄激素剥夺治疗）。这是一种癌症治疗（放射疗法），但与口腔癌无关。'
- en: '**Overlapping terms:** Radiotherapy, Aged, Male, Humans, Adjuvant'
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**重叠术语：** 放射疗法、老年、男性、人类、辅助治疗'
- en: '**Article 9:** *CT scan cerebral hemisphere asymmetries: predictors of recovery
    from aphasia.* This article is about how differences between the left and right
    sides of the brain (cerebral hemisphere assymetries) might predict how well someone
    recovers from aphasia after a stroke.'
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文章9：** *CT扫描脑半球不对称性：预测失语症恢复的因素*。这篇文章讨论了大脑左右半球的差异（脑半球不对称性）如何预测中风后失语症患者的恢复情况。'
- en: '**Overlapping terms:** Tomography, Aged, Male, Humans, X-Ray Computed'
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**重叠术语：** 断层扫描、老年、男性、人类、X射线计算机断层扫描'
- en: The best part of this method is that, because of the way we are calculating
    similarity here, we can see WHY the other articles are similar — we see exactly
    which terms are overlapping i.e. which terms are common on the Gingival article
    and each of the comparisons.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 这种方法最好的部分是，由于我们在这里计算相似度的方式，我们可以看到为什么其他文章是相似的——我们可以准确地看到哪些术语是重叠的，即哪些术语在牙龈文章和每篇对比文章中是共同的。
- en: The downside of explainability is that we can see that these do not seem like
    the most similar articles, given the previous results. They all have three terms
    in common (Aged, Male, and Humans) that are probably not nearly as relevant as
    Treatment Options or Mouth Neoplasms. You could re-calculate using some weight
    based on the prevalence of the term across the corpus — Term Frequency-Inverse
    Document Frequency (TF-IDF) — which would probably improve the results. You could
    also select the tagged terms that are most relevant for you when conducting similarity
    for more control over the results.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 可解释性的缺点是，我们可以看到这些文章似乎不是最相似的，考虑到之前的结果。它们都在三个术语（老年、男性和人类）上有共同之处，但这些术语可能远没有“治疗方案”或“口腔肿瘤”那么相关。你可以重新计算，基于术语在语料库中的出现频率来加权——即“词频-逆文档频率”（TF-IDF），这可能会改善结果。你也可以选择在进行相似性计算时最相关的标记术语，从而对结果进行更多控制。
- en: The biggest downside of using Jaccard similarity on terms in a knowledge graph
    for calculating similarity is the computational efforts — it took like 30 minutes
    to run this one calculation.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Jaccard相似性计算知识图谱中术语相似度的最大缺点是计算工作量——运行这个计算大约花了30分钟。
- en: RAG using a knowledge graph
  id: totrans-130
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用知识图谱的RAG
- en: We can also do RAG using just the knowledge graph for the retrieval part. We
    already have a list of articles about mouth neoplasms saved as results from the
    semantic search above. To implement RAG, we just want to send these articles to
    an LLM and ask it to summarize the results.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 我们也可以仅使用知识图谱来进行RAG的检索部分。我们已经有了一份关于口腔肿瘤的文章列表，这些文章是从上述语义搜索中保存下来的结果。要实现RAG，我们只需要将这些文章发送给LLM，并要求它总结这些结果。
- en: 'First we combine the titles and abstracts for each of the articles into one
    big chunk of text called combined_text:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们将每篇文章的标题和摘要合并成一个大的文本块，称为combined_text：
- en: '[PRE17]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'We then set up a client so that we can send this text directly to an LLM:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们设置一个客户端，以便可以将这个文本直接发送给LLM：
- en: '[PRE18]'
  id: totrans-135
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'Then we give the context and the prompt to the LLM:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 然后我们将上下文和提示发送给LLM：
- en: '[PRE19]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: 'The results look as follows:'
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下所示：
- en: '[PRE20]'
  id: totrans-139
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: The results look good i.e. it is a good summary of the three articles that were
    returned from the semantic search. The quality of the response from a RAG application
    using a KG alone is a function of the ability of your KG to retrieve relevant
    documents. As seen in this example, if your prompt is simple enough, like, “summarize
    the key information here,” then the hard part is the retrieval (giving the LLM
    the correct articles as context), not in generating the response.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 结果看起来不错，即它很好地总结了从语义搜索返回的三篇文章。仅使用知识图谱（KG）的RAG应用程序的响应质量取决于你的知识图谱检索相关文档的能力。正如这个例子所示，如果你的提示足够简单，比如“总结这里的关键信息”，那么难点就在于检索（将正确的文章作为上下文提供给LLM），而不是生成响应。
- en: 'Step 3: use a vectorized knowledge graph to test data retrieval'
  id: totrans-141
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤3：使用向量化知识图谱测试数据检索
- en: Now we want to combine forces. We will add a URIs to each article in the database
    and then create a new collection in Weaviate where we vectorize the article name,
    abstract, the MeSH terms associated with it, as well as the URI. The URI is a
    unique identifier for the article and a way for us to connect back to the knowledge
    graph.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们要联合各方力量。我们将在数据库中的每篇文章添加一个 URI，然后在 Weaviate 中创建一个新的集合，将文章的名称、摘要、相关的 MeSH
    术语以及 URI 向量化。URI 是文章的唯一标识符，是我们将其与知识图谱连接的方式。
- en: 'First we add a new column in the data for the URI:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们在数据中为 URI 添加了一个新列：
- en: '[PRE21]'
  id: totrans-144
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Now we create a new schema for the new collection with the additional fields:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们为新集合创建一个包含附加字段的新架构：
- en: '[PRE22]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Push that schema to the vector database:'
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 将该架构推送到向量数据库：
- en: '[PRE23]'
  id: totrans-148
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: 'Now we vectorize the data into the new collection:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们将数据向量化到新集合中：
- en: '[PRE24]'
  id: totrans-150
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: Semantic search with a vectorized knowledge graph
  id: totrans-151
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用向量化的知识图谱进行语义搜索
- en: Now we can do semantic search over the vector database, just like before, but
    with more explainability and control over the results.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以像之前一样在向量数据库上进行语义搜索，但具有更好的可解释性和对结果的控制。
- en: '[PRE25]'
  id: totrans-153
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'The results are:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 结果是：
- en: '**Article 1:** "Gingival metastasis as first sign of multiorgan dissemination
    of epithelioid malignant mesothelioma."'
  id: totrans-155
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文章 1：** "牙龈转移作为上皮样恶性间皮瘤多脏器扩散的首个迹象。"'
- en: '**Article 10:** *"Angiocentric Centrofacial Lymphoma as a Challenging Diagnosis
    in an Elderly Man."* This article is about how it was challenging to diagnose
    a man with nasal cancer.'
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文章 10：** *"血管中心性中央面部淋巴瘤：一位老年男性的挑战性诊断。"* 这篇文章讲述了如何诊断一名鼻癌患者。'
- en: '**Article 11:** *"Mandibular pseudocarcinomatous hyperplasia."* This is a very
    hard article for me to decipher but I believe it is about how pseudocarcinomatous
    hyperplasia can look like cancer (hence the pseuo in the name), but that is non-cancerous.
    While it does seem to be about mandibles, it is tagged with the MeSH term “Mouth
    Neoplasms”.'
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文章 11：** *"下颌假性癌性增生。"* 这篇文章对我来说非常难以理解，但我认为它讨论了假性癌性增生如何看起来像癌症（因此名称中有“假性”一词），但实际上并不是癌症。虽然它似乎确实与下颌有关，但它被标记为
    MeSH 术语“口腔肿瘤”。'
- en: It is hard to say whether these results are better or worse than the KG or the
    vector database alone. In theory, the results should be better because the MeSH
    terms associated with each article are now vectorized alongside the articles.
    We are not really vectorizing the knowledge graph, however. The relationships
    between the MeSH terms, for example, are not in the vector database.
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
  zh: 很难说这些结果比单独使用知识图谱或向量数据库的结果更好还是更差。从理论上讲，结果应该更好，因为每篇文章相关的 MeSH 术语现在和文章一起被向量化。然而，我们并没有真正对知识图谱进行向量化。例如，MeSH
    术语之间的关系并没有被包含在向量数据库中。
- en: 'What is nice about having the MeSH terms vectorized is that there is some explainability
    right away — Article 11 is also tagged with Mouth Neoplasms, for example. But
    what is really cool about having the vector database connected to the knowledge
    graph is that we can apply any filters we want from the knowledge graph. Remember
    how we added in date published as a field in the data earlier? We can now filter
    on that. Suppose we want to find articles about mouth neoplasms published after
    May 1st, 2020:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 拥有 MeSH 术语向量化的好处是，可以立即得到一些可解释性——例如，文章 11 也标记了“口腔肿瘤”这一 MeSH 术语。但将向量数据库与知识图谱连接的真正酷的地方在于，我们可以从知识图谱中应用任何我们想要的过滤器。记得我们之前在数据中添加了“发布日期”作为字段吗？现在我们可以基于此进行过滤。假设我们想要找到
    2020 年 5 月 1 日之后发布的关于口腔肿瘤的文章：
- en: '[PRE26]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'The originally query returned ten results (we gave it a max of ten) but only
    six of these were published after Jan 1st, 2023\. See the results below:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 原始查询返回了十个结果（我们设置的最大值是十个），但其中只有六篇是在 2023 年 1 月 1 日之后发布的。请参见下面的结果：
- en: '![](../Images/ada8d32d499aa914c3251e746b68c4c5.png)'
  id: totrans-162
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/ada8d32d499aa914c3251e746b68c4c5.png)'
- en: Image by author
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 图片来源：作者
- en: Similarity search using a vectorized knowledge graph
  id: totrans-164
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 使用向量化的知识图谱进行相似度搜索
- en: 'We can run a similarity search on this new collection just like we did before
    on our gingival article (Article 1):'
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以像之前对我们的牙龈文章（文章 1）所做的那样，在这个新集合上运行相似度搜索：
- en: '[PRE27]'
  id: totrans-166
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'The results are below:'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 结果如下：
- en: '**Article 3:** *"Metastatic neuroblastoma in the mandible. Report of a case."*'
  id: totrans-168
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文章 3：** *"下颌的转移性神经母细胞瘤。案例报告。"*'
- en: '**Article 4:** *“Feasability study of screening for malignant lesions in the
    oral cavity targeting tobacco users.”*'
  id: totrans-169
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文章 4：** *“针对烟草使用者进行口腔恶性病变筛查的可行性研究。”*'
- en: '**Article 12:** *“Diffuse intrapulmonary malignant mesothelioma masquerading
    as interstitial lung disease: a distinctive variant of mesothelioma.*” This article
    is about five male patients with a form of mesothelioma that looks a lot like
    another lung disease: interstitial lung disease.'
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第12篇文章：** *“弥漫性肺内恶性间皮瘤伪装为间质性肺病：一种独特的间皮瘤变异。”* 本文讲述了五名男性患者患有一种间皮瘤，这种间皮瘤看起来像另一种肺病：间质性肺病。'
- en: Since we have the MeSH tagged vectorized, we can see the tags associated with
    each article. Some of them, while perhaps similar in some respects, are not about
    mouth neoplasms. Suppose we want to find articles similar to our gingival article,
    but specifically about mouth neoplasms. We can now combine the SPARQL filtering
    we did with the knowledge graph earlier on these results.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 由于我们已经对MeSH标签进行了向量化处理，因此可以查看与每篇文章关联的标签。其中一些文章虽然在某些方面可能相似，但并非关于口腔肿瘤。假设我们希望找到与我们的牙龈文章相似的文章，但特别是关于口腔肿瘤的。现在我们可以将之前在知识图谱中应用的SPARQL过滤器与这些结果结合使用。
- en: 'The MeSH URIs for the synonyms and narrower concepts of Mouth Neoplasms is
    already saved, but do need the URIs for the 50 articles returned by the vector
    search:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 口腔肿瘤的同义词和更窄概念的MeSH URI已经保存，但仍需要为通过向量搜索返回的50篇文章提供URI：
- en: '[PRE28]'
  id: totrans-173
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: Now we can rank the results based on the tags, just like we did before for semantic
    search using a knowledge graph.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们可以根据标签对结果进行排名，就像我们之前使用知识图谱进行语义搜索时那样。
- en: '[PRE29]'
  id: totrans-175
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: Of the 50 articles originally returned by the vector database, only five of
    them are tagged with Mouth Neoplasms or a related concept.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 在原本由向量数据库返回的50篇文章中，只有5篇标记为口腔肿瘤或相关概念。
- en: '**Article 2:** *“Myoepithelioma of minor salivary gland origin. Light and electron
    microscopical study.”* Tagged with: Gingival Neoplasms, Salivary Gland Neoplasms'
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第2篇文章：** *“小唾液腺起源的肌上皮瘤。光学和电子显微镜研究。”* 标签：牙龈肿瘤、唾液腺肿瘤'
- en: '**Article 4:** *“Feasability study of screening for malignant lesions in the
    oral cavity targeting tobacco users.”* Tagged with: Mouth Neoplasms'
  id: totrans-178
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第4篇文章：** *“针对烟草用户的口腔恶性病变筛查可行性研究。”* 标签：口腔肿瘤'
- en: '**Article 13:** *“Epidermoid carcinoma originating from the gingival sulcus.”*
    This article describes a case of gum cancer (gingival neoplasms). Tagged with:
    Gingival Neoplasms'
  id: totrans-179
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第13篇文章：** *“起源于牙龈沟的表皮样癌。”* 本文描述了一个牙龈癌的病例（牙龈肿瘤）。标签：牙龈肿瘤'
- en: '**Article 1: *“****Gingival metastasis as first sign of multiorgan dissemination
    of epithelioid malignant mesothelioma.”* Tagged with: Gingival Neoplasms'
  id: totrans-180
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第1篇文章：** *“****牙龈转移作为上皮样恶性间皮瘤多脏器扩散的首个征兆。”* 标签：牙龈肿瘤'
- en: '**Article 14:** *“Metastases to the parotid nodes: CT and MR imaging findings.”*
    This article is about neoplasms in the parotid glands, major salivary glands.
    Tagged with: Parotid Neoplasms'
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第14篇文章：** *“腮腺淋巴结转移：CT和MR影像学发现。”* 本文讲述了腮腺肿瘤，即主要的唾液腺肿瘤。标签：腮腺肿瘤'
- en: 'Finally, suppose we want to serve these similar articles to a user as a recommendation,
    but we only want to recommend the articles that that user has access to. Suppose
    we know that this user can only access articles tagged with access levels 3, 5,
    and 7\. We can apply a filter in our knowledge graph using a similar SPARQL query:'
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，假设我们希望向用户推荐这些相似的文章，但我们只想推荐该用户可以访问的文章。假设我们知道该用户只能访问标记为访问级别3、5和7的文章。我们可以在知识图谱中使用类似的SPARQL查询应用过滤器：
- en: '[PRE30]'
  id: totrans-183
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: 'There was one article that the user did not have access to. The four remaining
    articles are:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 有一篇文章用户无法访问。剩余的四篇文章是：
- en: '**Article 2:** *“Myoepithelioma of minor salivary gland origin. Light and electron
    microscopical study.”* Tagged with: Gingival Neoplasms, Salivary Gland Neoplasms.
    Access level: 5'
  id: totrans-185
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第2篇文章：** *“小唾液腺起源的肌上皮瘤。光学和电子显微镜研究。”* 标签：牙龈肿瘤、唾液腺肿瘤。访问级别：5'
- en: '**Article 4:** *“Feasability study of screening for malignant lesions in the
    oral cavity targeting tobacco users.”* Tagged with: Mouth Neoplasms. Access level:
    7'
  id: totrans-186
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第4篇文章：** *“针对烟草用户的口腔恶性病变筛查可行性研究。”* 标签：口腔肿瘤。访问级别：7'
- en: '**Article 1: *“****Gingival metastasis as first sign of multiorgan dissemination
    of epithelioid malignant mesothelioma.”* Tagged with: Gingival Neoplasms. Access
    level: 3'
  id: totrans-187
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第1篇文章：** *“****牙龈转移作为上皮样恶性间皮瘤多脏器扩散的首个征兆。”* 标签：牙龈肿瘤。访问级别：3'
- en: '**Article 14:** *“Metastases to the parotid nodes: CT and MR imaging findings.”*
    This article is about neoplasms in the parotid glands, major salivary glands.
    Tagged with: Parotid Neoplasms. Access level: 3'
  id: totrans-188
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文章 14：** *“腮腺淋巴结转移：CT和MRI影像学发现。”* 这篇文章讨论的是腮腺肿瘤，腮腺是主要的唾液腺。标签：腮腺肿瘤。访问级别：3'
- en: RAG with a vectorized knowledge graph
  id: totrans-189
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 带有向量化知识图谱的RAG
- en: 'Finally, let’s see how RAG works once we combine a vector database with a knowledge
    graph. As a reminder, you can run RAG directly against the vector database and
    send it to an LLM to get a generated response:'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，让我们看看当我们将向量数据库与知识图谱结合时，RAG是如何工作的。提醒一下，您可以直接对向量数据库运行RAG，并将其发送给LLM以获取生成的响应：
- en: '[PRE31]'
  id: totrans-191
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'In this example, I am using the search term, ‘therapies for mouth neoplasms,’
    with the same prompt, ‘Summarize the key information here in bullet points. Make
    it understandable to someone without a medical degree.’ We are only returning
    the top three articles to generate this response. Here are the results:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个例子中，我使用了搜索词“口腔肿瘤的治疗方法”，并使用相同的提示“总结出关键的要点，以项目符号的形式呈现。使其对没有医学学位的人也能理解。”我们仅返回排名前三的文章来生成此响应。以下是结果：
- en: '[PRE32]'
  id: totrans-193
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'As a test, we can see exactly which three articles were chosen:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 作为测试，我们可以确切看到选择了哪三篇文章：
- en: '[PRE33]'
  id: totrans-195
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: Interestingly, the first article is about gingival neoplasms, which is a subset
    of mouth neoplasms, but the second article is about rectal cancer, and the third
    is about nasopharyngeal cancer. They are about therapies for cancers, just not
    the kind of cancer I searched for. What is concerning is that the prompt was,
    “therapies for mouth neoplasms” and the results contain information about therapies
    for other kinds of cancer. This is what is sometimes called ‘context poisoning’
    — irrelevant or misleading information is getting injected into the prompt which
    leads to misleading responses from the LLM.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 有趣的是，第一篇文章讨论的是牙龈肿瘤，这是口腔肿瘤的一个子集，但第二篇文章是关于直肠癌的，第三篇是关于鼻咽癌的。它们是关于癌症治疗的，只不过不是我搜索的那种癌症。令人担忧的是，提示是“口腔肿瘤的治疗方法”，而结果却包含了其他类型癌症的治疗信息。这有时被称为‘上下文污染’——无关或误导性的信息被注入到提示中，导致LLM给出误导性的回应。
- en: 'We can use the KG to address the context poisoning. Here is a diagram of how
    the vector database and the KG can work together for a better RAG implementation:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以使用KG来解决上下文污染问题。以下是向量数据库和KG如何协同工作以实现更好的RAG实现的示意图：
- en: '![](../Images/0d64f10c44a2ffa30daa4a207c094e12.png)'
  id: totrans-198
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/0d64f10c44a2ffa30daa4a207c094e12.png)'
- en: Image by author
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 作者提供的图片
- en: 'First, we run a semantic search on the vector database using the same prompt:
    therapies for mouth cancer. I’ve upped the limit to 20 articles this time since
    we are going to filter some out.'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们使用相同的提示对向量数据库进行语义搜索：口腔癌的治疗方法。这次我将限制增加到了20篇文章，因为我们将会过滤掉一些。
- en: '[PRE34]'
  id: totrans-201
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: 'Next we use the same sorting technique as before, using the Mouth Neoplasms
    related concepts:'
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们使用与之前相同的排序技术，利用与口腔肿瘤相关的概念：
- en: '[PRE35]'
  id: totrans-203
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'There are only three articles that are tagged with one of the Mouth Neoplasms
    terms:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
  zh: 只有三篇文章被标记为与口腔肿瘤相关的术语：
- en: '**Article 4:** *“Feasability study of screening for malignant lesions in the
    oral cavity targeting tobacco users.”* Tagged with: Mouth Neoplasms.'
  id: totrans-205
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文章 4：** *“针对烟草使用者进行口腔恶性病变筛查的可行性研究。”* 标签：口腔肿瘤。'
- en: '**Article 15:** *“Photofrin-mediated photodynamic therapy of chemically-induced
    premalignant lesions and squamous cell carcinoma of the palatal mucosa in rats.”*
    This article is about an experimental cancer therapy (photodynamic therapy) for
    palatal cancer tested on rats. Tagged with: Palatal Neoplasms.'
  id: totrans-206
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文章 15：** *“光敏剂介导的光动力治疗化学诱导的口腔粘膜前癌病变及口腔鳞状细胞癌。”* 这篇文章讨论的是一种针对口腔癌的实验性癌症治疗方法（光动力治疗），并在大鼠身上进行了测试。标签：口腔腺瘤。'
- en: '**Article 1:** *“Gingival metastasis as first sign of multiorgan dissemination
    of epithelioid malignant mesothelioma.”* Tagged with: Gingival Neoplasms.'
  id: totrans-207
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**文章 1：** *“牙龈转移作为上皮样恶性间皮瘤多脏器扩散的首个标志。”* 标签：牙龈肿瘤。'
- en: 'Let’s send these to the LLM to see if the results improve:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们把这些发送给LLM看看结果是否有所改善：
- en: '[PRE36]'
  id: totrans-209
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'Here are the results:'
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是结果：
- en: '[PRE37]'
  id: totrans-211
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: We can definitely see an improvement — these results are not about rectal cancer
    or nasopharyngeal neoplasms. This looks like a relatively accurate summary of
    the three articles selected, which are about therapies for mouth neoplasms
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 我们确实看到了一些改进——这些结果与直肠癌或鼻咽肿瘤无关。这看起来像是对所选三篇文章的一个相对准确的总结，三篇文章都涉及口腔肿瘤的治疗方法。
- en: Conclusions
  id: totrans-213
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 结论
- en: Overall, vector databases are great at getting search, similarity (recommendation),
    and RAG applications up and running quickly. There is little overhead required.
    If you have unstructured data associated with your structured data, like in this
    example of journal articles, it can work well. This would not work nearly as well
    if we didn’t have article abstracts as part of the dataset, for example.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 总的来说，向量数据库在快速启动搜索、相似性（推荐）和RAG应用程序方面表现优秀。几乎不需要额外的开销。如果你的结构化数据中关联了非结构化数据，比如在这个期刊文章的例子中，它也能很好地工作。例如，如果我们没有将文章摘要作为数据集的一部分，这种方法就不太奏效了。
- en: KGs are great for accuracy and control. If you want to be sure that the data
    going into your search application is ‘right,’ and by ‘right’ I mean whatever
    you decide based on your needs, then a KG is going to be needed. KGs can work
    well for search and similarity, but the degree to which they will meet your needs
    will depend on the richness of your metadata, and the quality of the tagging.
    Quality of tagging might also mean different things depending on your use case
    — the way you build and apply a taxonomy to content might look different if you’re
    building a recommendation engine rather than a search engine.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 知识图谱（KG）在准确性和控制方面非常有效。如果你想确保进入搜索应用程序的数据是“正确的”，而这里的“正确”是指根据你的需求所决定的内容，那么就需要使用知识图谱。知识图谱对于搜索和相似性工作效果良好，但它们能满足需求的程度将取决于元数据的丰富性以及标签的质量。标签质量的定义也可能因使用场景不同而有所不同——例如，如果你构建的是推荐引擎而非搜索引擎，构建和应用分类法的方式可能会有所不同。
- en: 'Using a KG to filter results from a vector database leads to the best results.
    This is not surprising — I am using the KG to filter out irrelevant or misleading
    results **as determined by me**, so of course the results are better, according
    to me. But that’s the point: it’s not that the KG necessarily improves results
    by itself, it’s that the KG provides you the ability to control the output to
    optimize your results.'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 使用知识图谱过滤向量数据库的结果可以得到最佳效果。这并不令人惊讶——我使用知识图谱来过滤掉**由我自己决定的**无关或误导性结果，因此根据我的标准，结果自然会更好。但重点在于：并不是说知识图谱本身一定能改善结果，而是知识图谱为你提供了控制输出的能力，从而优化结果。
