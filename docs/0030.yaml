- en: On the Statistical Analysis of Rounded or Binned Data
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/on-the-statistical-analysis-of-rounded-or-binned-data-e24147a12fa0?source=collection_archive---------17-----------------------#2024-01-04](https://towardsdatascience.com/on-the-statistical-analysis-of-rounded-or-binned-data-e24147a12fa0?source=collection_archive---------17-----------------------#2024-01-04)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Sheppard’s corrections offer approximations, but errors persist. Analytical
    bounds provide insight into the magnitude of these errors
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@mplaue?source=post_page---byline--e24147a12fa0--------------------------------)[![Matthias
    Plaue](../Images/3663c89478e6acf276002dad0a5d1ea4.png)](https://medium.com/@mplaue?source=post_page---byline--e24147a12fa0--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--e24147a12fa0--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--e24147a12fa0--------------------------------)
    [Matthias Plaue](https://medium.com/@mplaue?source=post_page---byline--e24147a12fa0--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--e24147a12fa0--------------------------------)
    ·9 min read·Jan 4, 2024
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/c093b820f3535d3863bac1d63c20a74d.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [charlesdeluvio](https://unsplash.com/@charlesdeluvio?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: Imagine having a list of length measurements in inches, precise to the inch.
    This list might represent, for instance, the heights of individuals participating
    in a medical study, forming a sample from a cohort of interest. Our goal is to
    estimate the average height within this cohort.
  prefs: []
  type: TYPE_NORMAL
- en: 'Consider an arithmetic mean of 70.08 inches. The crucial question is: How accurate
    is this figure? Despite a large sample size, the reality is that each individual
    measurement is only precise up to the inch. Thus, even with abundant data, we
    might cautiously assume that the true average height falls within the range of
    69.5 inches to 70.5 inches, and round the value to 70 inches.'
  prefs: []
  type: TYPE_NORMAL
- en: 'This isn’t merely a theoretical concern easily dismissed. Take, for instance,
    determining the average height in metric units. One inch equals exactly 2.54 centimeters,
    so we can easily convert the measurements from inches to the finer centimeter
    scale, and compute the mean. Yet, considering the inch-level accuracy, we can
    only confidently assert that the average height lies somewhere between 177 cm
    and 179 cm. The question arises: Can we confidently conclude that the average
    height is *precisely* 178 cm?'
  prefs: []
  type: TYPE_NORMAL
- en: Rounding errors or [quantization errors](https://en.wikipedia.org/wiki/Quantization_(signal_processing))
    can have [enormous consequences](https://slate.com/technology/2019/10/round-floor-software-errors-stock-market-battlefield.html)—
    such as changing the [outcome of elections](https://catless.ncl.ac.uk/Risks/13/37#subj4),
    or changing the course of a ballistic missile, leading to [accidental death and
    injury](https://www-users.cse.umn.edu/~arnold/disasters/patriot.html). How rounding
    errors affect statistical analyses is a non-trivial inquiry that we aim to elucidate
    in this article.
  prefs: []
  type: TYPE_NORMAL
- en: Sheppard’s corrections
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Suppose that we observe values produced by a continuous random variable ***X***
    that have been rounded, or binned*.* These observations follow the distribution
    of a discrete random variable ***Y*** defined by:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/cf954df685039f9c1e28372b1c1e02d2.png)'
  prefs: []
  type: TYPE_IMG
- en: where ***h*** is the bin width and ⌊ ⋅ ⌋ denotes the floor function. For example,
    ***X*** could generate length measurements. Since rounding is not an invertible
    operation, reconstructing the original data from the rounded values alone is impossible.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following approximations relate the mean and the variance of these distributions,
    known as [Sheppard’s corrections](https://en.wikipedia.org/wiki/Sheppard%27s_correction)
    [[Sheppard 1897](https://doi.org/10.1112/plms/s1-29.1.353)]:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0339fa02c499f3eaf4c6c2cefca7ecda.png)'
  prefs: []
  type: TYPE_IMG
- en: For example, if we are given measurements rounded to the inch, ***h*** = 2.54
    cm, and observe a standard deviation of 10.0 cm, Sheppard’s second moment correction
    asks us to assume that the original data have in fact a smaller standard deviation
    of **σ** = 9.97 cm. For many practical purposes, the correction is very small.
    Even if the standard deviation is of similar magnitude as the bin width, the correction
    only amounts to 5% of the original value.
  prefs: []
  type: TYPE_NORMAL
- en: 'Sheppard’s corrections can be applied if the following conditions hold [[Kendall
    1938](https://doi.org/10.2307/2980630), [Heitjan 1989](https://doi.org/10.1214/ss/1177012601)]:'
  prefs: []
  type: TYPE_NORMAL
- en: the probability density function of ***X*** is sufficiently smooth and its derivatives
    tend to zero at its tails,
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: the bin width ***h*** is not too large (***h*** < 1.6 **σ**),
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: the sample size ***N*** is not too small and not too large (5 < ***N*** < 100).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The first two requirements present as the typical “no free lunch” situation
    in statistical inference: in order to check whether these conditions hold, we
    would have to know the true distribution in the first place. The first of these
    conditions, in particular, is a local condition in the sense that it involves
    derivatives of the density which we cannot robustly estimate given only the rounded
    or binned data.'
  prefs: []
  type: TYPE_NORMAL
- en: The requirement on the sample size not being too *large* does not mean that
    the propagation of rounding errors becomes less controllable (in absolute value)
    with large sample size. Instead, it addresses the situation where Sheppard’s corrections
    may cease to be adequate when attempting to compare the bias introduced by rounding/binning
    with the diminishing standard error in larger samples.
  prefs: []
  type: TYPE_NORMAL
- en: Total variation bounds on the rounding error in estimating the mean
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Sheppard’s corrections are only approximations. For example, in general, the
    bias in estimating the mean, *E*[***Y***] - *E*[***X***], is in fact non-zero.
    We want to compute some upper bounds on the absolute value of this bias. The simplest
    bound is a result of the monotonicity of the expected value, and the fact that
    rounding/binning can change the values by at most ***h*** / 2:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/472e10acdf4f0952be7b6326b878a685.png)'
  prefs: []
  type: TYPE_IMG
- en: 'With no additional information on the distribution of ***X*** available, we
    are not able to improve on this bound: imagine that the probability mass of ***X***
    is highly concentrated just above the midpoint of a bin, then all values produced
    by ***X*** will be shifted by + ***h*** / 2 to result in a value for ***Y***,
    realizing the upper bound.'
  prefs: []
  type: TYPE_NORMAL
- en: 'However, the following exact formula can be given, based on [Theorem 2.3 (i),
    [Janson 2006](https://doi.org/10.1214/009117906000000232)]:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/8a5b0cb730e73434979d75921a06756e.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Here, **φ**( ⋅ ) denotes the [characteristic function](https://en.wikipedia.org/wiki/Characteristic_function_(probability_theory))
    of ***X***, i.e., the Fourier transform of the unknown probability density function
    ***p***( ⋅ ). This formula implies the following bound:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/b0c88040213dfa77deba3ff43c0d53ee.png)'
  prefs: []
  type: TYPE_IMG
- en: 'We can calculate this bound for some of our favorite distributions, for example
    the uniform distribution with support on the interval [***a***, ***b***]:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/f6025a73590856608aa5928213da31e9.png)'
  prefs: []
  type: TYPE_IMG
- en: Here, we have used the well-known value of the [sum of reciprocals of squares](https://en.wikipedia.org/wiki/Basel_problem).
    For example, if we sample from a uniform distribution with range ***b*** - ***a***
    = 10 cm, and compute the mean from data that has been rounded to a precision of
    ***h*** = 2.54 cm, the bias in estimating the mean is at most 1.1 millimeters.
  prefs: []
  type: TYPE_NORMAL
- en: 'By a calculation very similar to one performed in [[Ushakov & Ushakov 2022](https://doi.org/10.1002/sta4.478)],
    we may also bound the rounding error when sampling from a normal distribution
    with variance **σ**²:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/629ccb8e220047f7cf0d3d26edf5ae5e.png)'
  prefs: []
  type: TYPE_IMG
- en: The exponential term decays very fast with smaller values of the bin width.
    For example, given a standard deviation of **σ** = 10 cm and a bin width of ***h***
    = 2.54 cm the rounding error in estimating the mean is of the order 10^(-133),
    i.e., it is negligible for any practical purpose.
  prefs: []
  type: TYPE_NORMAL
- en: 'Applying Theorem 2.5.3 of [[Ushakov 1999](https://doi.org/10.1515/9783110935981)],
    we can give a more general bound in terms of the total variation *V*(***p***)
    of the probability density function ***p***( ⋅ ) instead of its characteristic
    function:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/bb3a67fc6fc58c870833e86996d4a91d.png)'
  prefs: []
  type: TYPE_IMG
- en: where
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/1277b6984d3c1a63794cbb0b3f3ffb6e.png)'
  prefs: []
  type: TYPE_IMG
- en: The calculation is similar to one provided in [[Ushakov & Ushakov 2018](https://doi.org/10.1007/s10958-018-4042-3)].
    For example, the total variation of the uniform distribution with support on the
    interval [***a***, ***b***] is given by 2 / (***b*** - ***a***), so the above
    formula provides the same bound as the previous calculation, via the modulus of
    the characteristic function.
  prefs: []
  type: TYPE_NORMAL
- en: 'The total variation bound allows us to provide a formula for practical use
    that estimates an upper bound for the rounding error, based on the histogram with
    bin width ***h***:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/5351f9c3dc5370234c8410973cade24d.png)'
  prefs: []
  type: TYPE_IMG
- en: Here, ***n_k*** is the number of observations that fall into the ***k***-th
    bin.
  prefs: []
  type: TYPE_NORMAL
- en: As a numerical example, we analyze ***N*** = 412,659 of person’s height values
    surveyed by the U.S. Centers for Disease Control and Prevention [[CDC 2022](https://www.cdc.gov/brfss/annual_data/annual_2022.html)],
    given in inches. The mean height in metric units is given by 170.33 cm. Because
    of the large sample size, the standard error ***σ*** / √***N*** is very small,
    0.02 cm. However, the error due to rounding may be larger, as the total variation
    bound can be estimated to be 0.05 cm. In this case, the statistical errors are
    negligible since differences in body height well below a centimeter are rarely
    of practical relevance. For other cases that require highly accurate estimates
    of the average value of measurements, however, it may not be sufficient to just
    compute the standard error when the data is subject to quantization.
  prefs: []
  type: TYPE_NORMAL
- en: Bounds based on Fisher information
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'If the probability density function ***p***( ⋅ ) is continuously differentiable,
    we can express its total variation *V*(***p***) as an integral over the derivatives’
    modulus. Applying [Hölder’s inequality](https://en.wikipedia.org/wiki/H%C3%B6lder%27s_inequality),
    we can bound the total variation by (the square root of) the Fisher information
    *I*(***p***):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/472aef89126a01db1259cef07338b5ab.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Consequently, we can write down an additional upper bound to the bias when
    computing the mean of rounded or binned data:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/bb2941122b5815dda1a1ff21ec21fdcb.png)'
  prefs: []
  type: TYPE_IMG
- en: This new bound is of (theoretical) interest since Fisher information is a characteristic
    of the density function that is more commonly used than its total variation.
  prefs: []
  type: TYPE_NORMAL
- en: 'More bounds can be found via known upper bounds for the Fisher information,
    many of which can be found in [[Bobkov 2022](https://doi.org/10.1214/22-ejp834)],
    including the following involving the third derivative of the probability density
    function:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/15554aa27d3b01809408b5cf12b1f6e9.png)'
  prefs: []
  type: TYPE_IMG
- en: Curiously, Fisher information also holds significance in certain formulations
    of quantum mechanics, wherein it serves as the component of the Hamiltonian responsible
    for inducing quantum effects [[Curcuraci & Ramezani 2019](https://doi.org/10.1016/j.physa.2019.121570)].
    One might ponder the existence of a concrete and meaningful link between quantized
    physical matter and classical measurements subjected to “ordinary” quantization.
    However, it is important to note that such speculation is likely rooted in mathematical
    pareidolia.
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Sheppard’s corrections are approximations that can be used to account for errors
    in computing the mean, variance, and other (central) moments of a distribution
    based on rounded or binned data.
  prefs: []
  type: TYPE_NORMAL
- en: Although Sheppard’s correction for the mean is zero, the actual error may be
    comparable to, or even exceed, the standard error, especially for larger samples.
    We can constrain the error in computing the mean based on rounded or binned data
    by considering the total variation of the probability density function, a quantity
    estimable from the binned data.
  prefs: []
  type: TYPE_NORMAL
- en: Additional bounds on the rounding error when estimating the mean can be expressed
    in terms of the Fisher information and higher derivatives of the probability density
    function of the unknown distribution.
  prefs: []
  type: TYPE_NORMAL
- en: References
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[[Sheppard 1897](https://doi.org/10.1112/plms/s1-29.1.353)] Sheppard, W.F.
    (1897). “On the Calculation of the most Probable Values of Frequency-Constants,
    for Data arranged according to Equidistant Division of a Scale.” Proceedings of
    the London Mathematical Society s1–29: 353–380.'
  prefs: []
  type: TYPE_NORMAL
- en: '[[Kendall 1938](https://doi.org/10.2307/2980630)] Kendall, M. G. (1938). “The
    Conditions under which Sheppard’s Corrections are Valid.” Journal of the Royal
    Statistical Society 101(3): 592–605.'
  prefs: []
  type: TYPE_NORMAL
- en: '[[Heitjan 1989](https://doi.org/10.1214/ss/1177012601)] Daniel F. Heitjan (1989).
    “Inference from Grouped Continuous Data: A Review.” Statist. Sci. 4 (2): 164–179.'
  prefs: []
  type: TYPE_NORMAL
- en: '[[Janson 2006](https://doi.org/10.1214/009117906000000232)] Janson, Svante
    (2005). “Rounding of continuous random variables and oscillatory asymptotics.”
    *Annals of Probability* 34 (5): 1807–1826.'
  prefs: []
  type: TYPE_NORMAL
- en: '[[Ushakov & Ushakov 2022](https://doi.org/10.1002/sta4.478)] Ushakov, N. G.,
    & Ushakov, V. G. (2022). “On the effect of rounding on hypothesis testing when
    sample size is large.” Stat 11(1): e478.'
  prefs: []
  type: TYPE_NORMAL
- en: '[[Ushakov 1999](https://doi.org/10.1515/9783110935981)] Ushakov, N. G. (1999).
    “Selected Topics in Characteristic Functions.” De Gruyter.'
  prefs: []
  type: TYPE_NORMAL
- en: '[[Ushakov & Ushakov 2018](https://doi.org/10.1007/s10958-018-4042-3)] Ushakov,
    N. G., Ushakov, V. G. Statistical Analysis of Rounded Data: Measurement Errors
    vs Rounding Errors. J Math Sci 234 (2018): 770–773.'
  prefs: []
  type: TYPE_NORMAL
- en: '[[CDC 2022](https://www.cdc.gov/brfss/annual_data/annual_2022.html)] Centers
    for Disease Control and Prevention (CDC). Behavioral Risk Factor Surveillance
    System Survey Data 2022\. Atlanta, Georgia: U.S. Department of Health and Human
    Services, Centers for Disease Control and Prevention.'
  prefs: []
  type: TYPE_NORMAL
- en: '[[Bobkov 2022](https://doi.org/10.1214/22-ejp834)] Bobkov, Sergey G. (2022).
    “Upper Bounds for Fisher information.” Electron. J. Probab. 27: 1–44.'
  prefs: []
  type: TYPE_NORMAL
- en: '[[Curcuraci & Ramezani 2019](https://doi.org/10.1016/j.physa.2019.121570)]
    L. Curcuraci, M. Ramezani (2019). “A thermodynamical derivation of the quantum
    potential and the temperature of the wave function.” Physica A: Statistical Mechanics
    and its Applications 530: 121570.'
  prefs: []
  type: TYPE_NORMAL
