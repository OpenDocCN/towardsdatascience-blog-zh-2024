<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>A Guide on Estimating Long-Term Effects in A/B Tests</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>A Guide on Estimating Long-Term Effects in A/B Tests</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/a-guide-on-estimating-long-term-effects-in-a-b-tests-9a3790501047?source=collection_archive---------9-----------------------#2024-02-24">https://towardsdatascience.com/a-guide-on-estimating-long-term-effects-in-a-b-tests-9a3790501047?source=collection_archive---------9-----------------------#2024-02-24</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="1f7f" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">Addressing the complexity of identifying and measuring long-term effects in online experiments</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@kseniia.baidina?source=post_page---byline--9a3790501047--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Kseniia Baidina" class="l ep by dd de cx" src="../Images/a6ee80021fb9b319d463006ce5952634.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*3AUFSeH0spN3Ihfrxd7Yew.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--9a3790501047--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://medium.com/@kseniia.baidina?source=post_page---byline--9a3790501047--------------------------------" rel="noopener follow">Kseniia Baidina</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--9a3790501047--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">9 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Feb 24, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj lc ld ab q ee le lf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count la lb">3</span></p></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lg k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lh an ao ap id li lj lk" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep ll cn"><div class="l ae"><div class="ab cb"><div class="lm ln lo lp lq lr ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk ml"><img src="../Images/57e1dbb6b650f6237f9d43bad54dec94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RdeVHOkMYVM-Q9spYE1NIg.jpeg"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Photo by <a class="af nc" href="https://unsplash.com/@isaacmsmith?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash" rel="noopener ugc nofollow" target="_blank">Isaac Smith</a> on <a class="af nc" href="https://unsplash.com/photos/pen-on-paper-6EnTPvPPL6I?utm_content=creditCopyText&amp;utm_medium=referral&amp;utm_source=unsplash" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="cf6b" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Imagine you’re an analyst at an online store. You and your team aim to understand how offering free delivery will affect the number of orders on the platform, so you decide to run an A/B test. The test group enjoys free delivery, while the control group sticks to the regular delivery fare. In the initial days of the experiment, you’ll observe more people completing orders after adding items to their carts. But the real impact is long-term — users in the test group are more likely to return for future shopping on your platform because they know you offer free delivery.</p><p id="cb0b" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">In essence, what’s the key takeaway from this example? The impact of free delivery on orders tends to increase gradually. Testing it for only a short period might mean you miss the whole story, and this is a challenge we aim to address in this article.</p><h1 id="446d" class="nz oa fq bf ob oc od gq oe of og gt oh oi oj ok ol om on oo op oq or os ot ou bk">Understanding Why Long-Term and Short-Term Effects May Differ</h1><p id="ba3c" class="pw-post-body-paragraph nd ne fq nf b go ov nh ni gr ow nk nl nm ox no np nq oy ns nt nu oz nw nx ny fj bk">Overall, there could be multiple reasons why short-term effects of the experiment differ from long-term effects [1]:</p><p id="2a61" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><em class="pa">Heterogeneous Treatment Effect</em></p><ul class=""><li id="9704" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny pb pc pd bk">The impact of the experiment may vary for frequent and occasional users of the product. In the short run, frequent users might disproportionately influence the experiment’s outcome, introducing bias to the average treatment effect.</li></ul><p id="c3e0" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><em class="pa">User Learning</em></p><ul class=""><li id="eb83" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny pb pc pd bk">Novelty Effect — picture this: you introduce a new gamification mechanic to your product. Initially, users are curious, but this effect tends to decrease over time.</li><li id="f324" class="nd ne fq nf b go pe nh ni gr pf nk nl nm pg no np nq ph ns nt nu pi nw nx ny pb pc pd bk">Primacy Effect — think about when Facebook changed its ranking algorithm from chronological to recommendations. Initially, there might be a drop in time spent in the feed as users can’t find what they expect, leading to frustration. However, over time, engagement is likely to recover as users get used to the new algorithm, and discover interesting posts. Users may initially react negatively but eventually adapt, leading to increased engagement.</li></ul><p id="7adc" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">In this article, our focus will be on addressing two questions:</p><blockquote class="pj"><p id="4d63" class="pk pl fq bf pm pn po pp pq pr ps ny dx">How to identify and test whether the long-term impact of the experiment differs from the short-term?</p><p id="a9a3" class="pk pl fq bf pm pn po pp pq pr ps ny dx">How to estimate the long-term effect when running the experiment for a sufficiently long period isn’t possible?</p></blockquote><h1 id="cefc" class="nz oa fq bf ob oc od gq oe of og gt oh oi pt ok ol om pu oo op oq pv os ot ou bk">Methods for Identifying Trends in Long-Term Effects</h1><h2 id="7cfb" class="pw oa fq bf ob px py pz oe qa qb qc oh nm qd qe qf nq qg qh qi nu qj qk ql qm bk">Visualization</h2><p id="fa68" class="pw-post-body-paragraph nd ne fq nf b go ov nh ni gr ow nk nl nm ox no np nq oy ns nt nu oz nw nx ny fj bk">The initial step is to observe how the difference between the test and control groups changes over time. If you notice a pattern like this, you will have to dive into the details to grasp the long-term effect.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qn"><img src="../Images/ebe54510b9c4c097b8e52642dc962476.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*oZgGUifDVi3mcuC9jTXhKg.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx"><a class="af nc" href="https://arxiv.org/pdf/2102.12893.pdf" rel="noopener ugc nofollow" target="_blank">I</a>llustration from Sadeghi et al. (2021) [2]</figcaption></figure><p id="5392" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">It might be also tempting to plot the experiment’s effect based not only on the experiment day but also on the number of days from the first exposure.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qo"><img src="../Images/fab48d1bbf252e97184834534a975f8c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nhgtJ6cUsO1CLO62eXTcXA.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx"><a class="af nc" href="https://arxiv.org/pdf/2102.12893.pdf" rel="noopener ugc nofollow" target="_blank">I</a>llustration from Sadeghi et al. (2021) [2]</figcaption></figure><p id="2eb9" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">However, there are several pitfalls when you look at the number of days from the first exposure:</p><ul class=""><li id="a01c" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny pb pc pd bk"><em class="pa">Engaged Users Bias: </em>The right side of the chart might show more engaged users. The observed pattern might not be due to user learning but because of diverse treatment effects. The impact on highly engaged users could be different from the effect on occasional users.</li><li id="a686" class="nd ne fq nf b go pe nh ni gr pf nk nl nm pg no np nq ph ns nt nu pi nw nx ny pb pc pd bk"><em class="pa">Selective Sampling Issue: </em>We could decide to focus solely on highly engaged users and observe how their effect evolves over time. However, this subset may not accurately represent the entire user base.</li><li id="d0d2" class="nd ne fq nf b go pe nh ni gr pf nk nl nm pg no np nq ph ns nt nu pi nw nx ny pb pc pd bk"><em class="pa">Decreasing User Numbers: </em>There may be only a few users who have a substantial number of days since the first exposure (the right part of the graph). This widens the confidence intervals, making it tricky to draw dependable conclusions.</li></ul><p id="fde4" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">The visual method for identifying long-term effects in an experiment is quite straightforward, and it’s always a good starting point to observe the difference in effects over time. However, this approach lacks rigor; you might also consider formally testing the presence of long-term effects. We’ll explore that in the next part.</p><h2 id="204b" class="pw oa fq bf ob px py pz oe qa qb qc oh nm qd qe qf nq qg qh qi nu qj qk ql qm bk">Ladder Experiment Assignment [2]</h2><p id="0e13" class="pw-post-body-paragraph nd ne fq nf b go ov nh ni gr ow nk nl nm ox no np nq oy ns nt nu oz nw nx ny fj bk">The concept behind this approach is as follows: before initiating the experiment, we categorize users into <em class="pa">k</em> cohorts and incrementally introduce them to the experiment. For instance, if we divide users into 4 cohorts, <em class="pa">k_1</em> is the control group, <em class="pa">k_2</em> receives the treatment from week 1, <em class="pa">k_3</em> from week 2, and <em class="pa">k_4</em> from week 3.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qp"><img src="../Images/b23011c3e7a8b1121eb5cfdae3603e4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jDxPyw_a7Ywp_Oik6tS7LQ.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx"><a class="af nc" href="https://arxiv.org/pdf/2102.12893.pdf" rel="noopener ugc nofollow" target="_blank">I</a>llustration from Sadeghiet al. (2021)²</figcaption></figure><p id="2665" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">The user-learning rate can be estimated by comparing the treatment effects from various time periods.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk qq"><img src="../Images/5496aab0b7ccdaedc93a2e7a05aa0cd8.png" data-original-src="https://miro.medium.com/v2/resize:fit:544/format:webp/0*TxrfgShFyKQNFytY"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx"><a class="af nc" href="https://arxiv.org/pdf/2102.12893.pdf" rel="noopener ugc nofollow" target="_blank">I</a>llustration from Sadeghi et al. (2021) [2]</figcaption></figure><p id="82eb" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">For instance, if you aim to estimate user learning in week 4, you would compare values <em class="pa">T4_5</em> and <em class="pa">T4_2</em>.</p><p id="06ff" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">The challenges with this approach are quite evident. Firstly, it introduces extra operational complexities to the experiment design. Secondly, a substantial number of users are needed to effectively divide them into different cohorts and attain reasonable statistical significance levels. Thirdly, one should anticipate having different long-term effects beforehand, and prepare to run an experiment in this complicated setting.</p><h2 id="9a54" class="pw oa fq bf ob px py pz oe qa qb qc oh nm qd qe qf nq qg qh qi nu qj qk ql qm bk">Difference-in-Difference [2]</h2><p id="2d44" class="pw-post-body-paragraph nd ne fq nf b go ov nh ni gr ow nk nl nm ox no np nq oy ns nt nu oz nw nx ny fj bk">This approach is a simplified version of the previous one. We split the experiment into two (or more generally, into <em class="pa">k</em>) time periods and compare the treatment effect in the first period with the treatment effect in the <em class="pa">k-th </em>period.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk qr"><img src="../Images/7317a638c2acd81df3f46586f503d599.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/0*uR0eW1FuA4QVOAss"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx"><a class="af nc" href="https://arxiv.org/pdf/2102.12893.pdf" rel="noopener ugc nofollow" target="_blank">I</a>llustration from Sadeghi et al. (2021) [2]</figcaption></figure><p id="1d6b" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">In this approach, a vital question is how to estimate the variance of the estimate to make conclusions about statistical significance. The authors suggest the following formula (for details, refer to the article):</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qs"><img src="../Images/8009f071299337c4fc666708239b8859.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4xiYYQWACVAov3Dg6FOX_g.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx"><a class="af nc" href="https://arxiv.org/pdf/2102.12893.pdf" rel="noopener ugc nofollow" target="_blank">I</a>llustration from Sadeghi et al. (2021) [2]</figcaption></figure><p id="07c6" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><em class="pa">σ2</em> — the variance of each experimental unit within each time window</p><p id="d153" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><em class="pa">ρ </em>— the correlation of the metric for each experimental unit in two time windows</p><h2 id="2dd9" class="pw oa fq bf ob px py pz oe qa qb qc oh nm qd qe qf nq qg qh qi nu qj qk ql qm bk">Random VS Constant Treatment Assignment [3]</h2><p id="8e7b" class="pw-post-body-paragraph nd ne fq nf b go ov nh ni gr ow nk nl nm ox no np nq oy ns nt nu oz nw nx ny fj bk">This is another extension of the ladder experiment assignment. In this approach, the pool of users is divided into three groups: <em class="pa">C</em> — control group, <em class="pa">E </em>— the group that receives treatment throughout the experiment, and <em class="pa">E1</em> — the group in which users are assigned to treatment every day with probability <em class="pa">p</em>. As a result, each user in the <em class="pa">E1</em> group will receive treatment only a few days, preventing user learning. Now, how do we estimate user learning? Let’s introduce <em class="pa">E1_d</em> — a fraction of users from <em class="pa">E1</em> exposed to treatment on day <em class="pa">d</em>. The user learning rate is then determined by the difference between <em class="pa">E </em>and <em class="pa">E1_d</em>.</p><h2 id="5b5b" class="pw oa fq bf ob px py pz oe qa qb qc oh nm qd qe qf nq qg qh qi nu qj qk ql qm bk">User “Unlearning” [3]</h2><p id="d1fc" class="pw-post-body-paragraph nd ne fq nf b go ov nh ni gr ow nk nl nm ox no np nq oy ns nt nu oz nw nx ny fj bk">This approach enables us to assess both the existence of user learning and the duration of this learning. The concept is quite elegant: it posits that users learn at the same rate as they “unlearn.” The idea is as follows: turn off the experiment and observe how the test and control groups converge over time. As both groups will receive the same treatment post-experiment, any changes in their behavior will occur because of the different treatments during the experiment period.</p><p id="5b3f" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">This approach helps us measure the period required for users to “forget” about the experiment, and we assume that this forgetting period will be equivalent to the time users take to learn during the feature roll-out.</p><p id="9d13" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">This method has two significant drawbacks: firstly, it requires a considerable amount of time to analyze user learning. Initially, you run an experiment for an extended period to allow users to “learn,” and then you must deactivate the experiment and wait for them to “unlearn.” This process can be time-consuming. Secondly, you need to deactivate the experimental feature, which businesses may be hesitant to do.</p><h1 id="ce7b" class="nz oa fq bf ob oc od gq oe of og gt oh oi oj ok ol om on oo op oq or os ot ou bk">Methods for Assessing the Long-Term Effects [4]</h1><p id="652d" class="pw-post-body-paragraph nd ne fq nf b go ov nh ni gr ow nk nl nm ox no np nq oy ns nt nu oz nw nx ny fj bk">You’ve successfully established the existence of user learning in your experiment, and it’s clear that the long-term results are likely to differ from what you observe in the short term. Now, the question is how to predict these long-term results without running the experiment for weeks or even months.</p><p id="4377" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">One approach is to attempt predicting long-run outcomes of <em class="pa">Y</em> using short-term data. The simplest method is to use lags of <em class="pa">Y</em>, and it is referred to as “auto-surrogate” models. Suppose you want to predict the experiment’s result after two months but currently have only two weeks of data. In this scenario, you can train a linear regression (or any other) model:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk qt"><img src="../Images/dad84ab54798e76c9f05f7e1b0b618aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:724/format:webp/1*wzbV_LkK-s9rUaf66srgfg.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx"><a class="af nc" href="https://arxiv.org/pdf/2102.12893.pdf" rel="noopener ugc nofollow" target="_blank">I</a>llustration from Zhang et al. (2023) [5]</figcaption></figure><p id="6e52" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><em class="pa">m</em> is the average daily outcome for user<em class="pa"> i</em> over two months</p><p id="4eb5" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><em class="pa">Yi_t </em>are value of the metric for user <em class="pa">i </em>at day <em class="pa">t</em> (<em class="pa">T</em> ranges from 1 to 14 in our case)</p><p id="7ad9" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">In that case, the long-term treatment effect is determined by the difference in predicted values of the metric for the test and control groups using surrogate models.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk qu"><img src="../Images/b7241935cba06b8faac86270b181f439.png" data-original-src="https://miro.medium.com/v2/resize:fit:1084/format:webp/1*d1iopK6N98RaEJx_TtAntw.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx"><a class="af nc" href="https://arxiv.org/pdf/2102.12893.pdf" rel="noopener ugc nofollow" target="_blank">I</a>llustration from Zhang et al. (2023) [5]</figcaption></figure><p id="d9d9" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Where <em class="pa">N_a</em> represents the number of users in the experiment group, and <em class="pa">N_0</em> represents the number of users in the control group.</p><p id="b438" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">There appears to be an inconsistency here: we aim to predict <strong class="nf fr"><em class="pa">μ</em></strong> (the long-term effect of the experiment), but to train the model, we require this <strong class="nf fr"><em class="pa">μ</em></strong>. So, how do we obtain the model? There are two approaches:</p><ul class=""><li id="6d0d" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny pb pc pd bk"><em class="pa">Using pre-experiment data: </em>We can train a model using two months of pre-experiment data for the same users.</li><li id="cb09" class="nd ne fq nf b go pe nh ni gr pf nk nl nm pg no np nq ph ns nt nu pi nw nx ny pb pc pd bk"><em class="pa">Similar experiments: </em>We can select a “gold standard” experiment from the same product domain that ran for two months and use it to train the model.</li></ul><p id="9124" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">In their article, Netflix validated this approach using 200 experiments and concluded that surrogate index models are consistent with long-term measurements in 95% of experiments [5].</p><h1 id="aee8" class="nz oa fq bf ob oc od gq oe of og gt oh oi oj ok ol om on oo op oq or os ot ou bk">Conclusion</h1><p id="b3b7" class="pw-post-body-paragraph nd ne fq nf b go ov nh ni gr ow nk nl nm ox no np nq oy ns nt nu oz nw nx ny fj bk">We’ve learned a lot, so let’s summarize it. Short-term experiment results often differ from the long-term due to factors like heterogeneous treatment effects or user learning. There are several approaches to detect this difference, with the most straightforward being:</p><ul class=""><li id="4527" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny pb pc pd bk"><em class="pa">Visual Approach: </em>Simply observing the difference between the test and control over time. However, this method lacks rigor.</li><li id="5e5a" class="nd ne fq nf b go pe nh ni gr pf nk nl nm pg no np nq ph ns nt nu pi nw nx ny pb pc pd bk"><em class="pa">Difference-in-Difference: </em>Comparing the difference in the test and control at the beginning and after some time of the experiment.</li></ul><p id="5b9a" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">If you suspect user learning in your experiment, the ideal approach is to extend the experiment until the treatment effect stabilizes. However, this may not always be feasible due to technical (e.g., short-lived cookies) or business restrictions. In such cases, you can predict the long-term effect using auto-surrogate models, forecasting the long-term outcome of the experiment on <em class="pa">Y</em> using lags of <em class="pa">Y</em>.</p><blockquote class="qv qw qx"><p id="00a2" class="nd ne pa nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Thank you for taking the time to read this article. I would love to hear your thoughts, so please feel free to share any comments or questions you may have.</p></blockquote><h1 id="1e96" class="nz oa fq bf ob oc od gq oe of og gt oh oi oj ok ol om on oo op oq or os ot ou bk">References</h1><ol class=""><li id="9c73" class="nd ne fq nf b go ov nh ni gr ow nk nl nm ox no np nq oy ns nt nu oz nw nx ny qy pc pd bk">N. Larsen, J. Stallrich, S. Sengupta, A. Deng, R. Kohavi, N. T. Stevens, <em class="pa">Statistical Challenges in Online Controlled Experiments: A Review of A/B Testing Methodology</em> (2023),<em class="pa"> </em><a class="af nc" href="https://arxiv.org/pdf/2212.11366.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/2212.11366.pdf</a></li><li id="7a28" class="nd ne fq nf b go pe nh ni gr pf nk nl nm pg no np nq ph ns nt nu pi nw nx ny qy pc pd bk">S. Sadeghi, S. Gupta, S. Gramatovici, J. Lu, H. Ai, R. Zhang, <em class="pa">Novelty and Primacy: A Long-Term Estimator for Online Experiments </em>(2021),<em class="pa"> </em><a class="af nc" href="https://arxiv.org/pdf/2102.12893.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/2102.12893.pdf</a></li><li id="c805" class="nd ne fq nf b go pe nh ni gr pf nk nl nm pg no np nq ph ns nt nu pi nw nx ny qy pc pd bk">H. Hohnhold, D. O’Brien, D. Tang, <em class="pa">Focusing on the Long-term: It’s Good for Users and Business</em> (2015),<em class="pa"> </em><a class="af nc" href="https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/43887.pdf" rel="noopener ugc nofollow" target="_blank">https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/43887.pdf</a></li><li id="4a94" class="nd ne fq nf b go pe nh ni gr pf nk nl nm pg no np nq ph ns nt nu pi nw nx ny qy pc pd bk">S. Athey, R. Chetty, G. W. Imbens, H. Kang, <em class="pa">The Surrogate Index: Combining Short-Term Proxies to Estimate Long-Term Treatment Effects More Rapidly and Precisely </em>(2019),<em class="pa"> </em><a class="af nc" href="https://www.nber.org/system/files/working_papers/w26463/w26463.pdf" rel="noopener ugc nofollow" target="_blank">https://www.nber.org/system/files/working_papers/w26463/w26463.pdf</a></li><li id="c1a9" class="nd ne fq nf b go pe nh ni gr pf nk nl nm pg no np nq ph ns nt nu pi nw nx ny qy pc pd bk">V. Zhang, M. Zhao, A. Le, M. Dimakopoulou, N. Kallus, <em class="pa">Evaluating the Surrogate Index as a Decision-Making Tool Using 200 A/B Tests at Netflix </em>(2023),<em class="pa"> </em><a class="af nc" href="https://arxiv.org/pdf/2311.11922.pdf" rel="noopener ugc nofollow" target="_blank">https://arxiv.org/pdf/2311.11922.pdf</a></li></ol></div></div></div></div>    
</body>
</html>