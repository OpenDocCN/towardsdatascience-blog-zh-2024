# 互信息的直观视角

> 原文：[https://towardsdatascience.com/an-intuitive-view-on-mutual-information-db0655535f84?source=collection_archive---------6-----------------------#2024-03-13](https://towardsdatascience.com/an-intuitive-view-on-mutual-information-db0655535f84?source=collection_archive---------6-----------------------#2024-03-13)

## 普通人如何理解关联概念

[](https://medium.com/@markchangg?source=post_page---byline--db0655535f84--------------------------------)[![Mark Chang](../Images/149afb7a61e175743da6c36f05bc6318.png)](https://medium.com/@markchangg?source=post_page---byline--db0655535f84--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--db0655535f84--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--db0655535f84--------------------------------) [Mark Chang](https://medium.com/@markchangg?source=post_page---byline--db0655535f84--------------------------------)

·发表于[Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--db0655535f84--------------------------------) ·8分钟阅读·2024年3月13日

--

![](../Images/119a293dadb7e3a97d7b8666de767d74.png)

图片来自[Ben White](https://unsplash.com/@benwhitephotography?utm_source=medium&utm_medium=referral)在[Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)上的分享

最近，我一直在进行一个项目，旨在筛选**股市中的变量对**，并**查看它们是否显示出足够的相关性潜力**，以便我们可以深入研究。

在我的研究过程中，我接触了许多不同的方法论；从简单的斯皮尔曼/皮尔逊线性相关，到使用时间延迟嵌入和甚至机器学习技术的更先进的非线性方法。

那时，我偶然发现了这个强大且具有概率性的概念——**互信息**，它帮助人们衡量两个变量之间的关联/依赖程度。这是模型开发或关联研究中的一个很好的起步工具。

在网上进一步了解时，我意识到虽然有很多出色的数学和统计学解释，**但很少有直观的见解来阐明互信息为何及如何起作用**。

因此，我们现在在这里，

> 欢迎来到我的尝试，帮助你拆解并理解这个统计学概念！

# **教科书定义**

> 互信息是衡量通过观察一个变量可以获得多少关于另一个变量的“信息”的度量。

我相信你在自己的研究中一定见过上述陈述，或者它的变种。但究竟是什么是他们所说的“信息”？它如何告诉我两个变量是相关/依赖的？

当你看到这个公式时，定义变得更加令人生畏：

![](../Images/78bbaebed9d998ae8de882ead9c34c67.png)

离散观察下互信息的公式

不要担心！让我们通过案例研究来分解这个概念，变得易于理解。

> “人们真的只有在下雨时才用伞吗？”

![](../Images/23262ac9ac78fbd879c736b941f5b590.png)

图片来自[zhang dayong](https://unsplash.com/@dayongzhang?utm_source=medium&utm_medium=referral)在[Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)上的分享

这是Bob说的，你的醉酒朋友，在节日狂欢的夜晚。

他坚持认为人们只有在自己想带伞时才会带伞，而不是因为需要它来遮挡雨水。

你认为这个说法太荒谬了！它挑战了你成长过程中所做的每一次观察；挑战了你骨子里的每一个逻辑观念。

你决定跟踪Bob，并在他在热带新加坡度假的5天里观察他。你想看看他是否真的做到了他所宣称的行为。

你决定使用**互信息**的概念来进行分析。

# Bob与互信息

我们可以将互信息公式分解为以下几个部分：

## ***x, X* 和 *y, Y***

*x*和*y*是我们在数据中看到的个体观察值/数值。*X*和*Y*仅是这些个体值的集合。一个很好的例子如下：

![](../Images/a4f6e7a5ead25c261663a5081fbb6a6f.png)

离散/二进制观察携伞与天气

假设我们有Bob在这个确切顺序中的5天观察数据：

![](../Images/a5f8f1a57846c491c3a4f19ac00c51ad.png)

在5天内对携伞与天气的离散/二进制观察

## **个体/边际概率**

![](../Images/383c1c8c07fb4779e277865282fe9c24.png)

这些仅仅是观察特定*x*或*y*在其各自的*X*和*Y*值集合中的简单概率。

以*x = 1*为例：概率简单为*0.4*（Bob在假期的5天中有2天带了伞）。

## **联合概率**

![](../Images/cc6114a1cdc620ee8e98e97fbdbe1177.png)

这是从联合概率（*X, Y*）中观察特定*x*和*y*的概率。联合概率（*X, Y*）仅仅是成对观察的集合。我们根据它们的索引将它们配对。

在我们的案例中，我们根据它们发生的具体日期将Bob的观察配对起来。

![](../Images/a881e1dbacfa805bf74e041ddc5a140b.png)

看完这些对的配对后，你可能会忍不住得出结论：

> 由于有80%的时间发生了相等值的配对，这明显意味着人们带伞是因为下雨了！

好吧，我来充当魔鬼代言人，认为这可能只是一个极其巧合的事件：

如果新加坡的降雨几率非常低，并且Bob独立地携带雨伞的可能性也同样低（因为他讨厌拿额外的东西），你能看到*(0,0)*配对观察的几率自然会非常高吗？

> 那么我们可以做什么来证明这些配对观察结果并非巧合呢？

## **联合概率与个体概率**

![](../Images/5be386e3384c40df59a7e23635daadee.png)

我们可以计算这两个概率的比值，从而给我们一个关于**“巧合程度”**的线索。

在分母中，我们取特定*x*和特定*y发生的个体概率的乘积。我们为什么要这么做？

**窥探那朴素的硬币抛掷**

回想一下你在统计课上学的第一课：计算在2次公平抛掷中得到2个正面的概率。

+   第一次抛掷 [*p(x*)]：得到正面的几率是50%

+   第二次抛掷 [*p(y*)]：得到正面的几率仍然是50%，因为结果**独立**于第一次抛掷发生的事情。

+   上面这2次抛掷构成了你的个体概率

+   因此，**理论上**在2次独立抛掷中得到2个正面的概率是 *0.5* * 0.5* = 0.25*（[ *p(x).p(y)*](#0073)）

![](../Images/8499b8db31a00ac5b3cb3b6f52277fbd.png)

如果你实际上做了100组这样的双重硬币抛掷实验，你很可能会看到你得到*(正面, 正面)*结果的几率是25%。这100组实验实际上是你的[(*X, Y)*联合概率集](#807d)!

因此，当你计算联合概率与各自个体概率的比值时，你会得到一个值为*1*。

这实际上是**独立事件的真实期望**：特定值对的联合概率正好等于它们各自概率的乘积！就像你在基础统计学中学到的那样。

现在假设你的100组实验中，*(正面, 正面)*的结果出现了90%的时间。**这肯定不是巧合……**

你原本预计是25%，因为你知道这些事件是独立的，但观察到的却是这种期望的极端偏斜。

为了将这种定性感觉转化为数字，概率的比值现在是惊人的*3.6 (0.9 / 0.25)*，也就是说，比我们预期的要频繁3.6倍。

因此，我们开始认为**也许硬币抛掷并不是独立的**。也许第一次抛掷的结果实际上会对第二次抛掷产生一些未解释的影响。**也许**第一次和第二次抛掷之间存在某种程度的关联/依赖。

> 这就是**互信息试图告诉**我们的！

## 观察的期望值

![](../Images/25e9be68a91424b51e5245c580c56a0e.png)

为了对Bob公平，我们不仅仅应该看他错误声明的次数，即计算*(0,0)*和*(1,1)*的概率比。

我们还应该计算他声明正确时的概率比，即*(0,1)*和*(1,0)*的概率比。

此后，我们可以通过**聚合所有 4 种情形**的期望值方法，这意味着“取平均”：将每一对观察到的(*X, Y*)的概率比率聚合起来，然后除以观察的次数。

这就是这两个求和项的目的。对于像我的股市示例这样的连续变量，我们将使用积分来代替。

## 比率的对数

![](../Images/a273e4b9b4ea16ede7fbcbbd37c09dbd.png)

类似于我们计算掷硬币时得到两个连续正面的概率一样，我们现在也在计算观察到的 5 对的额外概率。

对于掷硬币，我们通过**乘法**计算每次掷硬币的概率。对于 Bob 来说也是一样：**概率之间有乘法效应**，从而给我们提供了我们在联合集合中观察到的序列。

使用对数，我们**将乘法效应转化为加法效应**：

![](../Images/e40d4d458dde7c2f139bf9b2e10df7b9.png)

将概率比率转换为它们的对数形式后，我们现在可以简单地按照[上面描述的](#776f)使用**对数求和**来计算期望值。

随意使用底数为 2、*e* 或 10 的对数，本文目的并不受影响。

## 将所有内容汇总

![](../Images/78bbaebed9d998ae8de882ead9c34c67.png)

离散观察的互信息公式

现在让我们通过计算互信息来证明 Bob 是错的。我将使用以 *e* 为底的对数（自然对数）进行计算：

![](../Images/c07fbe0d1451d05fa071d7d2555cf854.png)

那么，值为 ***0.223*** 的结果告诉了我们什么？

首先假设 Bob 是对的，且伞的使用与下雨的存在是**独立**的：

+   我们知道，联合概率将恰好等于单独概率的乘积。

+   因此，对于每一个 *x* 和 *y* 的排列，概率比率 *= 1*。

+   取对数后，结果等于 0。

+   因此，所有排列的期望值（即互信息）因此为***0***。

但是，由于我们计算的互信息分数是**非零**的，因此我们可以证明 Bob 是错的！

# 超越线性相关

因为互信息是一个概率性关联/依赖度的度量，它同样适用于**非线性相关**的研究！

举个例子，考虑两个变量 *X* 和 *Y*：

![](../Images/70abc9232eefbc36d9c44dcb55bc713f.png)

计算它们的互信息分数、Spearman 等级相关系数，并绘制图表，我们得到如下结果：

![](../Images/4c73cfb29d55e9f31e7b62c88a438361.png)

Y 对 X：Y 是 X 的确定性、非线性缩放

仅依赖 Spearman 等级相关系数，我们会认为这两个变量没有任何关系，但我们明明知道它们是确定性相关的（基于我上面的公式）！

非零的互信息分数提示我们需要深入探讨，**尽管它没有给出关系的明确形式**。

它也足够强大，可以处理严格的线性相关性：

![](../Images/0f8a77486dbd30f736b568c22677154e.png)

Y对X：Y是X的确定性线性变换

所以，如果你在进行X对Y分析时不确定你期待的相关性是什么，你可以尝试将互信息作为零步来使用！

# 我对互信息的“外行”定义

![](../Images/792fe745d9888281b96376019e26e4a4.png)

摄影：由[Albert](https://unsplash.com/@picturesbyalbert?utm_source=medium&utm_medium=referral)拍摄，来自[Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

通过[以上示例和分析](#7bae)，我希望我已经帮助大家直观地理解了互信息是什么以及它是如何工作的。

如果这对你有帮助，我倾向于将互信息总结如下：

> 互信息为我们提供了x和y同时发生的额外概率，这一概率是由其他因素引起的，而不仅仅是它们同时发生的机会。

互信息在构建机器学习模型之前的特征选择等领域非常有用，甚至在与文本嵌入一起使用时，能用于文本关联分析。因此，在我们采用它来应对各种用途之前，真正理解它的工作原理是至关重要的。

凭借你新获得的直觉和理解，我相信你将能够发现其他机会，将这一多用途概念应用于其他领域，就像我在股市投资中所做的那样！
