<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>AWS DeepRacer : A Practical Guide to Reducing the Sim2Real Gap — Part 1 || Preparing the Track</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>AWS DeepRacer : A Practical Guide to Reducing the Sim2Real Gap — Part 1 || Preparing the Track</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/aws-deepracer-a-practical-guide-to-reducing-the-sim2real-gap-part-1-580fb1244229?source=collection_archive---------9-----------------------#2024-08-21">https://towardsdatascience.com/aws-deepracer-a-practical-guide-to-reducing-the-sim2real-gap-part-1-580fb1244229?source=collection_archive---------9-----------------------#2024-08-21</a></blockquote><div><div class="em ff fg fh fi fj"/><div class="fk fl fm fn fo"><div class="ab cb"><div class="ci bh ew ex ey ez"><div/><div><h2 id="5eca" class="pw-subtitle-paragraph go fq fr bf b gp gq gr gs gt gu gv gw gx gy gz ha hb hc hd cq dx">Minimize visual distractions to maximize successful laps</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="he hf hg hh hi ab"><div><div class="ab hj"><div><div class="bm" aria-hidden="false"><a href="https://shrey-pareek.medium.com/?source=post_page---byline--580fb1244229--------------------------------" rel="noopener follow"><div class="l hk hl by hm hn"><div class="l ed"><img alt="Shrey Pareek, PhD" class="l ep by dd de cx" src="../Images/e1169ff2f538e8bc9f64c6f591bf1f80.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*_Ogel3POBbkCnwE81UhqxQ@2x.jpeg"/><div class="ho by l dd de em n hp eo"/></div></div></a></div></div><div class="hq ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--580fb1244229--------------------------------" rel="noopener follow"><div class="l hr hs by hm ht"><div class="l ed"><img alt="Towards Data Science" class="l ep by br hu cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="ho by l br hu em n hp eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hv ab q"><div class="ab q hw"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hx hy bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hz" data-testid="authorName" href="https://shrey-pareek.medium.com/?source=post_page---byline--580fb1244229--------------------------------" rel="noopener follow">Shrey Pareek, PhD</a></p></div></div></div><span class="ia ib" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hx hy dx"><button class="ic id ah ai aj ak al am an ao ap aq ar ie if ig" disabled="">Follow</button></p></div></div></span></div></div><div class="l ih"><span class="bf b bg z dx"><div class="ab cn ii ij ik"><div class="il im ab"><div class="bf b bg z dx ab in"><span class="io l ih">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hz ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--580fb1244229--------------------------------" rel="noopener follow"><p class="bf b bg z ip iq ir is it iu iv iw bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="ia ib" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">8 min read</span><div class="ix iy l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Aug 21, 2024</span></div></span></div></span></div></div></div><div class="ab cp iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo"><div class="h k w ea eb q"><div class="ke l"><div class="ab q kf kg"><div class="pw-multi-vote-icon ed io kh ki kj"><div class=""><div class="kk kl km kn ko kp kq am kr ks kt kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l ku kv kw kx ky kz la"><p class="bf b dy z dx"><span class="kl">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kk lb lc ab q ee ld le" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lf"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg></button></div></div></div><div class="ab q jp jq jr js jt ju jv jw jx jy jz ka kb kc kd"><div class="lg k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lh an ao ap ie li lj lk" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep ll cn"><div class="l ae"><div class="ab cb"><div class="lm ln lo lp lq lr ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lh an ao ap ie ls lt le lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lh an ao ap ie ls lt le lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lh an ao ap ie ls lt le lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><p id="fc7e" class="pw-post-body-paragraph mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fk bk">Ever wondered why your DeepRacer performs perfectly in the sim but can’t even navigate a single turn in the real world? Read on to understand why and how to resolve common issues.</p><figure class="nf ng nh ni nj nk"><div class="nl ip l ed"><div class="nm nn l"/></div><figcaption class="no np nq nr ns nt nu bf b bg z dx">Video demo of AWS DeepRacer on real track. Video by author.</figcaption></figure><ul class=""><li id="616b" class="mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne nv nw nx bk"><a class="af ny" rel="noopener" target="_blank" href="/aws-deepracer-a-practical-guide-to-reducing-the-sim2real-gap-part-1-580fb1244229"><strong class="ml fs">Part 1 (08/20/2024)</strong></a> : Track and surrounding environment setup.</li><li id="2c92" class="mj mk fr ml b gp nz mn mo gs oa mq mr ms ob mu mv mw oc my mz na od nc nd ne nv nw nx bk"><a class="af ny" href="https://medium.com/towards-data-science/aws-deepracer-a-practical-guide-to-reducing-the-sim2real-gap-part-2-training-guide-e96805cd7141" rel="noopener"><strong class="ml fs">Part 2 (08/26/2024)</strong></a><strong class="ml fs"> </strong>: Action space and reward function design along with training paradigm.</li></ul><p id="91b0" class="pw-post-body-paragraph mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fk bk">In this guide, I will share practical tips &amp; tricks to autonomously run the <a class="af ny" href="https://aws.amazon.com/deepracer/" rel="noopener ugc nofollow" target="_blank">AWS DeepRacer</a> around a race track. I will include information on training the reinforcement learning agent in simulation and <em class="oe">more</em> crucially, practical advice on how to successfully run your car on a physical track — the so called simulated-to-real (<strong class="ml fs">sim2real)</strong> challenge.</p><p id="0f8e" class="pw-post-body-paragraph mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fk bk">In <strong class="ml fs">Part 1</strong>, I will describe physical factors to keep in mind for running your car on a real track. I will go over the camera sensor (and its limitations) of the car and how to prepare your physical space and track. In later parts, we will go over the training process and reward function best practices. I decided to first focus on physical factors rather than training as understanding the physical limitations before training in simulation is more crucial in my opinion.</p><p id="21de" class="pw-post-body-paragraph mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fk bk">As you will see through this multi-part series, the key goal is to reduce camera distractions arising from lighting changes and background movement.</p><h1 id="cdbe" class="of og fr bf oh oi oj gr ok ol om gu on oo op oq or os ot ou ov ow ox oy oz pa bk">The Car and Sensors</h1><figure class="nf ng nh ni nj nk nr ns paragraph-image"><div class="nr ns pb"><img src="../Images/f21e194429877554df724df9c32b9d84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1160/format:webp/1*37YUcXn0x-yz9kTHSG9EvQ.png"/></div><figcaption class="no np nq nr ns nt nu bf b bg z dx">AWS DeepRacer. Image by author.</figcaption></figure><p id="679f" class="pw-post-body-paragraph mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fk bk">The car is a 1/18th scale race car with a RGB (Red Green Blue) Camera sensor. From <a class="af ny" href="https://docs.aws.amazon.com/deepracer/latest/developerguide/deepracer-choose-race-type.html#deepracer-how-it-works-autonomous-driving-sensors" rel="noopener ugc nofollow" target="_blank">AWS</a>:</p><blockquote class="pd pe pf"><p id="bb15" class="mj mk oe ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fk bk">The camera has 120-degree wide angle lens and captures RGB images that are then converted to grey-scale images of 160 x 120 pixels at 15 frames per second (fps). These sensor properties are preserved in the simulator to maximize the chance that the trained model transfers well from simulation to the real world.</p></blockquote><p id="f89e" class="pw-post-body-paragraph mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fk bk">The key thing to note here is that the camera uses <em class="oe">grey-scale images of 160 x 120 pixels. </em>This roughly means that the camera will be good at separating light or <em class="oe">white</em> colored pixels from dark or <em class="oe">black</em> colored pixels. Pixels that lie between these i.e. <em class="oe">greys — </em>can be used to represent additional information.</p><figure class="nf ng nh ni nj nk"><div class="nl ip l ed"><div class="pg nn l"/></div><figcaption class="no np nq nr ns nt nu bf b bg z dx">DeepRacer view in RGB (Left) and Greyscale (Right). Even though the camera captures images in RGB, they are converted to Greyscale for inference. Notice the creases on the track and light reflection which increases the sim2real gap. Video by author.</figcaption></figure><p id="ed75" class="pw-post-body-paragraph mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fk bk">The <strong class="ml fs">most importan</strong>t thing to remember from this article is the following:</p><blockquote class="pd pe pf"><p id="bbc2" class="mj mk oe ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fk bk">The car only uses <strong class="ml fs">a black and white image </strong>for understanding the environment around it. It does not <em class="fr">recognize </em>objects — rather it learns to avoid or stick to different grey pixel values (from black to white).</p></blockquote><p id="cfe6" class="pw-post-body-paragraph mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fk bk"><strong class="ml fs">So all steps that we take, ranging from <em class="oe">track preparation </em>to<em class="oe"> training the model </em>will be executed keeping the above fact in mind.</strong></p><p id="e816" class="pw-post-body-paragraph mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fk bk">In the DeepRacer’s case <strong class="ml fs">three color-based basic goals</strong> can be identified for the car:</p><ol class=""><li id="510d" class="mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne ph nw nx bk"><strong class="ml fs">Stay Within White Colored Track Boundary:</strong> Lighter or higher pixel values close to the color <em class="oe">white</em> (255) will be interpreted as the track boundary by the car and it will try to stay within this pixel boundary.</li><li id="ca41" class="mj mk fr ml b gp nz mn mo gs oa mq mr ms ob mu mv mw oc my mz na od nc nd ne ph nw nx bk"><strong class="ml fs">Drive On Black Colored Track: </strong>Darker or lower <em class="oe">black </em>(0) pixel values close will be interpreted as driving surface itself, and the car should try to drive on it as much as possible.</li><li id="1e58" class="mj mk fr ml b gp nz mn mo gs oa mq mr ms ob mu mv mw oc my mz na od nc nd ne ph nw nx bk"><strong class="ml fs">Green/Yellow: </strong>Although green and yellow colors will be seen as shades of grey by the car — it can still learn to (a) stay close to <em class="oe">dotted yellow </em>center line; and (b) avoid <em class="oe">solid green </em>out of bounds area.</li></ol><figure class="nf ng nh ni nj nk nr ns paragraph-image"><div role="button" tabindex="0" class="pj pk ed pl bh pm"><div class="nr ns pi"><img src="../Images/5db9aa456a6f381afcf84014dc1e7beb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zWaNJ8ocR-F_l2_gXucU7A.png"/></div></div><figcaption class="no np nq nr ns nt nu bf b bg z dx">Actual camera view (Left) and simulation View (Right) in RGB space. These images are converted to grey scale before inference. Source².</figcaption></figure><h1 id="0306" class="of og fr bf oh oi oj gr ok ol om gu on oo op oq or os ot ou ov ow ox oy oz pa bk">DeepRacer’s sim2real Performance Gap</h1><p id="300a" class="pw-post-body-paragraph mj mk fr ml b gp pn mn mo gs po mq mr ms pp mu mv mw pq my mz na pr nc nd ne fk bk">AWS DeepRacer uses Reinforcement Learning (RL)¹ in a <em class="oe">simulated</em> environment to train a scaled racecar to autonomously race around a track. This enables the racer to first <em class="oe">learn </em>an optimal and safe policy or behavior in a virtual environment. Then, we can deploy our model on the real car and race it around a real track.</p><p id="5f35" class="pw-post-body-paragraph mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fk bk">Unfortunately, it is rare to get the exact performance in the real world as that observed in a simulator. This is because the simulation cannot capture all aspects of the real world accurately. To their credit, AWS provides a guide on <a class="af ny" href="https://docs.aws.amazon.com/deepracer/latest/developerguide/deepracer-console-train-evaluate-models.html#deepracer-evaluate-model-test-approaches" rel="noopener ugc nofollow" target="_blank">optimizing training to minimize sim2real gap</a>. Although advice provided here is useful, it did not quite work for me. The car comes with an inbuilt model from AWS that is supposed to be suited for multiple tracks should work out of the box. Unfortunately, at least in my experiments, that model couldn’t even complete a single lap (despite making multiple physical changes). There is missing information in the guides from AWS which I was eventually able to piece together via online blogs and discussion forums.</p><p id="4bc2" class="pw-post-body-paragraph mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fk bk">Through my experiments, identified the following key factors increasing <em class="oe">sim2real</em> gaps:</p><ol class=""><li id="9834" class="mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne ph nw nx bk"><strong class="ml fs">Camera Light/Noise Sensitivity: </strong>The biggest challenge is the camera’s sensitivity to light and/or background noise. Any light hotspot washes out the camera sensors and the car may exhibit unexpected behavior. Try reducing ambient lighting and any background distractions as much as possible. (More on this later.)</li><li id="ea73" class="mj mk fr ml b gp nz mn mo gs oa mq mr ms ob mu mv mw oc my mz na od nc nd ne ph nw nx bk"><strong class="ml fs">Friction: </strong>Friction between the car wheels and track adds challenges with calibrating throttle. We purchased the track recommended by AWS <a class="af ny" href="https://www.amazon.com/Speedway-Printed-Track-DeepRacer-Matte/dp/B0BT8CGKTP/ref=s9_acsd_al_ot_c2_x_0_t?_encoding=UTF8&amp;pf_rd_m=ATVPDKIKX0DER&amp;pf_rd_s=merchandised-search-2&amp;pf_rd_r=58S30ZXVWXMZH7T5DBP2&amp;pf_rd_p=904aa3c6-ee70-4b7c-9984-72e3ba23e425&amp;pf_rd_t=&amp;pf_rd_i=32957528011" rel="noopener ugc nofollow" target="_blank">through their storefront</a> (read on for why I <strong class="ml fs">wouldn’t</strong> recommend it). The track is Matte Vinyl, and in my setup I placed it on carpet in my office’s lunch area. It appears that vinyl on carpet creates high static friction causes the car to continuously get stuck especially around slow turns or when attempting to move from a standing start.</li><li id="d662" class="mj mk fr ml b gp nz mn mo gs oa mq mr ms ob mu mv mw oc my mz na od nc nd ne ph nw nx bk"><strong class="ml fs">Different Sensing Capability of Virtual v/s Real Car:</strong> There is a gap in input parameters/state space available to the real v/s simulation car. AWS provides <a class="af ny" href="https://docs.aws.amazon.com/deepracer/latest/developerguide/deepracer-reward-function-input.html" rel="noopener ugc nofollow" target="_blank">a list of input parameters</a>, but parameters such as track length, progress, steps etc. are only available in simulation and cannot be used by the real car. To the best of my knowledge and through some internet sleuthing — it appears that the <strong class="ml fs"><em class="oe">car can only access information from the camera sensor</em></strong><em class="oe">. </em>There is a slim chance that parameters such as <em class="oe">x,y location and heading </em>of car are known. My research points to this information being <strong class="ml fs"><em class="oe">unavailable</em></strong> as the car most likely does not have an IMU, and even if it does — IMU based localization is a very difficult problem to solve. This information is helpful in designing the correct reward function (more on that in future parts).</li></ol><h1 id="18db" class="of og fr bf oh oi oj gr ok ol om gu on oo op oq or os ot ou ov ow ox oy oz pa bk">Track — Build v/s Buy</h1><p id="02d6" class="pw-post-body-paragraph mj mk fr ml b gp pn mn mo gs po mq mr ms pp mu mv mw pq my mz na pr nc nd ne fk bk">As mentioned earlier, I purchased the <a class="af ny" href="https://www.amazon.com/Speedway-Printed-Track-DeepRacer-Matte/dp/B0BT8CGKTP" rel="noopener ugc nofollow" target="_blank">A To Z Speedway Track </a>recommended by AWS. The track is a simplified version of the <a class="af ny" href="https://www.formula1.com/en/information/italy-autodromo-nazionale-monza.FiJN1jnQlRLeHqOxIt13m" rel="noopener ugc nofollow" target="_blank">Autodroma Nazionale Monza F1 Track in Monza, Italy.</a></p><h2 id="cbd6" class="ps og fr bf oh pt pu pv ok pw px py on ms pz qa qb mw qc qd qe na qf qg qh qi bk">Track Review — Do Not Buy</h2><figure class="nf ng nh ni nj nk nr ns paragraph-image"><div role="button" tabindex="0" class="pj pk ed pl bh pm"><div class="nr ns qj"><img src="../Images/348dde094c2e4150f6a2ecb9134ebb7c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WLAKcWK6K3C9gEtt89G2qg@2x.jpeg"/></div></div><figcaption class="no np nq nr ns nt nu bf b bg z dx">The track is of terribly low quality and I would not recommend buying it. The surface is very creased, flimsy, and highlly reflective. Image by author.</figcaption></figure><p id="5d45" class="pw-post-body-paragraph mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fk bk">Personally, I would <strong class="ml fs">not</strong> recommend buying <a class="af ny" href="https://www.amazon.com/Speedway-Printed-Track-DeepRacer-Matte/dp/B0BT8CGKTP" rel="noopener ugc nofollow" target="_blank">this track.</a> It costs $760 plus taxes (the car <a class="af ny" href="https://www.amazon.com/AWS-DeepRacer-Fully-autonomous-developers/dp/B07JMHRKQG/ref=sr_1_1?crid=30BVZW4UKAM5S&amp;dib=eyJ2IjoiMSJ9.qyF0JnH5YYnFSRDVg9ViSV45_uIjGjxt_KK8SfhNITtHJx6iNeg9BmxLpl7RZDh_YlRRiO1WbcFsOUge4YuMZEfD9MCdRIngz8Fmo-y128P3RdHAB0lwDsvtnI7kvO4NzSeu_wM9G0qMdD-cQnvItTchdk-JthTNJKaT9d82PcJGU9AvZKtPLFcI6qaPcklH7HaTOp-1kImXR963CHm5gxGJaZP8bfKLSpZmVo665HS8hcmbkCzTdDUJSoQc16gmE8Bpd8SQyQR3c1Zwdf3oQgA82jI8lfXiNajo-mE7mIg.Fvk9UaaxYngFN1wsp6d2RIHNYm9dRrlGIH7JG_AzdV0&amp;dib_tag=se&amp;keywords=aws+deepracer&amp;qid=1724204524&amp;sprefix=aws+deep%2Caps%2C140&amp;sr=8-1" rel="noopener ugc nofollow" target="_blank">costs</a> almost half that) and is a little underwhelming to say the least.</p><ol class=""><li id="d6b2" class="mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne ph nw nx bk"><strong class="ml fs">Reflective Surface:</strong> The matte vinyl print is of low quality and highly reflective. Any ambient light washes out the camera and leads to crashes and other unexpected behavior.</li><li id="0123" class="mj mk fr ml b gp nz mn mo gs oa mq mr ms ob mu mv mw oc my mz na od nc nd ne ph nw nx bk"><strong class="ml fs">Creases:</strong> Track is very creased and this causes the car to get stuck. You can fix this to some extent by leaving your track spread out in the sun for a couple of days. I had limited success with this. You can also use a steam iron <a class="af ny" href="https://www.signs.com/blog/how-to-remove-wrinkles-from-vinyl-banners-signage-101/#:~:text=Use%20a%20heat%20gun%2C%20handheld%20steamer%2C%20or%20hairdryer%20on%20low,the%20creases%20on%20the%20banner." rel="noopener ugc nofollow" target="_blank">(see this guide)</a>. I did not try this, so please do this at your own risk.</li><li id="229f" class="mj mk fr ml b gp nz mn mo gs oa mq mr ms ob mu mv mw oc my mz na od nc nd ne ph nw nx bk"><strong class="ml fs">Size: </strong>Not really the tracks fault, but the track dimensions are18' x 27' which was too large for my house. It couldn’t even fit in my two-car garage. Luckily my office folks were kind enough to let me use the lunch room. It is also difficult very cumbersome to fold and carry.</li></ol><p id="a1cf" class="pw-post-body-paragraph mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fk bk">Overall, I was not impressed by the quality and would only recommend buying this track if you are short on time or do not want to go through the hassle of building your own.</p><h2 id="f342" class="ps og fr bf oh pt pu pv ok pw px py on ms pz qa qb mw qc qd qe na qf qg qh qi bk">Build Your Own Track (If Possible)</h2><p id="0026" class="pw-post-body-paragraph mj mk fr ml b gp pn mn mo gs po mq mr ms pp mu mv mw pq my mz na pr nc nd ne fk bk">If you can, try to build one on your own. Here is an <a class="af ny" href="https://docs.aws.amazon.com/deepracer/latest/developerguide/deepracer-build-your-track.html" rel="noopener ugc nofollow" target="_blank">official guide</a> from AWS and <a class="af ny" href="https://medium.com/@autonomousracecarclub/guide-to-creating-a-full-re-invent-2018-deepracer-track-in-7-steps-979aff28a6f5" rel="noopener">another one from Medium</a> User <a class="af ny" href="http://twitter.com/autonomousracecarclu" rel="noopener ugc nofollow" target="_blank">@autonomousracecarclu</a>b which looks more promising.</p><p id="d7eb" class="pw-post-body-paragraph mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fk bk">Using interlocking foam mats to build track is perhaps the best approach here. This addresses reflectiveness and friction problems of vinyl tracks. Also, these mats are lightweight and stack up easily; so moving and storing them is easier.</p><p id="260f" class="pw-post-body-paragraph mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fk bk">You can also get the track printed at FedEx and stick it on a rubber or concrete surface. Whether you build your own or get it printed, those approaches <em class="oe">are better than buying the one recommended by AWS </em>(both financially and performance-wise).</p><h1 id="7d32" class="of og fr bf oh oi oj gr ok ol om gu on oo op oq or os ot ou ov ow ox oy oz pa bk">Preparing Your Space — Lighting and Distractions</h1><p id="8315" class="pw-post-body-paragraph mj mk fr ml b gp pn mn mo gs po mq mr ms pp mu mv mw pq my mz na pr nc nd ne fk bk">Remember that the car only uses <strong class="ml fs">a black and white image </strong>to <em class="oe">understand and navigate </em>the environment around it. It cannot <em class="oe">recognize </em>objects — rather it learns to avoid or stick to one different shades of grey (from black to white). Stay on black track, avoid white boundaries and green out of bound area.</p><p id="a194" class="pw-post-body-paragraph mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fk bk">The following section outlines the physical setup recommended to make your car drive around the track successfully with minimum crashes.</p><figure class="nf ng nh ni nj nk nr ns paragraph-image"><div role="button" tabindex="0" class="pj pk ed pl bh pm"><div class="nr ns qk"><img src="../Images/be6cd908be0851c97f4b88d2391a6ccf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aL5cb4v-XPvvVc1ThXqvMw.jpeg"/></div></div><figcaption class="no np nq nr ns nt nu bf b bg z dx">Track preparation steps - (a) I reduced ambient lighting by pulling down all blinds and switching off ceiling lights. A couple of lights could not be switched off as they were always on for emergencies. (b) Barriers help reduce background distractions and reflections. Colored barriers work better than black ones. Green barriers are the most effective. I did not have enough green ones so I used them around more difficult turns. Image by author.</figcaption></figure><h2 id="600c" class="ps og fr bf oh pt pu pv ok pw px py on ms pz qa qb mw qc qd qe na qf qg qh qi bk">Minimize Ambient Lights</h2><p id="a4cd" class="pw-post-body-paragraph mj mk fr ml b gp pn mn mo gs po mq mr ms pp mu mv mw pq my mz na pr nc nd ne fk bk">Try to reduce ambient lighting as much as possible. This includes any natural light from windows and ceiling lights. Of course, you need some light for the camera to be able to see, but lower is better.</p><p id="6b72" class="pw-post-body-paragraph mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fk bk">If you cannot reduce lighting, try to make it as uniform as possible. Hotspots of light create more problems than the light itself. If your track is creased up like mine was, hotspots are more frequent and will cause more failures.</p><h2 id="aaf0" class="ps og fr bf oh pt pu pv ok pw px py on ms pz qa qb mw qc qd qe na qf qg qh qi bk">Colorful Interlocking Barriers</h2><p id="82f4" class="pw-post-body-paragraph mj mk fr ml b gp pn mn mo gs po mq mr ms pp mu mv mw pq my mz na pr nc nd ne fk bk">Both the color of the barriers and their placement are crucial. Perhaps a lot more crucial than I had initially anticipated. One might think they are used to protect the car if it crashes. Although that is part of it, barriers are more useful for reducing background distractions.</p><p id="0bb5" class="pw-post-body-paragraph mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fk bk">I used these <a class="af ny" href="https://www.samsclub.com/p/reversible-foam-mats-8-pack/prod3310384" rel="noopener ugc nofollow" target="_blank">2x2 ft Interlocking Mats from Costco</a>. AWS recommends using atleast <a class="af ny" href="https://docs.aws.amazon.com/deepracer/latest/developerguide/deepracer-build-your-track-construction.html#deepracer-build-your-track-construction-dimensions" rel="noopener ugc nofollow" target="_blank">2.5x2.5ft and<em class="oe"> any color but white</em></a><em class="oe">.</em> I realized that even <em class="oe">black </em>color throws off the car. So I would recommend colorful ones.</p><p id="c8db" class="pw-post-body-paragraph mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fk bk">The best are <strong class="ml fs">green colored ones </strong>since the car learns to avoid green in the simulation. Even though training and inference images are in grey scale, using green colored barriers work better. I had a mix of different colors so I used the green ones around turns where the car would go off track more than others.</p><p id="30a0" class="pw-post-body-paragraph mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fk bk">Remember from the earlier section — the car only uses <strong class="ml fs">a black and white image </strong>for understanding the environment around it. It does not <em class="oe">recognize </em>objects around it — rather it learns to avoid or stick to one different shades of grey (from black to white).</p><h1 id="84fa" class="of og fr bf oh oi oj gr ok ol om gu on oo op oq or os ot ou ov ow ox oy oz pa bk">What’s Next?</h1><p id="07c6" class="pw-post-body-paragraph mj mk fr ml b gp pn mn mo gs po mq mr ms pp mu mv mw pq my mz na pr nc nd ne fk bk">In future posts, I will focus on model training tips and vehicle calibration.</p><h1 id="4f5a" class="of og fr bf oh oi oj gr ok ol om gu on oo op oq or os ot ou ov ow ox oy oz pa bk">Acknowledgements</h1><p id="1482" class="pw-post-body-paragraph mj mk fr ml b gp pn mn mo gs po mq mr ms pp mu mv mw pq my mz na pr nc nd ne fk bk">Shout out to <a class="af ny" href="https://www.linkedin.com/in/wesstrait/" rel="noopener ugc nofollow" target="_blank">Wes Strait</a> for sharing his best practices and detailed notes on reducing the Sim2Real gap. <a class="af ny" href="https://www.linkedin.com/in/abhishekkroy/" rel="noopener ugc nofollow" target="_blank">Abhishek Roy</a> and <span class="ib"><span class="ib" aria-hidden="false"><a class="ql ic qm" href="https://medium.com/u/7d0b0a351a27?source=post_page---user_mention--580fb1244229--------------------------------" rel="noopener" target="_blank">Kyle Stahl</a></span></span> for helping with the experiments and documenting &amp; debugging different vehicle behaviors. Finally, thanks to the <a class="af ny" href="https://www.cargill.com" rel="noopener ugc nofollow" target="_blank">Cargill</a> R&amp;D Team for letting me use their lunch space for multiple days to experiment with the car and track.</p></div></div></div><div class="ab cb qn qo qp qq" role="separator"><span class="qr by bm qs qt qu"/><span class="qr by bm qs qt qu"/><span class="qr by bm qs qt"/></div><div class="fk fl fm fn fo"><div class="ab cb"><div class="ci bh ew ex ey ez"><h1 id="46a7" class="of og fr bf oh oi qv gr ok ol qw gu on oo qx oq or os qy ou ov ow qz oy oz pa bk">References</h1><p id="d40a" class="pw-post-body-paragraph mj mk fr ml b gp pn mn mo gs po mq mr ms pp mu mv mw pq my mz na pr nc nd ne fk bk">[1] Sutton, Richard S. “Reinforcement learning: an introduction.” <em class="oe">A Bradford Book</em> (2018).</p><p id="becd" class="pw-post-body-paragraph mj mk fr ml b gp mm mn mo gs mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fk bk">[2] Balaji, Bharathan, et al. “Deepracer: Educational autonomous racing platform for experimentation with sim2real reinforcement learning.” <em class="oe">arXiv preprint arXiv:1911.01562</em>(2019).</p></div></div></div></div>    
</body>
</html>