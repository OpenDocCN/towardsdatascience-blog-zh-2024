<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>lintsampler: a new way to quickly get random samples from any distribution</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>lintsampler: a new way to quickly get random samples from any distribution</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/lintsampler-a-new-way-to-quickly-get-random-samples-from-any-distribution-d07f73a70f5c?source=collection_archive---------8-----------------------#2024-10-14">https://towardsdatascience.com/lintsampler-a-new-way-to-quickly-get-random-samples-from-any-distribution-d07f73a70f5c?source=collection_archive---------8-----------------------#2024-10-14</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="gv gw gx gy gz ab"><div><div class="ab ha"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@aneesh92?source=post_page---byline--d07f73a70f5c--------------------------------" rel="noopener follow"><div class="l hb hc by hd he"><div class="l ed"><img alt="Aneesh Naik" class="l ep by dd de cx" src="../Images/65aff47941ac2013ccbbbc15423e03a8.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*Qj30G2TSU2Qat9pDEf-5jQ.png"/><div class="hf by l dd de em n hg eo"/></div></div></a></div></div><div class="hh ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--d07f73a70f5c--------------------------------" rel="noopener follow"><div class="l hi hj by hd hk"><div class="l ed"><img alt="Towards Data Science" class="l ep by br hl cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hf by l br hl em n hg eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hm ab q"><div class="ab q hn"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b ho hp bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hq" data-testid="authorName" href="https://medium.com/@aneesh92?source=post_page---byline--d07f73a70f5c--------------------------------" rel="noopener follow">Aneesh Naik</a></p></div></div></div><span class="hr hs" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b ho hp dx"><button class="ht hu ah ai aj ak al am an ao ap aq ar hv hw hx" disabled="">Follow</button></p></div></div></span></div></div><div class="l hy"><span class="bf b bg z dx"><div class="ab cn hz ia ib"><div class="ic id ab"><div class="bf b bg z dx ab ie"><span class="if l hy">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hq ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--d07f73a70f5c--------------------------------" rel="noopener follow"><p class="bf b bg z ig ih ii ij ik il im in bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hr hs" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">4 min read</span><div class="io ip l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Oct 14, 2024</span></div></span></div></span></div></div></div><div class="ab cp iq ir is it iu iv iw ix iy iz ja jb jc jd je jf"><div class="h k w ea eb q"><div class="jv l"><div class="ab q jw jx"><div class="pw-multi-vote-icon ed if jy jz ka"><div class=""><div class="kb kc kd ke kf kg kh am ki kj kk ka"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kl km kn ko kp kq kr"><p class="bf b dy z dx"><span class="kc">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kb ku kv ab q ee kw kx" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="kt"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count ks kt">3</span></p></button></div></div></div><div class="ab q jg jh ji jj jk jl jm jn jo jp jq jr js jt ju"><div class="ky k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al kz an ao ap hv la lb lc" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep ld cn"><div class="l ae"><div class="ab cb"><div class="le lf lg lh li lj ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al kz an ao ap hv lk ll kx lm ln lo lp lq s lr ls lt lu lv lw lx u ly lz ma"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al kz an ao ap hv lk ll kx lm ln lo lp lq s lr ls lt lu lv lw lx u ly lz ma"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al kz an ao ap hv lk ll kx lm ln lo lp lq s lr ls lt lu lv lw lx u ly lz ma"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><p id="6c33" class="pw-post-body-paragraph mb mc fq md b me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my fj bk"><code class="cx gr gs gt gu b">lintsampler</code> is a pure Python package that can easily and efficiently generate random samples from any probability distribution.</p><p id="4c1e" class="pw-post-body-paragraph mb mc fq md b me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my fj bk">Full disclosure: I am one of the authors of <code class="cx gr gs gt gu b">lintsampler</code>.</p><h1 id="1ece" class="mz na fq bf nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw bk">Why you need lintsampler</h1><p id="81f0" class="pw-post-body-paragraph mb mc fq md b me nx mg mh mi ny mk ml mm nz mo mp mq oa ms mt mu ob mw mx my fj bk">We often find ourselves in situations where we have a probability distribution (PDF) and we need to draw random samples it. For example, we might want to estimate some summary statistics or to create a population of particles for a simulation.</p><p id="9882" class="pw-post-body-paragraph mb mc fq md b me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my fj bk">If the probability distribution is a standard one, such as a uniform distribution or a Gaussian (normal) distribution, then the <code class="cx gr gs gt gu b">numpy</code>/<code class="cx gr gs gt gu b">scipy</code> ecosystem provides us with some easy ways to draw these samples, via the <code class="cx gr gs gt gu b">numpy.random</code> or <code class="cx gr gs gt gu b">scipy.stats</code> modules.</p><p id="74e8" class="pw-post-body-paragraph mb mc fq md b me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my fj bk">However, out in the wild, we often encounter probability distributions that are not Gaussian. Sometimes, they are <em class="oc">very</em> not Gaussian. For example:</p><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on ed oo bh op"><div class="od oe of"><img src="../Images/a816e849fa2d0c53df5dd8cde36582eb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GqQ_vor7AyKoG6XxMbHbGw.png"/></div></div><figcaption class="or os ot od oe ou ov bf b bg z dx">A very non-Gaussian PDF. Contour lines are lines of equal density, separated by equal intervals in log-space. Image by author.</figcaption></figure><p id="9d53" class="pw-post-body-paragraph mb mc fq md b me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my fj bk">How would we draw samples from this distribution?</p><p id="ce17" class="pw-post-body-paragraph mb mc fq md b me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my fj bk">There are a few widely-used techniques to draw samples from arbitrary distributions like this, such as <a class="af ow" href="https://en.wikipedia.org/wiki/Rejection_sampling" rel="noopener ugc nofollow" target="_blank">rejection sampling</a> or <a class="af ow" href="https://en.wikipedia.org/wiki/Markov_chain_Monte_Carlo" rel="noopener ugc nofollow" target="_blank">Markov chain Monte Carlo (MCMC)</a>. These are excellent and reliable methods, with some handy Python implementations. For example, <a class="af ow" href="https://emcee.readthedocs.io/en/stable/" rel="noopener ugc nofollow" target="_blank">emcee</a> is an MCMC sampler widely used in scientific applications.</p><p id="6761" class="pw-post-body-paragraph mb mc fq md b me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my fj bk">The problem with these existing techniques is that they require a fair amount of setup and tuning. With rejection sampling, one has to choose a proposal distribution, and a poor choice can make the procedure very inefficient. With MCMC one has to worry about whether the samples are converged, which typically requires some post-hoc testing to gauge.</p><p id="4462" class="pw-post-body-paragraph mb mc fq md b me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my fj bk">Enter <code class="cx gr gs gt gu b">lintsampler</code>. It’s as easy as:</p><pre class="og oh oi oj ok ox gu oy bp oz bb bk"><span id="8704" class="pa na fq gu b bg pb pc l pd pe">from lintsampler import LintSampler<br/>import numpy as np<br/><br/>x = np.linspace(xmin, xmax, ngrid)<br/>y = np.linspace(ymin, ymax, ngrid)<br/>sampler = LintSampler((x, y), pdf)<br/>pts = sampler.sample(N=100000)</span></pre><p id="e2ad" class="pw-post-body-paragraph mb mc fq md b me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my fj bk">In this code snippet, we constructed 1D arrays along each of the two dimensions, then we fed them to the <code class="cx gr gs gt gu b">LintSampler</code> object (imported from the <code class="cx gr gs gt gu b">lintsampler</code> package) along with a <code class="cx gr gs gt gu b">pdf</code> function representing the probability distribution we want to draw samples from. We didn’t spell out the <code class="cx gr gs gt gu b">pdf</code> function in this snippet, but there are some fully self-contained examples in the <a class="af ow" href="https://lintsampler.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">docs</a>.</p><p id="af4d" class="pw-post-body-paragraph mb mc fq md b me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my fj bk">Now, <code class="cx gr gs gt gu b">pts</code> is an array containing 100000 samples from the PDF. Here they are in a scatter plot:</p><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on ed oo bh op"><div class="od oe of"><img src="../Images/d79dcd41533335c64d581654d00cf3ee.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lmJ8euv1zB9U2j6W3Iyn1w.png"/></div></div><figcaption class="or os ot od oe ou ov bf b bg z dx">Scatter plot of points sampled from the weird PDF above (the latter is represented by the contour lines). Image by author.</figcaption></figure><p id="325b" class="pw-post-body-paragraph mb mc fq md b me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my fj bk">The point of this example was to demonstrate how easy it is to set up and use <code class="cx gr gs gt gu b">lintsampler</code>. In certain cases, it is also much faster and more efficient than MCMC and/or rejection sampling. If you’re interested to find out how <code class="cx gr gs gt gu b">lintsampler</code> works under the hood, read on. Otherwise, visit the <a class="af ow" href="https://lintsampler.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">docs</a>, where there are instructions describing <a class="af ow" href="https://lintsampler.readthedocs.io/en/latest/installation.html" rel="noopener ugc nofollow" target="_blank">how to install</a> and use <code class="cx gr gs gt gu b">lintsampler</code>, including example notebooks with <a class="af ow" href="https://lintsampler.readthedocs.io/en/latest/example_notebooks/1_gmm.html" rel="noopener ugc nofollow" target="_blank">1D</a>, <a class="af ow" href="https://lintsampler.readthedocs.io/en/latest/example_notebooks/2_doughnuts.html" rel="noopener ugc nofollow" target="_blank">2D</a>, and <a class="af ow" href="https://lintsampler.readthedocs.io/en/latest/example_notebooks/3_dark_matter.html" rel="noopener ugc nofollow" target="_blank">3D</a> use cases, as well as descriptions of some of lintsampler’s additional features: <a class="af ow" href="https://lintsampler.readthedocs.io/en/latest/example_notebooks/4_qmc.html" rel="noopener ugc nofollow" target="_blank">quasi Monte Carlo sampling</a> (a.k.a. low discrepancy sequencing), and sampling on an <a class="af ow" href="https://lintsampler.readthedocs.io/en/latest/densitytree.html" rel="noopener ugc nofollow" target="_blank">adaptive tree structure</a>. There is also a <a class="af ow" href="https://joss.theoj.org/papers/10.21105/joss.06906" rel="noopener ugc nofollow" target="_blank">paper</a> published in the Journal of Open Source Software (JOSS) describing <code class="cx gr gs gt gu b">lintsampler</code>.</p><h1 id="910d" class="mz na fq bf nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw bk">How lintsampler works</h1><p id="f0d4" class="pw-post-body-paragraph mb mc fq md b me nx mg mh mi ny mk ml mm nz mo mp mq oa ms mt mu ob mw mx my fj bk">Underlying <code class="cx gr gs gt gu b">lintsampler</code> is an algorithm we call <em class="oc">linear interpolant sampling</em>. The <a class="af ow" href="https://lintsampler.readthedocs.io/en/latest/theory/preamble.html" rel="noopener ugc nofollow" target="_blank">theory</a> section of the docs gives a more detailed and more mathematical description of how the algorithm works, but here it is in short.</p><p id="e53c" class="pw-post-body-paragraph mb mc fq md b me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my fj bk">The example below illustrates what happens under the hood in <code class="cx gr gs gt gu b">lintsampler</code> when you feed a PDF and a grid to the <code class="cx gr gs gt gu b">LintSampler</code> class. We’ll take an easy example of a 2D Gaussian, but this methodology applies in any number of dimensions, and with much less friendly PDFs.</p><ul class=""><li id="5ee6" class="mb mc fq md b me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my pf pg ph bk">First, the PDF gets evaluated on the grid. In the example below, the grid has uneven spacings, just for fun.</li></ul><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on ed oo bh op"><div class="od oe of"><img src="../Images/3ea73a9e43dfcf1f8357735edfbacb2c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0SVLyjJyi6Yx6eH00Nzt6w.png"/></div></div><figcaption class="or os ot od oe ou ov bf b bg z dx">Left: 2D Gaussian PDF. Right: PDF evaluated on (uneven) grid. Image by author.</figcaption></figure><ul class=""><li id="1132" class="mb mc fq md b me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my pf pg ph bk">Having evaluated the PDF on the grid in this way, we can estimate the total probability of each grid cell according to the trapezium rule (i.e., volume of the cell multiplied by the average of its corner densities).</li><li id="c993" class="mb mc fq md b me pi mg mh mi pj mk ml mm pk mo mp mq pl ms mt mu pm mw mx my pf pg ph bk">Within each grid cell, we can approximate the PDF with the <a class="af ow" href="https://en.wikipedia.org/wiki/Bilinear_interpolation" rel="noopener ugc nofollow" target="_blank">bilinear interpolant</a> between the cell corners:</li></ul><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on ed oo bh op"><div class="od oe of"><img src="../Images/d349e131a17ba10837746ab5363527d6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UkiLM71T6Ao3kBgm0xcf6g.png"/></div></div><figcaption class="or os ot od oe ou ov bf b bg z dx">Gridded PDF filled in with (bi)linear interpolation. Image by author.</figcaption></figure><ul class=""><li id="ac7e" class="mb mc fq md b me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my pf pg ph bk">This linear approximation to the PDF can then be sampled very efficiently. Drawing a single sample is a two step process, illustrated in the figure below. First, choose a random cell from the probability-weighted list of cells (left-hand panel). Next, sample a point within the cell via <a class="af ow" href="https://en.wikipedia.org/wiki/Inverse_transform_sampling" rel="noopener ugc nofollow" target="_blank">inverse transform sampling</a> (right-hand panel).</li></ul><figure class="og oh oi oj ok ol od oe paragraph-image"><div role="button" tabindex="0" class="om on ed oo bh op"><div class="od oe of"><img src="../Images/abf2821331ada9ab62cafcd622eb73e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lQ7cX-vSlY3AUpBbqchtWQ.png"/></div></div><figcaption class="or os ot od oe ou ov bf b bg z dx">Left: same as previous figure, with randomly chosen cell highlighted. Right: Zoom-in of highlighted cell, with sampled point illustrated. Image by author.</figcaption></figure><p id="17a8" class="pw-post-body-paragraph mb mc fq md b me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my fj bk">It is worth understanding that the key step here is the linear approximation: we describe this, as well as more details of the inverse transform sampling process, in the <code class="cx gr gs gt gu b">lintsampler</code> docs. Approximating the PDF to a linear function within grid each cell means it has a closed, analytic form for its <a class="af ow" href="https://en.wikipedia.org/wiki/Quantile_function" rel="noopener ugc nofollow" target="_blank">quantile function</a> (i.e., its inverse CDF), which means doing inverse transform sampling essentially boils down to drawing uniform samples and applying an algebraic function to them.</p><p id="deb4" class="pw-post-body-paragraph mb mc fq md b me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my fj bk">The main thing the user needs to worry about is getting a decent grid resolution, so that the linear approximation is sufficient. What a good resolution is will vary from use case to use case, as demonstrated in some of the example notebooks in the <code class="cx gr gs gt gu b">lintsampler</code> docs.</p><p id="0eae" class="pw-post-body-paragraph mb mc fq md b me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx my fj bk">Happy sampling!</p></div></div></div></div>    
</body>
</html>