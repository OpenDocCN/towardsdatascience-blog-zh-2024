# 使用GLOP进行预测性营销组合建模：完美的摇酒器

> 原文：[https://towardsdatascience.com/predictive-marketing-mix-modeling-with-glop-the-perfect-cocktail-shaker-1f071b18efc4?source=collection_archive---------7-----------------------#2024-07-12](https://towardsdatascience.com/predictive-marketing-mix-modeling-with-glop-the-perfect-cocktail-shaker-1f071b18efc4?source=collection_archive---------7-----------------------#2024-07-12)

## 使用机器学习和GLOP（由Google提供）在数字领域最大化利润

[](https://medium.com/@gonzaloespinosaduelo?source=post_page---byline--1f071b18efc4--------------------------------)[![Gonzalo Espinosa Duelo](../Images/bdd4d285728c682b619138ed6e5bffaf.png)](https://medium.com/@gonzaloespinosaduelo?source=post_page---byline--1f071b18efc4--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--1f071b18efc4--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--1f071b18efc4--------------------------------) [Gonzalo Espinosa Duelo](https://medium.com/@gonzaloespinosaduelo?source=post_page---byline--1f071b18efc4--------------------------------)

·发布于[Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--1f071b18efc4--------------------------------) ·11分钟阅读·2024年7月12日

--

![](../Images/cca3b59d4a7df611d19db4181f181e22.png)

使用DALL-E生成的图像

# 🍹调制完美鸡尾酒

想象一下，走进一个高档酒吧。爵士乐正播放着，时尚的调酒师正在准备一款精致的鸡尾酒。这位调酒师，调酒艺术的大师，不是随意将各种成分倒入摇酒器里希望能够成功。他运用自己多年实践中积累的知识和经验，精心调配出完美的混合。他知道哪些成分相辅相成，哪些比例能产生最佳的口味，并且能够根据你的偏好和反馈来调整配方。

就像调酒师在制作完美鸡尾酒一样，**市场营销人员面临着找到理想的获客渠道组合**这一具有挑战性的任务，以优化他们的广告预算并最大化转化率。

在这个过程中，广告支出回报率（ROAS）就像是酒吧中的量酒器——一个决定活动成败的关键指标。

> ROAS = 广告带来的收入 / 广告费用

在今天的营销环境中，许多活动仍然基于**试错法**进行运作。营销人员对表现作出**反应**。当一个活动表现良好时，他们会增加投资；否则，他们则会减少投资。

对于那些销售过程需要几天时间才能完成的长期成熟期的商业模型，试错法策略显得反应不够及时，而且可能带来痛苦的后果。它们需要一种更加主动的策略。

其他传统方法试图通过大量依赖描述性历史数据来预测ROAS。市场营销人员查看过去的表现，**平衡近期几周和年度同比（YoY）数据**，以识别趋势并对未来可能有效的策略做出有根据的推测。

不幸的是，这些假设也失败了。

市场动态变化迅速，竞争对手以相似的营销策略出现，导致**转化率看起来不稳定，并导致ROAS的大幅波动**。历史转化模式不足以准确预测广告活动的表现。

对于市场营销人员来说，这种**不可预测性**不仅仅是一个麻烦，它还是一个重大的障碍。每一笔广告支出都是对正向回报的押注。当广告活动未能成功时，这不仅影响了公司利润，还削弱了销售团队对市场营销策略的信心，尤其是在他们收到较低质量潜在客户时，他们的成功几率也会直接受到影响。

除了实现最佳绩效，市场营销人员还应关注**为销售团队提供潜在客户**，并确保所有团队都能获得足够数量的潜在客户。市场营销负责维持销售网络的运转，既要保证数量，又要确保质量。潜在客户的短缺将成为一个严重的问题，进而对销售产生负面影响。

然而，分配广告投资是一项复杂的任务。尽管CPL、转化率和生成的潜在客户数量存在不确定性，市场营销人员仍需精确确定分配给每个渠道和广告活动的预算。

> 广告活动的调整是一个复杂的任务，市场营销人员往往会感到力不从心。

**预测性营销组合建模（PMMM）**满足了市场营销人员的需求。它确定了每个广告活动或获取渠道的**最佳投资组合**，既关注ROAS表现，也考虑了量的限制。

> 目标是最大化利润，同时确保每个销售团队获得适当数量的潜在客户。

在本文中，我将介绍如何通过结合线性优化和机器学习来解决PMMM问题，利用**资源分配**问题和基于机器学习的**预测组件**。

# 📈 商业案例

在2023年，我处理了一个西班牙领先教育行业公司的市场营销组合建模案例。

他们在**六个不同的付费获取渠道**上为**三种** **产品类型**运行常规广告活动。一些平台因与像Educaedu和Emagister等潜在客户生成商的合同而具有固定的每条潜在客户成本（CPL）。相比之下，其他平台，如Google Ads和Meta Ads，则提供具有**可变CPL**的潜在客户。这种变化为问题引入了第一层**复杂性和不确定性**。

> 理解CPL在各渠道中的作用至关重要

公司在**上一季度**的MMM状态如下：

![](../Images/c7b62221636c740c32b2c8024095144d.png)

图片来源：作者

如表所示，具有更好ROAS的渠道是Emagister，而Educaedu提供了最差的ROAS。这应该在我们的MMM模型中得到反映，因为**ROAS高于平均值的渠道可能是投资机会**。

## 那么，销售团队怎么办？

公司在西班牙各地运营着**15家教育机构**。自然，他们的活动按地区进行细分，销售团队也是如此。每个团队有一定数量的销售代理，并且每月能够处理的线索数量有限。

这给我们的问题增加了约束条件：

> 我们需要确保每个中心每月都有最低数量的线索，同时不能超过销售组织承受的上限。

考虑到每月为营销活动分配的预算，目标是**选择每个渠道的投资金额以最大化利润**，同时确保**销售团队获得足够的线索**。

> 🚨 **剧透**：通过结合GLOP和机器学习（ML），解决方案实现了令人惊叹的**+13.8%利润**。下面查看我是如何得出这个解决方案的。

# 🪵🪨🪙 资源分配

资源分配是将可用资源在各种竞争任务之间分配的过程，目的是最大化目标。在我们的案例中，定义资源分配问题的关键概念如下：

## 关键概念

1.  **目标**：分配过程旨在实现的目标。在这个商业案例中，目标是最大化利润。

1.  **资源**：任何完成任务所需的东西。在我们的案例中，**营销预算和销售需求**。

1.  **任务**：需要资源才能完成的活动。在我们的案例中，**选择具有最高利润潜力的渠道和活动**。

这种问题面临着多重挑战，简要总结如下：

+   **复杂性**：许多资源分配问题是NP难题，意味着它们在计算上很难解决。

> 在我们的商业案例中，我使用了**GLOP**来应对这一复杂性。我通过考虑一些**经过验证的假设**来使用线性优化，详细信息如下。

+   **约束**：必须考虑现实世界中的限制因素，如预算限制和资源容量。

+   **不确定性**：活动表现的未来行为可能是不确定的，增加了估算的复杂性。

> 在这个商业案例中，不同学校和产品之间渠道的转化率（CR）是不确定的，并且远非恒定。在使用GLOP编程之前，我开发了一个基于**XGBoost**的线索评分模型来预测转化率，因为销售生命周期太长，无法依赖短期模式。该模型表现优异，在超时（OOT）测试中取得了**85%的AUC和0.1的log-loss**，显著减少了CR的收入不确定性。拥有准确的线索评分模型后，剩下的工作就是**平均预测值**，以获得每个细分市场的预期转化率。

# 🤓 公式化

为了基于业务案例制定优化问题，让我们分解必要的变量、目标和约束条件。

## 定义

![](../Images/e6d494d211bd3692364e04a4d2dcb6cc.png)

> 提醒一下，转化率是一个期望值，通过潜在客户评分模型进行预测。其他组件基于前几个月的历史数据平均值。

## 目标

最大化所有渠道、学校和产品类型的利润总和，具体取决于成本。

![](../Images/4e3ba38c708e2e7b4068fc94aca8276b.png)![](../Images/7df3b3cd6bef0e91b6b863a729f234c6.png)

其中，量为：

![](../Images/839934c24216b5a839295abf5297d33b.png)

代入利润表达式，我们得到：

![](../Images/f5879e148857088511235684fb06f129.png)

图片来源：作者

## 约束条件

1.  **非负约束：**

投资应该是非负的。

![](../Images/002f4c2ad1133bb72a9994639b6b87d1.png)

2. **预算约束**：

所有成本的总和必须与总预算***B***完全相等。

![](../Images/284c1ba0457e5e4b0e64d5b7cd74657b.png)

每个渠道 *i* 可以超过一个特定的预算***B***i*：

![](../Images/9cded16471af71809630d949345ded10.png)

3. **生成的潜在客户**：

每个学校 *j* 必须接收一个在指定范围内的潜在客户数量，该范围由最小值和最大值 ***L*** 限定：

![](../Images/91441577ec37241106170e5fd6ba57a9.png)

图片来源：作者

4. **与基准的偏差**

除了必要的约束条件，公司还希望增加一个额外的约束，即最大偏离其基准的限制。

每个月，公司会定义一个投资基准（由市场营销人员计算）。输出应该偏离基准最多30%。

![](../Images/84d51bdf9a50c2b082cc240aa83f7b5a.png)

图片来源：作者

# 假设

## 从非线性到线性

请注意，由于某些渠道（如Google和Meta Ads）中CPL与成本的依赖关系，**这个问题本质上是非线性的**。

然而，如果成本偏差的范围受到限制，CPL的变化也会相应受到限制。鉴于我们是从基准开始，并允许最大30%的变化，我们可以合理地假设这个条件成立，并且可以假设每个渠道的CPL**大致保持恒定**。

为了估算CPL，我们将使用上个月的CPL数据。虽然这种方法可能会与实际CPL存在一些差异，但它仍然比基准有所改进。

> 如果需要应对投资的重大变化，应该使用非线性优化器。通常，CPL与数字平台的总投资之间的依赖关系是线性的。这可以通过简单的线性回归建模，进而得到一个二次规划问题。然而，我建议你用数据进行验证。

假设CPL恒定，则：

![](../Images/476085199734089adb1b02795174fb41.png)

并且

![](../Images/1089c8cd45f2c3b4a22573a9e0dca6c6.png)

图片来源：作者

通过这样的调整，**问题变成了线性问题**。

## 其他假设：

鉴于在一些活动 *ijk* 中，历史数据量较低，包含了以下其他假设：

1.  **转化率（CR）不依赖于投资。** 这个假设比较难。转化率主要依赖于销售表现和市场动态，也与潜在客户的质量相关。潜在客户的质量直接取决于从渠道获得的线索类型。有些渠道可能提供比其他渠道更好的潜在客户质量，这是我们能够衡量的。然而，每个渠道基于各种因素决定了向我们发送线索的质量，其中一个因素可能是投资金额。例如，他们可以决定是否将我们的广告显示在顶部位置，而这个决定可能会受到我们投资金额的影响。

    我假设转化率不依赖于投资，因为我可以通过较低的时效性对数损失预测转化率，表明模型拟合优异。这意味着使用的变量（不包括投资）将其他未见因素的影响降低为低噪音。投资对转化率的影响应当最小。

1.  **每个频道的 CPL 是固定的。** 实际上，CPL 可能在一个频道内有所变化，并应针对每个活动（ijk）计算，但某些活动的量较小，显著增加了它们的不确定性。因此，我使用了频道的 CPL。然后：

![](../Images/09f46021cb04980c4486883fd05097d0.png)

和

![](../Images/8fc9e2b1a4a3894891f6d5139e32c776.png)

图片由作者提供

# 🧮 使用 GLOP 求解 LP 问题（由 Google 提供）

GLOP（Google 线性优化包）是一个线性编程求解器，是 Google OR-Tools 的一部分，OR-Tools 是一个开源的优化软件套件。GLOP 旨在解决线性规划问题，这些问题涉及在一个数学模型中找到最佳结果，其要求通过线性关系表示。

[](https://developers.google.com/optimization/lp/lp_example?source=post_page-----1f071b18efc4--------------------------------) [## 求解 LP 问题 | OR-Tools | Google for Developers

### 以下各节展示了一个线性规划（LP）问题的示例，并演示了如何解决该问题。问题如下：最大化 3x +…

developers.google.com](https://developers.google.com/optimization/lp/lp_example?source=post_page-----1f071b18efc4--------------------------------)

GLOP 是一种高效的原始对偶混合算法实现，非常容易实现。我通过编写几小时的代码使用它来解决我们的资源分配问题。

具体来说，我使用了**or-tools**中的[**pywraplp**](https://developers.google.com/optimization/reference/python/linear_solver/pywraplp)模块，GLOP 是该模块提供的求解器之一。

通过使用该模块，公式可以轻松转化为代码，从而计算最佳解决方案。

> 🛎️ 如果你对代码感兴趣，请在下方评论。

# 🚀 结果

使用 GLOP 实现的这个 MMM 在**下一个季度**进行了测试，并得到了令人印象深刻的结果如下：

![](../Images/24eac96f0f418e5efe204ed3cca7f489.png)

图片由作者提供

> 💥 该解决方案实现了令人印象深刻的+13.86% 💥

与营销团队定义的基准相比，渠道的投资分配发生了显著变化，但未超过30%的限制。

以下是**前三个月每个渠道的投资百分比差异**：

![](../Images/e5a5df54e4b6f893a48351818f360eaa.png)

作者提供的图片

注意，Emagister和Meta被低估了，另一方面，Educaedu和Google Ads被高估了。

**渠道分布与ROAS相关，但并不完全与观察到的ROAS提升一致**。最优分配受到容量约束的影响，并且依赖于特定渠道在根据位置为学校生成潜在客户和不同产品的有效性。因此，渠道分布可能会呈现出变动。

> 注意：每个平台的有效性取决于多个因素，如目标受众、商业模式、活动类型等。这不是投资营销建议，而是一个具体的示例。

# 🏆 成功的关键

在开发这个项目的过程中，我识别出了几个关键点，这些是实现卓越表现的关键。

这是一个总结：

1.  **GLOP的卓越表现。** 该包能够快速找到最优解，使其在解决线性规划任务时非常高效。它在解决复杂优化问题时的**速度和准确性**显著提升了项目成果。同样重要的是其**直观的类和函数**，使得将公式转化为代码变得简单。GLOP已被证明在资源分配问题上表现出色。

1.  **通过基于机器学习（ML）的预测潜在客户评分精确预测转化率（CR）**。特别提到的是实现了**较低的对数损失误差**，这不仅有助于良好的区分性，而且在**最小化平均概率与实际转化率之间的误差**方面尤为重要。这大大减少了不确定性。

1.  **通过统计分析精确识别每个细分市场的CPL（无需任何机器学习）**。这使得可以根据投资识别每个细分市场提供的潜在客户量，并且**简化为一个线性问题**。需要注意！如果你在活动中使用较大的投资变动，常数CPL的假设可能会变得更复杂。

# 最后的说明

感谢您的阅读！

如果您有任何想法或问题，请留下评论。您的反馈对我非常重要，我很高兴听到读者的声音。

如果您对作为此算法一部分使用的机器学习模型有兴趣，或需要更多关于GLOP的信息，请告诉我。我正在考虑撰写关于它的另一篇文章。

敬请关注更多深入的文章和更新！

别忘了关注以获取最新的内容和讨论。你的支持对我来说意味着一切！
