# æ•°æ®æ³„éœ²åœ¨é¢„å¤„ç†ä¸­çš„è§£é‡Šï¼šå¸¦ä»£ç ç¤ºä¾‹çš„è§†è§‰æŒ‡å—

> åŸæ–‡ï¼š[https://towardsdatascience.com/data-leakage-in-preprocessing-explained-a-visual-guide-with-code-examples-33cbf07507b7?source=collection_archive---------2-----------------------#2024-10-30](https://towardsdatascience.com/data-leakage-in-preprocessing-explained-a-visual-guide-with-code-examples-33cbf07507b7?source=collection_archive---------2-----------------------#2024-10-30)

## æ•°æ®é¢„å¤„ç†

## 10ç§éšè”½çš„é¢„å¤„ç†ç®¡é“æ³„éœ²æ–¹å¼

[](https://medium.com/@samybaladram?source=post_page---byline--33cbf07507b7--------------------------------)[![Samy Baladram](../Images/715cb7af97c57601966c5d2f9edd0066.png)](https://medium.com/@samybaladram?source=post_page---byline--33cbf07507b7--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--33cbf07507b7--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--33cbf07507b7--------------------------------) [Samy Baladram](https://medium.com/@samybaladram?source=post_page---byline--33cbf07507b7--------------------------------)

Â·å‘è¡¨äº[Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--33cbf07507b7--------------------------------) Â·é˜…è¯»æ—¶é—´14åˆ†é’ŸÂ·2024å¹´10æœˆ30æ—¥

--

`â›³ï¸ æ›´å¤š[æ•°æ®é¢„å¤„ç†](https://medium.com/@samybaladram/list/data-preprocessing-17a2c49b44e4)è§£é‡Šï¼šÂ· [ç¼ºå¤±å€¼å¡«è¡¥](/missing-value-imputation-explained-a-visual-guide-with-code-examples-for-beginners-93e0726284eb) Â· [ç±»åˆ«ç¼–ç ](/encoding-categorical-data-explained-a-visual-guide-with-code-example-for-beginners-b169ac4193ae) Â· [æ•°æ®ç¼©æ”¾](/scaling-numerical-data-explained-a-visual-guide-with-code-examples-for-beginners-11676cdb45cb) Â· [ç¦»æ•£åŒ–](/discretization-explained-a-visual-guide-with-code-examples-for-beginners-f056af9102fa?gi=c1bf25229f86) Â· [è¿‡é‡‡æ ·ä¸æ¬ é‡‡æ ·](/oversampling-and-undersampling-explained-a-visual-guide-with-mini-2d-dataset-1155577d3091) â–¶ [æ•°æ®æ³„éœ²åœ¨é¢„å¤„ç†ä¸­çš„åº”ç”¨](/data-leakage-in-preprocessing-explained-a-visual-guide-with-code-examples-33cbf07507b7)`

åœ¨æˆ‘æ•™æˆæœºå™¨å­¦ä¹ çš„ç»éªŒä¸­ï¼Œå­¦ç”Ÿä»¬ç»å¸¸é‡åˆ°è¿™æ ·çš„é—®é¢˜ï¼šâ€œæˆ‘çš„æ¨¡å‹è¡¨ç°å¾—å¾ˆå¥½â€”â€”å‡†ç¡®ç‡è¶…è¿‡90%ï¼ä½†æ˜¯å½“æˆ‘æäº¤ç»™éšè—æ•°æ®é›†è¿›è¡Œæµ‹è¯•æ—¶ï¼Œç»“æœä¸å¦‚é¢„æœŸã€‚å“ªé‡Œå‡ºäº†é—®é¢˜ï¼Ÿâ€è¿™ç§æƒ…å†µå‡ ä¹æ€»æ˜¯æŒ‡å‘æ•°æ®æ³„éœ²ã€‚

æ•°æ®æ³„éœ²å‘ç”Ÿåœ¨æµ‹è¯•æ•°æ®çš„æŸäº›ä¿¡æ¯åœ¨æ•°æ®å‡†å¤‡æ­¥éª¤ä¸­æ‚„æ‚„åœ°ï¼ˆæˆ–æ³„éœ²ï¼‰è¿›å…¥è®­ç»ƒæ•°æ®æ—¶ã€‚è¿™ç§æƒ…å†µé€šå¸¸å‘ç”Ÿåœ¨å¸¸è§„çš„æ•°æ®å¤„ç†ä»»åŠ¡ä¸­ï¼Œè€Œä½ æœªæ›¾å¯Ÿè§‰ã€‚å½“è¿™ç§æƒ…å†µå‘ç”Ÿæ—¶ï¼Œæ¨¡å‹**ä»ä¸è¯¥çœ‹åˆ°çš„æµ‹è¯•æ•°æ®ä¸­å­¦ä¹ **ï¼Œä½¿å¾—æµ‹è¯•ç»“æœå…·æœ‰è¯¯å¯¼æ€§ã€‚

è®©æˆ‘ä»¬çœ‹çœ‹å¸¸è§çš„æ•°æ®é¢„å¤„ç†æ­¥éª¤ï¼Œå¹¶å‡†ç¡®äº†è§£æ•°æ®æ³„æ¼æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆâ€”â€”å¸Œæœ›ä½ å¯ä»¥åœ¨è‡ªå·±çš„é¡¹ç›®ä¸­é¿å…è¿™äº›â€œç®¡é“é—®é¢˜â€ã€‚

![](../Images/f9b656af3dc4c870b634e61dfd631791.png)

æ‰€æœ‰è§†è§‰å›¾ï¼šä½œè€…ä½¿ç”¨ Canva Pro åˆ›å»ºã€‚ä¼˜åŒ–ä¸ºç§»åŠ¨ç«¯æ˜¾ç¤ºï¼›åœ¨æ¡Œé¢ç«¯å¯èƒ½ä¼šæ˜¾å¾—è¿‡å¤§ã€‚

# å®šä¹‰

æ•°æ®æ³„æ¼æ˜¯æœºå™¨å­¦ä¹ ä¸­ä¸€ä¸ªå¸¸è§çš„é—®é¢˜ï¼Œå®ƒå‘ç”Ÿåœ¨ä¸åº”è¯¥è¢«æ¨¡å‹çœ‹åˆ°çš„æ•°æ®ï¼ˆä¾‹å¦‚æµ‹è¯•æ•°æ®æˆ–æœªæ¥æ•°æ®ï¼‰è¢«æ„å¤–ç”¨æ¥è®­ç»ƒæ¨¡å‹æ—¶ã€‚è¿™å¯èƒ½å¯¼è‡´æ¨¡å‹è¿‡æ‹Ÿåˆï¼Œåœ¨æ–°çš„ã€æœªè§è¿‡çš„æ•°æ®ä¸Šè¡¨ç°ä¸ä½³ã€‚

ç°åœ¨ï¼Œè®©æˆ‘ä»¬é›†ä¸­è®¨è®ºä»¥ä¸‹æ•°æ®é¢„å¤„ç†æ­¥éª¤ä¸­çš„æ•°æ®æ³„æ¼é—®é¢˜ã€‚è¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬è¿˜å°†çœ‹åˆ°è¿™äº›æ­¥éª¤å¯¹åº”çš„ `scikit-learn` é¢„å¤„ç†æ–¹æ³•åç§°ï¼Œå¹¶ä¸”åœ¨æ–‡ç« çš„æœ€åä¼šçœ‹åˆ°ä»£ç ç¤ºä¾‹ã€‚

![](../Images/04fe8556bee3eb3b7108de42fc432543.png)

# ç¼ºå¤±å€¼å¡«å……

åœ¨å¤„ç†çœŸå®æ•°æ®æ—¶ï¼Œä½ ç»å¸¸ä¼šé‡åˆ°ç¼ºå¤±å€¼ã€‚ä¸å…¶åˆ é™¤è¿™äº›ä¸å®Œæ•´çš„æ•°æ®ç‚¹ï¼Œä¸å¦‚ç”¨åˆç†çš„ä¼°è®¡å€¼æ¥å¡«å……å®ƒä»¬ã€‚è¿™å¯ä»¥å¸®åŠ©æˆ‘ä»¬ä¿ç•™æ›´å¤šçš„æ•°æ®è¿›è¡Œåˆ†æã€‚

å¡«å……ç¼ºå¤±å€¼çš„ç®€å•æ–¹æ³•åŒ…æ‹¬ï¼š

1.  ä½¿ç”¨ `SimpleImputer(strategy='mean')` æˆ– `SimpleImputer(strategy='median')` ç”¨è¯¥åˆ—çš„å¹³å‡å€¼æˆ–ä¸­å€¼æ¥å¡«å……

1.  ä½¿ç”¨ `KNNImputer()` æŸ¥çœ‹ç›¸ä¼¼æ•°æ®ç‚¹å¹¶ä½¿ç”¨å®ƒä»¬çš„å€¼

1.  ä½¿ç”¨ `SimpleImputer(strategy='ffill')` æˆ– `SimpleImputer(strategy='bfill')` ç”¨æ•°æ®ä¸­å‰ä¸€ä¸ªæˆ–åä¸€ä¸ªå€¼æ¥å¡«å……

1.  ä½¿ç”¨ `SimpleImputer(strategy='constant', fill_value=value)` ç”¨ç›¸åŒçš„æ•°å­—æˆ–æ–‡æœ¬å¡«å……æ‰€æœ‰ç¼ºå¤±çš„ä½ç½®

è¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºå¡«å……ï¼Œè™½ç„¶å®ƒå¾ˆæœ‰ç”¨ï¼Œä½†æˆ‘ä»¬éœ€è¦å°å¿ƒå¦‚ä½•è®¡ç®—è¿™äº›æ›¿ä»£å€¼ï¼Œä»¥é¿å…æ•°æ®æ³„æ¼ã€‚

## **æ•°æ®æ³„æ¼æ¡ˆä¾‹ï¼šç®€å•å¡«å……ï¼ˆå‡å€¼ï¼‰**

å½“ä½ ä½¿ç”¨æ‰€æœ‰æ•°æ®çš„å‡å€¼æ¥å¡«å……ç¼ºå¤±å€¼æ—¶ï¼Œå‡å€¼æœ¬èº«åŒ…å«äº†æ¥è‡ªè®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„ä¿¡æ¯ã€‚è¿™ä¸ªç»„åˆå‡å€¼ä¸åŒäºä»…ä½¿ç”¨è®­ç»ƒæ•°æ®è®¡ç®—çš„å‡å€¼ã€‚ç”±äºè¿™ä¸ªä¸åŒçš„å‡å€¼è¿›å…¥äº†è®­ç»ƒæ•°æ®ï¼Œä½ çš„æ¨¡å‹ä»å®ƒæœ¬ä¸è¯¥çœ‹åˆ°çš„æµ‹è¯•æ•°æ®ä¸­å­¦ä¹ ã€‚æ€»ç»“ä¸€ä¸‹ï¼š

ğŸš¨ **é—®é¢˜æ‰€åœ¨** ä½¿ç”¨å®Œæ•´æ•°æ®é›†è®¡ç®—å‡å€¼

âŒ **æˆ‘ä»¬åšé”™äº†ä»€ä¹ˆ** ä½¿ç”¨è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„ç»Ÿè®¡æ•°æ®æ¥è®¡ç®—å¡«å……å€¼

ğŸ’¥ **åæœ** è®­ç»ƒæ•°æ®åŒ…å«å—æµ‹è¯•æ•°æ®å½±å“çš„å¹³å‡å€¼

![](../Images/d6efef35923d84701a67951a2c693a10.png)

å‡å€¼å¡«å……æ³„æ¼å‘ç”Ÿåœ¨ä½¿ç”¨ä»æ‰€æœ‰æ•°æ®è¡Œè®¡ç®—å¾—åˆ°çš„å¹³å‡å€¼ï¼ˆ4ï¼‰å¡«å……ç¼ºå¤±å€¼ï¼Œè€Œä¸æ˜¯æ­£ç¡®åœ°åªä½¿ç”¨è®­ç»ƒæ•°æ®çš„å¹³å‡å€¼ï¼ˆ3ï¼‰ï¼Œå¯¼è‡´é”™è¯¯çš„å¡«å……å€¼ã€‚

## **æ•°æ®æ³„æ¼æ¡ˆä¾‹ï¼šKNN å¡«å……**

å½“ä½ ä½¿ç”¨KNNå¡«å……ç¼ºå¤±å€¼æ—¶ï¼Œç®—æ³•ä¼šä»è®­ç»ƒé›†å’Œæµ‹è¯•é›†æ‰¾åˆ°ç›¸ä¼¼çš„æ•°æ®ç‚¹ã€‚å®ƒåˆ›å»ºçš„æ›¿ä»£å€¼æ˜¯åŸºäºè¿™äº›é‚»è¿‘ç‚¹çš„ï¼Œè¿™æ„å‘³ç€æµ‹è¯•é›†çš„å€¼ç›´æ¥å½±å“è®­ç»ƒæ•°æ®ä¸­çš„å†…å®¹ã€‚ç”±äºKNNä¼šæŸ¥çœ‹å®é™…çš„é‚»è¿‘å€¼ï¼Œå› æ­¤è¿™ç§è®­ç»ƒå’Œæµ‹è¯•ä¿¡æ¯çš„æ··åˆæ¯”ç®€å•çš„å‡å€¼å¡«å……æ›´ä¸ºç›´æ¥ã€‚æ€»ç»“æ¥è¯´ï¼š

ğŸš¨ **é—®é¢˜** åœ¨å®Œæ•´æ•°æ®é›†ä¸Šå¯»æ‰¾é‚»å±…

âŒ **æˆ‘ä»¬åšé”™äº†ä»€ä¹ˆ** ä½¿ç”¨æµ‹è¯•é›†æ ·æœ¬ä½œä¸ºæ½œåœ¨çš„é‚»å±…è¿›è¡Œå¡«å……

ğŸ’¥ **åæœ** ä½¿ç”¨ç›´æ¥çš„æµ‹è¯•é›†ä¿¡æ¯å¡«å……ç¼ºå¤±å€¼

![](../Images/9fafdbf52962bef41e3fb5bec8e2325c.png)

KNNå¡«å……æ³„æ¼å‘ç”Ÿåœ¨ä½¿ç”¨è®­ç»ƒé›†å’Œæµ‹è¯•é›†æ•°æ®å…±åŒå¯»æ‰¾æœ€è¿‘é‚»ï¼ˆç”Ÿæˆ3.5å’Œ4.5çš„å€¼ï¼‰ï¼Œè€Œä¸æ˜¯æ­£ç¡®åœ°åªä½¿ç”¨è®­ç»ƒæ•°æ®çš„æ¨¡å¼æ¥å¡«å……ç¼ºå¤±å€¼ï¼ˆç”Ÿæˆ6å’Œ6çš„å€¼ï¼‰ã€‚

# ç±»åˆ«ç¼–ç 

æœ‰äº›æ•°æ®ä»¥ç±»åˆ«çš„å½¢å¼å‡ºç°ï¼Œè€Œä¸æ˜¯æ•°å­—â€”â€”æ¯”å¦‚é¢œè‰²ã€åç§°æˆ–ç±»å‹ã€‚ç”±äºæ¨¡å‹åªèƒ½å¤„ç†æ•°å­—ï¼Œæˆ‘ä»¬éœ€è¦å°†è¿™äº›ç±»åˆ«è½¬æ¢ä¸ºæ•°å€¼ã€‚

è½¬æ¢ç±»åˆ«çš„å¸¸è§æ–¹æ³•åŒ…æ‹¬ï¼š

1.  ä½¿ç”¨`OneHotEncoder()`ä¸ºæ¯ä¸ªç±»åˆ«åˆ›å»ºå•ç‹¬çš„1å’Œ0çš„åˆ—ï¼ˆä¹Ÿå«è™šæ‹Ÿå˜é‡ï¼‰

1.  ä½¿ç”¨`OrdinalEncoder()`æˆ–`LabelEncoder()`ä¸ºæ¯ä¸ªç±»åˆ«åˆ†é…ä¸€ä¸ªæ•°å­—ï¼ˆå¦‚1ï¼Œ2ï¼Œ3ï¼‰

1.  ä½¿ç”¨`OrdinalEncoder(categories=[ordered_list])`ä¸è‡ªå®šä¹‰ç±»åˆ«é¡ºåºåæ˜ è‡ªç„¶å±‚çº§ï¼ˆå¦‚small=1ï¼Œmedium=2ï¼Œlarge=3ï¼‰

1.  ä½¿ç”¨`TargetEncoder()`æ ¹æ®ç±»åˆ«ä¸æˆ‘ä»¬è¯•å›¾é¢„æµ‹çš„ç›®æ ‡å˜é‡çš„å…³ç³»å°†ç±»åˆ«è½¬æ¢ä¸ºæ•°å­—

æˆ‘ä»¬è½¬æ¢è¿™äº›ç±»åˆ«çš„æ–¹å¼ä¼šå½±å“æ¨¡å‹å­¦ä¹ çš„æ•ˆæœï¼Œå› æ­¤åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­éœ€è¦å°å¿ƒä¸è¦ä½¿ç”¨æµ‹è¯•æ•°æ®çš„ä¿¡æ¯ã€‚

## æ•°æ®æ³„éœ²æ¡ˆä¾‹ï¼š**ç›®æ ‡ç¼–ç **

å½“ä½ ä½¿ç”¨ç›®æ ‡ç¼–ç åœ¨æ‰€æœ‰æ•°æ®ä¸Šè½¬æ¢ç±»åˆ«å€¼æ—¶ï¼Œç¼–ç å€¼æ˜¯åŸºäºæ¥è‡ªè®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„ç›®æ ‡ä¿¡æ¯è®¡ç®—çš„ã€‚æ›¿æ¢æ¯ä¸ªç±»åˆ«çš„æ•°å­—æ˜¯åŒ…å«æµ‹è¯•æ•°æ®çš„ç›®æ ‡å€¼çš„å¹³å‡å€¼ã€‚è¿™æ„å‘³ç€ä½ çš„è®­ç»ƒæ•°æ®ä¼šè¢«èµ‹äºˆå·²ç»åŒ…å«æ¥è‡ªæµ‹è¯•é›†çš„ç›®æ ‡å€¼ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å®ƒæœ¬ä¸åº”è¯¥çŸ¥é“ã€‚æ€»ç»“æ¥è¯´ï¼š

ğŸš¨ **é—®é¢˜** è®¡ç®—ç±»åˆ«æ—¶ä½¿ç”¨äº†å®Œæ•´çš„æ•°æ®é›†

âŒ **æˆ‘ä»¬åšé”™äº†ä»€ä¹ˆ** ä½¿ç”¨æ‰€æœ‰ç›®æ ‡å€¼è®¡ç®—ç±»åˆ«æ›¿æ¢

ğŸ’¥ **åæœ** è®­ç»ƒç‰¹å¾åŒ…å«æœªæ¥ç›®æ ‡ä¿¡æ¯

![](../Images/57834471ff029388e93763c630f6e268.png)

ç›®æ ‡ç¼–ç æ³„æ¼å‘ç”Ÿåœ¨ä½¿ç”¨æ‰€æœ‰æ•°æ®æ›¿æ¢ç±»åˆ«çš„å¹³å‡ç›®æ ‡å€¼ï¼ˆA=3ï¼ŒB=4ï¼ŒC=2ï¼‰ï¼Œè€Œä¸æ˜¯æ­£ç¡®åœ°åªä½¿ç”¨è®­ç»ƒæ•°æ®çš„å¹³å‡å€¼ï¼ˆA=2ï¼ŒB=5ï¼ŒC=1ï¼‰ï¼Œå¯¼è‡´ç±»åˆ«å€¼é”™è¯¯ã€‚

## æ•°æ®æ³„éœ²æ¡ˆä¾‹ï¼šç‹¬çƒ­ç¼–ç 

å½“ä½ ä½¿ç”¨æ‰€æœ‰æ•°æ®å°†ç±»åˆ«è½¬æ¢ä¸ºäºŒè¿›åˆ¶åˆ—ï¼Œç„¶åé€‰æ‹©è¦ä¿ç•™çš„åˆ—æ—¶ï¼Œé€‰æ‹©æ˜¯åŸºäºè®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸­çš„æ¨¡å¼ã€‚è¿™æ„å‘³ç€ä½ å†³å®šä¿ç•™æˆ–åˆ é™¤æŸäº›äºŒè¿›åˆ¶åˆ—æ—¶ï¼Œå—åˆ°äº†æµ‹è¯•æ•°æ®ä¸­ç›®æ ‡é¢„æµ‹èƒ½åŠ›çš„å½±å“ï¼Œè€Œä¸ä»…ä»…æ˜¯è®­ç»ƒæ•°æ®ã€‚è¿™æ„å‘³ç€ä½ é€‰æ‹©çš„åˆ—é›†éƒ¨åˆ†å—åˆ°äº†æœ¬ä¸åº”è¯¥ä½¿ç”¨çš„æµ‹è¯•é›†å…³ç³»çš„å½±å“ã€‚æ€»ç»“ï¼š

ğŸš¨ **é—®é¢˜æ‰€åœ¨** ä»å®Œæ•´æ•°æ®é›†ä¸­ç¡®å®šç±»åˆ«

âŒ **æˆ‘ä»¬åšé”™äº†ä»€ä¹ˆ** åŸºäºæ‰€æœ‰å”¯ä¸€å€¼åˆ›å»ºäºŒè¿›åˆ¶åˆ—

ğŸ’¥ **åæœ** ç‰¹å¾é€‰æ‹©å—åˆ°æµ‹è¯•é›†æ¨¡å¼çš„å½±å“

![](../Images/de6c9ace481f7e7d863aebe762b2940a.png)

å½“ä½¿ç”¨æ‰€æœ‰å”¯ä¸€å€¼ï¼ˆAã€Bã€Cã€Dï¼‰ä»å®Œæ•´æ•°æ®é›†åˆ›å»ºç±»åˆ«åˆ—ï¼Œè€Œä¸æ˜¯ä»…æ­£ç¡®ä½¿ç”¨è®­ç»ƒæ•°æ®ä¸­å­˜åœ¨çš„ç±»åˆ«ï¼ˆAã€Bã€Cï¼‰æ—¶ï¼Œä¼šå‘ç”Ÿç‹¬çƒ­ç¼–ç æ³„æ¼ï¼Œå¯¼è‡´é”™è¯¯çš„ç¼–ç æ¨¡å¼ã€‚

# æ•°æ®ç¼©æ”¾

æ•°æ®ä¸­çš„ä¸åŒç‰¹å¾å¾€å¾€å…·æœ‰éå¸¸ä¸åŒçš„èŒƒå›´â€”â€”æœ‰äº›å¯èƒ½åœ¨åƒä½ï¼Œè€Œå…¶ä»–åˆ™å¯èƒ½æ˜¯å¾ˆå°çš„å°æ•°ã€‚æˆ‘ä»¬è°ƒæ•´è¿™äº›èŒƒå›´ï¼Œä½¿æ‰€æœ‰ç‰¹å¾å…·æœ‰ç›¸ä¼¼çš„å°ºåº¦ï¼Œä»è€Œå¸®åŠ©æ¨¡å‹æ›´å¥½åœ°å·¥ä½œã€‚

å¸¸è§çš„ç¼©æ”¾è°ƒæ•´æ–¹æ³•åŒ…æ‹¬ï¼š

1.  ä½¿ç”¨`StandardScaler()`ä½¿å¾—å€¼é›†ä¸­åœ¨0é™„è¿‘ï¼Œå¤§å¤šæ•°å€¼åœ¨-1å’Œ1ä¹‹é—´ï¼ˆå‡å€¼=0ï¼Œæ–¹å·®=1ï¼‰

1.  ä½¿ç”¨`MinMaxScaler()`å°†æ‰€æœ‰å€¼ç¼©æ”¾åˆ°0å’Œ1ä¹‹é—´ï¼Œæˆ–è€…ä½¿ç”¨`MinMaxScaler(feature_range=(min, max))`æ¥è®¾ç½®è‡ªå®šä¹‰èŒƒå›´

1.  ä½¿ç”¨`FunctionTransformer(np.log1p)`æˆ–`PowerTransformer(method='box-cox')`æ¥å¤„ç†éå¸¸å¤§çš„æ•°å­—ï¼Œä½¿æ•°æ®åˆ†å¸ƒæ›´åŠ æ¥è¿‘æ­£æ€åˆ†å¸ƒ

1.  ä½¿ç”¨`RobustScaler()`é€šè¿‡ä¸å—å¼‚å¸¸å€¼å½±å“çš„ç»Ÿè®¡é‡è°ƒæ•´ç¼©æ”¾ï¼ˆä½¿ç”¨å››åˆ†ä½æ•°è€Œéå‡å€¼/æ–¹å·®ï¼‰

è™½ç„¶ç¼©æ”¾æœ‰åŠ©äºæ¨¡å‹å…¬å¹³åœ°æ¯”è¾ƒä¸åŒçš„ç‰¹å¾ï¼Œä½†æˆ‘ä»¬éœ€è¦ä»…ä½¿ç”¨è®­ç»ƒæ•°æ®æ¥è®¡ç®—è¿™äº›è°ƒæ•´ï¼Œä»¥é¿å…æ•°æ®æ³„æ¼ã€‚

## æ•°æ®æ³„æ¼æ¡ˆä¾‹ï¼šæ ‡å‡†åŒ–ç¼©æ”¾

å½“ä½ ä½¿ç”¨æ‰€æœ‰æ•°æ®æ ‡å‡†åŒ–ç‰¹å¾æ—¶ï¼Œç”¨äºè®¡ç®—çš„å¹³å‡å€¼å’Œåˆ†å¸ƒå€¼æ¥è‡ªè®­ç»ƒé›†å’Œæµ‹è¯•é›†ã€‚è¿™äº›å€¼ä¸ä»…ä½¿ç”¨è®­ç»ƒæ•°æ®æ—¶å¾—åˆ°çš„ä¸åŒã€‚è¿™æ„å‘³ç€ä½ è®­ç»ƒæ•°æ®ä¸­çš„æ¯ä¸ªæ ‡å‡†åŒ–å€¼éƒ½ä½¿ç”¨äº†å…³äºæµ‹è¯•é›†åˆ†å¸ƒçš„ä¿¡æ¯æ¥è¿›è¡Œè°ƒæ•´ã€‚æ€»ç»“ï¼š

ğŸš¨ **é—®é¢˜æ‰€åœ¨** ä½¿ç”¨å®Œæ•´æ•°æ®é›†è®¡ç®—ç»Ÿè®¡é‡

âŒ **æˆ‘ä»¬åšé”™äº†ä»€ä¹ˆ** ä½¿ç”¨æ‰€æœ‰å€¼è®¡ç®—å‡å€¼å’Œæ ‡å‡†å·®

ğŸ’¥ **åæœ** ä½¿ç”¨æµ‹è¯•é›†åˆ†å¸ƒç¼©æ”¾è®­ç»ƒç‰¹å¾

![](../Images/07e43284950a668a081b2a90dd6c0512.png)

æ ‡å‡†åŒ–æ³„æ¼å‘ç”Ÿåœ¨ä½¿ç”¨å®Œæ•´æ•°æ®é›†çš„å¹³å‡å€¼ï¼ˆÎ¼=0ï¼‰å’Œåˆ†å¸ƒï¼ˆÏƒ=3ï¼‰æ¥è§„èŒƒåŒ–æ•°æ®æ—¶ï¼Œè€Œä¸æ˜¯ä»…æ­£ç¡®ä½¿ç”¨è®­ç»ƒæ•°æ®çš„ç»Ÿè®¡é‡ï¼ˆÎ¼=2ï¼ŒÏƒ=2ï¼‰ï¼Œå¯¼è‡´é”™è¯¯çš„æ ‡å‡†åŒ–å€¼ã€‚

## æ•°æ®æ³„æ¼æ¡ˆä¾‹ï¼š**æœ€å°-æœ€å¤§ç¼©æ”¾**

å½“ä½ ä½¿ç”¨æ‰€æœ‰æ•°æ®çš„æœ€å°å€¼å’Œæœ€å¤§å€¼è¿›è¡Œç‰¹å¾ç¼©æ”¾æ—¶ï¼Œè¿™äº›è¾¹ç•Œå€¼å¯èƒ½æ¥è‡ªæµ‹è¯•é›†ã€‚ä½ è®­ç»ƒæ•°æ®ä¸­çš„ç¼©æ”¾å€¼æ˜¯æ ¹æ®è¿™äº›è¾¹ç•Œè®¡ç®—çš„ï¼Œè¿™äº›è¾¹ç•Œå¯èƒ½ä¸ä»…ä½¿ç”¨è®­ç»ƒæ•°æ®æ—¶å¾—åˆ°çš„è¾¹ç•Œä¸åŒã€‚è¿™æ„å‘³ç€è®­ç»ƒæ•°æ®ä¸­çš„æ¯ä¸ªç¼©æ”¾å€¼éƒ½ä½¿ç”¨äº†æ¥è‡ªæµ‹è¯•é›†çš„å®Œæ•´å€¼èŒƒå›´è¿›è¡Œè°ƒæ•´ã€‚æ€»ç»“å¦‚ä¸‹ï¼š

ğŸš¨ **é—®é¢˜æ‰€åœ¨** ä½¿ç”¨å®Œæ•´æ•°æ®é›†æŸ¥æ‰¾è¾¹ç•Œ

âŒ **æˆ‘ä»¬åšé”™äº†ä»€ä¹ˆ** ä»æ‰€æœ‰æ•°æ®ç‚¹ä¸­ç¡®å®šæœ€å°/æœ€å¤§å€¼

ğŸ’¥ **åæœ** ä½¿ç”¨æµ‹è¯•é›†èŒƒå›´å¯¹è®­ç»ƒç‰¹å¾è¿›è¡Œå½’ä¸€åŒ–

![](../Images/f904f4f392adbf5fa4711e4a90bfaa9c.png)

ä½¿ç”¨å®Œæ•´æ•°æ®é›†çš„æœ€å°å€¼ï¼ˆ-5ï¼‰å’Œæœ€å¤§å€¼ï¼ˆ5ï¼‰æ¥è¿›è¡Œç¼©æ”¾ï¼Œè€Œä¸æ˜¯ä»…æ­£ç¡®ä½¿ç”¨è®­ç»ƒæ•°æ®çš„èŒƒå›´ï¼ˆæœ€å°å€¼=-1ï¼Œæœ€å¤§å€¼=5ï¼‰è¿›è¡Œç¼©æ”¾ï¼Œä»è€Œå¯¼è‡´å€¼çš„ç¼©æ”¾é”™è¯¯ã€‚

# ç¦»æ•£åŒ–

æœ‰æ—¶ï¼Œå°†æ•°å­—åˆ†ç»„ä¸ºç±»åˆ«æ¯”ä½¿ç”¨ç²¾ç¡®çš„å€¼æ›´å¥½ã€‚è¿™æœ‰åŠ©äºæœºå™¨å­¦ä¹ æ¨¡å‹æ›´å®¹æ˜“åœ°å¤„ç†å’Œåˆ†ææ•°æ®ã€‚

åˆ›å»ºè¿™äº›åˆ†ç»„çš„å¸¸è§æ–¹æ³•åŒ…æ‹¬ï¼š

1.  ä½¿ç”¨`KBinsDiscretizer(strategy='uniform')`ä½¿æ¯ä¸ªç»„è¦†ç›–ç›¸åŒå¤§å°çš„å€¼èŒƒå›´

1.  ä½¿ç”¨`KBinsDiscretizer(strategy='quantile')`ä½¿æ¯ä¸ªç»„åŒ…å«ç›¸åŒæ•°é‡çš„æ•°æ®ç‚¹

1.  ä½¿ç”¨`KBinsDiscretizer(strategy='kmeans')`é€šè¿‡èšç±»æ‰¾åˆ°æ•°æ®ä¸­çš„è‡ªç„¶åˆ†ç»„

1.  ä½¿ç”¨`QuantileTransformer(n_quantiles=n, output_distribution='uniform')`åŸºäºæ•°æ®ä¸­çš„åˆ†ä½æ•°åˆ›å»ºåˆ†ç»„

è™½ç„¶åˆ†ç»„å€¼å¯ä»¥å¸®åŠ©æ¨¡å‹æ›´å¥½åœ°å‘ç°æ¨¡å¼ï¼Œä½†æˆ‘ä»¬å†³å®šåˆ†ç»„è¾¹ç•Œçš„æ–¹å¼éœ€è¦ä»…ä½¿ç”¨è®­ç»ƒæ•°æ®ï¼Œä»¥é¿å…æ³„æ¼ã€‚

## **æ•°æ®æ³„æ¼æ¡ˆä¾‹ï¼šç­‰é¢‘åˆ†ç®±**

å½“ä½ ä½¿ç”¨æ‰€æœ‰æ•°æ®åˆ›å»ºå…·æœ‰ç›¸ç­‰æ•°æ®ç‚¹æ•°é‡çš„ç®±æ—¶ï¼Œç®±ä¹‹é—´çš„åˆ†å‰²ç‚¹æ˜¯é€šè¿‡è®­ç»ƒé›†å’Œæµ‹è¯•é›†å…±åŒç¡®å®šçš„ã€‚è¿™äº›åˆ†å‰²å€¼ä¸ä»…ä½¿ç”¨è®­ç»ƒæ•°æ®æ—¶å¾—åˆ°çš„å€¼ä¸åŒã€‚è¿™æ„å‘³ç€ï¼Œå½“ä½ å°†æ•°æ®ç‚¹åˆ†é…åˆ°è®­ç»ƒæ•°æ®çš„ç®±ä¸­æ—¶ï¼Œä½ ä½¿ç”¨çš„æ˜¯å—æµ‹è¯•é›†å€¼å½±å“çš„åˆ†å‰²ç‚¹ã€‚æ€»ç»“å¦‚ä¸‹ï¼š

ğŸš¨ **é—®é¢˜æ‰€åœ¨** ä½¿ç”¨å®Œæ•´æ•°æ®é›†è®¾ç½®é˜ˆå€¼

âŒ **æˆ‘ä»¬åšé”™äº†ä»€ä¹ˆ** ä½¿ç”¨æ‰€æœ‰æ•°æ®ç‚¹ç¡®å®šç®±çš„è¾¹ç•Œ

ğŸ’¥ **åæœ** ä½¿ç”¨æµ‹è¯•é›†åˆ†å¸ƒå¯¹è®­ç»ƒæ•°æ®è¿›è¡Œåˆ†ç®±

![](../Images/c350933b8e9d11b558836a45c596c4b1.png)

ç­‰é¢‘åˆ†ç®±æ³„æ¼å‘ç”Ÿåœ¨ä½¿ç”¨æ‰€æœ‰æ•°æ®è®¾ç½®ç®±çš„åˆ†å‰²ç‚¹ï¼ˆ-0.5ï¼Œ2.5ï¼‰æ—¶ï¼Œè€Œä¸æ˜¯ä»…æ­£ç¡®ä½¿ç”¨è®­ç»ƒæ•°æ®æ¥è®¾ç½®è¾¹ç•Œï¼ˆ-0.5ï¼Œ2.0ï¼‰ï¼Œä»è€Œå¯¼è‡´å€¼çš„åˆ†ç»„é”™è¯¯ã€‚

## æ•°æ®æ³„æ¼æ¡ˆä¾‹ï¼šç­‰å®½åˆ†ç®±

å½“ä½ ä½¿ç”¨æ‰€æœ‰æ•°æ®åˆ›å»ºç›¸ç­‰å¤§å°çš„ç®±æ—¶ï¼Œç¡®å®šç®±å®½åº¦æ‰€ä½¿ç”¨çš„èŒƒå›´æ¥è‡ªè®­ç»ƒé›†å’Œæµ‹è¯•é›†ã€‚è¿™ä¸€æ€»èŒƒå›´å¯èƒ½æ¯”ä»…ä½¿ç”¨è®­ç»ƒæ•°æ®å¾—åˆ°çš„èŒƒå›´æ›´å®½æˆ–æ›´çª„ã€‚è¿™æ„å‘³ç€å½“ä½ å°†æ•°æ®ç‚¹åˆ†é…åˆ°è®­ç»ƒæ•°æ®ä¸­çš„ç®±æ—¶ï¼Œä½¿ç”¨çš„ç®±è¾¹ç•Œæ˜¯åŸºäºæ•´ä¸ªæµ‹è¯•é›†çš„èŒƒå›´è®¡ç®—å¾—å‡ºçš„ã€‚æ€»ç»“å¦‚ä¸‹ï¼š

ğŸš¨ **é—®é¢˜** ä½¿ç”¨å®Œæ•´æ•°æ®é›†è®¡ç®—èŒƒå›´

âŒ **æˆ‘ä»¬åšé”™äº†ä»€ä¹ˆ** åŸºäºå®Œæ•´æ•°æ®åˆ†å¸ƒè®¾ç½®ç®±å®½

ğŸ’¥ **åæœ** ä½¿ç”¨æµ‹è¯•é›†è¾¹ç•Œå¯¹è®­ç»ƒæ•°æ®è¿›è¡Œåˆ†ç®±

![](../Images/9942d147b1bda767bd112c2d616cec43.png)

ç­‰å®½åˆ†ç®±æ³„æ¼å‘ç”Ÿåœ¨ä½¿ç”¨å®Œæ•´æ•°æ®é›†èŒƒå›´ï¼ˆ-3åˆ°6ï¼‰å°†æ•°æ®åˆ’åˆ†ä¸ºç›¸ç­‰å¤§å°çš„ç»„æ—¶ï¼Œè€Œä¸æ˜¯ä»…æ­£ç¡®ä½¿ç”¨è®­ç»ƒæ•°æ®çš„èŒƒå›´ï¼ˆ-3åˆ°3ï¼‰ï¼Œä»è€Œå¯¼è‡´é”™è¯¯çš„åˆ†ç»„ã€‚

# é‡é‡‡æ ·

å½“ä½ çš„æ•°æ®ä¸­æŸäº›ç±»åˆ«çš„ç¤ºä¾‹æ¯”å…¶ä»–ç±»åˆ«å¤šå¾—å¤šæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨`imblearn`ä¸­çš„é‡é‡‡æ ·æŠ€æœ¯ï¼Œé€šè¿‡åˆ›å»ºæ–°æ ·æœ¬æˆ–åˆ é™¤ç°æœ‰æ ·æœ¬æ¥å¹³è¡¡å®ƒä»¬ã€‚è¿™æœ‰åŠ©äºæ¨¡å‹å…¬å¹³åœ°å­¦ä¹ æ‰€æœ‰ç±»åˆ«ã€‚

æ·»åŠ æ ·æœ¬çš„å¸¸è§æ–¹æ³•ï¼ˆè¿‡é‡‡æ ·ï¼‰ï¼š

1.  ä½¿ç”¨`RandomOverSampler()`ä»è¾ƒå°ç±»åˆ«ä¸­å¤åˆ¶ç°æœ‰ç¤ºä¾‹

1.  ä½¿ç”¨`SMOTE()`ä¸ºè¾ƒå°ç±»åˆ«åˆ›å»ºæ–°çš„åˆæˆç¤ºä¾‹ï¼Œé€šè¿‡æ’å€¼æ³•ç”Ÿæˆ

1.  ä½¿ç”¨`ADASYN()`åœ¨æ¨¡å‹æœ€éš¾å¤„ç†çš„åŒºåŸŸåˆ›å»ºæ›´å¤šç¤ºä¾‹ï¼Œé‡ç‚¹å…³æ³¨å†³ç­–è¾¹ç•Œ

åˆ é™¤æ ·æœ¬çš„å¸¸è§æ–¹æ³•ï¼ˆæ¬ é‡‡æ ·ï¼‰ï¼š

1.  ä½¿ç”¨`RandomUnderSampler()`éšæœºåˆ é™¤è¾ƒå¤§ç±»åˆ«ä¸­çš„ç¤ºä¾‹

1.  ä½¿ç”¨`NearMiss(version=1)`æˆ–`NearMiss(version=2)`æ ¹æ®ä¸è¾ƒå°ç±»åˆ«çš„è·ç¦»ä»è¾ƒå¤§ç±»åˆ«ä¸­åˆ é™¤ç¤ºä¾‹

1.  ä½¿ç”¨`TomekLinks()`æˆ–`EditedNearestNeighbours()`æ ¹æ®ä¸å…¶ä»–ç±»åˆ«çš„ç›¸ä¼¼åº¦ä»”ç»†é€‰æ‹©è¦åˆ é™¤çš„ç¤ºä¾‹

å¹³è¡¡æ•°æ®æœ‰åŠ©äºæ¨¡å‹æ›´å¥½åœ°å­¦ä¹ ï¼Œä½†åˆ›å»ºæˆ–åˆ é™¤æ ·æœ¬çš„è¿‡ç¨‹åº”è¯¥ä»…ä½¿ç”¨æ¥è‡ªè®­ç»ƒæ•°æ®çš„ä¿¡æ¯ï¼Œä»¥é¿å…æ•°æ®æ³„æ¼ã€‚

## **æ•°æ®æ³„æ¼æ¡ˆä¾‹ï¼šè¿‡é‡‡æ ·ï¼ˆSMOTEï¼‰**

å½“ä½ åœ¨æ‰€æœ‰æ•°æ®ä¸Šä½¿ç”¨SMOTEåˆ›å»ºåˆæˆæ•°æ®ç‚¹æ—¶ï¼Œç®—æ³•ä¼šä»è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸­æŒ‘é€‰é™„è¿‘çš„ç‚¹æ¥åˆ›å»ºæ–°æ ·æœ¬ã€‚è¿™äº›æ–°ç‚¹æ˜¯é€šè¿‡å°†æµ‹è¯•é›†æ ·æœ¬çš„å€¼ä¸è®­ç»ƒæ•°æ®æ··åˆç”Ÿæˆçš„ã€‚è¿™æ„å‘³ç€ä½ çš„è®­ç»ƒæ•°æ®å¾—åˆ°äº†ç›´æ¥ä½¿ç”¨æµ‹è¯•é›†ä¿¡æ¯åˆ›å»ºçš„æ–°æ ·æœ¬ã€‚æ€»ç»“å¦‚ä¸‹ï¼š

ğŸš¨ **é—®é¢˜** ä½¿ç”¨å®Œæ•´æ•°æ®é›†ç”Ÿæˆæ ·æœ¬

âŒ **æˆ‘ä»¬åšé”™äº†ä»€ä¹ˆ** ä½¿ç”¨æµ‹è¯•é›†é‚»å±…åˆ›å»ºåˆæˆç‚¹

ğŸ’¥ **åæœ** è®­ç»ƒæ•°æ®è¢«åŒ…å«æµ‹è¯•é›†å½±å“çš„æ ·æœ¬å¢å¼º

![](../Images/9faf04e494faa2e8a948243bc52ae55b.png)

è¿‡é‡‡æ ·æ³„æ¼å‘ç”Ÿåœ¨åŸºäºæ•´ä¸ªæ•°æ®é›†çš„ç±»åˆ«è®¡æ•°ï¼ˆAÃ—4, BÃ—3, CÃ—2ï¼‰é‡å¤æ•°æ®ç‚¹æ—¶ï¼Œè€Œä¸æ˜¯ä»…æ ¹æ®è®­ç»ƒæ•°æ®ï¼ˆAÃ—1, BÃ—2, CÃ—2ï¼‰æ¥å†³å®šæ¯ä¸ªç±»åˆ«é‡å¤çš„æ¬¡æ•°ã€‚

## æ•°æ®æ³„æ¼æ¡ˆä¾‹ï¼šæ¬ é‡‡æ ·ï¼ˆTomeké“¾æ¥ï¼‰

å½“ä½ ä½¿ç”¨Tomeké“¾æ¥åœ¨æ‰€æœ‰æ•°æ®ä¸­åˆ é™¤æ•°æ®ç‚¹æ—¶ï¼Œç®—æ³•ä¼šæ‰¾åˆ°æ¥è‡ªè®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„æœ€è¿‘é‚»æˆå¯¹æ•°æ®ç‚¹ï¼Œå®ƒä»¬çš„æ ‡ç­¾å´ä¸åŒã€‚æ ¹æ®è¿™äº›æ•°æ®ç‚¹ä¸æµ‹è¯•é›†æ•°æ®ç‚¹çš„è·ç¦»æ¥å†³å®šæ˜¯å¦ä»è®­ç»ƒé›†ä¸­ç§»é™¤è¿™äº›ç‚¹ã€‚è¿™æ„å‘³ç€ä½ çš„æœ€ç»ˆè®­ç»ƒæ•°æ®æ˜¯ç”±å®ƒä¸æµ‹è¯•é›†å€¼ä¹‹é—´çš„å…³ç³»å†³å®šçš„ã€‚æ€»ç»“å¦‚ä¸‹ï¼š

ğŸš¨ **é—®é¢˜** ä½¿ç”¨å®Œæ•´æ•°æ®é›†ç§»é™¤æ ·æœ¬

âŒ **æˆ‘ä»¬åšé”™äº†ä»€ä¹ˆ** ä½¿ç”¨æµ‹è¯•é›†å…³ç³»è¯†åˆ«æˆå¯¹æ•°æ®

ğŸ’¥ **åæœ** åŸºäºæµ‹è¯•é›†æ¨¡å¼å‡å°‘è®­ç»ƒ

![](../Images/d56e90a957fc6d7a249a9d990da10385.png)

æ¬ é‡‡æ ·æ³„æ¼å‘ç”Ÿåœ¨åŸºäºæ•´ä¸ªæ•°æ®é›†çš„ç±»åˆ«æ¯”ä¾‹ç§»é™¤æ•°æ®ç‚¹æ—¶ï¼ˆAÃ—4ï¼ŒBÃ—3ï¼ŒCÃ—2ï¼‰ï¼Œè€Œä¸æ˜¯æ­£ç¡®åœ°ä»…ä½¿ç”¨è®­ç»ƒæ•°æ®ï¼ˆAÃ—1ï¼ŒBÃ—2ï¼ŒCÃ—2ï¼‰æ¥å†³å®šä»æ¯ä¸ªç±»åˆ«ä¸­ä¿ç•™å¤šå°‘æ ·æœ¬ã€‚

# æœ€åçš„è¯„è®º

åœ¨é¢„å¤„ç†æ•°æ®æ—¶ï¼Œä½ éœ€è¦ç¡®ä¿è®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®å®Œå…¨åˆ†å¼€ã€‚ä»»ä½•æ—¶å€™ä½ ä½¿ç”¨æ‰€æœ‰æ•°æ®çš„ä¿¡æ¯æ¥è½¬æ¢å€¼â€”â€”æ— è®ºæ˜¯å¡«è¡¥ç¼ºå¤±å€¼ã€å°†ç±»åˆ«è½¬æ¢ä¸ºæ•°å­—ã€ç‰¹å¾ç¼©æ”¾ã€åˆ›å»ºåŒºé—´ï¼Œè¿˜æ˜¯å¹³è¡¡ç±»åˆ«â€”â€”éƒ½ä¼šæœ‰å°†æµ‹è¯•æ•°æ®çš„ä¿¡æ¯æ··å…¥è®­ç»ƒæ•°æ®çš„é£é™©ã€‚è¿™ä¼šä½¿å¾—æ¨¡å‹çš„æµ‹è¯•ç»“æœä¸å¯é ï¼Œå› ä¸ºæ¨¡å‹å·²ç»ä»å®ƒæœ¬ä¸è¯¥çœ‹åˆ°çš„æ¨¡å¼ä¸­å­¦ä¹ äº†ã€‚

è§£å†³æ–¹æ¡ˆå¾ˆç®€å•ï¼š**å§‹ç»ˆå…ˆè½¬æ¢ä½ çš„è®­ç»ƒæ•°æ®ï¼Œä¿å­˜è¿™äº›è®¡ç®—ç»“æœï¼Œç„¶åå°†å…¶åº”ç”¨åˆ°ä½ çš„æµ‹è¯•æ•°æ®ä¸Šã€‚**

# ğŸŒŸ æ•°æ®é¢„å¤„ç† + åˆ†ç±»ï¼ˆå¸¦æœ‰æ³„æ¼ï¼‰ä»£ç æ€»ç»“

è®©æˆ‘ä»¬çœ‹çœ‹åœ¨é¢„æµ‹ä¸€ä¸ªç®€å•çš„é«˜å°”å¤«æ¯”èµ›æ•°æ®é›†æ—¶ï¼Œæ•°æ®æ³„æ¼æ˜¯å¦‚ä½•å‘ç”Ÿçš„ã€‚è¿™æ˜¯ä¸€ä¸ªä¸å¥½çš„ç¤ºä¾‹ï¼Œä¸åº”å½“è¢«éµå¾ªï¼Œä»…ç”¨äºæ¼”ç¤ºå’Œæ•™è‚²ç›®çš„ã€‚

```py
import pandas as pd
import numpy as np
from sklearn.compose import ColumnTransformer
from sklearn.preprocessing import StandardScaler, OrdinalEncoder, KBinsDiscretizer
from sklearn.impute import SimpleImputer
from sklearn.model_selection import train_test_split
from sklearn.tree import DecisionTreeClassifier
from sklearn.metrics import accuracy_score
from imblearn.pipeline import Pipeline
from imblearn.over_sampling import SMOTE

# Create dataset
dataset_dict = {
    'Outlook': ['sunny', 'sunny', 'overcast', 'rain', 'rain', 'rain', 'overcast', 'sunny', 'sunny', 'rain', 'sunny', 'overcast', 'overcast', 'rain', 'sunny', 'overcast', 'rain', 'sunny', 'sunny', 'rain', 'overcast', 'rain', 'sunny', 'overcast', 'sunny', 'overcast', 'rain', 'overcast'],
    'Temperature': [85.0, 80.0, 83.0, 70.0, 68.0, 65.0, 64.0, 72.0, 69.0, 75.0, 75.0, 72.0, 81.0, 71.0, 81.0, 74.0, 76.0, 78.0, 82.0, 67.0, 85.0, 73.0, 88.0, 77.0, 79.0, 80.0, 66.0, 84.0],
    'Humidity': [85.0, 90.0, 78.0, 96.0, 80.0, 70.0, 65.0, 95.0, 70.0, 80.0, 70.0, 90.0, 75.0, 80.0, 88.0, 92.0, 85.0, 75.0, 92.0, 90.0, 85.0, 88.0, 65.0, 70.0, 60.0, 95.0, 70.0, 78.0],
    'Wind': [False, True, False, False, False, True, True, False, False, False, True, True, False, True, True, False, False, True, False, True, True, False, True, False, False, True, False, False],
    'Play': ['No', 'No', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'No', 'Yes', 'Yes', 'No', 'No', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'Yes']
}
df = pd.DataFrame(dataset_dict)
X, y = df.drop('Play', axis=1), df['Play']

# Preprocess AND apply SMOTE to ALL data first (causing leakage)
preprocessor = ColumnTransformer(transformers=[
    ('temp_transform', Pipeline([
        ('imputer', SimpleImputer(strategy='mean')),
        ('scaler', StandardScaler()),
        ('discretizer', KBinsDiscretizer(n_bins=4, encode='ordinal'))
    ]), ['Temperature']),
    ('humid_transform', Pipeline([
        ('imputer', SimpleImputer(strategy='mean')),
        ('scaler', StandardScaler()),
        ('discretizer', KBinsDiscretizer(n_bins=4, encode='ordinal'))
    ]), ['Humidity']),
    ('outlook_transform', OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1), 
     ['Outlook']),
    ('wind_transform', Pipeline([
        ('imputer', SimpleImputer(strategy='constant', fill_value=False)),
        ('scaler', StandardScaler())
    ]), ['Wind'])
])

# Transform all data and apply SMOTE before splitting (leakage!)
X_transformed = preprocessor.fit_transform(X)
smote = SMOTE(random_state=42)
X_resampled, y_resampled = smote.fit_resample(X_transformed, y)

# Split the already transformed and resampled data
X_train, X_test, y_train, y_test = train_test_split(X_resampled, y_resampled, test_size=0.5, shuffle=False)

# Train a classifier
clf = DecisionTreeClassifier(random_state=42)
clf.fit(X_train, y_train)

print(f"Testing Accuracy (with leakage): {accuracy_score(y_test, clf.predict(X_test)):.2%}")
```

ä¸Šé¢çš„ä»£ç ä½¿ç”¨äº†`ColumnTransformer`ï¼Œè¿™æ˜¯scikit-learnä¸­çš„ä¸€ä¸ªå·¥å…·ï¼Œå…è®¸æˆ‘ä»¬å¯¹æ•°æ®é›†ä¸­çš„ä¸åŒåˆ—åº”ç”¨ä¸åŒçš„é¢„å¤„ç†æ­¥éª¤ã€‚

è¿™æ˜¯æ•°æ®é›†ä¸­æ¯ä¸€åˆ—é¢„å¤„ç†ç­–ç•¥çš„è¯¦ç»†è¯´æ˜ï¼š

`**æ¸©åº¦**`**ï¼š

-** å‡å€¼å¡«å……å¤„ç†ä»»ä½•ç¼ºå¤±å€¼

- æ ‡å‡†åŒ–ç¼©æ”¾ä»¥è§„èŒƒåŒ–å€¼ï¼ˆå‡å€¼=0ï¼Œæ ‡å‡†å·®=1ï¼‰

- ç­‰å®½ç¦»æ•£åŒ–ä¸º4ä¸ªåŒºé—´ï¼Œæ„å‘³ç€å°†è¿ç»­å€¼åˆ†ç±»ä¸º4ä¸ªç­‰å®½åŒºé—´

`**æ¹¿åº¦**`**ï¼š

-** ä¸æ¸©åº¦ç›¸åŒçš„ç­–ç•¥ï¼šå‡å€¼å¡«å…… â†’ æ ‡å‡†åŒ–ç¼©æ”¾ â†’ ç­‰å®½ç¦»æ•£åŒ–ï¼ˆ4ä¸ªåŒºé—´ï¼‰

`**å±•æœ›**`**ï¼ˆç±»åˆ«ï¼‰**ï¼š

- åºæ•°ç¼–ç ï¼šå°†ç±»åˆ«å€¼è½¬æ¢ä¸ºæ•°å€¼

- é€šè¿‡å°†æœªçŸ¥å€¼è®¾ç½®ä¸º-1æ¥å¤„ç†

`**é£é€Ÿ**` **ï¼ˆäºŒå…ƒï¼‰**ï¼š

- å¯¹ç¼ºå¤±å€¼è¿›è¡Œå¸¸æ•°å¡«å……ï¼ˆå¡«å……ä¸º Falseï¼‰

- æ ‡å‡†åŒ–ç¼©æ”¾ä»¥è§„èŒƒåŒ– 0/1 å€¼

`**æ¯”èµ›**` **ï¼ˆç›®æ ‡ï¼‰**ï¼š

- æ ‡ç­¾ç¼–ç å°†â€œæ˜¯/å¦â€è½¬æ¢ä¸º 1/0

- åœ¨é¢„å¤„ç†ååº”ç”¨SMOTEé€šè¿‡åˆ›å»ºå°‘æ•°ç±»åˆ«çš„åˆæˆç¤ºä¾‹æ¥å¹³è¡¡ç±»åˆ«

- ä½¿ç”¨ç®€å•çš„å†³ç­–æ ‘æ¥é¢„æµ‹ç›®æ ‡

æ•´ä¸ªæµæ°´çº¿æ¼”ç¤ºäº†æ•°æ®æ³„æ¼ï¼Œå› ä¸º**æ‰€æœ‰çš„è½¬æ¢åœ¨æ‹Ÿåˆè¿‡ç¨‹ä¸­éƒ½çœ‹åˆ°æ•´ä¸ªæ•°æ®é›†**ï¼Œåœ¨å®é™…çš„æœºå™¨å­¦ä¹ åœºæ™¯ä¸­è¿™å°†æ˜¯ä¸åˆé€‚çš„ï¼Œæˆ‘ä»¬éœ€è¦ç¡®ä¿æµ‹è¯•æ•°æ®ä¸è®­ç»ƒè¿‡ç¨‹å®Œå…¨åˆ†å¼€ã€‚

è¿™ç§æ–¹æ³•ä¹Ÿå¯èƒ½ä¼šæ˜¾ç¤ºå‡ºäººä¸ºæé«˜çš„æµ‹è¯•å‡†ç¡®åº¦ï¼Œå› ä¸ºåœ¨é¢„å¤„ç†æ­¥éª¤ä¸­ä½¿ç”¨äº†æµ‹è¯•æ•°æ®çš„ç‰¹å¾ï¼

# ğŸŒŸ æ•°æ®é¢„å¤„ç† + åˆ†ç±»ï¼ˆæ— æ³„æ¼ï¼‰ä»£ç æ€»ç»“

è¿™æ˜¯æ²¡æœ‰æ•°æ®æ³„æ¼çš„ç‰ˆæœ¬ï¼š

```py
import pandas as pd
import numpy as np
from sklearn.compose import ColumnTransformer
from sklearn.preprocessing import StandardScaler, OrdinalEncoder, KBinsDiscretizer
from sklearn.impute import SimpleImputer
from sklearn.model_selection import train_test_split
from sklearn.tree import DecisionTreeClassifier
from sklearn.metrics import accuracy_score
from imblearn.pipeline import Pipeline
from imblearn.over_sampling import SMOTE

# Create dataset
dataset_dict = {
    'Outlook': ['sunny', 'sunny', 'overcast', 'rain', 'rain', 'rain', 'overcast', 'sunny', 'sunny', 'rain', 'sunny', 'overcast', 'overcast', 'rain', 'sunny', 'overcast', 'rain', 'sunny', 'sunny', 'rain', 'overcast', 'rain', 'sunny', 'overcast', 'sunny', 'overcast', 'rain', 'overcast'],
    'Temperature': [85.0, 80.0, 83.0, 70.0, 68.0, 65.0, 64.0, 72.0, 69.0, 75.0, 75.0, 72.0, 81.0, 71.0, 81.0, 74.0, 76.0, 78.0, 82.0, 67.0, 85.0, 73.0, 88.0, 77.0, 79.0, 80.0, 66.0, 84.0],
    'Humidity': [85.0, 90.0, 78.0, 96.0, 80.0, 70.0, 65.0, 95.0, 70.0, 80.0, 70.0, 90.0, 75.0, 80.0, 88.0, 92.0, 85.0, 75.0, 92.0, 90.0, 85.0, 88.0, 65.0, 70.0, 60.0, 95.0, 70.0, 78.0],
    'Wind': [False, True, False, False, False, True, True, False, False, False, True, True, False, True, True, False, False, True, False, True, True, False, True, False, False, True, False, False],
    'Play': ['No', 'No', 'Yes', 'Yes', 'Yes', 'No', 'Yes', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'No', 'Yes', 'Yes', 'No', 'No', 'No', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'Yes', 'No', 'Yes']
}
df = pd.DataFrame(dataset_dict)
X, y = df.drop('Play', axis=1), df['Play']

# Split first (before any processing)
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.5, shuffle=False)

# Create pipeline with preprocessing, SMOTE, and classifier
pipeline = Pipeline([
    ('preprocessor', ColumnTransformer(transformers=[
        ('temp_transform', Pipeline([
            ('imputer', SimpleImputer(strategy='mean')),
            ('scaler', StandardScaler()),
            ('discretizer', KBinsDiscretizer(n_bins=4, encode='ordinal'))
        ]), ['Temperature']),
        ('humid_transform', Pipeline([
            ('imputer', SimpleImputer(strategy='mean')),
            ('scaler', StandardScaler()),
            ('discretizer', KBinsDiscretizer(n_bins=4, encode='ordinal'))
        ]), ['Humidity']),
        ('outlook_transform', OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=-1), 
         ['Outlook']),
        ('wind_transform', Pipeline([
            ('imputer', SimpleImputer(strategy='constant', fill_value=False)),
            ('scaler', StandardScaler())
        ]), ['Wind'])
    ])),
    ('smote', SMOTE(random_state=42)),
    ('classifier', DecisionTreeClassifier(random_state=42))
])

# Fit pipeline on training data only
pipeline.fit(X_train, y_train)

print(f"Training Accuracy: {accuracy_score(y_train, pipeline.predict(X_train)):.2%}")
print(f"Testing Accuracy: {accuracy_score(y_test, pipeline.predict(X_test)):.2%}")
```

## ä¸æ³„æ¼ç‰ˆæœ¬çš„ä¸»è¦åŒºåˆ«

1.  é¦–å…ˆæ‹†åˆ†æ•°æ®ï¼Œç„¶åå†è¿›è¡Œä»»ä½•å¤„ç†

1.  æ‰€æœ‰çš„è½¬æ¢ï¼ˆé¢„å¤„ç†ï¼ŒSMOTEï¼‰éƒ½åœ¨æµæ°´çº¿å†…

1.  æµæ°´çº¿ç¡®ä¿ï¼š

    - é¢„å¤„ç†å‚æ•°ä»…ä»è®­ç»ƒæ•°æ®ä¸­å­¦ä¹ 

    - SMOTEä»…é€‚ç”¨äºè®­ç»ƒæ•°æ®

    - æµ‹è¯•æ•°æ®åœ¨é¢„æµ‹ä¹‹å‰å®Œå…¨ä¸å¯è§

è¿™ç§æ–¹æ³•æä¾›äº†æ›´ç°å®çš„æ€§èƒ½ä¼°è®¡ï¼Œå› ä¸ºå®ƒä¿æŒäº†è®­ç»ƒæ•°æ®å’Œæµ‹è¯•æ•°æ®ä¹‹é—´çš„æ­£ç¡®åˆ†ç¦»ã€‚

## æŠ€æœ¯ç¯å¢ƒ

æœ¬æ–‡ä½¿ç”¨Python 3.7ï¼Œscikit-learn 1.5å’Œimblearn 0.12ã€‚è™½ç„¶è®¨è®ºçš„æ¦‚å¿µé€šå¸¸é€‚ç”¨ï¼Œä½†å…·ä½“çš„ä»£ç å®ç°å¯èƒ½ä¼šå› ç‰ˆæœ¬ä¸åŒç•¥æœ‰å·®å¼‚ã€‚

## å…³äºæ’å›¾

é™¤éå¦æœ‰è¯´æ˜ï¼Œæ‰€æœ‰æ’å›¾å‡ç”±ä½œè€…åˆ›å»ºï¼Œå¹¶ç»“åˆäº†Canva Proæˆæƒçš„è®¾è®¡å…ƒç´ ã€‚

ğ™ğ™šğ™š ğ™¢ğ™¤ğ™§ğ™š ğ˜¿ğ™–ğ™©ğ™– ğ™‹ğ™§ğ™šğ™¥ğ™§ğ™¤ğ™˜ğ™šğ™¨ğ™¨ğ™ğ™£ğ™œ ğ™¢ğ™šğ™©ğ™ğ™¤ğ™™ğ™¨ ğ™ğ™šğ™§ğ™š:

![Samy Baladram](../Images/835013c69e08fec04ad9ca465c2adf6c.png)

[Samy Baladram](https://medium.com/@samybaladram?source=post_page-----33cbf07507b7--------------------------------)

## æ•°æ®é¢„å¤„ç†

[æŸ¥çœ‹åˆ—è¡¨](https://medium.com/@samybaladram/list/data-preprocessing-17a2c49b44e4?source=post_page-----33cbf07507b7--------------------------------)6ä¸ªæ•…äº‹ï¼[](../Images/f7ead0fb9a8dc2823d7a43d67a1c6932.png)![ä¸¤ä¸ªäººç‰©æ‹¥æŠ±çš„å¡é€šæ’å›¾ï¼Œå­—æ¯â€˜Aâ€™ï¼Œâ€˜Bâ€™ï¼Œâ€˜Câ€™å’Œæ•°å­—â€˜1â€™ï¼Œâ€˜2â€™ï¼Œâ€˜3â€™åœ¨å®ƒä»¬å‘¨å›´æ¼‚æµ®ã€‚ä¸€ä¸ªç²‰è‰²çš„å¿ƒå½¢å›¾æ ‡æ‚¬æµ®åœ¨ä¸Šæ–¹ï¼Œè±¡å¾ç€æ„Ÿæƒ…ã€‚èƒŒæ™¯æ˜¯è“è‰²å’Œç»¿è‰²æ–¹å—çš„åƒç´ åŒ–å›¾æ¡ˆï¼Œä»£è¡¨æ•°æ®æˆ–ç¼–ç ã€‚è¿™ä¸ªæ’å›¾éšå–»åœ°æç»˜äº†å¯¹ç±»åˆ«æ•°æ®è¿›è¡Œç¼–ç çš„æ¦‚å¿µï¼Œå…¶ä¸­ç±»åˆ«ï¼ˆABCï¼‰è¢«è½¬åŒ–ä¸ºæ•°å­—è¡¨ç¤ºï¼ˆ123ï¼‰ã€‚](../Images/72bb3a287a9ca4c5e7a3871e234bcc4b.png)![ä¸€å¼ å¡é€šæ’å›¾ï¼Œè¡¨ç¤ºæœºå™¨å­¦ä¹ ä¸­çš„æ•°æ®ç¼©æ”¾ã€‚ä¸€ä¸ªé«˜å¤§çš„å¥³æ€§ï¼ˆä»£è¡¨ä¸€ä¸ªå…·æœ‰å¤§èŒƒå›´çš„æ•°å€¼ç‰¹å¾ï¼‰æ­£åœ¨ç¼©å°æˆä¸€ä¸ªå°å­©ï¼ˆä»£è¡¨ç›¸åŒç‰¹å¾åœ¨ç¼©æ”¾åå˜ä¸ºè¾ƒå°èŒƒå›´ï¼‰ã€‚ä¸€ä¸ªçº¢è‰²ç®­å¤´æŒ‡ç¤ºç¼©å°è¿‡ç¨‹ï¼Œå­©å­å‘¨å›´çš„é»„è‰²é—ªå…‰è±¡å¾ç€ç¼©æ”¾çš„ç§¯æå½±å“ã€‚](../Images/d261b2c52a3cafe266d1962d4dbabdbd.png)

ğ™”ğ™¤ğ™ª ğ™¢ğ™ğ™œğ™ğ™© ğ™–ğ™¡ğ™¨ğ™¤ ğ™¡ğ™ğ™ ğ™š:

![Samy Baladram](../Images/835013c69e08fec04ad9ca465c2adf6c.png)

[Samy Baladram](https://medium.com/@samybaladram?source=post_page-----33cbf07507b7--------------------------------)

## åˆ†ç±»ç®—æ³•

[æŸ¥çœ‹åˆ—è¡¨](https://medium.com/@samybaladram/list/classification-algorithms-b3586f0a772c?source=post_page-----33cbf07507b7--------------------------------)8ç¯‡æ–‡ç« ![](../Images/f95c1a80b88fe6220b18cd3b2a83a30d.png)![](../Images/6ea70d9d2d9456e0c221388dbb253be8.png)![](../Images/7221f0777228e7bcf08c1adb44a8eb76.png)![Samy Baladram](../Images/835013c69e08fec04ad9ca465c2adf6c.png)

[Samy Baladram](https://medium.com/@samybaladram?source=post_page-----33cbf07507b7--------------------------------)

## å›å½’ç®—æ³•

[æŸ¥çœ‹åˆ—è¡¨](https://medium.com/@samybaladram/list/regression-algorithms-b0b6959f1b39?source=post_page-----33cbf07507b7--------------------------------)5ç¯‡æ–‡ç« ![ä¸€ä¸ªæ‰ç€è¾«å­ã€æˆ´ç€ç²‰è‰²å¸½å­çš„å¡é€šå¨ƒå¨ƒã€‚è¿™ä¸ªâ€œå‚€å„¡â€å¨ƒå¨ƒï¼Œå‡­å€Ÿå…¶ç®€å•çš„è®¾è®¡å’Œå¿ƒå½¢è£…é¥°çš„è¡¬è¡«ï¼Œåœ¨è§†è§‰ä¸Šä»£è¡¨äº†æœºå™¨å­¦ä¹ ä¸­çš„å‚€å„¡å›å½’å™¨æ¦‚å¿µã€‚å°±åƒè¿™ä¸ªç©å…·èˆ¬çš„å½¢è±¡æ˜¯ä¸€ä¸ªç®€åŒ–ã€é™æ€çš„äººç‰©ä»£è¡¨ï¼Œå‚€å„¡å›å½’å™¨æ˜¯ä½œä¸ºåŸºå‡†çš„åŸºæœ¬æ¨¡å‹ï¼Œä¾›æ›´å¤æ‚çš„åˆ†æä½¿ç”¨ã€‚](../Images/aa7eeaa18e4bb093f5ce4ab9b93a8a27.png)![](../Images/44e6d84e61c895757ff31e27943ee597.png)![](../Images/7f3e5f3e2aca2feec035ca92e1bc440a.png)
