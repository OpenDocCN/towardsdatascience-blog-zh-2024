<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>3 Essential Questions to Address When Building an API-Involved Incremental Data Loading Script</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>3 Essential Questions to Address When Building an API-Involved Incremental Data Loading Script</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://towardsdatascience.com/3-essential-questions-to-address-when-building-an-api-involved-incremental-data-loading-script-03723cad3411?source=collection_archive---------3-----------------------#2024-06-30">https://towardsdatascience.com/3-essential-questions-to-address-when-building-an-api-involved-incremental-data-loading-script-03723cad3411?source=collection_archive---------3-----------------------#2024-06-30</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="gr gs gt gu gv ab"><div><div class="ab gw"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@khoadaniel?source=post_page---byline--03723cad3411--------------------------------" rel="noopener follow"><div class="l gx gy by gz ha"><div class="l ed"><img alt="Daniel Khoa Le" class="l ep by dd de cx" src="../Images/5c01c760dc1e92b3048cfae005838ef1.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*TJzSpU4qNpXTpQQswWFFqg.jpeg"/><div class="hb by l dd de em n hc eo"/></div></div></a></div></div><div class="hd ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--03723cad3411--------------------------------" rel="noopener follow"><div class="l he hf by gz hg"><div class="l ed"><img alt="Towards Data Science" class="l ep by br hh cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hb by l br hh em n hc eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hi ab q"><div class="ab q hj"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hk hl bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hm" data-testid="authorName" href="https://medium.com/@khoadaniel?source=post_page---byline--03723cad3411--------------------------------" rel="noopener follow">Daniel Khoa Le</a></p></div></div></div><span class="hn ho" aria-hidden="true"><span class="bf b bg z dx">Â·</span></span><p class="bf b hk hl dx"><button class="hp hq ah ai aj ak al am an ao ap aq ar hr hs ht" disabled="">Follow</button></p></div></div></span></div></div><div class="l hu"><span class="bf b bg z dx"><div class="ab cn hv hw hx"><div class="hy hz ab"><div class="bf b bg z dx ab ia"><span class="ib l hu">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hm ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--03723cad3411--------------------------------" rel="noopener follow"><p class="bf b bg z ic id ie if ig ih ii ij bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hn ho" aria-hidden="true"><span class="bf b bg z dx">Â·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">8 min read</span><div class="ik il l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">Â·</span></span></div><span data-testid="storyPublishDate">Jun 30, 2024</span></div></span></div></span></div></div></div><div class="ab cp im in io ip iq ir is it iu iv iw ix iy iz ja jb"><div class="h k w ea eb q"><div class="jr l"><div class="ab q js jt"><div class="pw-multi-vote-icon ed ib ju jv jw"><div class=""><div class="jx jy jz ka kb kc kd am ke kf kg jw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kh ki kj kk kl km kn"><p class="bf b dy z dx"><span class="jy">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao jx kq kr ab q ee ks kt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="kp"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count ko kp">2</span></p></button></div></div></div><div class="ab q jc jd je jf jg jh ji jj jk jl jm jn jo jp jq"><div class="ku k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al kv an ao ap hr kw kx ky" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep kz cn"><div class="l ae"><div class="ab cb"><div class="la lb lc ld le lf ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al kv an ao ap hr lg lh kt li lj lk ll lm s ln lo lp lq lr ls lt u lu lv lw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al kv an ao ap hr lg lh kt li lj lk ll lm s ln lo lp lq lr ls lt u lu lv lw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al kv an ao ap hr lg lh kt li lj lk ll lm s ln lo lp lq lr ls lt u lu lv lw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><h1 id="20fd" class="lx ly fq bf lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bk"><strong class="al">TLDR</strong></h1><blockquote class="mv mw mx"><p id="6fb3" class="my mz na nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">This article explains both the conceptual framework and practical code implementation for syncing data from API endpoints to your database using dlt (a Python library).</p></blockquote><blockquote class="nx"><p id="d881" class="ny nz fq bf oa ob oc od oe of og nw dx">At the end of this tutorial, you will understand (and know how to implement) the sync behavior in the following illustration where we extract data <strong class="al">incrementally</strong> and write to the destination table with the merge (dedup) strategy.</p></blockquote></div></div><div class="oh"><div class="ab cb"><div class="la oi lb oj lc ok cf ol cg om ci bh"><figure class="oq or os ot ou oh ov ow paragraph-image"><div role="button" tabindex="0" class="ox oy ed oz bh pa"><div class="on oo op"><img src="../Images/e80987236bba43864b69abbfaef3cadd.png" data-original-src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*4rsdx0SxBPW2UX4Znebs-Q.gif"/></div></div><figcaption class="pc pd pe on oo pf pg bf b bg z dx">Image by Author</figcaption></figure></div></div></div><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="68a4" class="lx ly fq bf lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu bk">The context</h1><ol class=""><li id="a9ad" class="my mz fq nb b nc ph ne nf ng pi ni nj nk pj nm nn no pk nq nr ns pl nu nv nw pm pn po bk">You want to sync data from an application (e.g., ads performance, sales figures, etc.) to your database.</li><li id="69a1" class="my mz fq nb b nc pp ne nf ng pq ni nj nk pr nm nn no ps nq nr ns pt nu nv nw pm pn po bk">Your application provides API endpoints to retrieve its data.</li><li id="8e3b" class="my mz fq nb b nc pp ne nf ng pq ni nj nk pr nm nn no ps nq nr ns pt nu nv nw pm pn po bk">The data needs to be synced daily to your database.</li><li id="2f5f" class="my mz fq nb b nc pp ne nf ng pq ni nj nk pr nm nn no ps nq nr ns pt nu nv nw pm pn po bk">You want to load only the â—<strong class="nb fr"><em class="na">â€œnewâ€ data (or the changes)</em></strong>â— into your database. You do not want to load the entire set of data all over again every time you sync.</li></ol><p id="a433" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">How would you do it in Python?</p><blockquote class="nx"><p id="06c4" class="ny nz fq bf oa ob pu pv pw px py nw dx">I will walk you through the solution by addressing the following 3 questions.</p></blockquote></div></div></div><div class="ab cb pz qa qb qc" role="separator"><span class="qd by bm qe qf qg"/><span class="qd by bm qe qf qg"/><span class="qd by bm qe qf"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="fcd7" class="lx ly fq bf lz ma qh mc md me qi mg mh mi qj mk ml mm qk mo mp mq ql ms mt mu bk">ğŸ’¥ Question 1: What do I need from an API to sync data incrementally?</h1><p id="cbc4" class="pw-post-body-paragraph my mz fq nb b nc ph ne nf ng pi ni nj nk pj nm nn no pk nq nr ns pl nu nv nw fj bk">Before developing an incremental loading script, we need to understand the behavior of the API endpoints we are working with.</p><p id="2f4e" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">â—Not all APIs can facilitate incremental loading.</p><h2 id="ba74" class="qm ly fq bf lz qn qo qp md qq qr qs mh nk qt qu qv no qw qx qy ns qz ra rb rc bk">ğŸ‘‰ Answer: Query params that support incremental loading</h2><p id="81e7" class="pw-post-body-paragraph my mz fq nb b nc ph ne nf ng pi ni nj nk pj nm nn no pk nq nr ns pl nu nv nw fj bk">Letâ€™s look at an example of an application (or â€œsourceâ€ application) that tracks your sales performance. In this application, each record represents a product along with its sales volume. The fields <code class="cx rd re rf rg b">created_at</code> and <code class="cx rd re rf rg b">updated_at</code> indicate when the record was created and updated.</p><p id="b86e" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">Changes in the sales data typically occur in two main ways:</p><ol class=""><li id="6914" class="my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw pm pn po bk">New products are added to the list.</li><li id="7a61" class="my mz fq nb b nc pp ne nf ng pq ni nj nk pr nm nn no ps nq nr ns pt nu nv nw pm pn po bk">Updates are made to the sales figures of existing records, <strong class="nb fr">which results in a new value for </strong><code class="cx rd re rf rg b"><strong class="nb fr">updated_at</strong></code><strong class="nb fr"> </strong>. This helps us to track the new changes; without it, we cannot know which records have been modified.</li></ol><p id="e1bc" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">ğŸ‘ï¸ğŸ‘ï¸ Below is the example sales table in the source applicationâ€™s database.</p><p id="8d61" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">â†ªï¸ <strong class="nb fr">Yesterday's data: 2 records</strong></p><figure class="ri rj rk rl rm oh on oo paragraph-image"><div class="on oo rh"><img src="../Images/fcf8c37fb8ec51718382ef2cb9d09a8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1218/format:webp/1*0N3uob6HRTDGcUl57cAqMg.png"/></div><figcaption class="pc pd pe on oo pf pg bf b bg z dx">Image by Author</figcaption></figure><p id="7797" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">â†ªï¸ <strong class="nb fr">Today's data: a new record added and a change made to an existing record</strong></p><figure class="ri rj rk rl rm oh on oo paragraph-image"><div class="on oo rn"><img src="../Images/a7b45d06827f32925d53d8bf2cf1043d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*xh2_yClGAJnvhCCRWutv1A.png"/></div><figcaption class="pc pd pe on oo pf pg bf b bg z dx">Image by Author</figcaption></figure><p id="43bc" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">ğŸŸ¢ <strong class="nb fr">Takeaways: </strong>If the API endpoint allows queries based on the<code class="cx rd re rf rg b">updated_at</code> parameter, you can implement incremental loading by making requests to retrieve only records that have an <code class="cx rd re rf rg b">updated_at</code> value later than the most recent <code class="cx rd re rf rg b">updated_at</code> value saved from the previous sync. In this context, <code class="cx rd re rf rg b">updated_at</code> is referred to as the incremental cursor, and its value, which persists through to the next sync, is known as the state.</p><p id="7ad1" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">The <code class="cx rd re rf rg b">updated_at</code> field is a common choice for an incremental cursor. Other query params, such as <strong class="nb fr">id</strong> or <strong class="nb fr">sales,</strong> cannot help us to request data incrementally as they cannot tell us which records have been added or updated since the last sync.</p><p id="bb39" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk"><strong class="nb fr">Which query param do you need to load data incrementally?</strong></p><figure class="ri rj rk rl rm oh on oo paragraph-image"><div class="on oo ro"><img src="../Images/7301b30bfbf0c3f33879ec2791bd4802.png" data-original-src="https://miro.medium.com/v2/resize:fit:1318/format:webp/1*kA1Q_DRbViBi7n6ot5-1_w.png"/></div><figcaption class="pc pd pe on oo pf pg bf b bg z dx">Image by Author</figcaption></figure><blockquote class="nx"><p id="b0a4" class="ny nz fq bf oa ob oc od oe of og nw dx">Since weâ€™re developing a data loading script that works with API, Iâ€™ll introduce two other important aspects of APIs for the code implementation: <strong class="al">pagination and path parameters</strong>. They have nothing to do with incremental loading though.</p></blockquote><h2 id="e80d" class="qm ly fq bf lz qn rp qp md qq rq qs mh nk rr qu qv no rs qx qy ns rt ra rb rc bk">ğŸ¤· Pagination mechanism</h2><p id="3042" class="pw-post-body-paragraph my mz fq nb b nc ph ne nf ng pi ni nj nk pj nm nn no pk nq nr ns pl nu nv nw fj bk">APIs often return results in small chunks to enhance performance. For instance, instead of returning 10,000 records at once, an API might limit the response to a maximum of 100 records per request, requiring you to iterate through subsequent batches.</p><p id="4d83" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">To manage this, you typically (not always) need to use two query parameters: <code class="cx rd re rf rg b">limit</code> and <code class="cx rd re rf rg b">skip</code> (or offset).</p><p id="5937" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">Hereâ€™s a simple example to illustrate:</p><p id="9342" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">For the first request:</p><ul class=""><li id="93b4" class="my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw ru pn po bk"><code class="cx rd re rf rg b">limit</code>=100</li><li id="20b7" class="my mz fq nb b nc pp ne nf ng pq ni nj nk pr nm nn no ps nq nr ns pt nu nv nw ru pn po bk"><code class="cx rd re rf rg b">skip</code>=0</li></ul><p id="0e57" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">For the second request, to skip the first 100 records weâ€™ve already synced:</p><ul class=""><li id="4381" class="my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw ru pn po bk"><code class="cx rd re rf rg b">limit</code>=100</li><li id="6033" class="my mz fq nb b nc pp ne nf ng pq ni nj nk pr nm nn no ps nq nr ns pt nu nv nw ru pn po bk"><code class="cx rd re rf rg b">skip</code>=100</li></ul><p id="8b7d" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">This pattern continues, incrementing the <code class="cx rd re rf rg b">skip</code> value by the <code class="cx rd re rf rg b">limit</code> after each batch until all records are retrieved.</p><p id="0ddc" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">ğŸŸ¢ <strong class="nb fr">Takeaways: </strong>You need to understand how APIs return responses so that you wonâ€™t miss any records while extracting. There are many approaches an API can use to manage pagination, beyond the commonly used methods of skip and offset. But thatâ€™s a story for another day.</p><h2 id="050f" class="qm ly fq bf lz qn qo qp md qq qr qs mh nk qt qu qv no qw qx qy ns qz ra rb rc bk">ğŸ¤· Path param</h2><p id="efbd" class="pw-post-body-paragraph my mz fq nb b nc ph ne nf ng pi ni nj nk pj nm nn no pk nq nr ns pl nu nv nw fj bk">Path parameters are included directly in the URL of an API and are typically used to distinguish between different segments (partitions) of data. For example, they might specify different campaigns within your marketing account or different sub-accounts managed in the source application.</p><p id="ea9c" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">In the example below: the path params are <code class="cx rd re rf rg b">applicationId</code> and <code class="cx rd re rf rg b">campaignId</code>.</p><p id="bedd" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk"><code class="cx rd re rf rg b"><a class="af rv" href="https://yourbaseurl.talon.one/v1/applications/%7BapplicationId%7D/campaigns/%7BcampaignId%7D/coupons/no_total" rel="noopener ugc nofollow" target="_blank">https://yourbaseurl.myapp/v1/applications/{applicationId}/campaigns/{campaignId}/</a>sales</code></p><p id="ec28" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">ğŸŸ¢ <strong class="nb fr">Takeaways: </strong>You need to decide whether you will sync data from the same API but with different path params to a single table or different tables (sales_campaign_1, sales_campaign_2, etc.).</p></div></div></div><div class="ab cb pz qa qb qc" role="separator"><span class="qd by bm qe qf qg"/><span class="qd by bm qe qf qg"/><span class="qd by bm qe qf"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="c7ac" class="lx ly fq bf lz ma qh mc md me qi mg mh mi qj mk ml mm qk mo mp mq ql ms mt mu bk">ğŸ’¥ Question 2: How do I want to write the extracted records to the destination table?</h1><p id="5957" class="pw-post-body-paragraph my mz fq nb b nc ph ne nf ng pi ni nj nk pj nm nn no pk nq nr ns pl nu nv nw fj bk">Now letâ€™s say you already extracted a bunch of records by making API requests with the above-mentioned params, itâ€™s time for you to decide how you want to write them to the destination table.</p><h2 id="df14" class="qm ly fq bf lz qn qo qp md qq qr qs mh nk qt qu qv no qw qx qy ns qz ra rb rc bk">ğŸ‘‰ Answer: Merge/Dedup mode (recommended)</h2><p id="a048" class="pw-post-body-paragraph my mz fq nb b nc ph ne nf ng pi ni nj nk pj nm nn no pk nq nr ns pl nu nv nw fj bk">This question concerns the choice of <strong class="nb fr">Write disposition</strong> or <strong class="nb fr">Sync mode</strong>. The immediate answer is that, given you are looking to load your data incrementally, you will likely opt to write your extracted data in either append mode or merge mode (also known as deduplication mode).</p><p id="85cd" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">However, letâ€™s step back to examine our options more closely and determine which method is best suited for incremental loading.</p><p id="e1c0" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">Here are the popular write dispositions.</p><ul class=""><li id="b53d" class="my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw ru pn po bk">ğŸŸª <strong class="nb fr">overwrite/replace:</strong> drop all existing records in the destination tables and then insert the extracted records.</li><li id="ad40" class="my mz fq nb b nc pp ne nf ng pq ni nj nk pr nm nn no ps nq nr ns pt nu nv nw ru pn po bk">ğŸŸª <strong class="nb fr">append: </strong>simply append extracted records to the destination tables.</li><li id="c124" class="my mz fq nb b nc pp ne nf ng pq ni nj nk pr nm nn no ps nq nr ns pt nu nv nw ru pn po bk">ğŸŸª <strong class="nb fr">merge / dedup: </strong>insert new(*) records and update(**) existing records.</li></ul><p id="f792" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">(*) How do we know which records are new?: Usually, we will use a primary key to determine that. If you use dlt, their merging strategy can be more sophisticated than that, including the distinction between <code class="cx rd re rf rg b">merge_key</code> and <code class="cx rd re rf rg b">primary_key</code> <em class="na">(one is used for merging and one is used for dedupication before merging)</em> or <code class="cx rd re rf rg b">dedup_sort</code> <em class="na">(which records are to be deleted with the same key in the dedup process)</em>. I will leave that part for another tutorial.</p><p id="0086" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">(**) This is a simple explanation, if you want to find out more about how dlt handles this merging strategy, read more <a class="af rv" href="https://dlthub.com/docs/general-usage/incremental-loading#merge-incremental-loading" rel="noopener ugc nofollow" target="_blank">here</a>.</p><p id="6a80" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">ğŸ‘ï¸ğŸ‘ï¸ Here is an example to help us understand the results of different write dispositions.</p><p id="8497" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">â†ªï¸ <strong class="nb fr">On 2024.06.19: We make the first sync.</strong></p><p id="e85d" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">ğŸ…°ï¸ <strong class="nb fr">Data in </strong><code class="cx rd re rf rg b"><strong class="nb fr">source application</strong></code>ï¸ï¸</p><figure class="ri rj rk rl rm oh on oo paragraph-image"><div role="button" tabindex="0" class="ox oy ed oz bh pa"><div class="on oo rw"><img src="../Images/74b8a8cbec32ac881ce296f257ab9913.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C4qVYzYM4d7wnA7TnmegCA.png"/></div></div><figcaption class="pc pd pe on oo pf pg bf b bg z dx">Image by Author</figcaption></figure><p id="5803" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">ğŸ…±ï¸ ï¸<strong class="nb fr">Data loaded to our </strong><code class="cx rd re rf rg b"><strong class="nb fr">destination database</strong></code></p><p id="46d7" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">No matter what sync strategy you choose, the table at the destination is <strong class="nb fr">literally a copy</strong> of the source table.</p><figure class="ri rj rk rl rm oh on oo paragraph-image"><div role="button" tabindex="0" class="ox oy ed oz bh pa"><div class="on oo rw"><img src="../Images/74b8a8cbec32ac881ce296f257ab9913.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C4qVYzYM4d7wnA7TnmegCA.png"/></div></div><figcaption class="pc pd pe on oo pf pg bf b bg z dx">Image by Author</figcaption></figure><p id="264e" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">Saved state of <code class="cx rd re rf rg b">updated_at</code>= 2024â€“06â€“03, which is the latest <code class="cx rd re rf rg b">updated_at</code> mong the 2 records we synced.</p><p id="4e0c" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">â†ªï¸ <strong class="nb fr">On 2024.06.2: We make the second sync.</strong></p><p id="9dea" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk"><strong class="nb fr">ğŸ…°ï¸ ï¸ï¸ï¸ï¸ï¸ï¸ï¸Data in </strong><code class="cx rd re rf rg b"><strong class="nb fr">source application</strong></code></p><figure class="ri rj rk rl rm oh on oo paragraph-image"><div role="button" tabindex="0" class="ox oy ed oz bh pa"><div class="on oo rx"><img src="../Images/43dd22288ef2069f3129fa81154bed22.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zx_CZq_rPpk-EBftj_rDog.png"/></div></div><figcaption class="pc pd pe on oo pf pg bf b bg z dx">Image by Author</figcaption></figure><p id="fcb1" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">âœï¸ Changes in the source table:</p><ul class=""><li id="2c14" class="my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw ru pn po bk">Record id=1 was updated (sales figure).</li><li id="582b" class="my mz fq nb b nc pp ne nf ng pq ni nj nk pr nm nn no ps nq nr ns pt nu nv nw ru pn po bk">Record id=2 was dropped.</li><li id="cf90" class="my mz fq nb b nc pp ne nf ng pq ni nj nk pr nm nn no ps nq nr ns pt nu nv nw ru pn po bk">Record id=3 was inserted.</li></ul><p id="2526" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">At this sync, we ONLY extract records with the <code class="cx rd re rf rg b">updated_at</code>&gt; 2024â€“06â€“03 (state saved from last sync). Therefore, we will extracted only record id=1 and id=3. Since record id=2 was removed from the source data, there is no way for us to recognize this change.</p><p id="d958" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">With the second sync, you now will see the difference among the write strategies.</p><p id="7bbd" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">ğŸ…±ï¸ <strong class="nb fr">Data loaded to our </strong><code class="cx rd re rf rg b"><strong class="nb fr">destination database</strong></code></p><p id="8888" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">â— <strong class="nb fr">Scenario 1: Overwrite</strong></p><figure class="ri rj rk rl rm oh on oo paragraph-image"><div role="button" tabindex="0" class="ox oy ed oz bh pa"><div class="on oo ry"><img src="../Images/19496a1ddb57a9f1e1107c691ddf441d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b8dhvAJKm1f5BhWa8P5ilQ.png"/></div></div><figcaption class="pc pd pe on oo pf pg bf b bg z dx">Image by Author</figcaption></figure><p id="2498" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">The destination table will be overwritten by the 2 records extracted this time.</p><p id="010a" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">â— <strong class="nb fr">Scenario 2: Append</strong></p><figure class="ri rj rk rl rm oh on oo paragraph-image"><div role="button" tabindex="0" class="ox oy ed oz bh pa"><div class="on oo rw"><img src="../Images/c30e26065a3f3bf15be9590181267768.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TZnoowZmM8q868it7okgwA.png"/></div></div><figcaption class="pc pd pe on oo pf pg bf b bg z dx">Image by Author</figcaption></figure><p id="5476" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">The 2 extracted records will be appended to the destination table, the existing records are not affected.</p><p id="c7d0" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">â— <strong class="nb fr">Scenario 3: Merge or dedup</strong></p><figure class="ri rj rk rl rm oh on oo paragraph-image"><div role="button" tabindex="0" class="ox oy ed oz bh pa"><div class="on oo ry"><img src="../Images/380959de013398c27bd89d42b83d8da6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eGgD7e3yAcZWU9c1-p2Ybg.png"/></div></div><figcaption class="pc pd pe on oo pf pg bf b bg z dx">Image by Author</figcaption></figure><p id="3b5d" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">The 2 extracted records with id=1 and 3 will replace the existing records at destination. This processing is so called merging or deduplicating. Record id=2 in the destination table remains intact.</p><p id="e8d9" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">ğŸŸ¢ <strong class="nb fr">Takeaways: </strong>The merge (dedup) strategy can be effective in the incremental data loading pipeline, but if your table is very large, this dedup process might take a considerable amount of time.</p></div></div></div><div class="ab cb pz qa qb qc" role="separator"><span class="qd by bm qe qf qg"/><span class="qd by bm qe qf qg"/><span class="qd by bm qe qf"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="750f" class="lx ly fq bf lz ma qh mc md me qi mg mh mi qj mk ml mm qk mo mp mq ql ms mt mu bk">ğŸ’¥ Question 3: How do I implement it in code?</h1><h2 id="256b" class="qm ly fq bf lz qn qo qp md qq qr qs mh nk qt qu qv no qw qx qy ns qz ra rb rc bk">ğŸ‘‰ Answer: dlt â€” as it is lightweight, well-documented, and has an active community for support.</h2><blockquote class="nx"><p id="5bce" class="ny nz fq bf oa ob pu pv pw px py nw dx"><a class="af rv" href="https://dlthub.com/" rel="noopener ugc nofollow" target="_blank">dlt</a> is an excellent choice because it provides you with the right level of abstraction. In fact, you can choose how much abstraction you want. As you can see in my example code below, I have taken the liberty of writing my own request loop, but dlt offers helper functions that can do this for you with much fewer lines of code. This flexibility makes dlt stand out compared to other solutions.</p></blockquote><p id="770a" class="pw-post-body-paragraph my mz fq nb b nc rz ne nf ng sa ni nj nk sb nm nn no sc nq nr ns sd nu nv nw fj bk">You can refer to the diagram for a high-level view and then drill down to the code with detailed remarks below.</p><p id="16c9" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">Quick note: dlt uses the terms <strong class="nb fr">source</strong> and <strong class="nb fr">resources </strong>in its structuring. A resource typically corresponds to an API endpoint and writes data to a table in the destination database. A source is a collection of resources.</p><p id="6de0" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">In the illustration below, you can see the answers to the two questions we discussed:</p><ul class=""><li id="0d5d" class="my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw ru pn po bk">Answer to Question 1: Make requests to an API endpoint using a date cursor to get data incrementally (and persist the cursor value, also known as state, for subsequent runs).</li><li id="5b1f" class="my mz fq nb b nc pp ne nf ng pq ni nj nk pr nm nn no ps nq nr ns pt nu nv nw ru pn po bk">Answer to Question 2: Write data to the destination table using the merge strategy.</li></ul></div></div><div class="oh"><div class="ab cb"><div class="la oi lb oj lc ok cf ol cg om ci bh"><figure class="ri rj rk rl rm oh ov ow paragraph-image"><div role="button" tabindex="0" class="ox oy ed oz bh pa"><div class="on oo se"><img src="../Images/0d48e7a8399a7ac757f7be442cb17cd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:2000/format:webp/1*qMfE09esdjRFwK99DZ1KMQ.gif"/></div></div></figure></div></div></div><div class="ab cb"><div class="ci bh ev ew ex ey"><blockquote class="nx"><p id="1064" class="ny nz fq bf oa ob oc od oe of og nw dx">Now, you might wonder how to run this Python script? I suggest you to go to <a class="af rv" href="https://github.com/khoadaniel/incremental-data-loading-guide" rel="noopener ugc nofollow" target="_blank">this repository</a> and try out yourself. This repository also provides you with a mock API that you can deploy locally for testing purposes. Check out the README for the detailed execution guide.</p></blockquote><p id="e4a7" class="pw-post-body-paragraph my mz fq nb b nc rz ne nf ng sa ni nj nk sb nm nn no sc nq nr ns sd nu nv nw fj bk">ğŸ’¥ Here is a snippet of the dlt implementation with my remarks ğŸ’¥</p><figure class="ri rj rk rl rm oh"><div class="sf ic l ed"><div class="sg sh l"/></div></figure><p id="28ba" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">ğŸŸ£ï¸ <strong class="nb fr">Full code can be seen at the repository </strong><a class="af rv" href="https://github.com/khoadaniel/incremental-data-loading-guide" rel="noopener ugc nofollow" target="_blank"><strong class="nb fr">here</strong></a><strong class="nb fr"> </strong>ğŸŸ£</p><p id="21fd" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">âœ… This concludes the tutorial. I hope you have learned about the different components that make up an incremental loading script, as well as the code implementation.</p><p id="78d0" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">If youâ€™re interested in finding out more about how to build an incremental loading script with dlt, check out their documentation <a class="af rv" href="https://dlthub.com/docs/general-usage/incremental-loading" rel="noopener ugc nofollow" target="_blank">here</a>.</p></div></div></div><div class="ab cb pz qa qb qc" role="separator"><span class="qd by bm qe qf qg"/><span class="qd by bm qe qf qg"/><span class="qd by bm qe qf"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="a20a" class="lx ly fq bf lz ma qh mc md me qi mg mh mi qj mk ml mm qk mo mp mq ql ms mt mu bk">About me</h1><p id="bac0" class="pw-post-body-paragraph my mz fq nb b nc ph ne nf ng pi ni nj nk pj nm nn no pk nq nr ns pl nu nv nw fj bk">I am Daniel Le, based in Berlin. I currently work in the fields of Data Engineering and Machine Learning.</p><p id="23c2" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">I am interested in new technologies and how they can be implemented to solve real-world problems.</p><p id="dd3b" class="pw-post-body-paragraph my mz fq nb b nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">Should you have any inquiries or wish to discuss these interests further, please do not hesitate to connect with me on <a class="af rv" href="https://www.linkedin.com/in/khoadaniel/" rel="noopener ugc nofollow" target="_blank">LinkedIn</a>.</p></div></div></div><div class="ab cb pz qa qb qc" role="separator"><span class="qd by bm qe qf qg"/><span class="qd by bm qe qf qg"/><span class="qd by bm qe qf"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="bfa8" class="lx ly fq bf lz ma qh mc md me qi mg mh mi qj mk ml mm qk mo mp mq ql ms mt mu bk">Reference</h1><ul class=""><li id="0aac" class="my mz fq nb b nc ph ne nf ng pi ni nj nk pj nm nn no pk nq nr ns pl nu nv nw ru pn po bk"><a class="af rv" href="https://dlthub.com/docs/general-usage/incremental-loading" rel="noopener ugc nofollow" target="_blank">https://dlthub.com/docs/general-usage/incremental-loading</a></li></ul></div></div></div></div>    
</body>
</html>