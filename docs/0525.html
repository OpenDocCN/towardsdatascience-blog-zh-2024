<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Lessons From My ML Journey: Data Splitting and Data Leakage</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Lessons From My ML Journey: Data Splitting and Data Leakage</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/two-rookie-mistakes-i-made-in-machine-learning-improper-data-splitting-and-data-leakage-3e33a99560ea?source=collection_archive---------1-----------------------#2024-02-25">https://towardsdatascience.com/two-rookie-mistakes-i-made-in-machine-learning-improper-data-splitting-and-data-leakage-3e33a99560ea?source=collection_archive---------1-----------------------#2024-02-25</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="fa95" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">Common mistakes to avoid when you transition from statistical modelling to Machine Learning</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@khinydnlin_310?source=post_page---byline--3e33a99560ea--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Khin Yadanar Lin" class="l ep by dd de cx" src="../Images/1018a44583239dfd33901b6d392d257f.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*JX5Ik3pxwYwZh3-iN80oEQ.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--3e33a99560ea--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://medium.com/@khinydnlin_310?source=post_page---byline--3e33a99560ea--------------------------------" rel="noopener follow">Khin Yadanar Lin</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--3e33a99560ea--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">7 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Feb 25, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj la lb ab q ee lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lf k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lg an ao ap id lh li lj" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep lk cn"><div class="l ae"><div class="ab cb"><div class="ll lm ln lo lp lq ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj mk"><img src="../Images/61b1e12ac5adb638a6f48a7ce5d93b04.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*mZrJghgnnYrw_Moe"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Photo by <a class="af nb" href="https://unsplash.com/@syinq?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Susan Q Yin</a> on <a class="af nb" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="11b9" class="nc nd fq bf ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz bk">My Story</h2><p id="6bc2" class="pw-post-body-paragraph oa ob fq oc b go od oe of gr og oh oi nn oj ok ol nr om on oo nv op oq or os fj bk"><strong class="oc fr">Data Science, Machine Learning, and AI</strong> are undeniably buzzwords of today. My LinkedIn is flooded with data gurus sharing learning roadmaps for those eager to break into this data space.</p><p id="60a9" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">Yet, from my personal experience, I’ve found that the journey towards Data Science isn’t as linear as merely following a fixed roadmap, especially for individuals transitioning from various professional backgrounds. Data Science requires a blend of diverse skills like programming, statistics, math, analytics, soft skills, and domain knowledge. This means that everyone picks up learning from different points depending on their prior experience/skill sets.</p><p id="a7e8" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">As someone who worked in research and analytics for years and pursued a master’s degree in analytics, I have acquired a fair amount of statistical knowledge and its applications. Even then, data science is such a broad and dynamic industry that my knowledge is still all over the place. I struggled to find resources that could effectively fill my knowledge gap between statistics and ML as well. This posed significant challenges to my learning experience.</p><p id="70e3" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">In this article, I aim to share the technical oversights I encounter as I navigate from research &amp; analytics to data science. Hopefully, my sharing can save you time and help you avoid these pitfalls.</p></div></div></div><div class="ab cb oy oz pa pb" role="separator"><span class="pc by bm pd pe pf"/><span class="pc by bm pd pe pf"/><span class="pc by bm pd pe"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h2 id="1917" class="nc nd fq bf ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz bk">Statistical Modelling Vs Machine Learning</h2><p id="8901" class="pw-post-body-paragraph oa ob fq oc b go od oe of gr og oh oi nn oj ok ol nr om on oo nv op oq or os fj bk">So, you might be wondering why I am starting with a reflection on my journey instead of getting to the point. Well, the reason is simple — I have noticed that many individuals claim to be building ML models when, in reality, they are only crafting statistical models. I confess I was one of them! It’s not like one is better than the other, but I believe it is crucial to recognise the nuances between statistical modelling and ML before I talk about technicalities.</p><blockquote class="pg ph pi"><p id="65de" class="oa ob pj oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">The purpose of <strong class="oc fr">statistical models </strong>is <strong class="oc fr">for making inferences</strong>, while the primary goal of <strong class="oc fr">Machine Learning </strong>is <strong class="oc fr">for predictions</strong>. Simply put, the ML model leverages statistics and math to generate predictions applicable to real-world scenarios. This is where data splitting and data leakage come into the picture, particularly in the context of supervised Machine Learning.</p></blockquote><p id="a9ab" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">My initial belief was that understanding statistical analysis was sufficient for prediction tasks. However, I quickly realised that without knowledge of data preparation techniques such as proper data splitting and awareness of potential pitfalls like data leakage, even the most sophisticated statistical models fall short in predictive performance.</p><p id="bd90" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">So, let’s get started!</p><h1 id="00a3" class="pk nd fq bf ne pl pm gq ni pn po gt nm pp pq pr ps pt pu pv pw px py pz qa qb bk"><strong class="al">Mistake 1: Improper Data Splitting</strong></h1><h2 id="c873" class="nc nd fq bf ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz bk"><strong class="al">What is meant by data splitting?</strong></h2><p id="f03d" class="pw-post-body-paragraph oa ob fq oc b go od oe of gr og oh oi nn oj ok ol nr om on oo nv op oq or os fj bk">Data splitting, in essence, is dividing your dataset into parts for optimal predictive performance of the model.</p><p id="2355" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">Consider a simple OLS regression concept that is familiar to many of us. We all have heard about it in one of the business/stats/finance, economics, or engineering lectures. It is a fundamental ML technique.</p><p id="8585" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">Let’s say we have a housing price dataset along with the factors that might affect housing prices.</p><p id="9a58" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">In <strong class="oc fr">traditional statistical analysis,</strong> we employ <strong class="oc fr">the entire dataset </strong>to develop a regression model, as our goal is just to understand what factors influence housing prices. In other words, regression models can explain what degree of changes in prices are associated with the predictors.</p><p id="39d2" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">However, in ML, the statistical part remains the same, but data splitting becomes crucial. Let me explain why — imagine we train the model on the entire set; how would we know the predictive performance of the model on unseen data?</p><p id="20b3" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">For this very reason, we typically split the dataset into two sets: training and test sets. The idea is to train the model on one set and evaluate its performance on the other set. Essentially, the test set should serve as real-world data, meaning the model should not have access to the test data in any way throughout the training phase.</p><p id="d65b" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">Here comes the pitfall that I wasn’t aware of before. Splitting data into two sets is not inherently wrong, but there is a risk of creating an unreliable model. Imagine you train the model on the training set, validate its accuracy on the test set, and then repeat the process to fine-tune the model. This creates a bias in model selection and defeats the whole purpose of “unseen data” because test data was seen multiple times during model development. It undermines the model’s ability to genuinely predict the unseen data, leading to overfitting issues.</p><h2 id="10a6" class="nc nd fq bf ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz bk"><strong class="al">How to prevent it:</strong></h2><p id="a5b1" class="pw-post-body-paragraph oa ob fq oc b go od oe of gr og oh oi nn oj ok ol nr om on oo nv op oq or os fj bk">Ideally, the dataset should be divided into two blocks (three distinct splits):</p><ul class=""><li id="5865" class="oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os qc qd qe bk"><strong class="oc fr">( Training set + Validation set) → 1st block</strong></li><li id="f21a" class="oa ob fq oc b go qf oe of gr qg oh oi nn qh ok ol nr qi on oo nv qj oq or os qc qd qe bk"><strong class="oc fr">Test set → 2nd block</strong></li></ul><p id="d400" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">The model can be trained and validated on the 1st block. The 2nd block (the test set) should not be involved in any of the model training processes. Think of the test set as a danger zone!</p><p id="3da3" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">How you want to split the data is dependent on the size of the dataset. The industry standard is 60% — 80 % for the training set (1st block) and 20% — 40% for the test set. The validation set is normally curved out of the 1st block so the actual training set would be 70% — 90% out of the 1st block , and the rest is for the validation set.</p><p id="cc99" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">The best way to grasp this concept is through a visual:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div class="mi mj qk"><img src="../Images/6105336a31da32444fe35c89d8af593c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1120/format:webp/1*wLkK2Vy2RwocgCKzKfTV1w.png"/></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Leave-One-Out (LOOV) method (Image by the author)</figcaption></figure><p id="26c9" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">There is more than one data-splitting technique other than LOOV (in the picture):</p><ul class=""><li id="f044" class="oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os qc qd qe bk">K-fold Cross-validation, which divides the data into a number of ‘K’ folds and iterates the training processes accordingly</li><li id="abe8" class="oa ob fq oc b go qf oe of gr qg oh oi nn qh ok ol nr qi on oo nv qj oq or os qc qd qe bk">Rolling Window Cross-validation (for time-series data)</li><li id="386c" class="oa ob fq oc b go qf oe of gr qg oh oi nn qh ok ol nr qi on oo nv qj oq or os qc qd qe bk">Blocked Cross-validation (for time-series data)</li><li id="e5f0" class="oa ob fq oc b go qf oe of gr qg oh oi nn qh ok ol nr qi on oo nv qj oq or os qc qd qe bk">Stratified Sampling Splitting for imbalanced classes</li></ul><p id="a0b5" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">Note: Time series data needs extra caution when splitting data due to its temporal order. Randomly splitting the dataset can mess up its time order. (I learnt it the hard way)</p><blockquote class="pg ph pi"><p id="6a6d" class="oa ob pj oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">The most important thing is regardless of the techniques you use, the “test set” should be kept separate and untouched until the model selection.</p></blockquote><h1 id="48a2" class="pk nd fq bf ne pl pm gq ni pn po gt nm pp pq pr ps pt pu pv pw px py pz qa qb bk"><strong class="al">Mistake 2: Data Leakage</strong></h1><blockquote class="pg ph pi"><p id="5aa8" class="oa ob pj oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">“In Machine learning, <strong class="oc fr">Data Leakage</strong> refers to a mistake that is made by the creator of a machine learning model in which they accidentally share the information between the test and training data sets.” — Analytics Vidhya</p></blockquote><p id="5b6e" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">This is connected to my first point about test data being contaminated by training data. It’s one example of data leakage. However, having a validation set alone can’t avoid data leakage.</p><p id="a243" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">In order to prevent data leakage, we need to be careful with the data handling process — from Exploratory Data Analysis (EDA) to Feature Engineering. Any procedure that allows the training data to interact with the test data could potentially lead to leakage.</p><p id="428b" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">There are two main types of leakage:</p><ol class=""><li id="08ea" class="oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os ql qd qe bk"><strong class="oc fr">Train-test-contamination</strong></li></ol><p id="af51" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">A common mistake I made involved applying a standardisation/pre-processing procedure to the entire set before data splitting. For example, using mean imputation to handle missing values/ outliers on the whole dataset. This makes the training data incorporate information from the test data. As a result, the model’s accuracy is inflated compared to its real-life performance.</p><p id="2fb4" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk"><strong class="oc fr">2. Target leakage</strong></p><p id="22a6" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">If the features (predictors) have some dependency on the variable that we want to predict (target), or if the features data will not be available at the time of prediction, this can result in target leakage.</p><p id="17c7" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">Let’s look at the data I worked on as an example. Here, I was trying to predict sales performance based on advertising campaigns. I tried to include the conversion rates. I overlooked the fact that conversion rates are only known post-campaign. In other words, I won’t have this information at the time of forecasting. Plus, because conversion rates are tied to sales data, this introduces a classic case of target leakage. Including conversion rates would lead the model to learn from data that would not be normally accessible, resulting in overly optimistic predictions.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div class="mi mj qm"><img src="../Images/770a023e6724fb3763738400109bd951.png" data-original-src="https://miro.medium.com/v2/resize:fit:1148/format:webp/1*0Gwzn6SopjJoafvNZvpTEQ.png"/></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Sample (made-up) Dataset (Image by the author)</figcaption></figure><h2 id="5a6a" class="nc nd fq bf ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz bk">How to prevent data leakage:</h2><p id="f75f" class="pw-post-body-paragraph oa ob fq oc b go od oe of gr og oh oi nn oj ok ol nr om on oo nv op oq or os fj bk">In summary, keep these points in mind to address data leakage issues:</p><ol class=""><li id="5fc2" class="oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os ql qd qe bk">Proper Data Preprocessing</li><li id="c26a" class="oa ob fq oc b go qf oe of gr qg oh oi nn qh ok ol nr qi on oo nv qj oq or os ql qd qe bk">Cross-validation with care</li><li id="7e14" class="oa ob fq oc b go qf oe of gr qg oh oi nn qh ok ol nr qi on oo nv qj oq or os ql qd qe bk">Careful Feature Selection</li></ol><h2 id="50f5" class="nc nd fq bf ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz bk"><strong class="al">Closing Thoughts</strong></h2><p id="ed7c" class="pw-post-body-paragraph oa ob fq oc b go od oe of gr og oh oi nn oj ok ol nr om on oo nv op oq or os fj bk">That’s about it! Thanks for sticking with me till the end! I hope this article clarifies the common misconceptions around data splitting and sheds light on the best practices in building efficient ML models.</p><p id="ee2a" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk">This is not just for documenting my learning journey but also for mutual learning. So, if you spot a gap in my technical know-how or have any insights to share, feel free to drop me a message!</p><h2 id="7fe6" class="nc nd fq bf ne nf ng nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz bk">References:</h2><p id="6a1b" class="pw-post-body-paragraph oa ob fq oc b go od oe of gr og oh oi nn oj ok ol nr om on oo nv op oq or os fj bk"><a class="af nb" href="https://www.linkedin.com/posts/danleedata_choosing-your-model-on-%3F%3F%3F%3F%3F-%3F%3F-activity-7158131388976693248-FXUT?utm_source=share&amp;utm_medium=member_desktop" rel="noopener ugc nofollow" target="_blank">Daniel Lee Datainterview.com LinkedIn Post</a></p><p id="28aa" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk"><a class="af nb" href="https://www.kaggle.com/code/alexisbcook/data-leakage" rel="noopener ugc nofollow" target="_blank">Kaggle — Data Leakage Explanation</a></p><p id="19f8" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk"><a class="af nb" href="https://www.analyticsvidhya.com/blog/2021/07/data-leakage-and-its-effect-on-the-performance-of-an-ml-model/" rel="noopener ugc nofollow" target="_blank">Analytics Vidhya — Data Leakage And Its Effect On The Performance of An ML Model</a></p><p id="fa46" class="pw-post-body-paragraph oa ob fq oc b go ot oe of gr ou oh oi nn ov ok ol nr ow on oo nv ox oq or os fj bk"><a class="af nb" href="https://otexts.com/fpp3/tscv.html" rel="noopener ugc nofollow" target="_blank">Forecasting: Principles and Practice</a></p></div></div></div></div>    
</body>
</html>