<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Data Modeling Techniques for the Post-Modern Data Stack</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Data Modeling Techniques for the Post-Modern Data Stack</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/data-modeling-techniques-for-the-post-modern-data-stack-03fc2e4a210c?source=collection_archive---------4-----------------------#2024-07-20">https://towardsdatascience.com/data-modeling-techniques-for-the-post-modern-data-stack-03fc2e4a210c?source=collection_archive---------4-----------------------#2024-07-20</a></blockquote><div><div class="em ff fg fh fi fj"/><div class="fk fl fm fn fo"><div class="ab cb"><div class="ci bh ew ex ey ez"><div/><div><h2 id="4db6" class="pw-subtitle-paragraph go fq fr bf b gp gq gr gs gt gu gv gw gx gy gz ha hb hc hd cq dx">A set of generic techniques and principles to design a robust, cost-efficient, and scalable data model for your post-modern data stack.</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="he hf hg hh hi ab"><div><div class="ab hj"><div><div class="bm" aria-hidden="false"><a href="https://mahdiqb.medium.com/?source=post_page---byline--03fc2e4a210c--------------------------------" rel="noopener follow"><div class="l hk hl by hm hn"><div class="l ed"><img alt="Mahdi Karabiben" class="l ep by dd de cx" src="../Images/f1aac76435b8db295c306c76796a3201.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*TA0_yFAlh4tMo5estOObNg.jpeg"/><div class="ho by l dd de em n hp eo"/></div></div></a></div></div><div class="hq ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--03fc2e4a210c--------------------------------" rel="noopener follow"><div class="l hr hs by hm ht"><div class="l ed"><img alt="Towards Data Science" class="l ep by br hu cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="ho by l br hu em n hp eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hv ab q"><div class="ab q hw"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hx hy bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hz" data-testid="authorName" href="https://mahdiqb.medium.com/?source=post_page---byline--03fc2e4a210c--------------------------------" rel="noopener follow">Mahdi Karabiben</a></p></div></div></div><span class="ia ib" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hx hy dx"><button class="ic id ah ai aj ak al am an ao ap aq ar ie if ig" disabled="">Follow</button></p></div></div></span></div></div><div class="l ih"><span class="bf b bg z dx"><div class="ab cn ii ij ik"><div class="il im ab"><div class="bf b bg z dx ab in"><span class="io l ih">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hz ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--03fc2e4a210c--------------------------------" rel="noopener follow"><p class="bf b bg z ip iq ir is it iu iv iw bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="ia ib" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">8 min read</span><div class="ix iy l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Jul 20, 2024</span></div></span></div></span></div></div></div><div class="ab cp iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo"><div class="h k w ea eb q"><div class="ke l"><div class="ab q kf kg"><div class="pw-multi-vote-icon ed io kh ki kj"><div class=""><div class="kk kl km kn ko kp kq am kr ks kt kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l ku kv kw kx ky kz la"><p class="bf b dy z dx"><span class="kl">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kk ld le ab q ee lf lg" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lc"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count lb lc">3</span></p></button></div></div></div><div class="ab q jp jq jr js jt ju jv jw jx jy jz ka kb kc kd"><div class="lh k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al li an ao ap ie lj lk ll" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep lm cn"><div class="l ae"><div class="ab cb"><div class="ln lo lp lq lr ls ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al li an ao ap ie lt lu lg lv lw lx ly lz s ma mb mc md me mf mg u mh mi mj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al li an ao ap ie lt lu lg lv lw lx ly lz s ma mb mc md me mf mg u mh mi mj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al li an ao ap ie lt lu lg lv lw lx ly lz s ma mb mc md me mf mg u mh mi mj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="mn mo mp mq mr ms mk ml paragraph-image"><div role="button" tabindex="0" class="mt mu ed mv bh mw"><div class="mk ml mm"><img src="../Images/c9837a2fd15473bf546f45783302debd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WxzbjtRjJ9-eARzV"/></div></div><figcaption class="my mz na mk ml nb nc bf b bg z dx">Photo by <a class="af nd" href="https://unsplash.com/@lazycreekimages?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Michael Dziedzic</a> on <a class="af nd" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="25ba" class="pw-post-body-paragraph ne nf fr ng b gp nh ni nj gs nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fk bk">Over the past few years, as the Modern Data Stack (MDS) introduced new patterns and standards for moving, transforming, and interacting with data, dimensional data modeling gradually became a relic of the past. In its place, data teams relied on One-Big-Tables (OBT) and stacking layer upon layer of dbt models to tackle new use cases. However, these approaches led to unfortunate situations in which data teams became a cost center with unscalable processes. So, as we enter a “post-modern” data stack era, defined by the pursuit to reduce costs, tidy up data platforms, and limit model sprawl, data modeling is witnessing a resurrection.</p><p id="ab11" class="pw-post-body-paragraph ne nf fr ng b gp nh ni nj gs nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fk bk">This transition puts data teams in front of a dilemma: should we revert back to strict data modeling approaches that were defined decades ago for a completely different data ecosystem, or can we introduce new principles that are defined based on today’s technology and business problems?</p><p id="fd7b" class="pw-post-body-paragraph ne nf fr ng b gp nh ni nj gs nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fk bk">I believe that, for most companies, the right answer lies somewhere in the middle. In this article, I’ll discuss a set of data modeling standards to move away from model sprawl without limiting the delivery speed of new data products. These standards are generic enough to be used in most “post-modern” data platforms, but there are always edge cases or industries that may require a different approach.</p><h1 id="e4b1" class="oa ob fr bf oc od oe gr of og oh gu oi oj ok ol om on oo op oq or os ot ou ov bk">The three-layer (<a class="af nd" href="https://www.databricks.com/glossary/medallion-architecture" rel="noopener ugc nofollow" target="_blank">medallion</a>) approach is still a safe bet, with some caveats</h1><p id="a328" class="pw-post-body-paragraph ne nf fr ng b gp ow ni nj gs ox nl nm nn oy np nq nr oz nt nu nv pa nx ny nz fk bk">Historically, when talking about data modeling, data teams mostly refer to the model we define for the warehouse’s “<em class="pb">consumption</em>” layer, which is the layer we show consumers and the one external tools interact with. However, the data’s journey starts well before it reaches this layer, and many data modeling decisions are made along the way.</p><p id="3429" class="pw-post-body-paragraph ne nf fr ng b gp nh ni nj gs nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fk bk">In terms of the layering approach, the three-layer/medallion architecture that gained popularity with the rise of data lakes (and data lakehouses after them) is still the most suitable approach in the majority of use cases. You start with a first layer that contains raw data, then a layer in which you perform technical cleansing but no business logic transformations, and finally a layer to store ready-to-use transformed consumption tables.</p><figure class="mn mo mp mq mr ms mk ml paragraph-image"><div role="button" tabindex="0" class="mt mu ed mv bh mw"><div class="mk ml pc"><img src="../Images/ac843b50e9af0b12061a8b8f53ae4b3c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DuKkLoLzXNnCb89IIxEfVA.png"/></div></div><figcaption class="my mz na mk ml nb nc bf b bg z dx">Bird’s eye view of the three-layer/medallion architecture (image by author)</figcaption></figure><p id="e3f1" class="pw-post-body-paragraph ne nf fr ng b gp nh ni nj gs nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fk bk">There are a few caveats, however, that you should keep in mind when defining the details of the different layers of your architecture:</p><ul class=""><li id="7800" class="ne nf fr ng b gp nh ni nj gs nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz pd pe pf bk"><strong class="ng fs">Start from the right, to define what needs to happen on the left</strong>: In any tech company, there are a myriad of internal systems that produce <em class="pb">potentially useful</em> data. Whether it’s your CRM, RevOps, or Marketing software, it’s easy to adopt a “bring everything” approach and burden yourself with managing thousands of tables that may remain unused. The key ingredient to avoiding this unnecessary complexity is to first focus on your data usage (consumption use cases on the right of the data platform) and then define the required data inputs from the various systems across your company. Once you have a list of all the upstream tables that are actually useful, bring only these tables to the raw layer, and bring new tables iteratively as new business needs arise on the right of the platform.</li><li id="29ce" class="ne nf fr ng b gp pg ni nj gs ph nl nm nn pi np nq nr pj nt nu nv pk nx ny nz pd pe pf bk"><strong class="ng fs">Minimize intermediate nodes</strong>: Although the Medallion architecture consists of three (theoretical) layers at a (very) high level, you’ll probably end up with a few intermediate steps within your Curated and Consumption layers. These intermediate steps may be necessary to perform certain tasks like tracking history or handling sensitive data, but they can also become redundant if you open the door to creating intermediate steps for every need. Ideally, you’d want to streamline your layers and group different operations within the same logical steps.</li><li id="2787" class="ne nf fr ng b gp pg ni nj gs ph nl nm nn pi np nq nr pj nt nu nv pk nx ny nz pd pe pf bk"><strong class="ng fs">Define clear and enforceable boundaries between the layers</strong>: Even though this may seem obvious, there are quite a few scenarios in which you may be tempted to say, “<em class="pb">Let me reference this raw table directly in my consumption model.</em>” Similar to craving an unhealthy snack after midnight, you’d eventually regret giving in to the temptation. If you decide to only perform snapshotting and format updates in your cleansing layer, then don’t start adding filters to deliver things faster. This opens the door to inconsistencies and confusion among the different teams that may use a shared cleansed model. Instead, if you notice that a certain boundary is too strict or unnecessary, it’s completely fine to move it and start performing certain operations at a different layer, but this needs to be communicated and standardized. This also applies to data consumption: If you want to allow running experiments on top of cleansed data directly, for example, you should ensure that the necessary guardrails are in place.</li></ul><h1 id="b98b" class="oa ob fr bf oc od oe gr of og oh gu oi oj ok ol om on oo op oq or os ot ou ov bk">Wider, metric-enriched, dimension tables are the path forward</h1><p id="426c" class="pw-post-body-paragraph ne nf fr ng b gp ow ni nj gs ox nl nm nn oy np nq nr oz nt nu nv pa nx ny nz fk bk">In “traditional” dimensional data modeling, dimension tables are not the home for metrics. Instead, metrics should be calculated via the measures stored in fact tables. At the time, this made sense: it simplified the management of dimension tables (especially when tracking history), separated quantitative and descriptive data, and allowed for analytics that relied on central fact tables enriched with different dimensions.</p><p id="a7be" class="pw-post-body-paragraph ne nf fr ng b gp nh ni nj gs nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fk bk">In today’s world, however, this separation seems forced. In most cases, the history of dimension tables is tracked via daily or hourly snapshots (cheap storage FTW), and the analytics we build today are centered around the dimension tables themselves. With this in mind, the calculation of a given metric can be embedded in such tables without any major negative consequences. This switch in approach dramatically reduces the need for joins between dimension and fact tables to answer basic questions. Additionally, it aligns with today’s analytics approaches that require multiple measures coming from different fact tables to calculate derived metrics, all as part of analyzing a given dimension.</p><figure class="mn mo mp mq mr ms mk ml paragraph-image"><div role="button" tabindex="0" class="mt mu ed mv bh mw"><div class="mk ml pl"><img src="../Images/7df6ebd5a021f3dba57c0d7d00714c52.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Pw1_XZ5a3-g8xTg9kGcUZQ.png"/></div></div><figcaption class="my mz na mk ml nb nc bf b bg z dx">Sample data model with a central metric-enriched dimension table (image by author)</figcaption></figure><p id="f0a5" class="pw-post-body-paragraph ne nf fr ng b gp nh ni nj gs nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fk bk"><span class="ib"><span class="ib" aria-hidden="false"><a class="pm ic pn" href="https://medium.com/u/9f4d525c99e2?source=post_page---user_mention--03fc2e4a210c--------------------------------" rel="noopener" target="_blank">Maxime Beauchemin</a></span></span>, <a class="af nd" href="https://maximebeauchemin.medium.com/functional-data-engineering-a-modern-paradigm-for-batch-data-processing-2327ec32c42a" rel="noopener">who contributed greatly to the data engineering field</a>, developed a full-on data modeling approach based on this principle: <a class="af nd" href="https://preset.io/blog/introducing-entity-centric-data-modeling-for-analytics/" rel="noopener ugc nofollow" target="_blank">Entity-Centric Data Modeling</a>. His article on this approach is a very important read, and I believe that similar to his functional data engineering paradigm, Entity-Centric data modeling will lead many data teams (and the field as a whole) in the right direction.</p><p id="5a8d" class="pw-post-body-paragraph ne nf fr ng b gp nh ni nj gs nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fk bk">I also believe that data teams would greatly benefit from adopting a “tiering” of metrics. Instead of treating all metrics equally or having to decide every single time whether a given metric needs to be added to a dimension table, metrics can be divided into two categories:</p><ul class=""><li id="1fee" class="ne nf fr ng b gp nh ni nj gs nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz pd pe pf bk"><strong class="ng fs">Universal metrics</strong>: These are key metrics that need to be highly governed and standardized across your company (think of metrics like Annual Recurring Revenue (ARR) or Daily Active Users (DAU)). As a generic definition, you can consider a universal metric any metric that’s relevant or used in at least two separate use cases. These metrics should be part of your dimension tables and have clear multi-faceted ownership (for example a given team can own the definition of the metric while another team owns a portion of the data that it relies on). Another way to determine whether a metric should be part of a given dimension table is whether it’s a characteristic of the entity/dimension itself and not simply a calculation that’s only relevant in a specific scenario.</li><li id="322a" class="ne nf fr ng b gp pg ni nj gs ph nl nm nn pi np nq nr pj nt nu nv pk nx ny nz pd pe pf bk"><strong class="ng fs">Experimental metrics</strong>: Unlike universal metrics, these metrics are used in a specific use case or are still being refined. Think of a metric that is specific to a given feature and only relevant to the team that built it. In such scenarios, making the metric part of your data model would cause unnecessary friction and add complexity for the sake of it. The more appropriate approach at this stage would consist of defining the metric as part of your semantic layer (if you have one) or calculating it downstream of your warehouse’s consumption layer. You should keep in mind, however, that an experimental metric can be promoted to a universal metric status if it starts being used in multiple use cases or finds its way into a production/critical data product.</li></ul><h1 id="1567" class="oa ob fr bf oc od oe gr of og oh gu oi oj ok ol om on oo op oq or os ot ou ov bk">Maintain flexibility and limit inherited logic</h1><p id="50c2" class="pw-post-body-paragraph ne nf fr ng b gp ow ni nj gs ox nl nm nn oy np nq nr oz nt nu nv pa nx ny nz fk bk">As new use cases arise and you enhance and update your consumption layer to support them, it’s important to keep the following key principles in mind.</p><h2 id="6656" class="po ob fr bf oc pp pq pr of ps pt pu oi nn pv pw px nr py pz qa nv qb qc qd qe bk"><strong class="al">Maintain data at the most granular level</strong></h2><p id="90a8" class="pw-post-body-paragraph ne nf fr ng b gp ow ni nj gs ox nl nm nn oy np nq nr oz nt nu nv pa nx ny nz fk bk">When adding a new data stream, if the finest granularity is not immediately needed, you may decide to pre-aggregate the data before it reaches your consumption layer to reduce costs and avoid potentially expensive queries (it’s no longer 2021, after all). Although this decision sounds reasonable, it typically results in unnecessary friction and frustration as data consumers won’t be able to drill down when needed.</p><p id="6209" class="pw-post-body-paragraph ne nf fr ng b gp nh ni nj gs nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fk bk">When you decide to bring a certain entity or stream of events to the data platform (because a use case requires it), it’s usually safer to surface the most granular data as part of your consumption layer and then build aggregations on top of it. More generally, try to always prioritize flexibility and minimze the number of one-way doors you take when designing your data model.</p><h2 id="d1e9" class="po ob fr bf oc pp pq pr of ps pt pu oi nn pv pw px nr py pz qa nv qb qc qd qe bk">Avoid inherited logic</h2><p id="72c8" class="pw-post-body-paragraph ne nf fr ng b gp ow ni nj gs ox nl nm nn oy np nq nr oz nt nu nv pa nx ny nz fk bk">Even though you’re theoretically the company’s only “official” data team, don’t be surprised to discover that other orgs within the company have their “ghost” data teams. As everyone tries to leverage data to their advantage and make data-driven decisions (which is good!), there will be scenarios in which other teams at your company (think of the teams that work on SaaS applications or your feature teams) define their own business logic and metrics in the tools that they use (since most B2B SaaS tools offer built-in analytics capabilities).</p><p id="8088" class="pw-post-body-paragraph ne nf fr ng b gp nh ni nj gs nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fk bk">This situation puts you in a delicate spot since you can either import “inherited” business logic that you don’t own (and can’t govern) or go through a lengthy process to redefine this logic in the warehouse. My recommendation is to always opt for the second option since it’ll ultimately allow you to minimize the range of potential issues and prevent implicit logic changes. However, this effort may be too expensive in some scenarios — in which case you can instead define detailed checks after the data lands in the data platform to ensure that your assumptions are still valid and the logic defined in the upstream tool wasn’t changed (this is also useful to ensure that your warehouse logic is always in sync with the upstream logic).</p></div></div></div><div class="ab cb qf qg qh qi" role="separator"><span class="qj by bm qk ql qm"/><span class="qj by bm qk ql qm"/><span class="qj by bm qk ql"/></div><div class="fk fl fm fn fo"><div class="ab cb"><div class="ci bh ew ex ey ez"><p id="34da" class="pw-post-body-paragraph ne nf fr ng b gp nh ni nj gs nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fk bk">As data teams continue to navigate the transition into an environment where budgets are limited and quality trumps quantity, it’s important to make the design decisions that are right for your own circumstances and that will generate the biggest returns over time. Following a certain data modeling approach as-is or neglecting data modeling altogether are both recipes that will lead you in the wrong direction. Instead, it’s important to arm yourself with techniques and principles that match your needs, allow you to make informed design decisions, and enable you to build a data model that’s well-suited for your team’s journey.</p><p id="03f4" class="pw-post-body-paragraph ne nf fr ng b gp nh ni nj gs nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fk bk">The techniques discussed in this article are usually a safe bet and would help you set the right foundations, but ultimately what matters most is understanding the requirements of your own (current and future) use cases, talking with data consumers to understand their current struggles, and monitoring the usage and cost of your data platform.</p></div></div></div><div class="ab cb qf qg qh qi" role="separator"><span class="qj by bm qk ql qm"/><span class="qj by bm qk ql qm"/><span class="qj by bm qk ql"/></div><div class="fk fl fm fn fo"><div class="ab cb"><div class="ci bh ew ex ey ez"><p id="fb88" class="pw-post-body-paragraph ne nf fr ng b gp nh ni nj gs nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fk bk"><em class="pb">For more data engineering content you can subscribe to my newsletter, Data Espresso, in which I discuss various topics related to data engineering and technology in general:</em></p><div class="qn qo qp qq qr qs"><a href="https://dataespresso.substack.com/?source=post_page-----03fc2e4a210c--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qt ab ih"><div class="qu ab co cb qv qw"><h2 class="bf fs hx z ip qx ir is qy iu iw fq bk">Data Espresso | Mahdi Karabiben | Substack</h2><div class="qz l"><h3 class="bf b hx z ip qx ir is qy iu iw dx">Data engineering updates and commentary to accompany your afternoon espresso. Click to read Data Espresso, by Mahdi…</h3></div><div class="ra l"><p class="bf b dy z ip qx ir is qy iu iw dx">dataespresso.substack.com</p></div></div><div class="rb l"><div class="rc l rd re rf rb rg ls qs"/></div></div></a></div></div></div></div></div>    
</body>
</html>