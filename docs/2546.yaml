- en: Implementing â€œModular RAGâ€ with Haystack and Hypster
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å®ç°â€œæ¨¡å—åŒ–RAGâ€ä¸Haystackå’ŒHypster
- en: åŸæ–‡ï¼š[https://towardsdatascience.com/implementing-modular-rag-with-haystack-and-hypster-d2f0ecc88b8f?source=collection_archive---------3-----------------------#2024-10-18](https://towardsdatascience.com/implementing-modular-rag-with-haystack-and-hypster-d2f0ecc88b8f?source=collection_archive---------3-----------------------#2024-10-18)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://towardsdatascience.com/implementing-modular-rag-with-haystack-and-hypster-d2f0ecc88b8f?source=collection_archive---------3-----------------------#2024-10-18](https://towardsdatascience.com/implementing-modular-rag-with-haystack-and-hypster-d2f0ecc88b8f?source=collection_archive---------3-----------------------#2024-10-18)
- en: Transforming RAG systems into LEGO-like reconfigurable frameworks
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å°†RAGç³»ç»Ÿè½¬å˜ä¸ºç±»ä¼¼ä¹é«˜çš„å¯é‡æ„æ¡†æ¶
- en: '[](https://medium.com/@giladrubin?source=post_page---byline--d2f0ecc88b8f--------------------------------)[![Gilad
    Rubin](../Images/e98728582365c22c2803d5db0a0f3ca6.png)](https://medium.com/@giladrubin?source=post_page---byline--d2f0ecc88b8f--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--d2f0ecc88b8f--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--d2f0ecc88b8f--------------------------------)
    [Gilad Rubin](https://medium.com/@giladrubin?source=post_page---byline--d2f0ecc88b8f--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/@giladrubin?source=post_page---byline--d2f0ecc88b8f--------------------------------)[![Gilad
    Rubin](../Images/e98728582365c22c2803d5db0a0f3ca6.png)](https://medium.com/@giladrubin?source=post_page---byline--d2f0ecc88b8f--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--d2f0ecc88b8f--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--d2f0ecc88b8f--------------------------------)
    [Gilad Rubin](https://medium.com/@giladrubin?source=post_page---byline--d2f0ecc88b8f--------------------------------)'
- en: Â·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--d2f0ecc88b8f--------------------------------)
    Â·11 min readÂ·Oct 18, 2024
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: Â·å‘è¡¨äº[Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--d2f0ecc88b8f--------------------------------)
    Â·11åˆ†é’Ÿé˜…è¯»Â·2024å¹´10æœˆ18æ—¥
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '![](../Images/665f1ebb6e484102c452f4295f32035a.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/665f1ebb6e484102c452f4295f32035a.png)'
- en: Image Generated using [Midjourney AI](https://www.midjourney.com/), Prompted
    by the author
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿ç”¨[Midjourney AI](https://www.midjourney.com/)ç”Ÿæˆçš„å›¾åƒï¼Œæç¤ºç”±ä½œè€…æä¾›
- en: Intro
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ç®€ä»‹
- en: Keeping up with the latest in AI can be a challenge, especially when it comes
    to an increasingly evolving field like Retrieval Augmented Generation (RAG). With
    so many different solutions and implementations, one can easily feel lost.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: è·Ÿä¸Šäººå·¥æ™ºèƒ½çš„æœ€æ–°åŠ¨æ€å¯èƒ½æ˜¯ä¸€ä¸ªæŒ‘æˆ˜ï¼Œç‰¹åˆ«æ˜¯å½“æ¶‰åŠåˆ°åƒæ£€ç´¢å¢å¼ºç”Ÿæˆï¼ˆRAGï¼‰è¿™æ ·æ—¥æ–°æœˆå¼‚çš„é¢†åŸŸæ—¶ã€‚é¢å¯¹å¦‚æ­¤å¤šçš„ä¸åŒè§£å†³æ–¹æ¡ˆå’Œå®ç°æ–¹å¼ï¼Œäººä»¬å¾ˆå®¹æ˜“æ„Ÿåˆ°è¿·å¤±ã€‚
- en: I struggled with this myself for a long time, trying to wrap my head around
    every new article or â€œtrickâ€ to make RAG systems better in one way or another.
    Every new paper, tutorial or blogpost felt like something completely new and it
    became increasingly difficult to keep up with all the acronyms for all the newest
    fancy methods - HyDE, RAPTOR, CRAG, FLARE â€” they started to sound like PokÃ©mon
    character names to me.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘è‡ªå·±ä¹Ÿä¸ºæ­¤å›°æ‰°äº†å¾ˆé•¿æ—¶é—´ï¼Œè¯•å›¾ç†è§£æ¯ç¯‡æ–°æ–‡ç« æˆ–â€œæŠ€å·§â€ï¼Œä»¥ä¾¿ä»¥æŸç§æ–¹å¼æå‡RAGç³»ç»Ÿçš„è¡¨ç°ã€‚æ¯ä¸€ç¯‡æ–°è®ºæ–‡ã€æ•™ç¨‹æˆ–åšå®¢æ–‡ç« éƒ½åƒæ˜¯å®Œå…¨å´­æ–°çš„å†…å®¹ï¼Œä¸”è¶Šæ¥è¶Šéš¾ä»¥è·Ÿä¸Šæ‰€æœ‰æœ€æ–°æ–¹æ³•çš„ç¼©å†™â€”â€”HyDEã€RAPTORã€CRAGã€FLAREâ€”â€”å®ƒä»¬å¼€å§‹å¬èµ·æ¥åƒæ˜¯å®å¯æ¢¦è§’è‰²çš„åå­—ã€‚
- en: 'Then I came across this paper by Gao et al. (2024) â€œ[**Modular RAG: Transforming
    RAG Systems into LEGO-like Reconfigurable Frameworksâ€**](https://arxiv.org/abs/2407.21059)**.**'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åï¼Œæˆ‘é‡åˆ°äº†é«˜ç­‰äººï¼ˆ2024å¹´ï¼‰çš„è¿™ç¯‡è®ºæ–‡ã€Š[**æ¨¡å—åŒ–RAGï¼šå°†RAGç³»ç»Ÿè½¬å˜ä¸ºç±»ä¼¼ä¹é«˜çš„å¯é‡æ„æ¡†æ¶**](https://arxiv.org/abs/2407.21059)**ã€‹ã€‚
- en: '![](../Images/c9f2768a8d8fb903c8fa98e34bd40d0c.png)'
  id: totrans-12
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c9f2768a8d8fb903c8fa98e34bd40d0c.png)'
- en: 'The main figure from the paper that shows the components from which the authors
    construct RAG solutions. Source: [Modular RAG](https://arxiv.org/abs/2407.21059)'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: è®ºæ–‡ä¸­çš„ä¸»è¦å›¾ç¤ºå±•ç¤ºäº†ä½œè€…æ„å»ºRAGè§£å†³æ–¹æ¡ˆçš„ç»„ä»¶ã€‚æ¥æºï¼š[æ¨¡å—åŒ–RAG](https://arxiv.org/abs/2407.21059)
- en: Modular RAG
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: æ¨¡å—åŒ–RAG
- en: 'This paper provides a structured approach for breaking down RAG systems into
    a unified framework that can encompass diverse solutions and approaches. They
    proposed six main components:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: æœ¬æ–‡æä¾›äº†ä¸€ç§ç»“æ„åŒ–æ–¹æ³•ï¼Œå°†RAGç³»ç»Ÿåˆ†è§£ä¸ºä¸€ä¸ªç»Ÿä¸€çš„æ¡†æ¶ï¼Œä»¥æ¶µç›–å¤šç§è§£å†³æ–¹æ¡ˆå’Œæ–¹æ³•ã€‚ä½œè€…æå‡ºäº†å…­ä¸ªä¸»è¦ç»„ä»¶ï¼š
- en: '**Indexing:** Organize your data for efficient search.'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ç´¢å¼•ï¼š** ä¸ºé«˜æ•ˆæ£€ç´¢ç»„ç»‡æ•°æ®ã€‚'
- en: '**Pre-Retrieval:** Process the userâ€™s query before searching.'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**é¢„æ£€ç´¢ï¼š** åœ¨æœç´¢å‰å¤„ç†ç”¨æˆ·çš„æŸ¥è¯¢ã€‚'
- en: '**Retrieval:** Find the most relevant information.'
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**æ£€ç´¢ï¼š** æ‰¾åˆ°æœ€ç›¸å…³çš„ä¿¡æ¯ã€‚'
- en: '**Post-Retrieval:** Refine the retrieved information.'
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**åæ£€ç´¢ï¼š** ç²¾ç‚¼æ£€ç´¢åˆ°çš„ä¿¡æ¯ã€‚'
- en: '**Generation:** Use an LLM to generate a response.'
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ç”Ÿæˆï¼š** ä½¿ç”¨LLMç”Ÿæˆå“åº”ã€‚'
- en: '**Orchestration:** Control the overall flow of the system.'
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ç¼–æ’ï¼š** æ§åˆ¶ç³»ç»Ÿçš„æ•´ä½“æµç¨‹ã€‚'
- en: The key insight from this paper is that a wide range of existing RAG solutions
    can be described using these components in a LEGO-like manner. This modularity
    provides a framework for understanding, designing, and navigating the process
    of building a RAG system with greater flexibility and clarity.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ç¯‡è®ºæ–‡çš„å…³é”®è§è§£æ˜¯ï¼Œè®¸å¤šç°æœ‰çš„ RAG è§£å†³æ–¹æ¡ˆå¯ä»¥é€šè¿‡è¿™äº›ç»„ä»¶ä»¥ç±»ä¼¼ LEGO çš„æ–¹å¼è¿›è¡Œæè¿°ã€‚è¿™ç§æ¨¡å—åŒ–ä¸ºç†è§£ã€è®¾è®¡å’Œå¯¼èˆªæ„å»º RAG ç³»ç»Ÿçš„è¿‡ç¨‹æä¾›äº†ä¸€ä¸ªæ¡†æ¶ï¼Œä½¿å…¶æ›´åŠ çµæ´»å’Œæ¸…æ™°ã€‚
- en: 'In the paper, the authors showcase how this is possible by taking examples
    of existing RAG solutions and expressing them using the same building blocks.
    For example:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ç¯‡è®ºæ–‡ä¸­ï¼Œä½œè€…å±•ç¤ºäº†å¦‚ä½•é€šè¿‡ä¸¾ä¾‹ç°æœ‰çš„ RAG è§£å†³æ–¹æ¡ˆï¼Œå¹¶ä½¿ç”¨ç›¸åŒçš„æ„å»ºæ¨¡å—æ¥è¡¨è¾¾å®ƒä»¬ã€‚ä¾‹å¦‚ï¼š
- en: '![](../Images/d41279dd94909e693a0427b0faab823b.png)'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d41279dd94909e693a0427b0faab823b.png)'
- en: '**Adaptive RAG flow** - where the â€œjudgeâ€ decides whether or not to use retrieval.
    Source: [Modular RAG](https://arxiv.org/abs/2407.21059)'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '**è‡ªé€‚åº” RAG æµç¨‹** â€”â€” â€œåˆ¤æ–­è€…â€å†³å®šæ˜¯å¦ä½¿ç”¨æ£€ç´¢ã€‚æ¥æºï¼š[æ¨¡å—åŒ– RAG](https://arxiv.org/abs/2407.21059)'
- en: '![](../Images/818a2c6d61007b364397301bf777d21f.png)'
  id: totrans-26
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/818a2c6d61007b364397301bf777d21f.png)'
- en: '**FLARE - F**orward-**L**ooking **A**ctive **RE**trieval where each sentence
    can trigger a retrieval step. Source: [Modular RAG](https://arxiv.org/abs/2407.21059)'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: '**FLARE - å‰å‘**ï¼ˆ**F**orwardï¼‰**ä¸»åŠ¨æ£€ç´¢**ï¼ˆ**L**ooking **A**ctive **RE**trievalï¼‰ï¼Œæ¯ä¸ªå¥å­éƒ½å¯ä»¥è§¦å‘ä¸€æ¬¡æ£€ç´¢æ­¥éª¤ã€‚æ¥æºï¼š[æ¨¡å—åŒ–
    RAG](https://arxiv.org/abs/2407.21059)'
- en: 'I highly recommend reading this paper and the set of blog-posts by the author
    of the paper, Yunfan Gao: Modular RAG and RAG Flow: [Part I](https://medium.com/@yufan1602/modular-rag-and-rag-flow-part-%E2%85%B0-e69b32dc13a3),
    [Part II](https://medium.com/@yufan1602/modular-rag-and-rag-flow-part-ii-77b62bf8a5d3).'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘å¼ºçƒˆæ¨èé˜…è¯»è¿™ç¯‡è®ºæ–‡ä»¥åŠä½œè€…é«˜äº‘å¸†çš„åšå®¢ç³»åˆ—æ–‡ç« ï¼šæ¨¡å—åŒ– RAG å’Œ RAG æµç¨‹ï¼š[ç¬¬ä¸€éƒ¨åˆ†](https://medium.com/@yufan1602/modular-rag-and-rag-flow-part-%E2%85%B0-e69b32dc13a3)ã€[ç¬¬äºŒéƒ¨åˆ†](https://medium.com/@yufan1602/modular-rag-and-rag-flow-part-ii-77b62bf8a5d3)ã€‚
- en: Personally, this framework helped me understand how different RAG approaches
    relate to each other, and now I can easily make sense of new papers and implementations.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ªäººè€Œè¨€ï¼Œè¿™ä¸ªæ¡†æ¶å¸®åŠ©æˆ‘ç†è§£äº†ä¸åŒçš„ RAG æ–¹æ³•ä¹‹é—´çš„å…³ç³»ï¼Œç°åœ¨æˆ‘å¯ä»¥è½»æ¾ç†è§£æ–°çš„è®ºæ–‡å’Œå®ç°ã€‚
- en: Implementing Modular RAG
  id: totrans-30
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å®ç°æ¨¡å—åŒ– RAG
- en: So, how can we actually implement this â€œModular RAGâ€ framework?
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: é‚£ä¹ˆï¼Œæˆ‘ä»¬å¦‚ä½•å®é™…å®ç°è¿™ä¸ªâ€œæ¨¡å—åŒ– RAGâ€æ¡†æ¶å‘¢ï¼Ÿ
- en: Since itâ€™s more of a meta-framework â€” what does that mean in practical terms?
    Does it mean that we need to implement *all* the possible combinations of components?
    Or do we just build the individual components and let developers figure out how
    to put them together?
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: ç”±äºå®ƒæ›´åƒæ˜¯ä¸€ä¸ªå…ƒæ¡†æ¶â€”â€”è¿™åœ¨å®é™…æ“ä½œä¸­æ„å‘³ç€ä»€ä¹ˆï¼Ÿæ˜¯å¦æ„å‘³ç€æˆ‘ä»¬éœ€è¦å®ç°*æ‰€æœ‰*å¯èƒ½çš„ç»„ä»¶ç»„åˆï¼Ÿè¿˜æ˜¯æˆ‘ä»¬åªéœ€æ„å»ºå•ç‹¬çš„ç»„ä»¶ï¼Œè®©å¼€å‘äººå‘˜è‡ªå·±å†³å®šå¦‚ä½•å°†å®ƒä»¬ç»„åˆèµ·æ¥ï¼Ÿ
- en: I believe that in most real-life situations â€” itâ€™s not necessary to try to cover
    *every* possible RAG configuration, but to narrow down the space of relevant configurations
    based on the requirements and constraints of each project.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ç›¸ä¿¡ï¼Œåœ¨å¤§å¤šæ•°ç°å®æƒ…å†µä¸­â€”â€”å¹¶ä¸éœ€è¦å°è¯•è¦†ç›–*æ¯ä¸€ä¸ª*å¯èƒ½çš„ RAG é…ç½®ï¼Œè€Œæ˜¯æ ¹æ®æ¯ä¸ªé¡¹ç›®çš„éœ€æ±‚å’Œçº¦æŸï¼Œç¼©å°ç›¸å…³é…ç½®çš„èŒƒå›´ã€‚
- en: In this tutorial, Iâ€™ll show you a concrete example of how to build a configurable
    system using a small set of options. Hopefully, this will give you the right perspective
    and tools to create your own version of a Modular RAG that contains the set of
    relevant configurations for your specific use-case.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨æœ¬æ•™ç¨‹ä¸­ï¼Œæˆ‘å°†å‘ä½ å±•ç¤ºä¸€ä¸ªå¦‚ä½•ä½¿ç”¨å°‘é‡é€‰é¡¹æ„å»ºå¯é…ç½®ç³»ç»Ÿçš„å…·ä½“ç¤ºä¾‹ã€‚å¸Œæœ›è¿™èƒ½ä¸ºä½ æä¾›æ­£ç¡®çš„è§†è§’å’Œå·¥å…·ï¼Œå¸®åŠ©ä½ åˆ›å»ºé€‚åˆç‰¹å®šç”¨ä¾‹çš„æ¨¡å—åŒ– RAG ç‰ˆæœ¬ï¼Œå¹¶åŒ…å«ç›¸å…³é…ç½®é›†ã€‚
- en: 'Letâ€™s go on to explore the two main tools weâ€™ll be using:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ç»§ç»­æ¢ç´¢æˆ‘ä»¬å°†ä½¿ç”¨çš„ä¸¤ä¸ªä¸»è¦å·¥å…·ï¼š
- en: Haystack â€” The Main Components Library
  id: totrans-36
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Haystack â€” ä¸»è¦ç»„ä»¶åº“
- en: '`haystack` is an open-source framework for building production-ready LLM applications,
    retrieval-augmented generative pipelines and state-of-the-art search systems that
    work intelligently over large document collections.'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: '`haystack` æ˜¯ä¸€ä¸ªå¼€æºæ¡†æ¶ï¼Œç”¨äºæ„å»ºç”Ÿäº§å°±ç»ªçš„ LLM åº”ç”¨ã€å¢å¼ºæ£€ç´¢çš„ç”Ÿæˆç®¡é“ä»¥åŠåœ¨å¤§å‹æ–‡æ¡£é›†åˆä¸Šæ™ºèƒ½å·¥ä½œçš„æœ€å…ˆè¿›æœç´¢ç³»ç»Ÿã€‚'
- en: '[](https://haystack.deepset.ai/?source=post_page-----d2f0ecc88b8f--------------------------------)
    [## Haystack | Haystack'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://haystack.deepset.ai/?source=post_page-----d2f0ecc88b8f--------------------------------)
    [## Haystack | Haystack'
- en: Haystack, the composable open-source AI framework
  id: totrans-39
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Haystackï¼ŒComposable å¼€æº AI æ¡†æ¶
- en: haystack.deepset.ai](https://haystack.deepset.ai/?source=post_page-----d2f0ecc88b8f--------------------------------)
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: haystack.deepset.ai](https://haystack.deepset.ai/?source=post_page-----d2f0ecc88b8f--------------------------------)
- en: '**Pros:**'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: '**ä¼˜ç‚¹ï¼š**'
- en: Great component design
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å‡ºè‰²çš„ç»„ä»¶è®¾è®¡
- en: The pipeline is very flexible and allows for dynamic configurations
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¿™ä¸ªç®¡é“éå¸¸çµæ´»ï¼Œå…è®¸åŠ¨æ€é…ç½®
- en: Extremely (!) well documented
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æå…¶ï¼ˆï¼ï¼‰å®Œå–„çš„æ–‡æ¡£
- en: The framework includes many existing implementations and integrations with Generative
    AI providers.
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: è¯¥æ¡†æ¶åŒ…å«è®¸å¤šç°æœ‰çš„å®ç°å’Œä¸ç”Ÿæˆå¼ AI æä¾›è€…çš„é›†æˆã€‚
- en: '**Cons:**'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: '**ç¼ºç‚¹ï¼š**'
- en: The pipeline interface can be a bit verbose
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ç®¡é“æ¥å£å¯èƒ½ä¼šæœ‰äº›å†—é•¿
- en: Using components outside of a pipeline is not very ergonomic.
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: åœ¨ç®¡é“å¤–ä½¿ç”¨ç»„ä»¶ä¸æ˜¯å¾ˆç¬¦åˆäººä½“å·¥ç¨‹å­¦ã€‚
- en: Iâ€™ve played around with a few different Generative AI frameworks, and Haystack
    was by far the easiest for me to understand, use and customize.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘å°è¯•è¿‡ä¸€äº›ä¸åŒçš„ç”Ÿæˆå¼ AI æ¡†æ¶ï¼Œè€Œ Haystack æ˜¯æˆ‘ç†è§£ã€ä½¿ç”¨å’Œå®šåˆ¶æœ€ç®€å•çš„æ¡†æ¶ã€‚
- en: Hypster â€” Managing Configuration Spaces
  id: totrans-50
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Hypster â€” ç®¡ç†é…ç½®ç©ºé—´
- en: '`**hypster**` is a lightweight pythonic configuration system for AI & Machine
    Learning projects. It offers minimal, intuitive pythonic syntax, supporting hierarchical
    and swappable configurations.'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: '`**hypster**` æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ Pythonic é…ç½®ç³»ç»Ÿï¼Œé€‚ç”¨äº AI å’Œæœºå™¨å­¦ä¹ é¡¹ç›®ã€‚å®ƒæä¾›äº†ç®€æ´ã€ç›´è§‚çš„ Pythonic è¯­æ³•ï¼Œæ”¯æŒå±‚æ¬¡åŒ–å’Œå¯äº¤æ¢çš„é…ç½®ã€‚'
- en: '[](https://medium.com/@giladrubin/introducing-hypster-a-pythonic-framework-for-managing-configurations-to-build-highly-optimized-ai-5ee004dbd6a5?source=post_page-----d2f0ecc88b8f--------------------------------)
    [## Introducing HyPSTER: A Pythonic Framework for Managing Configurations to Build
    Highly Optimized AIâ€¦'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/@giladrubin/introducing-hypster-a-pythonic-framework-for-managing-configurations-to-build-highly-optimized-ai-5ee004dbd6a5?source=post_page-----d2f0ecc88b8f--------------------------------)
    [## ä»‹ç» HyPSTERï¼šä¸€ä¸ªç”¨äºæ„å»ºé«˜åº¦ä¼˜åŒ– AI çš„ Pythonic é…ç½®ç®¡ç†æ¡†æ¶â€¦'
- en: Image by the Author
  id: totrans-53
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: å›¾ç‰‡ç”±ä½œè€…æä¾›
- en: medium.com](https://medium.com/@giladrubin/introducing-hypster-a-pythonic-framework-for-managing-configurations-to-build-highly-optimized-ai-5ee004dbd6a5?source=post_page-----d2f0ecc88b8f--------------------------------)
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: '[medium.com](https://medium.com/@giladrubin/introducing-hypster-a-pythonic-framework-for-managing-configurations-to-build-highly-optimized-ai-5ee004dbd6a5?source=post_page-----d2f0ecc88b8f--------------------------------)'
- en: Hypster is a new open-source project that Iâ€™ve developed to enable a new kind
    of programming paradigm for AI & ML workflows â€” one that moves beyond single solutions
    towards a â€œsuperposition of workflowsâ€ or a â€œhyper-workflow.â€
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: Hypster æ˜¯ä¸€ä¸ªæ–°å¼€æºé¡¹ç›®ï¼Œæˆ‘å¼€å‘å®ƒæ˜¯ä¸ºäº†å®ç°ä¸€ç§æ–°çš„ç¼–ç¨‹èŒƒå¼ï¼Œç”¨äº AI å’Œ ML å·¥ä½œæµ â€”â€” è¿™ç§èŒƒå¼ä¸ä»…ä»…ä¾èµ–å•ä¸€çš„è§£å†³æ–¹æ¡ˆï¼Œè€Œæ˜¯æœç€â€œå·¥ä½œæµçš„å åŠ â€æˆ–â€œè¶…å·¥ä½œæµâ€çš„æ–¹å‘å‘å±•ã€‚
- en: Hypster allows you to define a range of possible configurations and easily switch
    between them for experimentation and optimization. This makes it simple to add
    and customize your own configuration spaces, instantiate them with different settings,
    and ultimately select the optimal configuration for your production environment.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: Hypster å…è®¸ä½ å®šä¹‰ä¸€ç³»åˆ—å¯èƒ½çš„é…ç½®ï¼Œå¹¶è½»æ¾åœ¨å®ƒä»¬ä¹‹é—´åˆ‡æ¢ä»¥è¿›è¡Œå®éªŒå’Œä¼˜åŒ–ã€‚è¿™ä½¿å¾—æ·»åŠ å’Œå®šåˆ¶ä½ è‡ªå·±çš„é…ç½®ç©ºé—´å˜å¾—ç®€å•ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸åŒçš„è®¾ç½®å®ä¾‹åŒ–å®ƒä»¬ï¼Œæœ€ç»ˆä¸ºä½ çš„ç”Ÿäº§ç¯å¢ƒé€‰æ‹©æœ€ä½³é…ç½®ã€‚
- en: '**Note:** Hypster is currently under active development. It is not yet recommended
    for production environments.'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: '**æ³¨æ„ï¼š** Hypster å½“å‰å¤„äºæ´»è·ƒå¼€å‘ä¸­ã€‚æš‚æ—¶ä¸å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ã€‚'
- en: Codebase
  id: totrans-58
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ä»£ç åº“
- en: '**This is an advanced tutorial.** It assumes youâ€™re already familiar with the
    main components of RAG.'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: '**è¿™æ˜¯ä¸€ä¸ªé«˜çº§æ•™ç¨‹ã€‚** å®ƒå‡è®¾ä½ å·²ç»ç†Ÿæ‚‰ RAG çš„ä¸»è¦ç»„ä»¶ã€‚'
- en: Iâ€™ll break down the main parts of the codebase and provide my insights as we
    go.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä¼šåœ¨æ¥ä¸‹æ¥çš„è¿‡ç¨‹ä¸­é€æ­¥è®²è§£ä»£ç åº“çš„ä¸»è¦éƒ¨åˆ†ï¼Œå¹¶åˆ†äº«æˆ‘çš„ä¸€äº›è§è§£ã€‚
- en: The full and updated code is in the following repository. Donâ€™t forget to add
    your â­ï¸
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: å®Œæ•´ä¸”æ›´æ–°çš„ä»£ç åœ¨ä»¥ä¸‹ä»£ç åº“ä¸­ã€‚åˆ«å¿˜äº†æ·»åŠ ä½ çš„â­ï¸
- en: '[](https://github.com/gilad-rubin/modular-rag?source=post_page-----d2f0ecc88b8f--------------------------------)
    [## GitHub - gilad-rubin/modular-rag'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://github.com/gilad-rubin/modular-rag?source=post_page-----d2f0ecc88b8f--------------------------------)
    [## GitHub - gilad-rubin/modular-rag'
- en: Contribute to gilad-rubin/modular-rag development by creating an account on
    GitHub.
  id: totrans-63
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: é€šè¿‡åœ¨ GitHub ä¸Šåˆ›å»ºå¸æˆ·ï¼Œå‚ä¸ gilad-rubin/modular-rag çš„å¼€å‘ã€‚
- en: github.com](https://github.com/gilad-rubin/modular-rag?source=post_page-----d2f0ecc88b8f--------------------------------)
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: '[github.com](https://github.com/gilad-rubin/modular-rag?source=post_page-----d2f0ecc88b8f--------------------------------)'
- en: LLM
  id: totrans-65
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: LLM
- en: 'Letâ€™s start with our LLM configuration-space definition:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ä»æˆ‘ä»¬çš„ LLM é…ç½®ç©ºé—´å®šä¹‰å¼€å§‹ï¼š
- en: '[PRE0]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '[PRE1]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: This code snippet demonstrates a basic example of Hypster and Haystack. Using
    the `@config` decorator, we define a function called `llm_config` that encapsulates
    the configuration space for our LLM. This space includes options for selecting
    different LLM providers (Anthropic or OpenAI) and their corresponding models,
    as well as a parameter for controlling the temperature.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™ä¸ªä»£ç ç‰‡æ®µæ¼”ç¤ºäº†ä¸€ä¸ª Hypster å’Œ Haystack çš„åŸºç¡€ç¤ºä¾‹ã€‚é€šè¿‡ä½¿ç”¨ `@config` è£…é¥°å™¨ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªåä¸º `llm_config`
    çš„å‡½æ•°ï¼Œå°è£…äº†æˆ‘ä»¬ LLM çš„é…ç½®ç©ºé—´ã€‚è¿™ä¸ªç©ºé—´åŒ…æ‹¬é€‰æ‹©ä¸åŒ LLM æä¾›è€…ï¼ˆAnthropic æˆ– OpenAIï¼‰åŠå…¶ç›¸åº”æ¨¡å‹çš„é€‰é¡¹ï¼Œè¿˜æœ‰ä¸€ä¸ªæ§åˆ¶æ¸©åº¦çš„å‚æ•°ã€‚
- en: Within the `llm_config` function, we use conditional logic to instantiate the
    appropriate Haystack component based on the selected model. This allows us to
    seamlessly switch between different LLMs using a selection without modifying the
    structure of our code.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨`llm_config`å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨æ¡ä»¶é€»è¾‘æ¥å®ä¾‹åŒ–é€‚å½“çš„Haystackç»„ä»¶ï¼Œå…·ä½“å–å†³äºæ‰€é€‰çš„æ¨¡å‹ã€‚è¿™ä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿåœ¨ä¸ä¿®æ”¹ä»£ç ç»“æ„çš„æƒ…å†µä¸‹ï¼Œè½»æ¾åœ°åœ¨ä¸åŒçš„LLMä¹‹é—´åˆ‡æ¢ã€‚
- en: 'For example, to create an Anthropic generator with the â€œhaikuâ€ model and a
    temperature of 0.5, we can instantiate the configuration as follows:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: ä¾‹å¦‚ï¼Œè¦åˆ›å»ºä¸€ä¸ªAnthropicç”Ÿæˆå™¨ï¼Œä½¿ç”¨â€œhaikuâ€æ¨¡å‹å’Œæ¸©åº¦ä¸º0.5ï¼Œæˆ‘ä»¬å¯ä»¥å¦‚ä¸‹å®ä¾‹åŒ–é…ç½®ï¼š
- en: '[PRE2]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Indexing pipeline
  id: totrans-73
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ç´¢å¼•ç®¡é“
- en: Letâ€™s move on to create our indexing pipeline, where weâ€™ll define how to process
    our input files. In our case â€” PDF files.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ç»§ç»­åˆ›å»ºç´¢å¼•ç®¡é“ï¼Œåœ¨é‚£é‡Œæˆ‘ä»¬å°†å®šä¹‰å¦‚ä½•å¤„ç†è¾“å…¥æ–‡ä»¶ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­â€”â€”æ˜¯PDFæ–‡ä»¶ã€‚
- en: '[PRE3]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: Next, weâ€™ll add an optional functionality â€” enriching the document with an LLM
    summary based on the first 1000 characters of the document.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ·»åŠ ä¸€ä¸ªå¯é€‰åŠŸèƒ½â€”â€”æ ¹æ®æ–‡æ¡£çš„å‰1000ä¸ªå­—ç¬¦é€šè¿‡LLMæ‘˜è¦æ¥å¢å¼ºæ–‡æ¡£ã€‚
- en: This is a nice trick where we use the first `n` characters of a document and
    then, upon splitting the document into chunks, each chunk "inherits" this enriched
    information for its embeddings and response generation.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™æ˜¯ä¸€ç§å¾ˆæ£’çš„æŠ€å·§ï¼Œæˆ‘ä»¬ä½¿ç”¨æ–‡æ¡£çš„å‰`n`ä¸ªå­—ç¬¦ï¼Œç„¶åï¼Œåœ¨å°†æ–‡æ¡£åˆ†å‰²æˆå—åï¼Œæ¯ä¸ªå—éƒ½ä¼šâ€œç»§æ‰¿â€è¿™äº›å¢å¼ºä¿¡æ¯ï¼Œç”¨äºå…¶åµŒå…¥å’Œå“åº”ç”Ÿæˆã€‚
- en: '[PRE4]'
  id: totrans-78
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'Here we can see Haystackâ€™s pipeline in action. If the user selects `enrich_doc_w_llm==True`
    we go on to add components and connections that enable this enrichment. In our
    case: PromptBuilder â†’ LLM â†’ AddLLMMetadata.'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°Haystackçš„ç®¡é“åœ¨è¿è¡Œã€‚å¦‚æœç”¨æˆ·é€‰æ‹©`enrich_doc_w_llm==True`ï¼Œæˆ‘ä»¬ç»§ç»­æ·»åŠ ç»„ä»¶å’Œè¿æ¥ï¼Œä»¥å®ç°è¿™ç§å¢å¼ºåŠŸèƒ½ã€‚åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼šPromptBuilder
    â†’ LLM â†’ AddLLMMetadataã€‚
- en: As you can see â€” itâ€™s very flexible and we can construct it on-the-fly using
    conditional logic. This is extremely powerful.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: æ­£å¦‚ä½ æ‰€çœ‹åˆ°çš„â€”â€”å®ƒéå¸¸çµæ´»ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¡ä»¶é€»è¾‘åŠ¨æ€æ„å»ºå®ƒã€‚è¿™éå¸¸å¼ºå¤§ã€‚
- en: 'Now we can instantiate the configuration object in a couple of ways. For example:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨æˆ‘ä»¬å¯ä»¥é€šè¿‡å‡ ç§æ–¹å¼å®ä¾‹åŒ–é…ç½®å¯¹è±¡ã€‚ä¾‹å¦‚ï¼š
- en: '[PRE5]'
  id: totrans-82
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Here we get a simple pipeline with a loader and a splitter, with the selected
    splitter configurations
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªç®€å•çš„ç®¡é“ï¼ŒåŒ…å«åŠ è½½å™¨å’Œåˆ†å‰²å™¨ï¼Œä»¥åŠé€‰å®šçš„åˆ†å‰²å™¨é…ç½®ã€‚
- en: '![](../Images/fd78f82144e6a23775f181cf847f5c26.png)'
  id: totrans-84
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/fd78f82144e6a23775f181cf847f5c26.png)'
- en: 'Otherwise, we can select to enrich the document with an LLM summary:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: å¦åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©é€šè¿‡LLMæ‘˜è¦æ¥å¢å¼ºæ–‡æ¡£ï¼š
- en: '[PRE6]'
  id: totrans-86
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Notice that Hypster takes on default values that are defined in each parameter,
    so thereâ€™s no need to specify all the parameter selections every time. Hereâ€™s
    an illustration of the resulting pipeline:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: è¯·æ³¨æ„ï¼ŒHypsteré‡‡ç”¨äº†åœ¨æ¯ä¸ªå‚æ•°ä¸­å®šä¹‰çš„é»˜è®¤å€¼ï¼Œå› æ­¤æ— éœ€æ¯æ¬¡éƒ½æŒ‡å®šæ‰€æœ‰çš„å‚æ•°é€‰æ‹©ã€‚ä¸‹é¢æ˜¯ç”Ÿæˆçš„ç®¡é“ç¤ºä¾‹ï¼š
- en: '![](../Images/424c4b7586fb3b12cf3330291cca6f42.png)'
  id: totrans-88
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/424c4b7586fb3b12cf3330291cca6f42.png)'
- en: 'Notice how we casually inserted the `llm_config` inside our indexing pipeline
    using `hp.nest(â€œconfigs/llm_config.py")`. This nesting ability lets us create
    nested configurations in a hierarchical way. We can define parameters values within
    the nested `llm_config` using dot notation. For example:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: æ³¨æ„æˆ‘ä»¬æ˜¯å¦‚ä½•å·§å¦™åœ°å°†`llm_config`æ’å…¥åˆ°ç´¢å¼•ç®¡é“ä¸­çš„ï¼Œä½¿ç”¨äº†`hp.nest(â€œconfigs/llm_config.py")`ã€‚è¿™ç§åµŒå¥—èƒ½åŠ›ä½¿æˆ‘ä»¬èƒ½å¤Ÿä»¥å±‚çº§æ–¹å¼åˆ›å»ºåµŒå¥—é…ç½®ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç‚¹ç¬¦å·åœ¨åµŒå¥—çš„`llm_config`ä¸­å®šä¹‰å‚æ•°å€¼ã€‚ä¾‹å¦‚ï¼š
- en: '[PRE7]'
  id: totrans-90
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: This will result in instantiating an indexing pipeline with the LLM enrichment
    task using the OpenAI `gpt-4o-2024â€“08` model.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: è¿™å°†å¯¼è‡´ä½¿ç”¨OpenAIçš„`gpt-4o-2024â€“08`æ¨¡å‹å®ä¾‹åŒ–ä¸€ä¸ªå¸¦æœ‰LLMå¢å¼ºä»»åŠ¡çš„ç´¢å¼•ç®¡é“ã€‚
- en: So far, weâ€™ve built a compact configuration space for many potential indexing
    pipelines.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»ä¸ºè®¸å¤šæ½œåœ¨çš„ç´¢å¼•ç®¡é“æ„å»ºäº†ä¸€ä¸ªç´§å‡‘çš„é…ç½®ç©ºé—´ã€‚
- en: For the sake of brevity, I will skip over the embedding configuration, where
    I incorporated `fastembed` and `jina` embeddings. If you're curious, please check
    out the [full implementation](https://github.com/gilad-rubin/modular-rag).
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†ç®€æ´èµ·è§ï¼Œæˆ‘å°†è·³è¿‡åµŒå…¥é…ç½®éƒ¨åˆ†ï¼Œå…¶ä¸­æˆ‘ä½¿ç”¨äº†`fastembed`å’Œ`jina`åµŒå…¥ã€‚å¦‚æœä½ æ„Ÿå…´è¶£ï¼Œè¯·æŸ¥çœ‹[å®Œæ•´å®ç°](https://github.com/gilad-rubin/modular-rag)ã€‚
- en: Letâ€™s move on to the retrieval pipeline.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬ç»§ç»­æŸ¥çœ‹æ£€ç´¢ç®¡é“ã€‚
- en: Retrieval
  id: totrans-95
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: æ£€ç´¢
- en: Haystack comes with an in-memory document store for fast experimentation. It
    includes an embedding retriever and a BM25 retriever. In this section â€” weâ€™ll
    build a configuration space that enables using either a BM25, an embedding retriever
    or both.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: Haystackæä¾›äº†ä¸€ä¸ªå†…å­˜ä¸­çš„æ–‡æ¡£å­˜å‚¨ï¼Œä¾¿äºå¿«é€Ÿå®éªŒã€‚å®ƒåŒ…æ‹¬ä¸€ä¸ªåµŒå…¥æ£€ç´¢å™¨å’Œä¸€ä¸ªBM25æ£€ç´¢å™¨ã€‚åœ¨è¿™ä¸€éƒ¨åˆ†â€”â€”æˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªé…ç½®ç©ºé—´ï¼Œå…è®¸ä½¿ç”¨BM25ã€åµŒå…¥æ£€ç´¢å™¨æˆ–ä¸¤è€…ç»“åˆã€‚
- en: '[PRE8]'
  id: totrans-97
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: Here, weâ€™re using a couple of â€œtricksâ€ to make it work. First of all, we use
    `hp.multi_select` which allows us to select multiple options from the options.
    Second, we add â€œhelperâ€ components from the start and end of the pipeline (PassThroughText,
    PassThroughDocuments) to make sure that any selection will start with `query`and
    end with `retrieved_documents` and the rest is relatively straightforward.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€äº›â€œæŠ€å·§â€æ¥ä½¿å®ƒå·¥ä½œã€‚é¦–å…ˆï¼Œæˆ‘ä»¬ä½¿ç”¨`hp.multi_select`ï¼Œå®ƒå…è®¸æˆ‘ä»¬ä»é€‰é¡¹ä¸­é€‰æ‹©å¤šä¸ªé€‰é¡¹ã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬åœ¨ç®¡é“çš„å¼€å§‹å’Œç»“æŸéƒ¨åˆ†æ·»åŠ äº†â€œåŠ©æ‰‹â€ç»„ä»¶ï¼ˆPassThroughTextï¼ŒPassThroughDocumentsï¼‰ï¼Œä»¥ç¡®ä¿ä»»ä½•é€‰æ‹©éƒ½ä¼šä»¥`query`å¼€å§‹ï¼Œä»¥`retrieved_documents`ç»“æŸï¼Œå…¶ä½™éƒ¨åˆ†ç›¸å¯¹ç®€å•ã€‚
- en: 'A couple of example instantiations would be:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€äº›ç¤ºä¾‹å®ä¾‹åŒ–çš„ä»£ç å¦‚ä¸‹ï¼š
- en: '[PRE9]'
  id: totrans-100
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '![](../Images/b0c0e300e43b6f5eb2180093b5aec6f5.png)'
  id: totrans-101
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b0c0e300e43b6f5eb2180093b5aec6f5.png)'
- en: Image by the author
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡ç”±ä½œè€…æä¾›
- en: 'And:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: å¹¶ä¸”ï¼š
- en: '[PRE10]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '![](../Images/7a2b2312dbc0d40475e14fe896db9c3c.png)'
  id: totrans-105
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/7a2b2312dbc0d40475e14fe896db9c3c.png)'
- en: In the full implementation, Iâ€™ve added a Qdrant vector store, an optional reranking
    step, and a final generation pipeline. These are all meant as examples to show
    the possibilities of adding and customizing the different components in these
    pipelines and you can find them as well in the full repository.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨å®Œæ•´çš„å®ç°ä¸­ï¼Œæˆ‘æ·»åŠ äº†ä¸€ä¸ªQdrantå‘é‡å­˜å‚¨ï¼Œä¸€ä¸ªå¯é€‰çš„é‡æ’åºæ­¥éª¤ï¼Œä»¥åŠä¸€ä¸ªæœ€ç»ˆçš„ç”Ÿæˆç®¡é“ã€‚è¿™äº›éƒ½ä½œä¸ºç¤ºä¾‹ï¼Œå±•ç¤ºäº†å¦‚ä½•åœ¨è¿™äº›ç®¡é“ä¸­æ·»åŠ å’Œè‡ªå®šä¹‰ä¸åŒçš„ç»„ä»¶ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨å®Œæ•´çš„ä»£ç åº“ä¸­æ‰¾åˆ°å®ƒä»¬ã€‚
- en: 'Eventually, we have the main config that binds all of these settings together:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: æœ€ç»ˆï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªä¸»é…ç½®ï¼Œå®ƒå°†æ‰€æœ‰è¿™äº›è®¾ç½®ç»‘å®šåœ¨ä¸€èµ·ï¼š
- en: '[PRE11]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'from here we can define pretty much anything we want inside any of the sub-components.
    For example:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: ä»è¿™é‡Œå¼€å§‹ï¼Œæˆ‘ä»¬å‡ ä¹å¯ä»¥åœ¨ä»»ä½•å­ç»„ä»¶å†…éƒ¨å®šä¹‰ä»»ä½•æˆ‘ä»¬æƒ³è¦çš„å†…å®¹ã€‚ä¾‹å¦‚ï¼š
- en: '[PRE12]'
  id: totrans-110
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'And weâ€™ve instantiated a concrete set of working pipelines:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å·²ç»å®ä¾‹åŒ–äº†ä¸€ç»„å…·ä½“çš„å·¥ä½œç®¡é“ï¼š
- en: '![](../Images/e6833095970f9a1928cfc184f1db1d83.png)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e6833095970f9a1928cfc184f1db1d83.png)'
- en: 'We can now execute them sequentially:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬ç°åœ¨å¯ä»¥é¡ºåºæ‰§è¡Œå®ƒä»¬ï¼š
- en: '[PRE13]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '[PRE14]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Great Response! ğŸ‘
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: å¾ˆæ£’çš„åé¦ˆï¼ğŸ‘
- en: Summary
  id: totrans-117
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: æ€»ç»“
- en: For some of you, this might be a lot to take in at once. You might be new to
    Haystack, and this is probably your first encounter with Hypster. Thatâ€™s perfectly
    understandable!
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: å¯¹äºä½ ä»¬ä¸­çš„ä¸€äº›äººæ¥è¯´ï¼Œè¿™å¯èƒ½ä¸€ä¸‹å­æ¥å—çš„ä¿¡æ¯é‡æœ‰ç‚¹å¤§ã€‚ä½ å¯èƒ½æ˜¯ç¬¬ä¸€æ¬¡æ¥è§¦Haystackï¼Œå¯èƒ½ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡é‡åˆ°Hypsterã€‚è¿™å®Œå…¨å¯ä»¥ç†è§£ï¼
- en: The code is complex, but I believe that this comes from the inherent complexity
    of building a modular system like this. In addition, defining the exact routings
    of a workflow is a visual task and itâ€™s sometimes harder to read via text.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: ä»£ç å¾ˆå¤æ‚ï¼Œä½†æˆ‘ç›¸ä¿¡è¿™æ¥è‡ªäºæ„å»ºè¿™æ ·ä¸€ä¸ªæ¨¡å—åŒ–ç³»ç»Ÿæœ¬èº«çš„å¤æ‚æ€§ã€‚æ­¤å¤–ï¼Œå®šä¹‰å·¥ä½œæµçš„ç²¾ç¡®è·¯ç”±æ˜¯ä¸€ä¸ªè§†è§‰ä»»åŠ¡ï¼Œæœ‰æ—¶å€™é€šè¿‡æ–‡æœ¬æ¥é˜…è¯»å®ƒä¼šæ›´å›°éš¾ã€‚
- en: That being said, this is the first time Iâ€™ve seen a fully configurable, modular
    RAG system. Itâ€™s exciting for me, and I hope for you as well!
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: è¯è™½å¦‚æ­¤ï¼Œè¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡çœ‹åˆ°ä¸€ä¸ªå®Œå…¨å¯é…ç½®ã€æ¨¡å—åŒ–çš„RAGç³»ç»Ÿã€‚å¯¹æˆ‘æ¥è¯´ï¼Œè¿™å¾ˆä»¤äººå…´å¥‹ï¼Œæˆ‘ä¹Ÿå¸Œæœ›å¯¹ä½ æ¥è¯´åŒæ ·å¦‚æ­¤ï¼
- en: I believe this represents a fundamentally different approach to AI/ML projects.
    Instead of building a codebase for a single solution, weâ€™re building a codebase
    that accommodates multiple potential workflows â€” a â€œsuperposition of workflowsâ€
    or a â€œhyper-workflow.â€
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ç›¸ä¿¡è¿™ä»£è¡¨äº†ä¸€ç§æ ¹æœ¬ä¸åŒçš„AI/MLé¡¹ç›®æ–¹æ³•ã€‚æˆ‘ä»¬ä¸æ˜¯ä¸ºå•ä¸€çš„è§£å†³æ–¹æ¡ˆæ„å»ºä»£ç åº“ï¼Œè€Œæ˜¯æ„å»ºä¸€ä¸ªå¯ä»¥å®¹çº³å¤šç§æ½œåœ¨å·¥ä½œæµçš„ä»£ç åº“â€”â€”ä¸€ç§â€œå·¥ä½œæµå åŠ â€æˆ–â€œè¶…å·¥ä½œæµâ€ã€‚
- en: 'Once you get into this kind of programming â€” you immediately unlock incredible
    benefits:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸€æ—¦ä½ è¿›å…¥è¿™ç§ç¼–ç¨‹æ–¹å¼â€”â€”ä½ å°†ç«‹å³è§£é”éš¾ä»¥ç½®ä¿¡çš„å¥½å¤„ï¼š
- en: '**Hyperparameter Optimization** is easily available (more on that in future
    posts)'
  id: totrans-123
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**è¶…å‚æ•°ä¼˜åŒ–** å¾ˆå®¹æ˜“å®ç°ï¼ˆå…³äºè¿™ä¸€ç‚¹å°†åœ¨æœªæ¥çš„æ–‡ç« ä¸­è¯¦ç»†è®¨è®ºï¼‰'
- en: '**Utilizing different configurations for diverse scenarios**. For example,
    queries of type X can use a RAG system with a high weight assigned to the BM25
    retriever and queries of type Y focus mainly on dense embedding techniques.'
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**ä¸ºä¸åŒåœºæ™¯åˆ©ç”¨ä¸åŒé…ç½®**ã€‚ä¾‹å¦‚ï¼ŒXç±»å‹çš„æŸ¥è¯¢å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå°†BM25æ£€ç´¢å™¨æƒé‡è®¾ç½®å¾—å¾ˆé«˜çš„RAGç³»ç»Ÿï¼Œè€ŒYç±»å‹çš„æŸ¥è¯¢åˆ™ä¸»è¦èšç„¦äºå¯†é›†åµŒå…¥æŠ€æœ¯ã€‚'
- en: '**Agentic Tool Use -** Itâ€™s relatively straightforward to wrap this as a tool
    that can be instantiated and used in different scenarios, which means thatâ€¦ Yes!
    We can turn this intoa tool that an AI Agent uses. Think of the possibilities
    there.'
  id: totrans-125
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**å·¥å…·æ€§ä½¿ç”¨ -** å°†å…¶å°è£…æˆä¸€ä¸ªå¯ä»¥åœ¨ä¸åŒåœºæ™¯ä¸‹å®ä¾‹åŒ–å’Œä½¿ç”¨çš„å·¥å…·æ˜¯ç›¸å¯¹ç®€å•çš„ï¼Œè¿™æ„å‘³ç€â€¦â€¦æ˜¯çš„ï¼æˆ‘ä»¬å¯ä»¥å°†å…¶å˜æˆä¸€ä¸ªAIä»£ç†ä½¿ç”¨çš„å·¥å…·ã€‚æƒ³è±¡ä¸€ä¸‹é‚£é‡Œçš„å¯èƒ½æ€§ã€‚'
- en: '**A/B testing in Production -** we can deploy this RAG hyperspace to production
    and perform A/B testing just by specifying configurations for each individual
    API request.'
  id: totrans-126
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**ç”Ÿäº§ç¯å¢ƒä¸­çš„A/Bæµ‹è¯• -** æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªRAGè¶…ç©ºé—´éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå¹¶ä»…é€šè¿‡ä¸ºæ¯ä¸ªå•ç‹¬çš„APIè¯·æ±‚æŒ‡å®šé…ç½®æ¥æ‰§è¡ŒA/Bæµ‹è¯•ã€‚'
- en: '**Outro**'
  id: totrans-127
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '**ç»“æŸè¯­**'
- en: So, how was it for you?
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: é‚£ä¹ˆï¼Œä½ è§‰å¾—æ€ä¹ˆæ ·ï¼Ÿ
- en: Making this knowledge accessible is important to me, so your inputs are valuable.
    If you have any questions or comments on this implementation or the overall approach,
    please feel free to add your comments to this article.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: ä½¿è¿™äº›çŸ¥è¯†å˜å¾—æ˜“äºè·å–å¯¹æˆ‘æ¥è¯´éå¸¸é‡è¦ï¼Œå› æ­¤ä½ çš„æ„è§å¯¹æˆ‘å¾ˆæœ‰ä»·å€¼ã€‚å¦‚æœä½ å¯¹è¿™ä¸ªå®ç°æˆ–æ•´ä½“æ–¹æ³•æœ‰ä»»ä½•é—®é¢˜æˆ–æ„è§ï¼Œæ¬¢è¿éšæ—¶åœ¨æœ¬æ–‡ä¸­æ·»åŠ ä½ çš„è¯„è®ºã€‚
- en: I also offer consultation and freelance services to companies looking for a
    structured, common-sense approach to solving business problems using state-of-the-art
    Generative AI and Machine Learning tools.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘è¿˜ä¸ºéœ€è¦ä½¿ç”¨æœ€å…ˆè¿›çš„ç”Ÿæˆæ€§äººå·¥æ™ºèƒ½å’Œæœºå™¨å­¦ä¹ å·¥å…·è§£å†³å•†ä¸šé—®é¢˜ã€å¯»æ‰¾ç»“æ„åŒ–ä¸”ç¬¦åˆå¸¸ç†æ–¹æ³•çš„å…¬å¸æä¾›å’¨è¯¢å’Œè‡ªç”±èŒä¸šæœåŠ¡ã€‚
- en: Feel free to contact me via [**E-Mail**](mailto:me@giladrubin.com), [**LinkedIn**](https://www.linkedin.com/in/gilad-rubin-2b72b3218/)
    or my [**Website**](http://www.giladrubin.com) **ğŸŒŸ**
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: éšæ—¶å¯ä»¥é€šè¿‡[**ç”µå­é‚®ä»¶**](mailto:me@giladrubin.com)ã€[**LinkedIn**](https://www.linkedin.com/in/gilad-rubin-2b72b3218/)æˆ–æˆ‘çš„[**ä¸ªäººç½‘ç«™**](http://www.giladrubin.com)è”ç³»æˆ‘
    **ğŸŒŸ**
- en: Resources
  id: totrans-132
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: èµ„æº
- en: 'Gao, Y., Xiong, Y., Wang, M., & Wang, H. (2024). [Modular RAG: Transforming
    RAG Systems into LEGO-like Reconfigurable Frameworks](https://arxiv.org/abs/2407.21059).
    arXiv preprint arXiv:2407.21059.'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 'Gao, Y., Xiong, Y., Wang, M., & Wang, H. (2024). [Modular RAG: å°†RAGç³»ç»Ÿè½¬åŒ–ä¸ºç±»ä¼¼ä¹é«˜çš„å¯é‡é…ç½®æ¡†æ¶](https://arxiv.org/abs/2407.21059)ã€‚arXivé¢„å°æœ¬
    arXiv:2407.21059ã€‚'
- en: '**Further Reading**'
  id: totrans-134
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: '**è¿›ä¸€æ­¥é˜…è¯»**'
- en: '**Haystackâ€™s** [Documentation](https://docs.haystack.deepset.ai/docs/intro)
    | [DeepLearning.ai Course](https://www.deeplearning.ai/short-courses/building-ai-applications-with-haystack/)
    | [Github Repo](https://github.com/deepset-ai/haystack)'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Haystack**çš„[æ–‡æ¡£](https://docs.haystack.deepset.ai/docs/intro) | [DeepLearning.aiè¯¾ç¨‹](https://www.deeplearning.ai/short-courses/building-ai-applications-with-haystack/)
    | [Githubä»“åº“](https://github.com/deepset-ai/haystack)'
- en: '**Hypsterâ€™s** [Introduction](https://medium.com/@giladrubin/introducing-hypster-a-pythonic-framework-for-managing-configurations-to-build-highly-optimized-ai-5ee004dbd6a5)
    | [Documentation](https://gilad-rubin.gitbook.io/hypster) | [Github Repo](https://github.com/gilad-rubin/hypster)'
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Hypster**çš„[ä»‹ç»](https://medium.com/@giladrubin/introducing-hypster-a-pythonic-framework-for-managing-configurations-to-build-highly-optimized-ai-5ee004dbd6a5)
    | [æ–‡æ¡£](https://gilad-rubin.gitbook.io/hypster) | [Githubä»“åº“](https://github.com/gilad-rubin/hypster)'
- en: '**Modular-RAG** [Github Repo](https://github.com/gilad-rubin/modular-rag)'
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Modular-RAG** [Githubä»“åº“](https://github.com/gilad-rubin/modular-rag)'
- en: Notes
  id: totrans-138
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å¤‡æ³¨
- en: All images without a caption were created by the author
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æ‰€æœ‰æ²¡æœ‰è¯´æ˜æ–‡å­—çš„å›¾ç‰‡å‡ç”±ä½œè€…åˆ›ä½œ
- en: Iâ€™m not affiliated with Deepset/Haystack in any way.
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘ä¸Deepset/Haystackæ²¡æœ‰ä»»ä½•å…³è”ã€‚
