<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Navigating the New Types of LLM Agents and Architectures</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Navigating the New Types of LLM Agents and Architectures</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/navigating-the-new-types-of-llm-agents-and-architectures-309382ce9f88?source=collection_archive---------0-----------------------#2024-08-30">https://towardsdatascience.com/navigating-the-new-types-of-llm-agents-and-architectures-309382ce9f88?source=collection_archive---------0-----------------------#2024-08-30</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><figure class="fr fs ft fu fv fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp fq"><img src="../Images/5939b58b0944ef661493ed70b68e1810.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*V4MeXmvD1IYgfytI3C9q_g.png"/></div></div><figcaption class="gd ge gf fo fp gg gh bf b bg z dx">Image created by author using Dall-E</figcaption></figure><div/><div><h2 id="889d" class="pw-subtitle-paragraph hh gj gk bf b hi hj hk hl hm hn ho hp hq hr hs ht hu hv hw cq dx">The failure of ReAct agents gives way to a new generation of agents — and possibilities</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hx hy hz ia ib ab"><div><div class="ab ic"><div><div class="bm" aria-hidden="false"><a href="https://aparnadhinak.medium.com/?source=post_page---byline--309382ce9f88--------------------------------" rel="noopener follow"><div class="l id ie by if ig"><div class="l ed"><img alt="Aparna Dhinakaran" class="l ep by dd de cx" src="../Images/e431ee69563ecb27c86f3428ba53574c.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*VbKXdndNnweCZQQa2TohWw.png"/><div class="ih by l dd de em n ii eo"/></div></div></a></div></div><div class="ij ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--309382ce9f88--------------------------------" rel="noopener follow"><div class="l ik il by if im"><div class="l ed"><img alt="Towards Data Science" class="l ep by br in cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="ih by l br in em n ii eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="io ab q"><div class="ab q ip"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b iq ir bk"><a class="af ag ah ai aj ak al am an ao ap aq ar is" data-testid="authorName" href="https://aparnadhinak.medium.com/?source=post_page---byline--309382ce9f88--------------------------------" rel="noopener follow">Aparna Dhinakaran</a></p></div></div></div><span class="it iu" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b iq ir dx"><button class="iv iw ah ai aj ak al am an ao ap aq ar ix iy iz" disabled="">Follow</button></p></div></div></span></div></div><div class="l ja"><span class="bf b bg z dx"><div class="ab cn jb jc jd"><div class="je jf ab"><div class="bf b bg z dx ab jg"><span class="jh l ja">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar is ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--309382ce9f88--------------------------------" rel="noopener follow"><p class="bf b bg z ji jj jk jl jm jn jo jp bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="it iu" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">10 min read</span><div class="jq jr l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Aug 30, 2024</span></div></span></div></span></div></div></div><div class="ab cp js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh"><div class="h k w ea eb q"><div class="kx l"><div class="ab q ky kz"><div class="pw-multi-vote-icon ed jh la lb lc"><div class=""><div class="ld le lf lg lh li lj am lk ll lm lc"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l ln lo lp lq lr ls lt"><p class="bf b dy z dx"><span class="le">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao ld lw lx ab q ee ly lz" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lv"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count lu lv">9</span></p></button></div></div></div><div class="ab q ki kj kk kl km kn ko kp kq kr ks kt ku kv kw"><div class="ma k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al mb an ao ap ix mc md me" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep mf cn"><div class="l ae"><div class="ab cb"><div class="mg mh mi mj mk gb ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al mb an ao ap ix ml mm lz mn mo mp mq mr s ms mt mu mv mw mx my u mz na nb"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al mb an ao ap ix ml mm lz mn mo mp mq mr s ms mt mu mv mw mx my u mz na nb"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al mb an ao ap ix ml mm lz mn mo mp mq mr s ms mt mu mv mw mx my u mz na nb"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><p id="ab92" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk"><em class="ny">My thanks to John Gilhuly for his contributions to this piece</em></p><p id="18a8" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">If 2023 was the year of retrieval augmented generation, 2024 has been the year of agents. Companies all over the world are experimenting with chatbot agents, tools like MultiOn are growing by connecting agents to outside websites, and frameworks like LangGraph and LlamaIndex Workflows are helping developers around the world build structured agents.</p><p id="bb2d" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">However, despite their popularity, agents have yet to make a strong splash outside of the AI ecosystem. Few agents are taking off among either consumer or enterprise users.</p><p id="ce29" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">How can teams navigate the new frameworks and new agent directions? What tools are available, and which should you use to build your next application? As a leader at a company that recently built our own complex agent to act as a copilot within our product, we have some insights on this topic.</p><h1 id="06a9" class="nz oa gk bf ob oc od hk oe of og hn oh oi oj ok ol om on oo op oq or os ot ou bk">Defining Agents</h1><p id="a3bd" class="pw-post-body-paragraph nc nd gk ne b hi ov ng nh hl ow nj nk nl ox nn no np oy nr ns nt oz nv nw nx fj bk">First, it helps to define what we mean by an agent. LLM-based agents are software systems that string together multiple processing steps, including calls to LLMs, in order to achieve a desired end result. Agents typically have some amount of conditional logic or decision-making capabilities, as well as a working memory they can access between steps.</p><p id="24d8" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Let’s dive into how agents are built today, the current problems with modern agents, and some initial solutions.</p><h2 id="6b55" class="pa oa gk bf ob pb pc pd oe pe pf pg oh nl ph pi pj np pk pl pm nt pn po pp pq bk">The Failure of ReAct Agents</h2><p id="7cc7" class="pw-post-body-paragraph nc nd gk ne b hi ov ng nh hl ow nj nk nl ox nn no np oy nr ns nt oz nv nw nx fj bk">Let’s be honest, the idea of an agent isn’t new. There were countless agents launched on AI Twitter over the last year claiming amazing feats of intelligence. This first generation were mainly <a class="af pr" href="https://arxiv.org/abs/2210.03629" rel="noopener ugc nofollow" target="_blank">ReAct</a> (reason, act) agents. They were designed to abstract as much as possible, and promised a wide set of outcomes.</p><p id="c1ef" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Unfortunately, this first generation of agent architectures really struggled. Their heavy abstraction made them hard to use, and despite their lofty promises, they turned out to <a class="af pr" href="https://arxiv.org/html/2405.13966v1" rel="noopener ugc nofollow" target="_blank">not do much of anything</a>.</p><p id="bea6" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">In reaction to this, many people began to rethink how agents should be structured. In the past year we’ve seen great advances, now leading us into the next generation of agents.</p><h2 id="eddc" class="pa oa gk bf ob pb pc pd oe pe pf pg oh nl ph pi pj np pk pl pm nt pn po pp pq bk">What is the Second Generation of Agents?</h2><p id="6406" class="pw-post-body-paragraph nc nd gk ne b hi ov ng nh hl ow nj nk nl ox nn no np oy nr ns nt oz nv nw nx fj bk">This new generation of agents is built on the principle of defining the possible paths an agent can take in a much more rigid fashion, instead of the open-ended nature of ReAct. Whether agents use a framework or not, we have seen a trend towards smaller solution spaces — aka a reduction in the possible things each agent can do. A smaller solution space means an easier-to-define agent, which often leads to a more powerful agent.</p><p id="6f7c" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">This second generation covers many different types of agents, however it’s worth noting that <em class="ny">most of the agents or assistants we see today are written in code without frameworks, have an LLM router stage, and process data in iterative loops.</em></p><h2 id="466a" class="pa oa gk bf ob pb pc pd oe pe pf pg oh nl ph pi pj np pk pl pm nt pn po pp pq bk">What Makes Up An Agent?</h2><p id="795a" class="pw-post-body-paragraph nc nd gk ne b hi ov ng nh hl ow nj nk nl ox nn no np oy nr ns nt oz nv nw nx fj bk">Many agents have a node or component called a <strong class="ne gl">router, </strong>that decides which step the agent should take next. The term router normally refers to an LLM or classifier making an intent decision of what path to take. An agent may return to this router continuously as they progress through their execution, each time bringing some updated information. The router will take that information, combine it with its existing knowledge of the possible next steps, and choose the next action to take.</p><p id="9b43" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">The router itself is sometimes powered by a call to an LLM. Most popular LLMs at this point support <strong class="ne gl">function calling</strong>, where they can choose a component to call from a JSON dictionary of function definitions. This ability makes the routing step easy to initially set up. As we’ll see later however, the router is often the step that needs the most improvement in an agent, so this ease of setup can belie the complexity under the surface.</p><p id="86f6" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Each action an agent can take is typically represented by a <strong class="ne gl">component</strong>. Components are blocks of code that accomplish a specific small task. These could call an LLM, or make multiple LLM calls, make an internal API call, or just run some sort of application code. These go by different names in different frameworks. In LangGraph, these are nodes. In LlamaIndex Workflows, they’re known as steps. Once the component completes its work, it may return to the router, or move to other decision components.</p><p id="8826" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Depending on the complexity of your agent, it can be helpful to group components together as execution branches or <strong class="ne gl">skills</strong>. Say you have a customer service chatbot agent. One of the things this agent can do is check the shipping status of an order. To functionally do that, the agent needs to extract an order id from the user’s query, create an api call to a backend system, make that api, parse the results, and generate a response. Each of those steps may be a component, and they can be grouped into the “Check shipping status” skill.</p><p id="c34b" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Finally, many agents will track a <strong class="ne gl">shared state</strong> or memory as they execute. This allows agents to more easily pass context between various components.</p><h1 id="22af" class="nz oa gk bf ob oc od hk oe of og hn oh oi oj ok ol om on oo op oq or os ot ou bk">Examples of Agent Architectures</h1><p id="ff9e" class="pw-post-body-paragraph nc nd gk ne b hi ov ng nh hl ow nj nk nl ox nn no np oy nr ns nt oz nv nw nx fj bk">There are some common patterns we see across agent deployments today. We’ll walk through an overview of all of those architectures in the following pieces but the below examples are probably the most common.</p><p id="3869" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">In its simplest form an agent or assistant might just be defined with a LLM router and a tool call. We call this first example a <strong class="ne gl"><em class="ny">single router with functions</em></strong>. We have a single router, that could be an LLM call, a classifier call, or just plain code, that directs and orchestrates which function to call. The idea is that the router can decide which tool or functional call to invoke based on input from the system. The single router comes from the fact that we are using only 1 router in this architecture.</p><figure class="pt pu pv pw px fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp ps"><img src="../Images/11f1778aef2eec4c137a1a670bcc2dca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*njskJnOGfz4Ge51OsBD6aA.jpeg"/></div></div><figcaption class="gd ge gf fo fp gg gh bf b bg z dx">Diagram by author</figcaption></figure><p id="7024" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">A slightly more complicated assistant we see is a <strong class="ne gl"><em class="ny">single router with skills</em></strong>. In this case, rather than calling a simple tooling or function call, the router can call a more complex workflow or skill set that might include many components and is an overall deeper set of chained actions. These components (LLM, API, tooling, RAG, and code calls) can be looped and chained to form a skill.</p><p id="b055" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">This is probably the most common architecture from advanced LLM application teams in production today that we see.</p><figure class="pt pu pv pw px fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp ps"><img src="../Images/75fe8804f273eab573708fd0d9f133ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vNWbMHCqnl1pCeqT73ZsyQ.jpeg"/></div></div><figcaption class="gd ge gf fo fp gg gh bf b bg z dx">Diagram by author</figcaption></figure><p id="115c" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">The general architecture gets more complicated by mixing branches of LLM calls with tools and state. In this next case, the router decides which of its skills (denoted in red) to call to answer the user’s question. It may update the shared state based on this question as well. Each skill may also access the shared state, and could involve one or more LLM calls of its own to retrieve a response to the user.</p><figure class="pt pu pv pw px fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp py"><img src="../Images/eeaa1ebe2277c41c4e42f3e33f2e536c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IDwnZHGWpquks3jgYvwvSQ.jpeg"/></div></div><figcaption class="gd ge gf fo fp gg gh bf b bg z dx">Diagram by author</figcaption></figure><p id="90f5" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">This is still generally straightforward, however, agents are usually far more complex. As agents become more complicated, you start to see frameworks built to try and reduce that complexity.</p><h1 id="4a3a" class="nz oa gk bf ob oc od hk oe of og hn oh oi oj ok ol om on oo op oq or os ot ou bk">Agent Architecture Frameworks</h1><h2 id="2c11" class="pa oa gk bf ob pb pc pd oe pe pf pg oh nl ph pi pj np pk pl pm nt pn po pp pq bk">LangGraph</h2><p id="9240" class="pw-post-body-paragraph nc nd gk ne b hi ov ng nh hl ow nj nk nl ox nn no np oy nr ns nt oz nv nw nx fj bk">LangGraph builds on the pre-existing concept of a Pregel graph, but translates it over to agents. In LangGraph, you define nodes and edges that your agent can travel along. While it is possible to define a router node in LangGraph, it is usually unnecessary unless you’re working with multi-agent applications. Instead, the same conditional logic that could live in the router now lives in the Nodes and Conditional Edges objects that LangGraph introduces.</p><p id="9c33" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Here’s an example of a LangGraph agent that can either respond to a user’s greeting, or perform some sort of RAG lookup of information:</p><figure class="pt pu pv pw px fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp pz"><img src="../Images/862a65a67f7fcea3ce139a3442f0dea2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*McVE1hfSCr7w79XSIEiZ8w.jpeg"/></div></div><figcaption class="gd ge gf fo fp gg gh bf b bg z dx">Diagram by author</figcaption></figure><p id="4dc7" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Here, the routing logic instead lives within nodes and conditional edges that choose to move the user between different nodes depending on a function response. In this case, <strong class="ne gl"><em class="ny">is_greeting</em></strong> and <strong class="ne gl"><em class="ny">check_rag_response</em></strong> are conditional edges. Defining one of these edges looks like this:</p><pre class="pt pu pv pw px qa qb qc bp qd bb bk"><span id="ac16" class="qe oa gk qb b bg qf qg l qh qi">graph.add_conditional_edges("classify_input", is_greeting, {True: "handle_greeting", False: "handle_RAG"})</span></pre><p id="b2aa" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Instead of collecting all of the routing logic in one node, we instead spread it between the relevant edges. This can be helpful, especially when you need to impose a predefined structure on your agent, and want to keep individual pieces of logic separated.</p><h2 id="1979" class="pa oa gk bf ob pb pc pd oe pe pf pg oh nl ph pi pj np pk pl pm nt pn po pp pq bk">LlamaIndex Workflows</h2><p id="09c8" class="pw-post-body-paragraph nc nd gk ne b hi ov ng nh hl ow nj nk nl ox nn no np oy nr ns nt oz nv nw nx fj bk">Other frameworks like <a class="af pr" href="https://arize.com/blog/llamaindex-workflows-a-new-way-to-build-cyclical-agents/" rel="noopener ugc nofollow" target="_blank">LlamaIndex Workflows</a> take a different approach, instead using events and event listeners to move between nodes. Like LangGraph, Workflows don’t necessarily need a routing node to handle the conditional logic of an agent. Instead, Workflows rely on individual nodes, or steps as they call them, to handle incoming events, and broadcast outgoing events to be handled by other steps. This results in the majority of Workflows logic being handled within each step, as opposed to within both steps and nodes.</p><figure class="pt pu pv pw px fw fo fp paragraph-image"><div role="button" tabindex="0" class="fx fy ed fz bh ga"><div class="fo fp qj"><img src="../Images/51e53013177ba3f241d11757c1882504.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dHQxQh4vVTLziA03QsE6eg.jpeg"/></div></div><figcaption class="gd ge gf fo fp gg gh bf b bg z dx"><em class="qk">A reflective SQL generation agent as a LlamaIndex Workflow (diagram by author)</em></figcaption></figure><h2 id="7328" class="pa oa gk bf ob pb pc pd oe pe pf pg oh nl ph pi pj np pk pl pm nt pn po pp pq bk">CrewAI, Autogen, Swarm, and Others</h2><p id="b2bc" class="pw-post-body-paragraph nc nd gk ne b hi ov ng nh hl ow nj nk nl ox nn no np oy nr ns nt oz nv nw nx fj bk">There are other frameworks that are intended to make agent development easier, including some that specialize in handling groups of agents working together. This space is rapidly evolving and it’s worth checking out these and other frameworks.</p><h1 id="72a9" class="nz oa gk bf ob oc od hk oe of og hn oh oi oj ok ol om on oo op oq or os ot ou bk">Key Questions When Considering An Agent</h1><h2 id="7d59" class="pa oa gk bf ob pb pc pd oe pe pf pg oh nl ph pi pj np pk pl pm nt pn po pp pq bk">Should You Use a Framework To Develop Your Agent?</h2><p id="f112" class="pw-post-body-paragraph nc nd gk ne b hi ov ng nh hl ow nj nk nl ox nn no np oy nr ns nt oz nv nw nx fj bk">Regardless of the framework you use, the additional structure provided by these tools can be helpful in building out agent applications. The question of whether using one of these frameworks is beneficial when creating larger, more complicated applications is a bit more challenging.</p><p id="2a85" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">We have a fairly strong opinion in this area because we built an assistant ourselves. Our assistant uses a multi-layer router architecture with branches and steps that echo some of the abstractions of the current frameworks. We started building our assistant before LangGraph was stable. As a result, we constantly ask ourselves: if we were starting from scratch, would we use the current framework abstractions? Are they up to the task?</p><p id="fe04" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">The current answer is not yet. There is just too much complexity in the overall system that doesn’t lend itself to a Pregel-based architecture. If you squint, you can map it to nodes and edges but the software abstraction would likely get in the way. As it stands, our team tends to prefer code over frameworks.</p><p id="2cf1" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">We do however, see the value in the agent framework approaches. Namely, it does force an architecture that has some best practices and good tooling. They are also getting better constantly, expanding where they are useful and what you can do with them. It is very likely that our answer may change in the near future as these frameworks improve.</p><h2 id="a270" class="pa oa gk bf ob pb pc pd oe pe pf pg oh nl ph pi pj np pk pl pm nt pn po pp pq bk">Do You Actually Need An Agent?</h2><p id="32db" class="pw-post-body-paragraph nc nd gk ne b hi ov ng nh hl ow nj nk nl ox nn no np oy nr ns nt oz nv nw nx fj bk">This begs another important question: what types of applications even require an agent? After all, agents cover a broad range of systems — and there is so much hype about what is “agentic” these days.</p><p id="40f8" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Here are three criteria to determine whether you might need an agent:</p><ul class=""><li id="bf1d" class="nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ql qm qn bk">Does your application follow an iterative flow based on incoming data?</li><li id="2d97" class="nc nd gk ne b hi qo ng nh hl qp nj nk nl qq nn no np qr nr ns nt qs nv nw nx ql qm qn bk">Does your application need to adapt and follow different flows based on previously taken actions or feedback along the way?</li><li id="138d" class="nc nd gk ne b hi qo ng nh hl qp nj nk nl qq nn no np qr nr ns nt qs nv nw nx ql qm qn bk">Is there a state space of actions that can be taken? The state space can be traversed in a variety of ways, and is not just restricted to linear pathways.</li></ul><h2 id="5514" class="pa oa gk bf ob pb pc pd oe pe pf pg oh nl ph pi pj np pk pl pm nt pn po pp pq bk">What Are The Common Issues To Expect?</h2><p id="f729" class="pw-post-body-paragraph nc nd gk ne b hi ov ng nh hl ow nj nk nl ox nn no np oy nr ns nt oz nv nw nx fj bk">Let’s say that you answer yes to one of these questions and need an agent. Here are several known issues to be aware of as you build.</p><p id="a2be" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">The first is <strong class="ne gl">long-term planning</strong>. While agents are powerful, they still struggle to decompose complex tasks into a logical plan. Worse, they can often get stuck in loops that block them from finding a solution. Agents also struggle with <strong class="ne gl">malformed tooling calls. </strong>This is typically due to the underlying LLMs powering an agent. In each case, human intervention is often needed to course correct.</p><p id="a5c3" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Another issue to be aware is inconsistent performance due to the<strong class="ne gl"> vastness of the solution space. </strong>The sheer number of possible actions and paths an agent can take makes it difficult to achieve consistent results and tends to drive up costs. Perhaps this is why the market is tending toward constrained agents that can only choose from a set of possible actions, effectively limiting the solution space.</p><h2 id="fb49" class="pa oa gk bf ob pb pc pd oe pe pf pg oh nl ph pi pj np pk pl pm nt pn po pp pq bk">What Are Some Tactics for Addressing These Challenges?</h2><p id="751a" class="pw-post-body-paragraph nc nd gk ne b hi ov ng nh hl ow nj nk nl ox nn no np oy nr ns nt oz nv nw nx fj bk">As noted, one of the most effective strategies is to <strong class="ne gl">map or narrow the solution space beforehand</strong>. By thoroughly defining the range of possible actions and outcomes, you can reduce ambiguity. Incorporating <strong class="ne gl">domain and business heuristics</strong> into the agent’s guidance system is also an easy win, giving agents the context they need to make better decisions. <strong class="ne gl">Being explicit about action intentions</strong> (clearly defining what each action is intended to accomplish) and creating <strong class="ne gl">repeatable processes </strong>(standardizing the steps and methodologies that agents follow) can also enhance reliability and make it easier to identify and correct errors when they occur.</p><p id="6caa" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Finally, <strong class="ne gl">orchestrating with code and more reliable methods</strong> rather than relying solely on LLM planning can dramatically improve agent performance. This involves swapping your LLM router for a code-based router where possible. By using code-based orchestration, you can implement more deterministic and controllable processes and reduce the unpredictability that often comes with LLM-based planning.</p><h1 id="5bf7" class="nz oa gk bf ob oc od hk oe of og hn oh oi oj ok ol om on oo op oq or os ot ou bk">Conclusion</h1><p id="e6b3" class="pw-post-body-paragraph nc nd gk ne b hi ov ng nh hl ow nj nk nl ox nn no np oy nr ns nt oz nv nw nx fj bk">With so much hype and the proliferation of new frameworks in a frenzied generative AI environment filled with FOMO, it can be easy to lose sight of fundamental questions. Taking the time to think about when and where a modern agent framework might — and might not — make sense for your use case before diving headlong into an MVP is always worthwhile.</p><p id="dde9" class="pw-post-body-paragraph nc nd gk ne b hi nf ng nh hl ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk"><em class="ny">Questions? Feel free to reach out here or </em><a class="af pr" href="https://join.slack.com/t/arize-ai/shared_invite/zt-26zg4u3lw-OjUNoLvKQ2Yv53EfvxW6Kg" rel="noopener ugc nofollow" target="_blank"><em class="ny">on Slack</em></a><em class="ny"> or find me live in one of our bi-weekly </em><a class="af pr" href="https://arize.com/ai-research-papers/" rel="noopener ugc nofollow" target="_blank"><em class="ny">AI research papers</em></a><em class="ny"> readings.</em></p></div></div></div></div>    
</body>
</html>