- en: Calculate the percentage of the total with RLS in place in Power BI
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 在 Power BI 中使用行级安全计算总百分比
- en: 原文：[https://towardsdatascience.com/calculate-the-percentage-of-the-total-with-rls-in-place-in-power-bi-1ea5c3ab1fac?source=collection_archive---------13-----------------------#2024-02-05](https://towardsdatascience.com/calculate-the-percentage-of-the-total-with-rls-in-place-in-power-bi-1ea5c3ab1fac?source=collection_archive---------13-----------------------#2024-02-05)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://towardsdatascience.com/calculate-the-percentage-of-the-total-with-rls-in-place-in-power-bi-1ea5c3ab1fac?source=collection_archive---------13-----------------------#2024-02-05](https://towardsdatascience.com/calculate-the-percentage-of-the-total-with-rls-in-place-in-power-bi-1ea5c3ab1fac?source=collection_archive---------13-----------------------#2024-02-05)
- en: '*Most data models have RLS in place, where some users can see only some aspects
    of the entire data set. But what happens when they must see their result compared
    to the overall result? This is not that easy.*'
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: '*大多数数据模型都有行级安全（RLS）机制，某些用户只能看到整个数据集的部分内容。但当他们必须看到与总体结果进行比较的结果时，情况就不那么简单了。*'
- en: '[](https://medium.com/@salvatorecagliari?source=post_page---byline--1ea5c3ab1fac--------------------------------)[![Salvatore
    Cagliari](../Images/a24b0cefab6e707cfee06cde9e857559.png)](https://medium.com/@salvatorecagliari?source=post_page---byline--1ea5c3ab1fac--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--1ea5c3ab1fac--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--1ea5c3ab1fac--------------------------------)
    [Salvatore Cagliari](https://medium.com/@salvatorecagliari?source=post_page---byline--1ea5c3ab1fac--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/@salvatorecagliari?source=post_page---byline--1ea5c3ab1fac--------------------------------)[![Salvatore
    Cagliari](../Images/a24b0cefab6e707cfee06cde9e857559.png)](https://medium.com/@salvatorecagliari?source=post_page---byline--1ea5c3ab1fac--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--1ea5c3ab1fac--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--1ea5c3ab1fac--------------------------------)
    [Salvatore Cagliari](https://medium.com/@salvatorecagliari?source=post_page---byline--1ea5c3ab1fac--------------------------------)'
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--1ea5c3ab1fac--------------------------------)
    ·11 min read·Feb 5, 2024
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: ·发表于 [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--1ea5c3ab1fac--------------------------------)
    ·阅读时间 11 分钟·2024年2月5日
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '![](../Images/a3c8d15eb058fbe11d3711d926e9fa1b.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a3c8d15eb058fbe11d3711d926e9fa1b.png)'
- en: Photo by [Wim van 't Einde](https://unsplash.com/@wimvanteinde?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 图片来自 [Wim van 't Einde](https://unsplash.com/@wimvanteinde?utm_source=medium&utm_medium=referral)
    在 [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
- en: Introduction
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 介绍
- en: 'Let’s look at the following scenario:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看一下以下场景：
- en: My Salespeople can see only the results for their assigned geographic regions.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 我的销售人员只能看到其指定地理区域的结果。
- en: In this scenario, it’s the continent.
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，它是大洲。
- en: For benchmarking, they must be able to compare their results to the results
    of the other continents and the total.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 为了进行基准测试，他们必须能够将自己的结果与其他大陆的结果以及总体结果进行比较。
- en: This is impossible when RLS (Row-Level-Security) is in place, as the users are
    not allowed to see the results for the other continents.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 当启用行级安全（RLS）时，这是不可能的，因为用户无法查看其他大洲的结果。
- en: A change to the data model is necessary to make this possible.
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 必须对数据模型进行更改才能实现这一点。
- en: So, let’s look at how to implement such a change.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，让我们来看看如何实现这样的变化。
- en: Solution by SQLBI
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 由 SQLBI 提供的解决方案
- en: 'SQLBI has already written an article and created a video on this topic:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: SQLBI 已经在此主题上撰写了文章并制作了视频：
- en: '[](https://www.sqlbi.com/articles/computing-accurate-percentages-with-row-level-security-in-power-bi/?source=post_page-----1ea5c3ab1fac--------------------------------)
    [## Computing accurate percentages with row-level security in Power BI - SQLBI'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://www.sqlbi.com/articles/computing-accurate-percentages-with-row-level-security-in-power-bi/?source=post_page-----1ea5c3ab1fac--------------------------------)
    [## 在 Power BI 中使用行级安全计算准确的百分比 - SQLBI'
- en: This article shows how to compute ratios when row-level security hides some
    of the data. If the percentage also…
  id: totrans-19
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 本文展示了当行级安全隐藏部分数据时，如何计算比例。如果百分比也……
- en: www.sqlbi.com](https://www.sqlbi.com/articles/computing-accurate-percentages-with-row-level-security-in-power-bi/?source=post_page-----1ea5c3ab1fac--------------------------------)
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: www.sqlbi.com](https://www.sqlbi.com/articles/computing-accurate-percentages-with-row-level-security-in-power-bi/?source=post_page-----1ea5c3ab1fac--------------------------------)
- en: 'Theoretically, we can stop here: Read the article or watch the video. All OK,
    isn’t it?'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 从理论上讲，我们可以到此为止：阅读文章或观看视频。都没问题，不是吗？
- en: Not that fast, my young horse.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 不要那么快，我的小马。
- en: While Alberto has built a solution using DAX, I would like to create the additional
    tables for the data model earlier, preferably in the source (database) or Power
    Query.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然Alberto已经使用DAX构建了解决方案，但我更愿意在数据模型之前尽早创建附加表，最好是在源（数据库）或Power Query中创建。
- en: As not everyone stores their data in a database, I don’t want to dig into SQL
    code to build the necessary tables, even though creating the solution in SQL would
    be pretty straightforward.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 由于并非每个人都将数据存储在数据库中，我不想深入SQL代码来构建必要的表，尽管在SQL中创建解决方案是相当直接的。
- en: So, I go to Power Query to create the solution.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，我去Power Query中创建解决方案。
- en: 'Just like my previous article:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 就像我之前的文章一样：
- en: '[](/converting-a-flat-table-to-a-good-data-model-in-power-query-46208215f17a?source=post_page-----1ea5c3ab1fac--------------------------------)
    [## Converting a Flat Table to a Good Data Model in Power Query'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: '[](/converting-a-flat-table-to-a-good-data-model-in-power-query-46208215f17a?source=post_page-----1ea5c3ab1fac--------------------------------)
    [## 在Power Query中将扁平表转换为良好的数据模型'
- en: When loading a wide Excel table into Power BI, we end up with a suboptimal Data
    model. What can we do to create a good…
  id: totrans-28
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 当将一个宽表的Excel文件加载到Power BI中时，我们最终会得到一个不理想的数据模型。我们可以做些什么来创建一个好的...
- en: towardsdatascience.com](/converting-a-flat-table-to-a-good-data-model-in-power-query-46208215f17a?source=post_page-----1ea5c3ab1fac--------------------------------)
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: '[towardsdatascience.com](/converting-a-flat-table-to-a-good-data-model-in-power-query-46208215f17a?source=post_page-----1ea5c3ab1fac--------------------------------)'
- en: OK, let’s start.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 好的，我们开始吧。
- en: Step 1 — Create the Fact table without Customers
  id: totrans-31
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第一步 — 创建没有客户的事实表
- en: I will take the same scenario and approach described in the SQLBI article above.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 我将采用上述SQLBI文章中描述的相同场景和方法。
- en: As the RLS rules are set up on the Customer table, I created a copy of the Fact
    tale “Online Sales,” but without referencing the Customer table.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 由于RLS规则已设置在客户表上，我创建了一个“在线销售”事实表的副本，但没有引用客户表。
- en: Without this reference, the RLS rule on the Customer table doesn’t apply, and
    I can calculate the result as needed.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 如果没有这个参考，客户表上的RLS规则将不适用，我可以根据需要计算结果。
- en: 'After opening Power Query, I create a Reference of the Online Sales table:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 打开Power Query后，我创建了在线销售表的引用：
- en: '![](../Images/10f54184f0be788adb2bd41b105c245b.png)'
  id: totrans-36
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/10f54184f0be788adb2bd41b105c245b.png)'
- en: Figure 1 — Create a Reference from the Online Sales table (Figure by the Author)
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 图1 — 从在线销售表创建引用（图由作者提供）
- en: By creating a Reference, I do not reread the data from the source in Power Query
    but reuse the result from the original Online Sales table.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 通过创建引用，我不会在Power Query中重新读取源数据，而是重用原始在线销售表的结果。
- en: I rename the table to “Online Sales (No Customers)”.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 我将表重命名为“在线销售（无客户）”。
- en: The second step is to analyze the data and decide by which columns I must group
    the data and which columns I can aggregate.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 第二步是分析数据，决定我必须按哪些列对数据进行分组，以及哪些列可以进行聚合。
- en: This step is necessary as I’m changing the granularity of the data.
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 这一步是必要的，因为我正在改变数据的粒度。
- en: By removing the Customer, I can reduce the size of the table, as I have fewer
    details.
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 通过移除客户信息，我可以减少表的大小，因为我拥有的详细信息较少。
- en: I can group my data by all Dimension Keys on the table. But without the Customer
    Key. And as I must not be able to figure out which customer has placed which order,
    I must also remove the Order Number and the Order Line details.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 我可以按表中的所有维度键对数据进行分组。但不能包含客户键。而且，由于我不能确定哪个客户下了哪个订单，因此我还必须删除订单号和订单行详细信息。
- en: But I must spend some time figuring out which column I can aggregate.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 但我必须花些时间弄清楚可以聚合哪些列。
- en: 'Let’s look at an example:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看一个例子：
- en: When I take Sales Quantity, I can sum this column without problems, as the result
    can be reused.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 当我取销售数量时，我可以毫无问题地对这个列进行求和，因为结果可以重用。
- en: But when I look at Unit Price, the picture is not that easy anymore.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 但是，当我查看单价时，情况就不再那么简单了。
- en: I have to look at what I can do with this column.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 我必须查看我可以如何处理这个列。
- en: What happens when I aggregate this column?
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 当我对这个列进行聚合时，会发生什么呢？
- en: This price is likely to change over time.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 这个价格可能会随着时间的推移而变化。
- en: This poses a danger when calculating the Sales Amount by multiplying the Unit
    Price with the Sales Quantity. This can lead to wrong results.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 当通过将单价与销售数量相乘来计算销售金额时，这会带来危险。这样可能导致错误的结果。
- en: Therefore, I cannot aggregate the Unit Price.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我不能聚合单价。
- en: 'In the end, I grouped the table by these columns:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我按以下列对表进行了分组：
- en: OrderDate
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 订单日期
- en: StoreKey
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 门店键
- en: ProductKey
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 产品键
- en: PromotionKey
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 促销键
- en: CurrencyKey
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 货币键
- en: DateKeyYear
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 日期键年份
- en: DueDate
  id: totrans-60
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 到期日期
- en: ShipDate
  id: totrans-61
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 发货日期
- en: 'And I aggregate (Sum) these columns:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我汇总（求和）这些列：
- en: SalesQuantity
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 销售数量
- en: SalesAmount
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 销售金额
- en: ReturnQuantity
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 返回数量
- en: ReturnAmount
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 返回金额
- en: DiscountAmount
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 折扣金额
- en: TotalCost
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 总成本
- en: UnitCost
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 单位成本
- en: Additionally, I can add a distinct count by CustomerKey to count the Customers
    to analyze the data.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，我还可以通过客户键添加不同的计数，以分析数据中的客户数量。
- en: '![](../Images/9a9c653c646619a796e7c5b2f8e743a2.png)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/9a9c653c646619a796e7c5b2f8e743a2.png)'
- en: Figure 2 — Grouping and aggregating the new table (Figure by the Author)
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 图 2 — 新表的分组和汇总（作者制作的图）
- en: I must click on “Add grouping” to add the column by which the data must be grouped.
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 我必须点击“添加分组”以添加用于分组数据的列。
- en: Then, I must scroll down to click on “Add aggregation” to add the columns that
    must be aggregated.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 然后，我必须向下滚动，点击“添加聚合”以添加需要聚合的列。
- en: For each column, I must set the Operation (Aggregation function à e. g. Sum),
    and I can put a new name.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 对于每一列，我必须设置操作（聚合函数，如求和），并且可以设置一个新名称。
- en: 'The next step is to add all relationships to the newly created table:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是将所有关系添加到新创建的表中：
- en: '![](../Images/1513d253cf98be2cbe4cf2226450171e.png)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1513d253cf98be2cbe4cf2226450171e.png)'
- en: Figure 3 — Data model for the new table (Figure by the Author)
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 图 3 — 新表的数据模型（作者制作的图）
- en: 'Now, let’s look at the results without and with the additional table:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们看看没有和有附加表的结果：
- en: 'This is the starting point from the original data and without RLS:'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 这是没有 RLS 时原始数据的起点：
- en: '![](../Images/581efb487f85b21e7cf1de5b31ffde50.png)'
  id: totrans-81
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/581efb487f85b21e7cf1de5b31ffde50.png)'
- en: Figure 4 — Initial result without RLS (Figure by the Author)
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 图 4 — 没有 RLS 时的初始结果（作者制作的图）
- en: 'Now, let’s apply the RLS role for Asia and Australia:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们为亚洲和澳大利亚应用 RLS 角色：
- en: '![](../Images/ea7b0c2b9b365072a3a4cf20aab1cfb9.png)'
  id: totrans-84
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/ea7b0c2b9b365072a3a4cf20aab1cfb9.png)'
- en: Figure 5 — Initial result with applied RLS role (Figure by the Author)
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 图 5 — 应用 RLS 角色后的初始结果（作者制作的图）
- en: As you can see, the result is mathematically correct, but it doesn’t fulfill
    our requirements.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 如您所见，结果在数学上是正确的，但它并没有满足我们的要求。
- en: The percentage is calculated only over the remaining two Continents instead
    of all continents.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 百分比仅计算在剩余的两个大陆上，而不是所有大陆。
- en: 'Now, I can change the report by moving the Continent to a Slicer and adding
    the Product Brand to the Matrix:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我可以通过将大陆移到切片器，并将产品品牌添加到矩阵中来更改报告：
- en: '![](../Images/b6b8253ac062266f765d32b7556b2d73.png)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b6b8253ac062266f765d32b7556b2d73.png)'
- en: Figure 6 — Changed report with continent Slicer and Brand (Figure by the Author)
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 图 6 — 更改后的报告，带有大陆切片器和品牌（作者制作的图）
- en: Due to this change, I can see that the values still change with and without
    RLS.
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 由于这一变化，我可以看到值在有 RLS 和没有 RLS 时仍然会变化。
- en: 'The problem now is that the result with an active RLS role is wrong:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 现在的问题是，激活 RLS 角色后的结果是错误的：
- en: '![](../Images/ee731f09a32902f8c64588de1723aced.png)'
  id: totrans-93
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/ee731f09a32902f8c64588de1723aced.png)'
- en: Figure 7 — Wrong result by Brand with RLS applied (Figure by the Author)
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 图 7 — 应用 RLS 后按品牌错误的结果（作者制作的图）
- en: The reason is that the percentage of Sales over “all” Continents by Brand is
    calculated over the available Continents, Asia and Australia. Therefore, the result
    is wrong.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 原因是，按品牌计算的“所有”大陆的销售百分比是基于可用的大洲（亚洲和澳大利亚）来计算的。因此，结果是错误的。
- en: However, the result differs when I add a new Measure, which points to the new
    table.
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，当我添加一个新的度量值，它指向新表时，结果有所不同。
- en: 'The Measure is the following:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 该度量值如下：
- en: '[PRE0]'
  id: totrans-98
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'And the result (with RLS) is this:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 而结果（带有 RLS）是这样的：
- en: '![](../Images/7b4f41e728dd213e4717ba1ad1b91c2d.png)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/7b4f41e728dd213e4717ba1ad1b91c2d.png)'
- en: Figure 8 — Result with new Measure on the new table and RLS (Figure by the Author)
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 图 8 — 在新表和 RLS 下的新度量值结果（作者制作的图）
- en: 'Take care: if you don’t select any continent and don’t have an active RLS role,
    the result of the new Measure looks wrong.'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意：如果您没有选择任何大陆，并且没有激活 RLS 角色，则新度量值的结果看起来会错误。
- en: You must take this into account while building and testing your solution.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 在构建和测试解决方案时，您必须考虑这一点。
- en: Depending on the report, you can use one of the two Measures, as both might
    deliver the correct result, depending on the situation.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 根据报告，您可以使用这两个度量值中的一个，因为根据情况，它们都可能提供正确的结果。
- en: For example, the Sales Director might have access to the Sales results of all
    Continents. For him, the result of the original Measure is correct, as it considers
    the Continent of the Customers.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，销售总监可能可以访问所有大洲的销售结果。对于他来说，原始度量的结果是正确的，因为它考虑了客户的所在大洲。
- en: To simplify this, we can add a new table with Customer Attributes.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 为了简化这个过程，我们可以添加一个新的客户属性表。
- en: Step 2 — Reporting over Customer Attributes
  id: totrans-107
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 步骤2 — 基于客户属性的报告
- en: As described in the SQL article, there can be a situation where it is necessary
    to create a report based on some Customer attributes, like Gender, Education,
    or any other Attributes.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 正如SQL文章中所描述的那样，可能存在一种情况，需要基于某些客户属性（如性别、教育或其他属性）创建报告。
- en: In this case, I must create a table for these Attributes and expand our Data
    model with this table.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，我必须为这些属性创建一个表，并使用这个表扩展我们的数据模型。
- en: To build such a table, I must first define the Requirements and then the process
    for creating the table.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 要构建这样的表格，我必须首先定义需求，然后是创建表格的过程。
- en: 'For example:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 例如：
- en: I must have a table without customers’ data (e.g., due to Data protection rules).
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我必须有一个不包含客户数据的表（例如，由于数据保护规则）。
- en: I must not be able to reconstruct customers’ data.
  id: totrans-113
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我必须无法重建客户的数据。
- en: I must be able to filter both the new and the original Online Sales tables.
  id: totrans-114
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 我必须能够过滤新的和原始的在线销售表。
- en: 'Next, I define the necessary steps to fulfill the requirements:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我定义完成要求所需的步骤：
- en: Duplicate the Customer table (named Customer Attributes).
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 复制客户表（命名为“客户属性”）。
- en: Remove the unnecessary columns.
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 移除不必要的列。
- en: Remove all duplicates.
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 移除所有重复项。
- en: Add an Index (Key / ID) column.
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 添加索引（键 / ID）列。
- en: Merge the new table with the original Customer table to add the newly created
    Key column.
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将新表与原始客户表合并，以添加新创建的键列。
- en: Merge the Key column to the “Online Sales” table.
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将键列合并到“在线销售”表中。
- en: Add the new Key column to the “Online Sales (No Customers)” table.
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在“在线销售（无客户）”表中添加新的键列。
- en: 'This should work. Let’s start:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 这应该可以工作。我们开始吧：
- en: 'One short note: As I must Merge the table without the unwanted Customer Attributes
    to the Original Customer table, I cannot create a Reference, as this would introduce
    a circular dependency. Therefore, I must Duplicate the Customer table:'
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 一条简短的说明：由于我必须将不包含不需要的客户属性的表合并到原始客户表中，因此无法创建引用，因为这会引入循环依赖。因此，我必须复制客户表：
- en: '![](../Images/b45ed1d09fccb86be53e32c515712485.png)'
  id: totrans-125
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b45ed1d09fccb86be53e32c515712485.png)'
- en: Figure 9 — Duplicate the Customer table (Figure by the Author)
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 图9 — 复制客户表（图源自作者）
- en: I renamed the duplicated table to Customer Attributes.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 我将重复的表重命名为“客户属性”。
- en: Now, I remove all columns that contain personal data (Except Gender, Education,
    and other statistically relevant columns). But I must make sure that I keep all
    the columns necessary to ensure that the Merge doesn’t result in a multiplication
    of rows in the following Merge Step.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我移除所有包含个人数据的列（除性别、教育和其他统计相关列外）。但我必须确保保留所有必要的列，以确保合并操作不会在后续合并步骤中导致行的乘法。
- en: For example, I got duplicates in the Result without the Birthdate. The reason
    is that there are a lot of customers sharing the same attributes without the Birthdate.
    But including the Birthdate ensures that the rows can be matched.
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，在结果中我得到了没有出生日期的重复项。原因是有很多客户共享相同的属性，但没有出生日期。但是，包含出生日期可以确保行之间可以匹配。
- en: You need to check this step carefully, as this might change case-by-case.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
  zh: 你需要仔细检查这一步，因为这可能会因情况而异。
- en: 'Next, I add the Index column:'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我添加索引列：
- en: '![](../Images/e3b648c321795449f0785ee4fe57f80d.png)'
  id: totrans-132
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e3b648c321795449f0785ee4fe57f80d.png)'
- en: Figure 10 — Add Index column (Figure by the Author)
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 图10 — 添加索引列（图源自作者）
- en: The Index column is renamed to “CustomerAttributesKey”.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 索引列被重命名为“CustomerAttributesKey”。
- en: 'I use the Merge function to transport the new Key to the Original Customer
    table:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 我使用合并功能将新键传输到原始客户表中：
- en: '![](../Images/17823dcb5738502dfee214d9d73d9a0e.png)'
  id: totrans-136
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/17823dcb5738502dfee214d9d73d9a0e.png)'
- en: Figure 11 — Merge the new Customer Attributes table to the original Customer
    table (Figure by the Author)
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 图11 — 将新的客户属性表合并到原始客户表中（图源自作者）
- en: I must select all matching columns while holding the Ctrl-Key pressed to ensure
    all columns are combined to merge the correct rows.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 我必须选择所有匹配的列，同时按住Ctrl键，确保所有列被合并，以合并正确的行。
- en: A problem exists with non-matching rows.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 存在不匹配的行问题。
- en: As you can see above, thirteen rows cannot be matched. Unfortunately, I wasn’t
    able to find the cause of this mismatch. Power Query doesn’t offer tools to find
    and solve such problems.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 如上所示，十三行无法匹配。不幸的是，我未能找到这种不匹配的原因。Power Query 并没有提供工具来查找并解决此类问题。
- en: I created a CustomerAttributes_Dummy table in Excel with a CustomerAttributesKey
    = -1 to solve this. Then, I added a table with the Enter Data feature with this
    row and appended this row to the CustomerAttributes table.
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 我在 Excel 中创建了一个 CustomerAttributes_Dummy 表，CustomerAttributesKey = -1，以解决此问题。然后，我使用“输入数据”功能添加了一个包含此行的表，并将该行附加到
    CustomerAttributes 表中。
- en: 'Another Note: I added the Dummy row to simplify the solution for this article.
    In the real world, I would try to find the cause, examine the data, and find the
    right solution instead of such a workaround.'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 另附说明：我添加了虚拟行来简化本文的解决方案。在实际情况下，我会尝试找出原因，检查数据，并找到正确的解决方案，而不是使用这种变通方法。
- en: 'Now I can expand the merged table to extract the CustomerAttributesKey:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，我可以扩展合并后的表以提取 CustomerAttributesKey：
- en: '![](../Images/c31f8568f440de8189fbde7fada04825.png)'
  id: totrans-144
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c31f8568f440de8189fbde7fada04825.png)'
- en: Figure 12 — Expand the new Key column (Figure by the Author)
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 图 12 — 扩展新的 Key 列（图示作者提供）
- en: 'The non-matching values for the Key columns can be filled with the Dummy-Key
    -1 through the Replace Value feature:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 可以通过“替换值”功能，将 Key 列中不匹配的值填充为虚拟 Key -1：
- en: '![](../Images/370de1eb79e764c9ff249e441abaf13f.png)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/370de1eb79e764c9ff249e441abaf13f.png)'
- en: Figure 13 — Replace the non-matching Keys with the Dummy Key “-1” (Figure by
    the Author)
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 图 13 — 用虚拟 Key “-1” 替换不匹配的 Key（图示作者提供）
- en: The next step is to add the CutomerAttributesKey to the “Online Sales” and,
    therefore, to the “Online Sales (No Customers)” tables.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 下一步是将 CustomerAttributesKey 添加到“在线销售”表中，并因此添加到“无客户在线销售”表中。
- en: 'Again, I use the Merge and Expand Features to add the column to the “Online
    Sales” table:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 我再次使用合并和扩展功能将列添加到“在线销售”表中：
- en: '![](../Images/6d5ebc81f51364982dff127222852d60.png)'
  id: totrans-151
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/6d5ebc81f51364982dff127222852d60.png)'
- en: Figure 14 — Merge the Online Sales table with the Customer table (Figure by
    the Author)
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 图 14 — 将在线销售表与客户表合并（图示作者提供）
- en: The Expansion of the CustomerAttributeyKey column is done the same way as shown
    before.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: CustomerAttributeyKey 列的扩展方式与之前展示的相同。
- en: 'Lastly, I have to add the new CustomerAttributeKey as a Grouping column to
    the “Online Sales (No Customers)” table:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我需要将新的 CustomerAttributeKey 作为分组列添加到“无客户在线销售”表中：
- en: '![](../Images/46ba5f5acc005f2be989f3804761712b.png)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/46ba5f5acc005f2be989f3804761712b.png)'
- en: Figure 15 — Add CustomerAttributeKey as a Grouping column (Figure by the Author)
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 图 15 — 将 CustomerAttributeKey 添加为分组列（图示作者提供）
- en: With this step, I have completed the data preparation tasks.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 通过这一步，我完成了数据准备任务。
- en: Modifying the Data model
  id: totrans-158
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 修改数据模型
- en: At this point, I have two options for the data model.
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 到此为止，我有两种数据模型的选择。
- en: In any case, I will add a Relationship to the “Online Sales (No Customer)” table,
    as this will fulfill a central requirement.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 无论如何，我将向“无客户在线销售”表添加关系，因为这将满足一个核心需求。
- en: 'But I can add a Relationship to the Customer or the Online Sales table:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 但我可以向客户表或在线销售表添加关系：
- en: Linking the new CustomerAttributes table to the Customer table, which relates
    to the Original Online Sales table.
  id: totrans-162
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 将新的 CustomerAttributes 表链接到客户表，客户表与原始的在线销售表相关联。
- en: Add a direct Relationship to the Online Sales table without adding a Relationship
    to the Customer table.
  id: totrans-163
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 向在线销售表直接添加关系，而不向客户表添加关系。
- en: 'Here are the two options, side by side:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 这里是两种选项并排显示：
- en: '![](../Images/785bb68292b2b140ca85a535e8c9e800.png)'
  id: totrans-165
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/785bb68292b2b140ca85a535e8c9e800.png)'
- en: Figure 16 — Variants for Data model for the Customer Attributes table (Figure
    by the Author)
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 图 16 — 客户属性表的数据模型变体（图示作者提供）
- en: Variant 1 uses the Customer table as an intermediary table.
  id: totrans-167
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 变体 1 使用客户表作为中介表。
- en: 'This has the following consequences:'
  id: totrans-168
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 这样会产生以下后果：
- en: The duplicate attributes in the Customer table can be removed.
  id: totrans-169
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可以删除客户表中的重复属性。
- en: Therefore, a unique distribution of Attributes.
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 因此，属性将具有唯一的分配。
- en: The RLS on the Customer table is always applied.
  id: totrans-171
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 客户表上的 RLS 始终适用。
- en: '2\. Variant 2 uses two relationships from the Online Sales table to each Customer
    table:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 2\. 变体 2 使用来自在线销售表到每个客户表的两个关系：
- en: Duplicated Attributes.
  id: totrans-173
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 重复的属性。
- en: Two possibilities to filter the data by the same attribute.
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 有两种可能性可以按相同属性过滤数据。
- en: The Customer Attributes table is not affected by RLS on the Customer table.
  id: totrans-175
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 客户属性表不受客户表上 RLS（行级安全性）的影响。
- en: A clear Star Schema.
  id: totrans-176
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 是否有清晰的星型架构（Star Schema）？
- en: I will go with the Variant 2, as I want to eliminate the effects of the RLS
    rules in some specific calculations, which opens more possibilities.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: 我会选择变体2，因为我希望消除在某些特定计算中RLS规则的影响，这样可以开启更多的可能性。
- en: But this is a decision for each situation.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 但这是针对每种情况的决策。
- en: Results and Conclusion
  id: totrans-179
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 结果与结论
- en: The result will differ depending on the data model and how you use the attributes
    from each table.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 结果会根据数据模型和你如何使用每个表中的属性而有所不同。
- en: 'For example, when I add the Gender from both tables to the Matrix shown at
    the beginning, the results are the following:'
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，当我将两个表中的性别字段添加到一开始展示的矩阵中时，结果如下：
- en: '![](../Images/be416d063c6be8e6c9db671680b59f68.png)'
  id: totrans-182
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/be416d063c6be8e6c9db671680b59f68.png)'
- en: Figure 17 — Comparison of the results with the Gender from each table (Figure
    by the Author)
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 图17 — 各表格中按性别分类的结果比较（图由作者提供）
- en: While the result by Gender on the right can be summarized to the Brand above,
    the result on the left cannot.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然右侧按性别分类的结果可以总结为上面的品牌，但左侧的结果无法如此总结。
- en: These results are Non-Visual-Totals, as described in the SQLBI article above,
    which can cause confusion and are hard to understand while being mathematically
    correct.
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
  zh: 这些结果是非视觉总计（Non-Visual-Totals），如上文SQLBI文章中所述，可能会引起混淆且难以理解，尽管它们在数学上是正确的。
- en: I strongly encourage reading the article to better understand this complex topic.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 我强烈建议阅读本文，以更好地理解这个复杂的话题。
- en: 'The main question is: What is better, using DAX or Power Query to prepare the
    data?'
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 主要问题是：使用DAX还是Power Query来准备数据，哪个更好？
- en: Strictly from the view of a data engineer, I would say Do it in the Source or
    Power Query to avoid data manipulation in Power BI using DAX.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 严格从数据工程师的角度来看，我会说，在源头或Power Query中进行转换，避免在Power BI中使用DAX进行数据处理。
- en: 'This would follow [Roche’s Maxim](https://ssbipolar.com/2021/05/31/roches-maxim/):'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 这将遵循[Roche的准则](https://ssbipolar.com/2021/05/31/roches-maxim/)：
- en: '*Transform the data as early as possible and as late as necessary.*'
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: '*尽早进行数据转换，并尽可能晚地进行必要的转换。*'
- en: One more reason to do it in Power Query is efficiency.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Power Query的另一个理由是效率。
- en: Power BI will compress and optimize the data storage more efficiently when the
    data is prepared in the source or Power Query than when using DAX tables.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 当数据在源头或Power Query中准备好时，Power BI会比使用DAX表时更有效地压缩和优化数据存储。
- en: 'This very technical video explains this in great detail:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
  zh: 这段非常技术性的视频详细解释了这一点：
- en: However, the complexity of doing this transformation is greater than the approach
    shown in the SQLBI article.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，进行这种转换的复杂性大于SQLBI文章中展示的方法。
- en: 'When developing a solution for my clients, I ask the following questions:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 在为我的客户开发解决方案时，我会问以下问题：
- en: Who will maintain the solution?
  id: totrans-196
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 谁将维护这个解决方案？
- en: What are the skills of that person?
  id: totrans-197
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 那个人的技能是什么？
- en: Is that person willing to learn more while maintaining the solution?
  id: totrans-198
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 那个人是否愿意在保持现有解决方案的同时学习更多？
- en: The answers to these questions will drive the approach for the solution.
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: 这些问题的答案将决定解决方案的方法。
- en: I already had situations when I had to rebuild a solution with a different approach,
    as the client wasn’t able or willing to learn the techniques used in my first
    approach.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: 我曾经遇到过这样的情况：当客户无法或不愿学习我首次方法中使用的技术时，我不得不以不同的方法重建解决方案。
- en: 'So, as usual, the answer to the question “Power Query or DAX” is: it depends
    …'
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
  zh: 所以，像往常一样，问题“使用Power Query还是DAX”的答案是：这取决于……
- en: My aim for this article is to show you an alternative way of building the solution,
    which can give you more flexibility while deciding which approach is the right
    one for you.
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 本文的目标是向你展示一种替代的解决方案构建方式，这种方式可以在你决定哪个方法最适合你的时候提供更多的灵活性。
- en: I hope I could achieve this and you learned something new.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 我希望我能够实现这一点，并且你学到了新的东西。
- en: '![](../Images/5c3c4eb830fdce30f0dd68f36dd39cef.png)'
  id: totrans-204
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/5c3c4eb830fdce30f0dd68f36dd39cef.png)'
- en: Photo by [Brett Jordan](https://unsplash.com/@brett_jordan?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 图片由[Brett Jordan](https://unsplash.com/@brett_jordan?utm_source=medium&utm_medium=referral)提供，来源于[Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
- en: References
  id: totrans-206
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 参考文献
- en: 'I wrote an article about using Power Query to transform a flat table into a
    Star schema while using some techniques described here. You can find it here:'
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 我写了一篇关于如何使用Power Query将平面表转换为星型架构的文章，并在其中使用了一些这里描述的技术。你可以在这里找到它：
- en: '[](/converting-a-flat-table-to-a-good-data-model-in-power-query-46208215f17a?source=post_page-----1ea5c3ab1fac--------------------------------)
    [## Converting a Flat Table to a Good Data Model in Power Query'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: '[](/converting-a-flat-table-to-a-good-data-model-in-power-query-46208215f17a?source=post_page-----1ea5c3ab1fac--------------------------------)
    [## 在 Power Query 中将平面表转换为良好的数据模型'
- en: When loading a wide Excel table into Power BI, we end up with a suboptimal Data
    model. What can we do to create a good…
  id: totrans-209
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 当将一个宽的 Excel 表格加载到 Power BI 时，我们最终会得到一个次优的数据模型。我们能做些什么来创建一个好的模型呢……
- en: towardsdatascience.com](/converting-a-flat-table-to-a-good-data-model-in-power-query-46208215f17a?source=post_page-----1ea5c3ab1fac--------------------------------)
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: towardsdatascience.com](/converting-a-flat-table-to-a-good-data-model-in-power-query-46208215f17a?source=post_page-----1ea5c3ab1fac--------------------------------)
- en: I use the Contoso sample dataset, like in my previous articles. You can download
    the ContosoRetailDW Dataset for free from Microsoft [here](https://www.microsoft.com/en-us/download/details.aspx?id=18279).
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: 我使用的是 Contoso 示例数据集，像我之前的文章中一样。你可以从微软[这里](https://www.microsoft.com/en-us/download/details.aspx?id=18279)免费下载
    ContosoRetailDW 数据集。
- en: The Contoso Data can be freely used under the MIT License, as described [here](https://github.com/microsoft/Power-BI-Embedded-Contoso-Sales-Demo).
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: Contoso 数据可以在 MIT 许可证下自由使用，详情请见[这里](https://github.com/microsoft/Power-BI-Embedded-Contoso-Sales-Demo)。
- en: You can support my work, which I do during my free time, through
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以通过以下方式支持我的工作，这是我在空闲时间进行的工作：
- en: '[https://buymeacoffee.com/salvatorecagliari](https://buymeacoffee.com/salvatorecagliari)'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: '[https://buymeacoffee.com/salvatorecagliari](https://buymeacoffee.com/salvatorecagliari)'
- en: 'Or scan this QR Code:'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
  zh: 或扫描此二维码：
- en: '![](../Images/e7ac062070dcd7a00dcf995ad7e95434.png)'
  id: totrans-216
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e7ac062070dcd7a00dcf995ad7e95434.png)'
- en: Any support is greatly appreciated and helps me find more time to create more
    content for you.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 任何支持都将不胜感激，并帮助我腾出更多时间为您创作更多内容。
- en: Thank you a lot.
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
  zh: 非常感谢。
