<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Arrays in Python and Excel VBA</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Arrays in Python and Excel VBA</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/arrays-in-python-and-excel-vba-efd73b649d6d?source=collection_archive---------14-----------------------#2024-01-23">https://towardsdatascience.com/arrays-in-python-and-excel-vba-efd73b649d6d?source=collection_archive---------14-----------------------#2024-01-23</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="fe79" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">Learning about arrays through simple examples</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@himalaya.birshrestha?source=post_page---byline--efd73b649d6d--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Himalaya Bir Shrestha" class="l ep by dd de cx" src="../Images/9766140c1c44381029d0a78154217775.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*lJ98JUmwLo6o5791TmzNJQ.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--efd73b649d6d--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://medium.com/@himalaya.birshrestha?source=post_page---byline--efd73b649d6d--------------------------------" rel="noopener follow">Himalaya Bir Shrestha</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--efd73b649d6d--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">8 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Jan 23, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj lc ld ab q ee le lf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count la lb">1</span></p></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lg k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lh an ao ap id li lj lk" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep ll cn"><div class="l ae"><div class="ab cb"><div class="lm ln lo lp lq lr ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><p id="efc2" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">As someone without a formal education in programming, my journey has been shaped by self-learning. Recognizing the significance of revisiting basic programming concepts, I have found that a solid foundation enhances the overall programming experience. In this tutorial, we will delve into one such fundamental concept — arrays. Specifically, we’ll explore the concept of arrays in both Python and Excel VBA through simple examples. Let’s get started.</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="no np ed nq bh nr"><div class="nf ng nh"><img src="../Images/f66043ed20c7b741ea145dcadfe8031d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*RcKQsNI6wExKiuhW"/></div></div><figcaption class="nt nu nv nf ng nw nx bf b bg z dx">Photo by <a class="af ny" href="https://unsplash.com/@nate_dumlao?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Nathan Dumlao</a> on <a class="af ny" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="6c65" class="nz oa fq bf ob oc od oe of og oh oi oj ms ok ol om mw on oo op na oq or os ot bk"><strong class="al">1. Arrays in Python</strong></h2><p id="49cc" class="pw-post-body-paragraph mj mk fq ml b go ou mn mo gr ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne fj bk">An array is a special variable that can hold one or multiple values of any data type. In Python, there is <a class="af ny" href="https://www.w3schools.com/python/python_arrays.asp" rel="noopener ugc nofollow" target="_blank">no built-in support</a> for arrays, unlike similar data types such as lists. However, one can create arrays using the array module of the <a class="af ny" href="https://numpy.org/doc/stable/index.html" rel="noopener ugc nofollow" target="_blank">numpy </a>package. The index of a numpy array object always starts with a 0. The last item inside a numpy array can be accessed by referring to -1. A numpy array can hold variables of a particular data type or multiple data types.</p><p id="26a8" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">This is shown in the code snippet below. The snippet also shows how the shape (dimensions i.e., rows, columns), size (number of elements) and length (number of items in a container i.e., rows) can be accessed from a numpy array.</p><pre class="ni nj nk nl nm oz pa pb bp pc bb bk"><span id="ab88" class="pd oa fq pa b bg pe pf l pg ph">import numpy as np<br/><br/>simple_array = np.array([1, 2, 3])<br/>mixed_array = np.array([1, 2, 3, "a", "b", "c", 4.5])<br/>print ("Simple array: ", simple_array)<br/>print ("First element of simple_array: ", simple_array[0])<br/>print ("Shape of simple_array: ", simple_array.shape)<br/>print ("Size of simple_array; ", simple_array.size)<br/>print ("\n")<br/>print ("Mixed array: ", mixed_array)<br/>print ("Last element of mixed_array: ", mixed_array[-1])<br/>print ("Length of mixed_array: ", len(mixed_array))</span></pre><p id="0e78" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk"><strong class="ml fr">1.1 Using numpy arrays for algebraic matrix operations</strong></p><p id="61b5" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Because of their flexible structure, numpy arrays are very handy in creating matrix objects of different dimensions and performing operations on them. The screenshot above has the examples of 1-dimensional array objects.</p><p id="58eb" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Below, I have created two array objects <code class="cx pi pj pk pa b">a</code> and <code class="cx pi pj pk pa b">b</code> both of which are 2-dimensional arrays. They can be considered as 2*2 matrices. Performing the dot product of the two matrices is as simple as doing just <code class="cx pi pj pk pa b">np.dot(a, b)</code>. In dot product, <code class="cx pi pj pk pa b">a</code> and <code class="cx pi pj pk pa b">b</code> are regarded as vectors (objects having both magnitude and direction). In matrix multiplication, each element in matrix <code class="cx pi pj pk pa b">a</code> is multiplied with the corresponding element in matrix <code class="cx pi pj pk pa b">b</code>. For example, a11 (first row, first column item) is multiplied by b11, and so on.</p><pre class="ni nj nk nl nm oz pa pb bp pc bb bk"><span id="b6eb" class="pd oa fq pa b bg pe pf l pg ph">a = np.array([[0, 1],[2,3]])<br/>b = np.array([[3,4],[5,6]])<br/>print ("Dot Product of a and b: \n", np.dot(a,b))<br/>print ("Matrix multiplication of a and b \n",a*b)</span></pre><p id="a67b" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Furthermore, one can perform other matrix operations such as addition, subtraction, and transpose. To get the determinant of the matrix, one can use <code class="cx pi pj pk pa b">np.linalg.det(a)</code>. To get the multiplicative inverse of a matrix, one can use <code class="cx pi pj pk pa b">np.linalg.inv(a)</code>.</p><pre class="ni nj nk nl nm oz pa pb bp pc bb bk"><span id="0eb3" class="pd oa fq pa b bg pe pf l pg ph">print (“Addition of a and b:\n”, np.add(a, b))<br/>print ("Also addition of a and b:\n", a+b)<br/>print ("Transpose of a:\n", a.T)<br/>print ("Determinant of a:\n", np.linalg.det(a))<br/>print ("Inverse of a:\n", np.linalg.inv(a))</span></pre><p id="3647" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk"><strong class="ml fr">1.2 Creating a m*n shape numpy array from list objects</strong></p><p id="4dac" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">I have two lists called <code class="cx pi pj pk pa b">countries_lived</code> and <code class="cx pi pj pk pa b">capitals</code> which contain the list of countries I have lived in and their corresponding capitals.</p><pre class="ni nj nk nl nm oz pa pb bp pc bb bk"><span id="7caf" class="pd oa fq pa b bg pe pf l pg ph">countries_lived = [“Nepal”,”India”,”Germany”,”Netherlands”]<br/>capitals = [“Kathmandu”,”New Delhi”,”Berlin”,”Amsterdam”]</span></pre><p id="a288" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">To create an array containing these list objects, I can use <code class="cx pi pj pk pa b">np.array([countries_lived, capitals])</code>. This will return me an array of shape 2*4 (i.e., 2 rows and 4 columns). If I want to have a single country and its corresponding capital in the same row, I can just transpose the same array.</p><pre class="ni nj nk nl nm oz pa pb bp pc bb bk"><span id="9790" class="pd oa fq pa b bg pe pf l pg ph">array1 = np.array([countries_lived, capitals])<br/>print ("array1:\n", array1)<br/>print ("Shape of array1:\n", array1.shape)<br/>print ("Size of array1:\n", array1.size)<br/><br/>array2 = np.array([countries_lived, capitals]).T<br/>print ("array2:\n", array2)<br/>print ("Shape of array2:\n", array2.shape)<br/>print ("Size of array2:\n", array2.size)</span></pre><h2 id="6bda" class="nz oa fq bf ob oc od oe of og oh oi oj ms ok ol om mw on oo op na oq or os ot bk">1.3 Appending an item to a numpy array and creating a dataframe</h2><p id="05d5" class="pw-post-body-paragraph mj mk fq ml b go ou mn mo gr ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne fj bk">Say I want to append an item France and Paris to <code class="cx pi pj pk pa b">array2</code> as an additional row, this can be done using the syntax <code class="cx pi pj pk pa b">np.append(arr, values, axis = None)</code>. The values must be of the same shape as <code class="cx pi pj pk pa b">arr</code>, excluding the axis. If the axis is not given, both arr and values are flattened before use.</p><p id="1168" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">As shown below, I appended the new item as a new row to the array. Finally, the <code class="cx pi pj pk pa b">array2</code> of shape (5,2) is used to create a dataframe object <code class="cx pi pj pk pa b">df</code> with Country and Capital columns.</p><pre class="ni nj nk nl nm oz pa pb bp pc bb bk"><span id="b590" class="pd oa fq pa b bg pe pf l pg ph">array2 = np.append(array2, [[“France”,”Paris”]], axis = 0)<br/>print ("array2 after appening new row: \n", array2)<br/><br/>import pandas as pd<br/><br/>df = pd.DataFrame(array2,<br/>                 columns = ["Country", "Capital"])<br/><br/>df</span></pre><h2 id="2d6b" class="nz oa fq bf ob oc od oe of og oh oi oj ms ok ol om mw on oo op na oq or os ot bk">2. Arrays in Excel VBA</h2><p id="6854" class="pw-post-body-paragraph mj mk fq ml b go ou mn mo gr ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne fj bk">Similar to Python, arrays are also a collection of variables in Excel VBA. The lower bound for arrays can start from either 0 or 1 in Excel VBA. The default lower bound is 0. However, the lower bounds for arrays can be specified by stating <code class="cx pi pj pk pa b">Option Base 0</code> or <code class="cx pi pj pk pa b">Option Base 1</code> on the top of<strong class="ml fr"> </strong>each module.</p><p id="65a4" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">To detect the lower bound and upper bound used for an array, one can use <code class="cx pi pj pk pa b">Lbound(array_name)</code> and <code class="cx pi pj pk pa b">Ubound(array_name)</code> respectively.</p><p id="3bcb" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk"><strong class="ml fr">2.1 Declaring an array</strong></p><p id="56c9" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Arrays can be declared publicly (i.e. globally) by using the <code class="cx pi pj pk pa b">Public</code> keyword. Declaring an array or any other variable publicly in Excel VBA allows it to be used in any module or subroutine without declaring again.</p><pre class="ni nj nk nl nm oz pa pb bp pc bb bk"><span id="1dd1" class="pd oa fq pa b bg pe pf l pg ph">Public countries(1 to 4) as String<br/>Public capitals(4) as String<br/>Public countries_visited() as String</span></pre><p id="b4a9" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Alternatively, arrays can be declared locally inside a subroutine simply using the <code class="cx pi pj pk pa b">Dim</code> keyword. These arrays can then be used only inside the specific subroutine.</p><pre class="ni nj nk nl nm oz pa pb bp pc bb bk"><span id="30b2" class="pd oa fq pa b bg pe pf l pg ph">Dim countries(1 to 4) as String<br/>Dim capitals(4) as String</span></pre><p id="5692" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">In the above examples, the size of the arrays is also specified. Specifying 1 to 4 or only 4 both imply the array of size 4.</p><p id="e0c9" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk"><strong class="ml fr">2.2 One-dimensional array</strong></p><p id="a7c4" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">A one-dimensional array is assigned by declaring the number of rows (e.g., 1 to 5) i.e., the number of elements to be contained by an array. An example of creating a 1-dimensional array of the four countries I have lived in is given below. It will print the name of these countries in column A in the worksheet of the Excel file.</p><pre class="ni nj nk nl nm oz pa pb bp pc bb bk"><span id="67e7" class="pd oa fq pa b bg pe pf l pg ph">Option Base 1<br/><br/>Sub array_1d()<br/><br/>countries(1) = "Nepal"<br/>countries(2) = "India"<br/>countries(3) = "Germany"<br/>countries(4) = "Netherlands"<br/><br/>Dim i As Integer<br/>Range("A1").Value = "Country"<br/><br/>For i = 1 To 4<br/>    Range("A" &amp; i + 1).Value = countries(i)<br/>Next i<br/><br/>End Sub</span></pre><p id="739d" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">The output of the running the <code class="cx pi pj pk pa b">array_1d</code> subroutine is as follows:</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div class="nf ng pl"><img src="../Images/98813e9fa922046d745c6bd04c89ee36.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/1*7RhawGQaKtemvxp213872Q.png"/></div><figcaption class="nt nu nv nf ng nw nx bf b bg z dx">Output of array_1d subroutine. Image by Author.</figcaption></figure><p id="082e" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk"><strong class="ml fr">2.2 2-dimensional array</strong></p><p id="c64b" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Two-dimensional arrays are defined by declaring the number of rows and columns. In the following example, I declare a 2-dimensional array called <code class="cx pi pj pk pa b">country_capital</code>. The first element in each row corresponds to the element of the <code class="cx pi pj pk pa b">countries</code>array declared in the previous section. The second element in each row corresponds to their capital cities which have been declared individually in the code below.</p><pre class="ni nj nk nl nm oz pa pb bp pc bb bk"><span id="8844" class="pd oa fq pa b bg pe pf l pg ph">Sub array_2d()<br/><br/>Dim country_capital(4, 2) As String<br/><br/><br/>For i = 1 To 4<br/>    country_capital(i, 1) = countries(i)<br/>Next i<br/><br/>country_capital(1, 2) = "Kathmandu"<br/>country_capital(2, 2) = "New Delhi"<br/>country_capital(3, 2) = "Berlin"<br/>country_capital(4, 2) = "Amsterdam"<br/><br/>Range("B1").Value = "Capital"<br/><br/>For i = 1 To 4<br/>    Range("A" &amp; i + 1).Value = country_capital(i, 1)<br/>    Range("B" &amp; i + 1).Value = country_capital(i, 2)<br/>    <br/>Next i<br/><br/>End Sub</span></pre><p id="b615" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Running this sub-routine returns the following:</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="no np ed nq bh nr"><div class="nf ng pm"><img src="../Images/bf21b342e5a6abf274ac8e8deed484e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ydmFyL6hBF2TdKB-nG1RMw.png"/></div></div><figcaption class="nt nu nv nf ng nw nx bf b bg z dx">Output of array_2d subroutine. Image by Author.</figcaption></figure><p id="5ee9" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk"><strong class="ml fr">2.3 Dynamic arrays</strong></p><p id="749a" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">Dynamic arrays are useful in cases when one is not certain about the size of the array and the size of the array can change in the future. In the code below, I specify two arrays <code class="cx pi pj pk pa b">countries_visited</code> and <code class="cx pi pj pk pa b">population</code> without specifying the size of the arrays. Inside the <code class="cx pi pj pk pa b">dynamic_array</code> subroutine, I specify the size of both of these arrays as 4 by using the <code class="cx pi pj pk pa b">ReDim</code> statement. Next, I specify each element of the array individually based on the four countries I have visited and their populations.</p><pre class="ni nj nk nl nm oz pa pb bp pc bb bk"><span id="c586" class="pd oa fq pa b bg pe pf l pg ph">Option Base 1<br/><br/>Public countries_visited() As String<br/>Public population() As Long<br/><br/>Sub dynamic_array()<br/><br/>Dim wb As Workbook<br/>Dim ws2 As Worksheet<br/>Set wb = ThisWorkbook<br/>Set ws2 = wb.Worksheets("Sheet2")<br/><br/>ReDim countries_visisted(4)<br/>ReDim population(4)<br/><br/>countries_visited(1) = "France"<br/>population(1) = 68<br/><br/>countries_visited(2) = "Spain"<br/>population(2) = 48<br/><br/>countries_visited(3) = "Iran"<br/>population(3) = 88<br/><br/>countries_visited(4) = "Indonesia"<br/>population(4) = 274<br/><br/>End Sub<br/><br/></span></pre><p id="f7e6" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">After a while, I realize that I have also visited one more country (Portugal). I redefine the size of the array while preserving the original contents/elements in these arrays. I increase the size of these arrays by 1. For this, I use the <code class="cx pi pj pk pa b">ReDim Preserve</code> statement as shown below.</p><pre class="ni nj nk nl nm oz pa pb bp pc bb bk"><span id="9c0b" class="pd oa fq pa b bg pe pf l pg ph">ReDim Preserve countries_visited(1 to 5)<br/>ReDim Preserve population(1 to 5)</span></pre><p id="2e21" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">The full code is given below:</p><pre class="ni nj nk nl nm oz pa pb bp pc bb bk"><span id="0110" class="pd oa fq pa b bg pe pf l pg ph">Option Base 1<br/><br/>Public countries_visited() As String<br/>Public population() As Long<br/><br/>Sub dynamic_array()<br/><br/>Dim wb As Workbook<br/>Dim ws2 As Worksheet<br/>Set wb = ThisWorkbook<br/>Set ws2 = wb.Worksheets("Sheet2")<br/><br/>ReDim countries_visisted(4)<br/>ReDim population(4)<br/><br/>countries_visited(1) = "France"<br/>population(1) = 68<br/><br/>countries_visited(2) = "Spain"<br/>population(2) = 48<br/><br/>countries_visited(3) = "Iran"<br/>population(3) = 88<br/><br/>countries_visited(4) = "Indonesia"<br/>population(4) = 274<br/><br/>ws2.Range("A1").Value = "Countries visited"<br/>ws2.Range("B1").Value = "Population (million)"<br/><br/>ReDim Preserve countries_visited(5)<br/>ReDim Preserve population(5)<br/><br/>countries_visited(5) = "Portugal"<br/>population(5) = 10<br/><br/>Dim i As Integer<br/>For i = 2 To 6<br/>    Range("A" &amp; i).Value = countries_visited(i - 1)<br/>    Range("B" &amp; i).Value = population(i - 1)<br/><br/>Next i<br/><br/>End Sub</span></pre><p id="ab64" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">The output of the above code is as shown:</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="no np ed nq bh nr"><div class="nf ng pn"><img src="../Images/53b0ee04a2d02ab0aaa51c25d3e5f899.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qRu9KTGwHnnYpDooQAej-g.png"/></div></div><figcaption class="nt nu nv nf ng nw nx bf b bg z dx">Output of dynamic_array subroutine. Image by Author.</figcaption></figure><p id="7ddd" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk"><strong class="ml fr">2.4 Declaring arrays to store variables of different data types</strong></p><p id="f4db" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">In the section above, the <code class="cx pi pj pk pa b">countries_visited</code> array is declared to store the variables of the <em class="po">String</em> data type and the <code class="cx pi pj pk pa b">population</code> array is declared to store the variables of the <em class="po">Long</em> data type. Similar to Python numpy arrays, it is also possible to store variables of different data types in arrays in Excel VBA. In that case, the array has be to declared as a <code class="cx pi pj pk pa b">Variant</code> type.</p><p id="66e0" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">In the example below, an array <code class="cx pi pj pk pa b">test</code> is declared as a <em class="po">Variant</em>. Its size is specified as 3 using the <code class="cx pi pj pk pa b">ReDim</code> statement. The three elements of types <em class="po">String</em>, <em class="po">Integer,</em> and <em class="po">Date</em> are specified inside the <code class="cx pi pj pk pa b">test</code>. The data types can be identified by passing the variable inside the <code class="cx pi pj pk pa b">TypeName()</code> function.</p><pre class="ni nj nk nl nm oz pa pb bp pc bb bk"><span id="61ea" class="pd oa fq pa b bg pe pf l pg ph">Option Base 0<br/><br/>Sub variant_test()<br/><br/>Dim test() As Variant<br/>ReDim test(3)<br/><br/>test = Array("Germany population in million: ", 83, Date)<br/><br/>Dim i As Integer<br/>For i = 0 To 2 <br/>     Debug.Print "Element " &amp; i &amp; " of test array is: " &amp; test(i) &amp; " of type " &amp; TypeName(test(i))<br/>Next i<br/><br/>End Sub</span></pre><p id="c66a" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">The output is as shown below:</p><figure class="ni nj nk nl nm nn nf ng paragraph-image"><div role="button" tabindex="0" class="no np ed nq bh nr"><div class="nf ng pp"><img src="../Images/11ecf26f56ad68da974831b0b645b8b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xVbgikemUOenuaLH0K0APQ.png"/></div></div><figcaption class="nt nu nv nf ng nw nx bf b bg z dx">Output of variant_test subroutine. Image by Author.</figcaption></figure><h2 id="1cd1" class="nz oa fq bf ob oc od oe of og oh oi oj ms ok ol om mw on oo op na oq or os ot bk">Conclusion</h2><p id="110d" class="pw-post-body-paragraph mj mk fq ml b go ou mn mo gr ov mq mr ms ow mu mv mw ox my mz na oy nc nd ne fj bk">Arrays are a collection of values/variables of one or more data types. Each variable is associated with a particular index number in an array. Arrays can be of one-dimension, two-dimensions, or multiple dimensions. In Python, there is no built-in support for arrays, but one can create arrays using the numpy package. Besides storing the values, the numpy arrays are also very useful in performing matrix operations. In Excel VBA, arrays are very useful in working with large databases of elements. In Excel VBA, an array can be static where the size of the array is pre-defined. Or array can be dynamic where the size of the array is not pre-defined, but it can be specified as we move along and even resized while preserving the elements already stored in the array.</p><p id="09df" class="pw-post-body-paragraph mj mk fq ml b go mm mn mo gr mp mq mr ms mt mu mv mw mx my mz na nb nc nd ne fj bk">The Python notebook, Excel workbook along with VBA scripts are available in this <a class="af ny" href="https://github.com/hbshrestha/Data_Analytics" rel="noopener ugc nofollow" target="_blank">GitHub repository</a>. Thank you for reading!</p></div></div></div></div>    
</body>
</html>