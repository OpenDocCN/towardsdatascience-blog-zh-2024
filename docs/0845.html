<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Fabric Madness</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Fabric Madness</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/fabric-madness-96b84dc5f241?source=collection_archive---------6-----------------------#2024-04-01">https://towardsdatascience.com/fabric-madness-96b84dc5f241?source=collection_archive---------6-----------------------#2024-04-01</a></blockquote><div><div class="em ff fg fh fi fj"/><div class="fk fl fm fn fo"><div class="ab cb"><div class="ci bh ew ex ey ez"><div/><div><h2 id="e025" class="pw-subtitle-paragraph go fq fr bf b gp gq gr gs gt gu gv gw gx gy gz ha hb hc hd cq dx">Predicting basketball games with Microsoft Fabric</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="he hf hg hh hi ab"><div><div class="ab hj"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@roger_noble?source=post_page---byline--96b84dc5f241--------------------------------" rel="noopener follow"><div class="l hk hl by hm hn"><div class="l ed"><img alt="Roger Noble" class="l ep by dd de cx" src="../Images/869b5b0f237f24b119ca6c41c2e31162.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*DSDhBVvFKAUKXJfpbO5beg.jpeg"/><div class="ho by l dd de em n hp eo"/></div></div></a></div></div><div class="hq ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--96b84dc5f241--------------------------------" rel="noopener follow"><div class="l hr hs by hm ht"><div class="l ed"><img alt="Towards Data Science" class="l ep by br hu cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="ho by l br hu em n hp eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hv ab q"><div class="ab q hw"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hx hy bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hz" data-testid="authorName" href="https://medium.com/@roger_noble?source=post_page---byline--96b84dc5f241--------------------------------" rel="noopener follow">Roger Noble</a></p></div></div></div><span class="ia ib" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hx hy dx"><button class="ic id ah ai aj ak al am an ao ap aq ar ie if ig" disabled="">Follow</button></p></div></div></span></div></div><div class="l ih"><span class="bf b bg z dx"><div class="ab cn ii ij ik"><div class="il im ab"><div class="bf b bg z dx ab in"><span class="io l ih">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hz ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--96b84dc5f241--------------------------------" rel="noopener follow"><p class="bf b bg z ip iq ir is it iu iv iw bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="ia ib" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">10 min read</span><div class="ix iy l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Apr 1, 2024</span></div></span></div></span></div></div></div><div class="ab cp iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo"><div class="h k w ea eb q"><div class="ke l"><div class="ab q kf kg"><div class="pw-multi-vote-icon ed io kh ki kj"><div class=""><div class="kk kl km kn ko kp kq am kr ks kt kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l ku kv kw kx ky kz la"><p class="bf b dy z dx"><span class="kl">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kk lb lc ab q ee ld le" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lf"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg></button></div></div></div><div class="ab q jp jq jr js jt ju jv jw jx jy jz ka kb kc kd"><div class="lg k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lh an ao ap ie li lj lk" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep ll cn"><div class="l ae"><div class="ab cb"><div class="lm ln lo lp lq lr ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lh an ao ap ie ls lt le lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lh an ao ap ie ls lt le lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lh an ao ap ie ls lt le lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk ml"><img src="../Images/8c8b9740fc1e7fac643483f34944ee5a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*a7uH6aty29MxCgSE.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by author and ChatGPT. “Design an illustration, focusing on a basketball player in action, the design integrates sports and data analytics themes in a graphic novel style” prompt. ChatGPT, 4, OpenAI, 28 March. 2024. <a class="af nc" href="https://chat.openai.com./" rel="noopener ugc nofollow" target="_blank">https://chat.openai.com.</a></figcaption></figure><p id="59eb" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk"><em class="nz">A Huge thanks to </em><span class="ib"><span class="ib" aria-hidden="false"><a class="oa ic ob" href="https://medium.com/u/1c5c115c8045?source=post_page---user_mention--96b84dc5f241--------------------------------" rel="noopener" target="_blank"><em class="nz">Martim Chaves</em></a></span></span><em class="nz"> who co-authored this post and developed the example scripts.</em></p><p id="9517" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">At the time of writing, it’s basketball season in the United States, and there is a lot of excitement around the men’s and women’s college basketball tournaments. The format is single elimination, so over the course of several rounds, teams are eliminated, till eventually we get a champion. This tournament is not only a showcase of upcoming basketball talent, but, more importantly, a fertile ground for data enthusiasts like us to analyse trends and predict outcomes.</p><p id="5def" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">One of the great things about sports is that there is lots of data available, and we at <a class="af nc" href="https://nobledynamic.com/" rel="noopener ugc nofollow" target="_blank">Noble Dynamic</a> wanted to take a crack at it 🤓.</p><p id="0a01" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">In this series of posts titled <em class="nz">Fabric Madness</em>, we’re going to be diving deep into some of the most interesting features of <a class="af nc" href="https://www.microsoft.com/en-us/microsoft-fabric" rel="noopener ugc nofollow" target="_blank">Microsoft Fabric</a>, for an end-to-end demonstration of how to train and use a machine learning model.</p><p id="c4f6" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">In this first blog post, we’ll be going over:</p><ul class=""><li id="e1f1" class="nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny oc od oe bk">A first look at the data using <a class="af nc" href="https://learn.microsoft.com/en-us/fabric/data-science/data-wrangler" rel="noopener ugc nofollow" target="_blank">Data Wrangler</a>.</li><li id="377b" class="nd ne fr nf b gp of nh ni gs og nk nl nm oh no np nq oi ns nt nu oj nw nx ny oc od oe bk">Exploratory Data Analysis (EDA) and Feature Engineering</li><li id="f7e7" class="nd ne fr nf b gp of nh ni gs og nk nl nm oh no np nq oi ns nt nu oj nw nx ny oc od oe bk">Tracking the performance of different Machine Learning (ML) Models using Experiments</li><li id="efdd" class="nd ne fr nf b gp of nh ni gs og nk nl nm oh no np nq oi ns nt nu oj nw nx ny oc od oe bk">Selecting the best performing model using the ML Model functionality</li></ul><h1 id="e6a2" class="ok ol fr bf om on oo gr op oq or gu os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">The Data</h1><p id="b0df" class="pw-post-body-paragraph nd ne fr nf b gp pg nh ni gs ph nk nl nm pi no np nq pj ns nt nu pk nw nx ny fk bk">The data used was obtained from the on-going Kaggle competition, the details of which can be found <a class="af nc" href="https://www.kaggle.com/competitions/march-machine-learning-mania-2024/overview" rel="noopener ugc nofollow" target="_blank">here</a>, which is licensed under <a class="af nc" href="http://creativecommons.org/licenses/by/4.0/" rel="noopener ugc nofollow" target="_blank">CC BY 4.0</a> [1]</p><p id="e141" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">Among all of the interesting data available, our focus for this case study was on the match-by-match statistics. This data was available for both the regular seasons and the tournaments, going all the way back to 2003. For each match, besides the date, the teams that were playing, and their scores, other relevant features were made available, such as field goals made and personal fouls by each team.</p><h2 id="37b7" class="pl ol fr bf om pm pn po op pp pq pr os nm ps pt pu nq pv pw px nu py pz qa qb bk">Loading the Data</h2><p id="cf7b" class="pw-post-body-paragraph nd ne fr nf b gp pg nh ni gs ph nk nl nm pi no np nq pj ns nt nu pk nw nx ny fk bk">The first step was creating a Fabric <strong class="nf fs">Workspace</strong>. Workspaces in Fabric are one of the fundamental building blocks of the platform, and are used for grouping together related items and for collaboration.</p><p id="3ab3" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">After downloading all of the CSV files available, a <strong class="nf fs">Lakehouse</strong> was created. A Lakehouse, in simple terms, is a mix between a <em class="nz">Database</em> of Tables (structured) and a <em class="nz">Data Lake</em> of Files (unstructured). The big benefit of a Lakehouse is that data is available for every tool in the workspace.</p><p id="4272" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">Uploading the files was done using the UI:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qc"><img src="../Images/5d3b6b5fa058b68609673e75ea3526db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xhVmWnyaLDW4IlAVIUqKrA.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Fig. 1 — Uploading Files. Image by <span class="ib"><span class="ib" aria-hidden="false"><a class="oa ic ob" href="https://medium.com/u/1c5c115c8045?source=post_page---user_mention--96b84dc5f241--------------------------------" rel="noopener" target="_blank">Martim Chaves</a></span></span></figcaption></figure><p id="9a97" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">Now that we have a Lakehouse with the CSV files, it was time to dig in, and get a first look at the data. To do that, we created a Notebook, using the UI, and attached the previously created Lakehouse.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qd"><img src="../Images/f93f56518fd10171dbe0c20ff82564b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ziCchRfBNKimx4IFGoqL4Q.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Fig. 2 — Adding Lakehouse to Notebook. Image by <span class="ib"><span class="ib" aria-hidden="false"><a class="oa ic ob" href="https://medium.com/u/1c5c115c8045?source=post_page---user_mention--96b84dc5f241--------------------------------" rel="noopener" target="_blank">Martim Chaves</a></span></span></figcaption></figure><h2 id="159b" class="pl ol fr bf om pm pn po op pp pq pr os nm ps pt pu nq pv pw px nu py pz qa qb bk">First Look</h2><p id="ca9e" class="pw-post-body-paragraph nd ne fr nf b gp pg nh ni gs ph nk nl nm pi no np nq pj ns nt nu pk nw nx ny fk bk">After a quick data wrangling, it was found that, as expected with data from Kaggle, the quality was great. With no duplicates or missing values.</p><p id="b6d4" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">For this task we used <a class="af nc" href="https://learn.microsoft.com/en-us/fabric/data-science/data-wrangler" rel="noopener ugc nofollow" target="_blank">Data Wrangler</a>, a tool built into Microsoft Fabric notebooks. Once an initial DataFrame has been created (Spark or Pandas supported), Data Wrangler becomes available to use and can attach to any DataFrame in the Notebook. What’s great is that it allows for easy analysis of loaded DataFrames.</p><p id="3b1b" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">In a Notebook, after reading the files into PySpark DataFrames, in the “Data” section, the “Transform DataFrame in Data Wrangler” was selected, and from there the several DataFrames were explored. Specific DataFrames can be chosen, carrying out a careful inspection.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qe"><img src="../Images/ae7bc9853f50fa142857c6345255b181.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zW7mE4fPStxlK7XJ6FE02A.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Fig. 3 — Opening Data Wrangler. Image by <span class="ib"><span class="ib" aria-hidden="false"><a class="oa ic ob" href="https://medium.com/u/1c5c115c8045?source=post_page---user_mention--96b84dc5f241--------------------------------" rel="noopener" target="_blank">Martim Chaves</a></span></span></figcaption></figure><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qc"><img src="../Images/c89f0f109d2fd114c56c931e36e23861.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*a6RYypImjJGM6or9ANnTVg.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Fig. 4 — Analysing the DataFrame with Data Wrangler. Image by <span class="ib"><span class="ib" aria-hidden="false"><a class="oa ic ob" href="https://medium.com/u/1c5c115c8045?source=post_page---user_mention--96b84dc5f241--------------------------------" rel="noopener" target="_blank">Martim Chaves</a></span></span></figcaption></figure><p id="d174" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">In the centre, we have access to all of the rows of the loaded DataFrame. On the right, a <strong class="nf fs">Summary</strong> tab, showing that indeed there are no duplicates or missing values. Clicking in a certain column, summary statistics of that column will be shown.</p><p id="726e" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">On the left, in the <strong class="nf fs">Operations</strong> tab, there are several pre-built operations that can be applied to the DataFrame. The operations feature many of the most common data wrangling tasks, such as filtering, sorting, and grouping, and is a quick way to generate boilerplate code for these tasks.</p><p id="f272" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">In our case, the data was already in good shape, so we moved on to the EDA stage.</p><h2 id="d0f5" class="pl ol fr bf om pm pn po op pp pq pr os nm ps pt pu nq pv pw px nu py pz qa qb bk">Exploratory Data Analysis</h2><p id="2b33" class="pw-post-body-paragraph nd ne fr nf b gp pg nh ni gs ph nk nl nm pi no np nq pj ns nt nu pk nw nx ny fk bk">A short Exploratory Data Analysis (EDA) followed, with the goal of getting a general idea of the data. Charts were plotted to get a sense of the distribution of the data and if there were any statistics that could be problematic due to, for example, very long tails.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qf"><img src="../Images/6d8f47db68ff58f8e5820bb4d9136cd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*L0k0YDQ81kmMkUtN-lJ74g.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Fig. 5 — Histogram of field goals made. Image by <span class="ib"><span class="ib" aria-hidden="false"><a class="oa ic ob" href="https://medium.com/u/1c5c115c8045?source=post_page---user_mention--96b84dc5f241--------------------------------" rel="noopener" target="_blank">Martim Chaves</a></span></span></figcaption></figure><p id="b8c1" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">At a quick glance, it was found that the data available from the regular season had normal distributions, suitable to use in the creation of features. Knowing the importance that good features have in creating solid predictive systems, the next sensible step was to carry out feature engineering to extract relevant information from the data.</p><p id="4c60" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">The goal was to create a dataset where each sample’s input would be a set of features for a game, containing information of both teams. For example, both teams average field goals made for the regular season. The target for each sample, the desired output, would be 1 if Team 1 won the game, or 0 if Team 2 won the game (which was done by subtracting the scores). Here’s a representation of the dataset:</p><h2 id="c782" class="pl ol fr bf om pm pn po op pp pq pr os nm ps pt pu nq pv pw px nu py pz qa qb bk">Feature Engineering</h2><p id="f2a7" class="pw-post-body-paragraph nd ne fr nf b gp pg nh ni gs ph nk nl nm pi no np nq pj ns nt nu pk nw nx ny fk bk">The first feature that we decided to explore was win rate. Not only would it be an interesting feature to explore, but it would also provide a baseline score. This initial approach employed a simple rule: the team with the higher win rate would be predicted as the winner. This method provides a fundamental baseline against which the performance of more sophisticated predictive systems can be compared to.</p><p id="a77f" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">To evaluate the accuracy of our predictions across different models, we adopted the Brier score. The Brier score is the mean of the square of the difference between the predicted probability (p) and the actual outcome (o) for each sample, and can be described by the following formula:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qg"><img src="../Images/4555570882e57072bf20b4054088e29f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t8YVTS2mQ8wtva_DbLPYLA.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by the author</figcaption></figure><p id="74fc" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">The predicted probability will vary between 0 and 1, and the actual outcome will either be 0 or 1. Thus, the Brier score will always be between 0 and 1. As we want the predicted probability to be as close to the actual outcome as possible, the lower the Brier score, the better, with 0 being the perfect score, and 1 the worst.</p><p id="4300" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">For the baseline, the previously mentioned dataset structure was followed. Each sample of the dataset was a match, containing the win rates for the regular season for Team 1 and Team 2. The actual outcome was considered 1 if Team 1 won, or 0 if Team 2 won. To simulate a probability, the prediction was a normalised difference between T1’s win rate and T2’s win rate. For the maximum value of the difference between the win rates, the prediction would be 1. For the minimum value, the prediction would be 0.</p><p id="5df2" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">After calculating the win rate, and then using it to predict the outcomes, we got a Brier score of <strong class="nf fs">0.23</strong>. Considering that guessing at random leads to a Brier score of <strong class="nf fs">0.25</strong>, it’s clear that this feature alone is not very good 😬.</p><p id="e187" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">By starting with a simple baseline, it clearly highlighted that more complex patterns were at play. We went ahead to developed another 42 features, in preparation for utilising more complex algorithms, machine learning models, that might have a better chance.</p><p id="0926" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">It was then time to create machine learning models!</p><h1 id="55cf" class="ok ol fr bf om on oo gr op oq or gu os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Models &amp; Machine Learning Experiments</h1><p id="1c1d" class="pw-post-body-paragraph nd ne fr nf b gp pg nh ni gs ph nk nl nm pi no np nq pj ns nt nu pk nw nx ny fk bk">For the models, we opted for simple Neural Networks (NN). To determine which level of complexity would be best, we created three different NNs, with an increasing number of layers and hyper-parameters. Here’s an example of a small NN, one that was used:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qh"><img src="../Images/e1e5cdf6b3a9f592f8b1e64c630c99da.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hwd8zxJrdTALrttuXD4lGQ.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Fig. 6 — Diagram of a Neural Network. Image by <span class="ib"><span class="ib" aria-hidden="false"><a class="oa ic ob" href="https://medium.com/u/1c5c115c8045?source=post_page---user_mention--96b84dc5f241--------------------------------" rel="noopener" target="_blank">Martim Chaves</a></span></span> using <a class="af nc" href="https://app.diagrams.net/" rel="noopener ugc nofollow" target="_blank">draw.io</a></figcaption></figure><p id="1a49" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">If you’re familiar with NNs, feel free to skip to the <a class="af nc" href="https://nobledynamic.com/posts/fabric-madness-1/#what-is-an-experiment" rel="noopener ugc nofollow" target="_blank">Experiments</a>! If you’re unfamiliar with NNs think of them as a set of layers, where each layer acts as a filter for relevant information. Data passes through successive layers, in a step-by-step fashion, where each layer has inputs and outputs. Data moves through the network in one direction, from the first layer (the model’s input) to the last layer (the model’s output), without looping back, hence the <strong class="nf fs">Sequential</strong> function.</p><p id="2da1" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">Each layer is made up of several neurons, that can be described as nodes. The model’s input, the first layer, will contain as many neurons as there are features available, and each neuron will hold the value of a feature. The model’s output, the last layer, in binary problems such as the one we’re tackling, will only have 1 neuron. The value held by this neuron should be 1 if the model is processing a match where Team 1 won, or 0 if Team 2 won. The intermediate layers have an <em class="nz">ad hoc</em> number of neurons. In the example in the code snippet, 64 neurons were chosen.</p><p id="3ed7" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">In a <strong class="nf fs">Dense</strong> layer, as is the case here, each neuron in the layer is connected to every neuron in the preceding layer. Fundamentally, each neuron <strong class="nf fs">processes</strong> the information provided by the neurons from the previous layer.</p><p id="d102" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">The processing of the previous layer’s information requires an <strong class="nf fs">activation function</strong>. There are many types of activation functions — <strong class="nf fs">ReLU</strong>, standing for Rectified Linear Unit, is one of them. It allows only positive values to pass and sets negative values to zero, making it effective for many types of data.</p><p id="856a" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">Note that the final activation function is a <strong class="nf fs">sigmoid</strong> function — this converts the output to a number between 0 and 1. This is crucial for binary classification tasks, where you need the model to express its output as a probability.</p><p id="0667" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">Besides these small models, medium and large models were created, with an increasing number of layers and parameters. The size of a model affects its ability to capture complex patterns in the data, with larger models generally being more capable in this regard. However, larger models also require more data to learn effectively — if there’s not enough data, issues may occur. Finding the right size is sometimes only possible through experimentation, by training different models and comparing their performance to identify the most effective configuration.</p><p id="dd76" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">The next step was running the experiments ⚗️!</p><h2 id="3c0a" class="pl ol fr bf om pm pn po op pp pq pr os nm ps pt pu nq pv pw px nu py pz qa qb bk">What is an Experiment?</h2><p id="5f33" class="pw-post-body-paragraph nd ne fr nf b gp pg nh ni gs ph nk nl nm pi no np nq pj ns nt nu pk nw nx ny fk bk">In Fabric, an Experiment can be seen as a group of related runs, where a run is an execution of a code snippet. In this context, a run is a training of a model. For each run, a model will be trained with a different set of hyper-parameters. The set of hyper-parameters, along with the final model score, is logged, and this information is available for each run. Once enough runs have been completed, the final model scores can be compared, so that the best version of each model can be selected.</p><p id="6a81" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">Creating an Experiment in Fabric can be done via the UI or directly from a Notebook. The Experiment is essentially a wrapper for <a class="af nc" href="https://mlflow.org/" rel="noopener ugc nofollow" target="_blank">MLFlow Experiments</a>. One of the great things about using Experiments in Fabric is that the results can be shared with others. This makes it possible to collaborate and allow others to participate in experiments, either writing code to run experiments, or analysing the results.</p><h2 id="5a7a" class="pl ol fr bf om pm pn po op pp pq pr os nm ps pt pu nq pv pw px nu py pz qa qb bk">Creating an Experiment</h2><p id="bb75" class="pw-post-body-paragraph nd ne fr nf b gp pg nh ni gs ph nk nl nm pi no np nq pj ns nt nu pk nw nx ny fk bk">Using the UI to create an Experiment simply select Experiment from the <strong class="nf fs">+ New</strong> button, and choose a name.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk qi"><img src="../Images/16babe28e7df7b00cf239df62d51f397.png" data-original-src="https://miro.medium.com/v2/resize:fit:1162/format:webp/1*sTEbKcY-NzJL48Y21A7sJw.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Fig. 7 — Creating an Experiment using the UI. Image by <span class="ib"><span class="ib" aria-hidden="false"><a class="oa ic ob" href="https://medium.com/u/1c5c115c8045?source=post_page---user_mention--96b84dc5f241--------------------------------" rel="noopener" target="_blank">Martim Chaves</a></span></span></figcaption></figure><p id="c742" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">When training each of the models, the hyper-parameters are logged with the experiment, as well as the final score. Once completed we can see the results in the UI, and compare the different runs to see which model performed best.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qj"><img src="../Images/05d17570644c450b37baa0c3a2019637.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zyNYpiPUXP-FLf0DgOFWHw.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Fig. 8 — Comparing different runs. Image by <span class="ib"><span class="ib" aria-hidden="false"><a class="oa ic ob" href="https://medium.com/u/1c5c115c8045?source=post_page---user_mention--96b84dc5f241--------------------------------" rel="noopener" target="_blank">Martim Chaves</a></span></span></figcaption></figure><p id="88bf" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">After that we can select the best model and use it to make the final prediction. When comparing the three models, the best Brier score was <strong class="nf fs">0.20</strong>, a slight improvement 🎉!</p><h1 id="2a27" class="ok ol fr bf om on oo gr op oq or gu os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Conclusion</h1><p id="09ba" class="pw-post-body-paragraph nd ne fr nf b gp pg nh ni gs ph nk nl nm pi no np nq pj ns nt nu pk nw nx ny fk bk">After loading and analysing data from this year’s US major college basketball tournament, and creating a dataset with relevant features, we were able to predict the outcome of the games using a simple Neural Network. Experiments were used to compare the performance of different models. Finally, the best performing model was selected to carry out the final prediction.</p><p id="1468" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk">In the next post we will go into detail on how we created the features using pyspark. Stay tuned for more! 👋</p><p id="11b8" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk"><strong class="nf fs">The full source code for this post can be found </strong><a class="af nc" href="https://dev.azure.com/nobledynamic/_git/FabricMadness" rel="noopener ugc nofollow" target="_blank"><strong class="nf fs">here</strong></a><strong class="nf fs">.</strong></p></div></div></div><div class="ab cb qk ql qm qn" role="separator"><span class="qo by bm qp qq qr"/><span class="qo by bm qp qq qr"/><span class="qo by bm qp qq"/></div><div class="fk fl fm fn fo"><div class="ab cb"><div class="ci bh ew ex ey ez"><p id="6496" class="pw-post-body-paragraph nd ne fr nf b gp ng nh ni gs nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fk bk"><em class="nz">Originally published at </em><a class="af nc" href="https://nobledynamic.com/posts/fabric-madness-1/" rel="noopener ugc nofollow" target="_blank"><em class="nz">https://nobledynamic.com</em></a><em class="nz"> on April 1, 2024.</em></p><h2 id="9c99" class="pl ol fr bf om pm pn po op pp pq pr os nm ps pt pu nq pv pw px nu py pz qa qb bk">References</h2><p id="273c" class="pw-post-body-paragraph nd ne fr nf b gp pg nh ni gs ph nk nl nm pi no np nq pj ns nt nu pk nw nx ny fk bk">[1] Jeff Sonas, Ryan Holbrook, Addison Howard, Anju Kandru. (2024). March Machine Learning Mania 2024. Kaggle. <a class="af nc" href="https://kaggle.com/competitions/march-machine-learning-mania-2024" rel="noopener ugc nofollow" target="_blank">https://kaggle.com/competitions/march-machine-learning-mania-2024</a></p></div></div></div></div>    
</body>
</html>