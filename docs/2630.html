<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Explore Solvable and Unsolvable Equations with Python</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Explore Solvable and Unsolvable Equations with Python</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/explore-solvable-and-unsolvable-equations-with-python-661ac11f4f20?source=collection_archive---------2-----------------------#2024-10-29">https://towardsdatascience.com/explore-solvable-and-unsolvable-equations-with-python-661ac11f4f20?source=collection_archive---------2-----------------------#2024-10-29</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="df53" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">Find closed-form solutions when possible — use numerical methods when necessary</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@carlmkadie?source=post_page---byline--661ac11f4f20--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Carl M. Kadie" class="l ep by dd de cx" src="../Images/9dbe27c76e9567136e5a7dc587f1fb15.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*RGViuuvF-_GQ-LXuVDQN7w.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--661ac11f4f20--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://medium.com/@carlmkadie?source=post_page---byline--661ac11f4f20--------------------------------" rel="noopener follow">Carl M. Kadie</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--661ac11f4f20--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">15 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Oct 29, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj la lb ab q ee lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lf k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lg an ao ap id lh li lj" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep lk cn"><div class="l ae"><div class="ab cb"><div class="ll lm ln lo lp lq ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj mk"><img src="../Images/7c1f799be7465f76240afc9db30d3020.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*52jeuQY6rpW68rtnwdepRg.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">A Python Refereeing an Italian Renaissance Mathematics Duel — Source: <a class="af nb" href="https://openai.com/dall-e-2/" rel="noopener ugc nofollow" target="_blank">https://openai.com/dall-e-2/</a>. All other figures from the author.</figcaption></figure><p id="7c0e" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk"><strong class="ne fr">Why can we solve some equations easily, while others seem impossible? And another thing: why is this knowledge hidden from us?</strong></p><p id="0e09" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">As data scientists, applied scientists, and engineers, we often create mathematical models. For example, consider the model: <em class="ny">y = x²</em>. Given a value for <em class="ny">x, w</em>e can apply it forward to compute <em class="ny">y</em>. For instance, if <em class="ny">x = 3</em>, then <em class="ny">y = 9</em>.</p><p id="3df1" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">We can also apply this model backward. Starting with <em class="ny">y = x²</em>, we rearrange to solve for <em class="ny">x</em>: <em class="ny">x = ±√y</em>. If <em class="ny">y = 9</em>, then <em class="ny">x = ±3</em>. The expression <em class="ny">x = ±√y</em> is an example of a <strong class="ne fr">closed-form solution</strong> — an expression that uses a finite combination of standard operations and functions.</p><p id="3251" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">However, not all models are so straightforward. Sometimes, we encounter equations where we can’t simply “solve for <em class="ny">x</em>” and get a closed-form expression. In such cases, we might hear, “That’s not solvable — you need numerical methods.” Numerical methods are powerful. They can provide precise approximations. Still, it frustrates me (and perhaps you) that no one ever seems to explain when closed-form solutions are possible and when they aren’t.</p><p id="4751" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">The great Johannes Kepler shared our frustration. When studying planetary motion, he created this model:</p><ul class=""><li id="218e" class="nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx nz oa ob bk"><em class="ny">y</em> = <em class="ny">x</em> −c sin(<em class="ny">x</em>)</li></ul><p id="28a7" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">This equation converts a body’s position along its orbit (<em class="ny">x)</em> into its time along the orbit (<em class="ny">y)</em>. Kepler sought a closed-form solution for <em class="ny">x</em> to turn time into a position. However, even 400 years later, the best we have are numerical methods.</p><p id="cd5a" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">In this article, we’ll build intuition about when to expect a closed-form solution. The only way to determine this rigorously is by using advanced mathematics — such as Galois theory, transcendental number theory, and algebraic geometry. These topics go far beyond what we, as applied scientists and engineers, typically learn in our training.</p><p id="9406" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Instead of diving into these advanced fields, we’ll cheat. Using <strong class="ne fr">SymPy</strong>, a Python-based computer algebra system, we’ll explore different classes of equations to see which it can solve with a closed-form expression. For completeness, we’ll also apply numerical methods.</p><p id="9cc9" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">We’ll explore equations that combine polynomials, exponentials, logarithms, and trigonometric functions. Along the way, we’ll discover specific combinations that often resist closed-form solutions. We’ll see that if you want to create an equation <strong class="ne fr">with</strong> (or <strong class="ne fr">without</strong>) a closed-form solution, you should <strong class="ne fr">avoid</strong> (or <strong class="ne fr">try</strong>) the following:</p><ul class=""><li id="c4d4" class="nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx nz oa ob bk">Fifth degree and higher polynomials</li><li id="93cf" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk">Mixing <em class="ny">x</em> with exp(<em class="ny">x</em>) or log(<em class="ny">x</em>) — if Lambert’s <em class="ny">W</em> function is off-limits</li><li id="fff7" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk">Combining exp(<em class="ny">x</em>) and log(<em class="ny">x</em>) within the same equation</li><li id="10ec" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk">Some pairs of trigonometric functions with commensurate frequencies</li><li id="4a52" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk">Many pairs of trigonometric functions with non-commensurate frequencies</li><li id="2edb" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk">Mixing trigonometric functions with <em class="ny">x</em>, exp(x), or log(x)</li></ul><blockquote class="oh oi oj"><p id="cc1a" class="nc nd ny ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Aside 1: I’m not a mathematician, and my SymPy scripts are not higher mathematics. If you find any mistakes or overlooked resources, forgive my oversight. Please share them with me, and I’ll gladly add a note.</p><p id="befc" class="nc nd ny ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Aside 2: Welch Lab’s recent video, <a class="af nb" href="https://www.youtube.com/watch?v=hBkmyJ3TE0g" rel="noopener ugc nofollow" target="_blank">Kepler’s Impossible Equation</a>, reminded me of my frustration about not knowing when an equation can be solved in a closed form. The video sparked the investigation that follows and provides our first example.</p></blockquote><h1 id="c4b1" class="ok ol fq bf om on oo gq op oq or gt os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Kepler’s Equation</h1><p id="23fe" class="pw-post-body-paragraph nc nd fq ne b go pg ng nh gr ph nj nk nl pi nn no np pj nr ns nt pk nv nw nx fj bk">Imagine you are Johannes Kepler’s research programmer. He has created the following model of orbital motion:</p><p id="b96e" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk"><em class="ny">y</em> = <em class="ny">x</em> −<em class="ny">c</em> sin(<em class="ny">x</em>)</p><p id="8914" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">where:</p><ul class=""><li id="4f75" class="nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx nz oa ob bk"><em class="ny">x</em> is the body’s position along its orbit. We measure this position as an angle (in radians). The angle starts at 0 radians when the body is closest to the Sun. When the body has covered ¼ of its orbit’s distance, the angle is π/2 radians (90°). When it has covered half of its orbit’s distance, the angle is π (180°), and so on. Recall that radians measure angles from 0 to 2π rather than from 0 to 360°.</li><li id="cadf" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk"><em class="ny">c</em> is the orbit’s eccentricity, ranging from 0 (a perfect circle) to just under 1 (a highly elongated ellipse). Suppose Kepler has observed a comet with c = 0.967.</li><li id="b523" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk"><em class="ny">y</em> is the body’s time along its orbit. We measure this time as an angle (in radians). For instance, if the comet has an orbital period of 76 Earth years, then π/2 (90°) corresponds to ¼ of 76 years, or 19 years. A time of π (180°) corresponds to ½ of 76 years, or 38 years. A time of 2π (360°) is the full 76-year orbital period.</li></ul><p id="3aa4" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">This diagram shows the comet’s position at π/2 radians (90°), which is ¼ of the way along its orbit:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div class="mi mj pl"><img src="../Images/9d4348de333abf529adc5317f2f0455f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1368/format:webp/1*IncK1FIySjqDWwhZ48I-nw.png"/></div></figure><p id="1a60" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Kepler asks for the time when the comet reaches position π/2 radians (90°). You create and run this Python code:</p><pre class="ml mm mn mo mp pm pn po bp pp bb bk"><span id="36a0" class="pq ol fq pn b bg pr ps l pt pu">import numpy as np<br/><br/>def kepler_equation(x):<br/>    return x - c * np.sin(x)<br/><br/>c = 0.967<br/>position_radians = np.pi / 2 # aka 90 degrees<br/>time_radians = kepler_equation(position_radians)<br/>orbital_period_earth_years = 76<br/><br/>t_earth_years = (time_radians / (2 * np.pi)) * orbital_period_earth_years<br/>print(f"It takes approximately {t_earth_years:.2f} Earth years for the comet to move from 0 to π/2 radians.")</span></pre><p id="9a24" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">You report back to Kepler:</p><pre class="ml mm mn mo mp pm pn po bp pp bb bk"><span id="d6dd" class="pq ol fq pn b bg pr ps l pt pu">It takes approximately 7.30 Earth years for the comet to move from 0 to π/2 radians.</span></pre><blockquote class="oh oi oj"><p id="f306" class="nc nd ny ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Aside: The comet covers 25% of its orbit distance in under 10% of its orbital period because it speeds up when closer to the Sun.</p></blockquote><p id="50fb" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">No good deed goes unpunished. Kepler, fascinated by the result, assigns you a new task: “Can you tell me how far along its orbit the comet is after 20 Earth years? I want to know the position in radians.”</p><p id="8aed" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">“No problem,” you think. “I’ll just use a bit of high school algebra.”</p><p id="4460" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">First, you convert 20 Earth years into radians:</p><ul class=""><li id="9cd5" class="nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx nz oa ob bk">time_radians = (20 / 76) × 2π = (10 / 19)π</li></ul><p id="a794" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Next, you rearrange Kepler’s equation, setting it equal to 0.</p><ul class=""><li id="4044" class="nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx nz oa ob bk"><em class="ny">x</em> − 0.967 sin(<em class="ny">x</em>) − (10 / 19)π = 0</li></ul><p id="c0c9" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Now you want to find the value of <em class="ny">x</em> that makes this equation true. You decide to graph the equation to see where it crosses zero:</p><pre class="ml mm mn mo mp pm pn po bp pp bb bk"><span id="4a53" class="pq ol fq pn b bg pr ps l pt pu">import numpy as np<br/>import matplotlib.pyplot as plt<br/><br/>c = 0.967<br/>time_earth_years = 20<br/>orbital_period_earth_years = 76<br/>time_radians = (time_earth_years / orbital_period_earth_years) * 2 * np.pi<br/><br/>def function_to_plot(x):<br/>    return x - c * np.sin(x) - time_radians<br/><br/>x_vals = np.linspace(0, 2 * np.pi, 1000)<br/>function_values = function_to_plot(x_vals)<br/>plt.figure(figsize=(10, 6))<br/>plt.axhline(0, color='black', linestyle='--') # dashed horizontal line at y=0<br/>plt.xlabel("Position (radians)")<br/>plt.ylabel("Function Value")<br/>plt.title("Graph of x - c sin(x) - y to Find the Root")<br/>plt.grid(True)<br/><br/>plt.plot(x_vals, function_values)<br/>plt.show()</span></pre><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj pv"><img src="../Images/cb926a0e01695cc42dae35835f1951cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1atEag7gG7MAVIs4crq3bQ.png"/></div></div></figure><p id="913b" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">So far, so good. The graph shows that a solution for <em class="ny">x</em> exists. But when you try to rearrange the equation to solve for <em class="ny">x</em> using algebra, you hit a wall. How do you isolate <em class="ny">x</em> when you have a combination of <em class="ny">x</em> and sin(<em class="ny">x</em>)?</p><p id="daea" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">“That’s okay,” you think. “We’ve got Python, and Python has the <a class="af nb" href="https://www.sympy.org/" rel="noopener ugc nofollow" target="_blank">SymPy package</a>,” a powerful and free computer algebra system.</p><p id="fb47" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">You pose the problem to SymPy:</p><pre class="ml mm mn mo mp pm pn po bp pp bb bk"><span id="19fc" class="pq ol fq pn b bg pr ps l pt pu"># Warning: This code will fail.<br/>import sympy as sym<br/>from sympy import pi, sin<br/>from sympy.abc import x<br/><br/>c = 0.967<br/>time_earth_years = 20<br/>orbital_period_earth_years = 76<br/><br/>time_radians = (time_earth_years / orbital_period_earth_years) * 2 * pi<br/>equation = x - c * sin(x) - time_radians<br/><br/>solution = sym.solve(equation, x)<br/>#^^^^^^^^^^^^^error^^^^^^^^^^^^^^<br/>print(solution)</span></pre><p id="929d" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Unfortunately, it replies with an error:</p><pre class="ml mm mn mo mp pm pn po bp pp bb bk"><span id="cdc3" class="pq ol fq pn b bg pr ps l pt pu">NotImplementedError: multiple generators [x, sin(x)]<br/>No algorithms are implemented to solve equation x - 967*sin(x)/1000 - 10*pi/19</span></pre><p id="fc62" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">SymPy is quite good at solving equations, but not all equations can be solved in what’s called <strong class="ne fr">closed form</strong> — a solution expressed in a finite number of <strong class="ne fr">elementary functions</strong> such as addition, multiplication, roots, exponentials, logarithms, and trigonometric functions. When we combine a term such as <em class="ny">x</em> with a trigonometric term like sin⁡(<em class="ny">x</em>), isolating <em class="ny">x</em> can become fundamentally impossible. In other words, these types of mixed equations often lack a closed-form solution.</p><p id="5cc7" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">That’s okay. From the graph, we know a solution exists. SymPy can get us arbitrarily close to that solution using numerical methods. We use SymPy’s <code class="cx pw px py pn b">nsolve()</code>:</p><pre class="ml mm mn mo mp pm pn po bp pp bb bk"><span id="2edd" class="pq ol fq pn b bg pr ps l pt pu">import sympy as sym<br/>from sympy import pi, sin<br/>from sympy.abc import x<br/><br/>c = 0.967<br/>time_earth_years = 20<br/>orbital_period_earth_years = 76<br/>time_radians = (time_earth_years / orbital_period_earth_years) * 2 * pi<br/>equation = x - c * sin(x) - time_radians<br/><br/>initial_guess = 1.0   # Initial guess for the numerical solver<br/>position_radians = sym.nsolve(equation, x, initial_guess)<br/>print(f"After {time_earth_years} Earth years, the comet will travel {position_radians:.4f} radians ({position_radians * 180 / pi:.2f}°) along its orbit.")</span></pre><p id="dfec" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Which reports:</p><pre class="ml mm mn mo mp pm pn po bp pp bb bk"><span id="ce28" class="pq ol fq pn b bg pr ps l pt pu">After 20 Earth years, the comet will travel 2.3449 radians (134.35°) along its orbit.</span></pre><p id="fce8" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">We can summarize the results in a table:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div class="mi mj pz"><img src="../Images/e3ef29a79ea4e43bbefffc9df2e89bdf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1256/format:webp/1*7xIwk9Wy4p-Vz_EpoCxRKA.png"/></div></figure><p id="6da6" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Are we sure there is not a closed-form solution? We add a question mark to our “No” answer. This reminds us that SymPy’s failure is not a mathematical proof that no closed-form solution exists. We label the last column “<strong class="ne fr">A</strong> Numeric” to remind ourselves that it represents one numerical solution. There could be more.</p></div></div></div><div class="ab cb qa qb qc qd" role="separator"><span class="qe by bm qf qg qh"/><span class="qe by bm qf qg qh"/><span class="qe by bm qf qg"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="3249" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">In this section, we explored Kepler’s equation and discovered the challenge of solving it in closed form. Python’s SymPy package confirmed our struggle, and in the end, we had to rely on a numerical solution.</p><p id="3670" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">This gives us one example of an equation with no apparent closed-form solution. But is this typical? Are there classes of equations where we can always — or never — find a closed-form solution? Let’s dig deeper by exploring another kind of equation: polynomials.</p><h1 id="2e69" class="ok ol fq bf om on oo gq op oq or gt os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Polynomials</h1><p id="fe9d" class="pw-post-body-paragraph nc nd fq ne b go pg ng nh gr ph nj nk nl pi nn no np pj nr ns nt pk nv nw nx fj bk"><a class="af nb" href="https://en.wikipedia.org/wiki/Polynomial" rel="noopener ugc nofollow" target="_blank">Polynomial</a> equations such as <em class="ny">x</em>² − <em class="ny">x</em> − 1 = 0 are the reliable hammer of mathematical modeling — straightforward but powerful. We all learn how to solve degree-two polynomials (those with <em class="ny">x</em>², “quadratic”) in school.</p><p id="4989" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">500 years ago, during the Renaissance in Italy, solving polynomials of higher degrees became a form of public entertainment. Mathematicians like Tartaglia and Cardano competed for glory and recognition in <a class="af nb" href="https://old.maa.org/press/maa-reviews/the-secret-formula-how-a-mathematical-duel-inflamed-renaissance-italy-and-uncovered-the-cubic" rel="noopener ugc nofollow" target="_blank">public math duels</a>. These contests led to solutions for degree-three (cubic) and degree-four (quartic) polynomials. But what about degree five?</p><p id="99a9" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Let’s use SymPy to investigate a sample of polynomials:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qi"><img src="../Images/0f3e71215f730a7a7cffd72d197facf6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IjeseEtKMRCqlX6An-OSbA.png"/></div></div></figure><p id="7919" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">For polynomials up to degree four, we can always find closed-form elementary solutions. Specifically, these solutions require only a finite expression of basic arithmetic operations and roots (such as square roots or cube roots).</p><p id="dc47" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">The number of solutions will never exceed the degree of the polynomial. However, some solutions may involve <em class="ny">i</em>, the square root of −1, which represents complex numbers. More on that in a moment.</p><p id="7399" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">And what about degree-five polynomials and beyond? Can we always find closed-form solutions? The answer is mixed. Sometimes, we can. When a closed-form solution exists — for example, for <em class="ny">x</em>⁵+1=0 above — SymPy typically finds it.</p><p id="6501" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">However, in other cases, such as with <em class="ny">x</em>⁵-<em class="ny">x</em>-1=0, SymPy cannot find a closed-form, elementary solution. Évariste Galois famously demonstrated the impossibility of closed-form solutions for general higher-degree polynomial. However, SymPy’s failure on a specific equation is not a proof that no closed-form solution exists. So, for this example, we add a question mark and answer “No?”.</p><p id="5fcd" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">To explore further, let’s see exactly what SymPy does when given <em class="ny">x</em>⁵-<em class="ny">x</em>-1=0:</p><pre class="ml mm mn mo mp pm pn po bp pp bb bk"><span id="961f" class="pq ol fq pn b bg pr ps l pt pu">import sympy as sym<br/>from sympy.abc import x<br/><br/>equation = x**5 - x - 1<br/>solution = sym.solve(equation, x)<br/>print(solution)</span></pre><p id="4bce" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">The output is:</p><pre class="ml mm mn mo mp pm pn po bp pp bb bk"><span id="bbd3" class="pq ol fq pn b bg pr ps l pt pu">[CRootOf(x**5 - x - 1, 0), CRootOf(x**5 - x - 1, 1), CRootOf(x**5 - x - 1, 2), CRootOf(x**5 - x - 1, 3), CRootOf(x**5 - x - 1, 4)]</span></pre><p id="9c80" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Yikes! SymPy is clearly cheating here. It’s saying, “Oh, you want a closed form? No problem! I’ll just define a new, one-off function called <code class="cx pw px py pn b">CRootOf(x**5 - x - 1, 0)</code> and call that the answer.”</p><p id="097c" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">This is cheating because it doesn’t answer the question of interest. SymPy is essentially giving a new name to an unsolved problem and claiming success.</p><p id="3a52" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">SymPy, of course, has good reasons for producing its answer this way. For one thing, we can now easily find a numerical solution:</p><pre class="ml mm mn mo mp pm pn po bp pp bb bk"><span id="cea0" class="pq ol fq pn b bg pr ps l pt pu">from sympy import N, CRootOf<br/><br/>print(N(CRootOf(x**5 - x - 1, 0)))</span></pre><p id="5c36" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Prints <code class="cx pw px py pn b">1.16730397826142</code>.</p><p id="ace8" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk"><strong class="ne fr">Solutions Even When No Real Solutions Exist: </strong>One surprising thing about polynomial equations is that you can always find solutions — at least numerically — even when no real solutions exist!</p><p id="c67d" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Consider this simple equation of degree two:</p><ul class=""><li id="1044" class="nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx nz oa ob bk"><em class="ny">x</em>² + 1 = 0</li></ul><p id="476f" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">If we plot this equation, it never crosses the <em class="ny">x</em>-axis, indicating no real solutions.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div class="mi mj qj"><img src="../Images/58fc36a03afc02e8aa37b6758d984eb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1062/format:webp/1*FbeG_l1X3w-k8T39jyhwqw.png"/></div></figure><p id="fe65" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">However, using SymPy, we can find numerical solutions for any polynomial. For example:</p><pre class="ml mm mn mo mp pm pn po bp pp bb bk"><span id="8163" class="pq ol fq pn b bg pr ps l pt pu">from sympy import solve, Eq, CRootOf, N, degree<br/>from sympy.abc import x<br/><br/>equation = Eq(x**2 + 1, 0)<br/>numerical_solution = [N(CRootOf(equation, d)) for d in range(degree(equation))]<br/>print(numerical_solution)</span></pre><p id="b20a" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Which prints: <code class="cx pw px py pn b">[-1.0*I, 1.0*I]</code>.</p><p id="a12e" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Notice that the solutions use <em class="ny">i</em> (the imaginary unit), meaning they are complex numbers. This is an illustration of the <a class="af nb" href="https://en.wikipedia.org/wiki/Fundamental_theorem_of_algebra" rel="noopener ugc nofollow" target="_blank">Fundamental Theorem of Algebra</a>, which states that every (non-constant) polynomial equation has at least one complex solution, even when no real solutions exist.</p><p id="bb63" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">The takeaway: unless complex numbers are meaningful in your domain, you should ignore complex solutions.</p></div></div></div><div class="ab cb qa qb qc qd" role="separator"><span class="qe by bm qf qg qh"/><span class="qe by bm qf qg qh"/><span class="qe by bm qf qg"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="3df0" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">To summarize polynomials:</p><ul class=""><li id="2622" class="nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx nz oa ob bk"><strong class="ne fr">Degree four and below</strong>: There is always a closed-form solution involving basic arithmetic operations and roots.</li><li id="02b9" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk"><strong class="ne fr">Degree five and above</strong>: Generally, no closed-form solution exists using elementary operations, though SymPy occasionally finds one.</li><li id="d713" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk"><strong class="ne fr">Solutions</strong>: Polynomials will always have solutions — at least numerically — but these solutions may not be real (both mathematically and practically). You should typically ignore them unless complex numbers are meaningful in your domain.</li></ul><p id="ee0c" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Next, we’ll add exponentials and logarithms to our equations. In the solutions, we discover the Lambert <em class="ny">W</em> function. Is it a CRootOf-like cheat?</p><h1 id="3e74" class="ok ol fq bf om on oo gq op oq or gt os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Exp, Log and x</h1><p id="30a8" class="pw-post-body-paragraph nc nd fq ne b go pg ng nh gr ph nj nk nl pi nn no np pj nr ns nt pk nv nw nx fj bk">When we model data mathematically, we often use exponentials and logarithms. Below is a sample of what happens when we try to reverse such models by solving their equations with SymPy:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div class="mi mj qk"><img src="../Images/6335c6c8cc5569c6cfff858a6b6b4634.png" data-original-src="https://miro.medium.com/v2/resize:fit:1332/format:webp/1*e1sbTiIxV-PNe82rsgp3mw.png"/></div></figure><p id="6416" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Observations:</p><ul class=""><li id="0247" class="nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx nz oa ob bk"><strong class="ne fr">Sometimes you get lucky</strong>: The first equation <em class="ny">x</em>e<em class="ny">ˣ</em>=0 has an elementary solution <em class="ny">x</em>=0. While this isn’t always the case, simple closed-form solutions can sometimes be found, even in equations involving exponentials or logarithms.</li><li id="5120" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk"><strong class="ne fr">Every equation in this “family” appears to be solvable, with two caveats:</strong> First, I can’t precisely define this family and am unsure if a clear definition is possible. Second, solving these equations requires the Lambert <em class="ny">W</em> function, such as <em class="ny">W(1)</em> and <em class="ny">W₋₁(1/10)</em>. This function arises when <em class="ny">x</em> appears both inside and outside of an exponential (or logarithmic) expression.</li><li id="45ab" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk"><strong class="ne fr">If you don’t accept <em class="ny">W</em>, you can’t solve these functions in closed form</strong>: Equations in this “family” generally have no closed-form elementary solutions without the Lambert <em class="ny">W</em> function.</li><li id="406e" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk"><strong class="ne fr">We should accept <em class="ny">W</em>:</strong> The Lambert <em class="ny">W</em> function is a well-defined, easily computable function with applications across math and science. Its late adoption relative to <em class="ny">exp</em>, <em class="ny">log</em>, <em class="ny">sin</em>, and <em class="ny">cos </em>is simply historical.</li><li id="6c8f" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk"><strong class="ne fr">A single <em class="ny">W</em> can generate multiple solutions</strong>: Similar to how the square root function can produce two solutions, a <em class="ny">W</em> expression can yield zero, one, or two real solutions. When two real solutions exist, SymPy lists them separately, representing one as <em class="ny">W</em> (the principal branch) and the other as <em class="ny">W₋₁</em> (the secondary branch). Beyond the real solutions, any <em class="ny">W</em> expression also generates an infinite number of complex solutions.</li><li id="fafc" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk"><strong class="ne fr">Complex solutions will arise</strong>: Some equations, such as <em class="ny">x</em> log(<em class="ny">x</em>)+1=0, lead to only complex solutions. As with polynomials, you should ignore complex numbers unless they are meaningful in your domain.</li><li id="d1db" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk"><strong class="ne fr">Degree-five and higher polynomials mixed with exp (or log) remain unsolvable</strong>: Even with special functions like the Lambert <em class="ny">W</em> function, degree-five and higher polynomials cannot be solved in closed form using elementary functions.</li></ul><p id="3e65" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">What happens if we use both an exponential and a logarithm in the same equation? Generally, we won’t find a closed-form solution — not even with the Lambert <em class="ny">W</em> function:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div class="mi mj ql"><img src="../Images/5829be0bc9a1cd84c0b62c9c3ce9049f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*Im5IKosgJgqv66p7StahvA.png"/></div></figure></div></div></div><div class="ab cb qa qb qc qd" role="separator"><span class="qe by bm qf qg qh"/><span class="qe by bm qf qg qh"/><span class="qe by bm qf qg"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="d932" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">To summarize, combining exponentials or logarithms with polynomials typically makes the equation unsolvable by traditional closed-form methods. However, if we allow the Lambert <em class="ny">W</em> function, equations with exponentials or logarithms (but not both) become solvable. We should embrace <em class="ny">W</em> as a valid tool for handling such cases.</p><p id="23fc" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Next, let’s generalize Kepler’s problem and see what happens when we introduce trigonometric functions into our equations.</p><h1 id="0614" class="ok ol fq bf om on oo gq op oq or gt os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Trigonometric Equations</h1><p id="44ec" class="pw-post-body-paragraph nc nd fq ne b go pg ng nh gr ph nj nk nl pi nn no np pj nr ns nt pk nv nw nx fj bk"><strong class="ne fr">Simple Trigonometric Equations:</strong> Here is our first batch of trigonometric samples:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qm"><img src="../Images/4cd22357d32d194a39711f98d4d3e16e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QODJiRCdotFDq3iH6VrsMg.png"/></div></div></figure><p id="5482" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">SymPy successfully finds closed-form elementary solutions for each equation. The solutions involve trigonometric functions, and in some cases, complex numbers appear. (Again, we typically ignore the complex solutions unless they are meaningful for the problem at hand.)</p><p id="1283" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Keep in mind that sine and cosine are periodic, which leads to infinitely many solutions. The closed-form solutions that SymPy provides typically represent a single cycle.</p><p id="e60c" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk"><strong class="ne fr">Commensurate Frequency Equations: </strong>In the preceding equations, we limited the trigonometric function’s input to <em class="ny">x</em>+<em class="ny">b</em>, where <em class="ny">b</em> is a constant. What happens if we allow inputs like <em class="ny">a</em>₁<em class="ny">x</em>+<em class="ny">b</em>₁ and <em class="ny">a</em>₂<em class="ny">x</em>+<em class="ny">b</em>₂ where <em class="ny">a</em>₁ is rational and <em class="ny">a</em>₂ is rational? This means the two periodic functions may have different frequencies but those frequences can synchronize. (The <em class="ny">a</em>’s are the frequencies.) We say our trigonometric functions have “commensurate frequencies.”</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qn"><img src="../Images/b94534cad076b5a3afdff21207d78ded.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5JoxMy45FrdgeAmWWh-3bw.png"/></div></div></figure><p id="4b6b" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Observations:</p><ul class=""><li id="24a5" class="nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx nz oa ob bk">We occasionally get a closed-form elementary solution.</li><li id="af97" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk">On sin(<em class="ny">x</em>) + sin(3<em class="ny">x</em>)+1=0, SymPy returns zero solutions. Plots and numerical methods, however, suggest solutions exist. Moreover, when I input <a class="af nb" href="https://www.wolframalpha.com/input?i=sin%28x%29+%2B+sin%283x%29+%2B+1+%3D+0%2C+solve+for+x" rel="noopener ugc nofollow" target="_blank">sin(x) + sin(3x)+1=0 into WolframAlpha</a>, an on-line computer algebra system, it produces hybrid solutions. (The WolframAlpha solutions combine elementary functions with <strong class="ne fr">CRootOf</strong> expressions of degree six. As we discussed in the polynomial section, such expressions generally lack a closed-form solution.)</li><li id="4253" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk">SymPy sometimes times out looking for a closed-form solution when numerical methods can still provide solutions.</li><li id="7a05" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk">In other cases, it times out, and both numerical methods and plots confirm there are no solutions. Before, instead of no numerical solution, we’d get a complex number solution. [WolframAlpha does give <a class="af nb" href="https://www.wolframalpha.com/input?i=sin%283x%29+*+sin%28x+%2B+1%29+%2B1+%3D+0%2C+solve+for+x" rel="noopener ugc nofollow" target="_blank">a complex numerical solution</a>.]</li></ul><p id="3247" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Let’s plot the equation that returned zero closed-formed solutions. Let’s also plot the one that numerically returned <code class="cx pw px py pn b">ValueError:</code></p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qo"><img src="../Images/8d65d0f9096833b9596b900a53b9acf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sIg74kBghtc6ITS1jRCIog.png"/></div></div></figure><p id="55bd" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Additional Observations:</p><ul class=""><li id="22e7" class="nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx nz oa ob bk">From the blue plot, SymPy’s response of “no solutions” appears to be a bug. There are clearly solutions in the plot, and SymPy should either have found them or thrown an exception.</li><li id="d3f3" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk">On the other hand, in the red plot, the numerical result of <code class="cx pw px py pn b">ValueError</code> is accurate. There are no solutions.</li></ul><p id="eaa4" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">For all the trigonometric equations we’ve encountered so far, SymPy seems to find real-valued closed-form solutions when they exist. When they don’t exist, it times out or gives unpredictable errors.</p><p id="85c3" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk"><strong class="ne fr">Non-Commensurate Frequency Equations: </strong>In the preceding equations, we allowed trigonometric functions with inputs of the form <em class="ny">ax</em>+<em class="ny">b</em>​, where <em class="ny">a</em>​ is a rational constant. What happens if we allow inputs like <em class="ny">a</em>₁<em class="ny">x</em>+<em class="ny">b</em>₁ and <em class="ny">a</em>₂<em class="ny">x</em>+<em class="ny">b</em>₂ where <em class="ny">a</em>₁ is rational and <em class="ny">a</em>₂ is irrational? This means the two periodic functions will never synchronize. We say they have “non-commensurate frequencies.”</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div class="mi mj qp"><img src="../Images/8040ccb39120f11492d4509551c293aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1334/format:webp/1*pDLSAdZ5fLX3DCRXeIH1Dw.png"/></div></figure><p id="f99e" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Observations:</p><ul class=""><li id="06a5" class="nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx nz oa ob bk">Equations with two trigonometric functions having non-commensurate frequencies generally seem unsolvable in closed form. When no elementary solution is available, SymPy returns <code class="cx pw px py pn b">NotImplementedError.</code></li><li id="7cc0" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk">We can still get lucky and occasionally find an equation with an elementary solution. In the case above, in which SymPy returned <code class="cx pw px py pn b">PolynomialDivisionFailed</code>, <a class="af nb" href="https://www.wolframalpha.com/input?i=sin%28sqrt%283%29*x%29+%2B+sin%28x%2B1%29%3D+0%2C+solve+for+x" rel="noopener ugc nofollow" target="_blank">WolframAlpha found a closed-form solution</a>.</li><li id="651b" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk">When an equation has no solutions, SymPy produces a <code class="cx pw px py pn b">ValueError</code>, which we can confirm through plots (see below). We did not see complex-number results in these cases.</li></ul><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj qq"><img src="../Images/f8314a07ca7e67d95fc55e8deb6699b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4-iicuFyBCTXiXHEsytg6Q.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">The equations do not quite touch zero, so no solutions</figcaption></figure></div></div></div><div class="ab cb qa qb qc qd" role="separator"><span class="qe by bm qf qg qh"/><span class="qe by bm qf qg qh"/><span class="qe by bm qf qg"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="a1a7" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Our conclusion regarding trigonometric equations is that we can often find elementary closed-form solutions. The main exception seems to be when the frequencies are non-commensurate — for example, in an equation containing sin(<em class="ny">x</em>) and sin⁡(√3 <em class="ny">x</em>).</p><p id="0360" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">The final question we’ll explore is what happens when we mix trigonometric functions with exponentials and logarithms.</p><h1 id="38b7" class="ok ol fq bf om on oo gq op oq or gt os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Trigonometric and x, Exp, Log</h1><p id="62d9" class="pw-post-body-paragraph nc nd fq ne b go pg ng nh gr ph nj nk nl pi nn no np pj nr ns nt pk nv nw nx fj bk">Our final set of samples will require only a short discussion. What if we run a sample of equations through SymPy, each equation containing one trigonometric function combined with either <em class="ny">x</em>, exp(<em class="ny">x</em>), or log(<em class="ny">x</em>)?</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div class="mi mj qr"><img src="../Images/80176233339aefc1eed8143e46e7479b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1166/format:webp/1*3h5tZLFE_VldR-B48nmFUw.png"/></div></figure><p id="6fee" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">The results are unanimous: SymPy is unable to produce closed-form solutions for any of these combinations. However, it seems that SymPy should have produced <em class="ny">x</em>=0 as the closed-form solution for the first equation, as indeed <a class="af nb" href="https://www.wolframalpha.com/input?i=x%2Bsin%28x%29%3D0%2C+solve" rel="noopener ugc nofollow" target="_blank">WolframAlpha does</a>.</p><h1 id="d6ae" class="ok ol fq bf om on oo gq op oq or gt os ot ou ov ow ox oy oz pa pb pc pd pe pf bk">Conclusion</h1><p id="2d26" class="pw-post-body-paragraph nc nd fq ne b go pg ng nh gr ph nj nk nl pi nn no np pj nr ns nt pk nv nw nx fj bk">So, there you have it — an exploration of which equations tend to lack closed-form solutions. If you’re interested in experimenting with the examples in this article, you can find my <a class="af nb" href="https://github.com/CarlKCarlK/unsolvable" rel="noopener ugc nofollow" target="_blank">Python code on GitHub</a>.</p><p id="e016" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">As I worked through these sample equations, here is what surprised me:</p><ul class=""><li id="e9ab" class="nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx nz oa ob bk"><strong class="ne fr">Kepler’s Equation is wonderfully simple.</strong> I didn’t know one could model an<strong class="ne fr"> </strong>ellipse — a geometric shape I find complicated — with such elegance.</li><li id="6cf1" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk"><strong class="ne fr">Lambert’s <em class="ny">W</em> function</strong> proved to be invaluable for handling equations that mix terms like <em class="ny">x</em> and exp⁡(<em class="ny">x</em>). We should consider it an elementary function.</li><li id="edd9" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk"><strong class="ne fr">SymPy</strong> is an excellent, free tool that handles symbolic algebra and trigonometric equations far better than many of us could handle manually. While it may not match WolframAlpha in some cases, it’s incredibly versatile and accessible.</li><li id="5cf9" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk"><strong class="ne fr">Mixing trigonometric functions </strong>with other terms frequently prevents closed-form solutions, especially when frequencies are non-commensurate.</li><li id="0bb1" class="nc nd fq ne b go oc ng nh gr od nj nk nl oe nn no np of nr ns nt og nv nw nx nz oa ob bk">When closed-form solutions remain out of reach, <strong class="ne fr">plotting and numerical methods</strong> step in, delivering practical results.</li></ul><p id="8fae" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Thank you for joining me on this journey. I hope you now have a clearer understanding of when you can use equation-solving techniques to reverse models and how much SymPy can assist. Also, when an equation resists a closed-form solution, you can now understand why and when to rely on numerical methods.</p><p id="a1de" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">If you enjoyed exploring <strong class="ne fr">mathematics </strong>with Python and SymPy, you may also enjoy using them to explore <strong class="ne fr">Newtonian physics</strong>. Please see this<strong class="ne fr"> </strong><a class="af nb" href="https://medium.com/towards-data-science/perfect-infinite-precision-game-physics-in-python-part-1-698211c08d95" rel="noopener">Towards Data Science article</a> and the related, popular <a class="af nb" href="https://www.youtube.com/watch?v=52n2qKgwW_Q" rel="noopener ugc nofollow" target="_blank">PyData conference talk</a>.</p></div></div></div><div class="ab cb qa qb qc qd" role="separator"><span class="qe by bm qf qg qh"/><span class="qe by bm qf qg qh"/><span class="qe by bm qf qg"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="2ba3" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk"><em class="ny">Interested in future articles? Please </em><a class="af nb" href="https://medium.com/@carlmkadie" rel="noopener"><em class="ny">follow me on Medium</em></a><em class="ny">. I write about Rust and Python, scientific programming, machine learning, and statistics. I tend to write about one article per month.</em></p></div></div></div></div>    
</body>
</html>