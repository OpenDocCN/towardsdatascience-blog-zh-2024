["```py\nlibrary(brms)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(gtsummary)\nlibrary(modelr)\nlibrary(spatstat)\nlibrary(tidybayes)\n```", "```py\nPointPatterns <- readRDS(\"Data/PointPatterns_5x.rds\")\nrow.names(PointPatterns) <- PointPatterns$ID \n\nhead(PointPatterns)\n```", "```py\nplot(PointPatterns$Neurons)\n```", "```py\nplot(PointPatterns$Neurons$M05)\n```", "```py\n# We plot neurons in black with symbol (10)\nplot(PointPatterns$Neurons$M05, pch = 10, cex = 0.4, main = \"Neurons and Astrocytes\")\n\n# We add astrocytes in red with a different symbol (18)\nplot(PointPatterns$Astrocytes$M05, pch = 18, cex = 0.4, col = \"red\", add = TRUE)\n```", "```py\nPointPatterns$AstrocytesIntensity <- with(PointPatterns, summary(Astrocytes)$intensity)\n\nhead(PointPatterns[,9:11])\n```", "```py\nAstrocytes_df <- as.data.frame(PointPatterns[,9:11])\n\n# We make sure to organize our factor variable in the right order\nAstrocytes_df$DPI <- factor(Astrocytes_df$DPI, levels = c(\"0D\", \"5D\", \"15D\", \"30D\"))\n\ngt::gt(Astrocytes_df[1:10,])\n```", "```py\nAstrocytes_Mdl <- bf(AstrocytesIntensity ~ DPI, \n                     sigma ~ DPI)\n\nAstrocytes_Fit <- brm(formula = Astrocytes_Mdl,\n                      family = student,\n                      data = Astrocytes_df, \n                      # seed for reproducibility purposes\n                      seed = 8807,\n                      control = list(adapt_delta = 0.99),\n                      # this is to save the model in my laptop\n                      file    = \"Models/2024-05-24_PPA/Astrocytes_Fit.rds\",\n                      file_refit = \"never\")\n\n# Add loo for model comparison\nAstrocytes_Fit <- \n  add_criterion(Astrocytes_Fit, c(\"loo\", \"waic\", \"bayes_R2\"))\n```", "```py\nAstrocytes_df %>%\n  data_grid(Astrocytes_df) %>%\n  add_epred_draws(Astrocytes_Fit) %>%\n  ggplot(aes(x = .epred, y = DPI)) +\n  labs(x = \"Spatial intensity\") +\n  stat_halfeye() +\n  geom_vline(xintercept = 0) +\n  Plot_theme\n```", "```py\nPointPatterns$Astrocytes_Dens <- with(PointPatterns, density(Astrocytes, sigma = 0.2, col = topo.colors))\n```", "```py\npar(mfrow = c(1,3), mar=c(1,1,1,1), oma=c(1,1,1,1))\n\nplot(density(PointPatterns$Astrocytes$M05, sigma = 0.02), col = topo.colors, main = \"sigma = 0.02\")\nplot(density(PointPatterns$Astrocytes$M05, sigma = 0.2), col = topo.colors, main = \"sigma = 0.2\")\nplot(density(PointPatterns$Astrocytes$M05, sigma = 2), col = topo.colors, main = \"sigma = 2\")\n```", "```py\n# We fit the mppm model\nNeurons_ppm <- mppm(Neurons ~ Astrocytes_Dens, data = PointPatterns)\n\n# We check the results\nsummary(Neurons_ppm)\n```"]