<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Validating Data in a Production Pipeline: The TFX Way</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Validating Data in a Production Pipeline: The TFX Way</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/validating-data-in-a-production-pipeline-the-tfx-way-9770311eb7ce?source=collection_archive---------2-----------------------#2024-06-22">https://towardsdatascience.com/validating-data-in-a-production-pipeline-the-tfx-way-9770311eb7ce?source=collection_archive---------2-----------------------#2024-06-22</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="620c" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">A deep dive into data validation using Tensorflow Data Validation</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@akila29?source=post_page---byline--9770311eb7ce--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Akila Somasundaram" class="l ep by dd de cx" src="../Images/5f3c58de8057c9c7ef42f6f5729fb395.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*3X97v4WvKq87j_whKdIwmA.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--9770311eb7ce--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://medium.com/@akila29?source=post_page---byline--9770311eb7ce--------------------------------" rel="noopener follow">Akila Somasundaram</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--9770311eb7ce--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">9 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Jun 22, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj la lb ab q ee lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lf k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lg an ao ap id lh li lj" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep lk cn"><div class="l ae"><div class="ab cb"><div class="ll lm ln lo lp lq ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><p id="47df" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Imagine this. We have a fully functional machine learning pipeline, and it is flawless. So we decide to push it to the production environment. All is well in prod, and one day a tiny change happens in one of the components that generates input data for our pipeline, and the pipeline breaks. Oops!!!</p><figure class="nh ni nj nk nl nm ne nf paragraph-image"><div role="button" tabindex="0" class="nn no ed np bh nq"><div class="ne nf ng"><img src="../Images/d53ddb0f90e923a8b1b9f06d777cadb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YZJ10ZsqIbfL_d18"/></div></div><figcaption class="ns nt nu ne nf nv nw bf b bg z dx">Photo by <a class="af nx" href="https://unsplash.com/@rojekilian?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Sarah Kilian</a> on <a class="af nx" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="51c2" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Why did this happen??</p><p id="43f1" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Because ML models rely heavily on the data being used, remember the age old saying, Garbage In, Garabage Out. Given the right data, the pipeline performs well, any change and the pipeline tends to go awry.</p><p id="8e99" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Data passed into pipelines are generated mostly through automated systems, thereby lowering control in the type of data being generated.</p><p id="9004" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">So, what do we do?</p><p id="8b3e" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Data Validation is the answer.</p><p id="f005" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Data Validation is the guardian system that would verify if the data is in appropriate format for the pipeline to consume.</p><p id="627d" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Read this article to understand why validation is crucial in an ML pipeline and the 5 stages of machine learning validations.</p><div class="ny nz oa ob oc od"><a rel="noopener follow" target="_blank" href="/the-5-stages-of-machine-learning-validation-162193f8e5db?source=post_page-----9770311eb7ce--------------------------------"><div class="oe ab ig"><div class="of ab co cb og oh"><h2 class="bf fr hw z io oi iq ir oj it iv fp bk">The 5 Stages of Machine Learning Validation</h2><div class="ok l"><h3 class="bf b hw z io oi iq ir oj it iv dx">Ensure high-quality machine learning across the ML lifecycle</h3></div><div class="ol l"><p class="bf b dy z io oi iq ir oj it iv dx">towardsdatascience.com</p></div></div><div class="om l"><div class="on l oo op oq om or lq od"/></div></div></a></div><h1 id="2f19" class="os ot fq bf ou ov ow gq ox oy oz gt pa pb pc pd pe pf pg ph pi pj pk pl pm pn bk">TensorFlow Data Validation</h1><p id="c4d9" class="pw-post-body-paragraph mi mj fq mk b go po mm mn gr pp mp mq mr pq mt mu mv pr mx my mz ps nb nc nd fj bk">TensorFlow Data Validation (TFDV), is a part of the TFX ecosystem, that can be used for validating data in an ML pipeline.</p><p id="70b9" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">TFDV computes descriptive statistics, schemas and identifies anomalies by comparing the training and serving data. This ensures training and serving data are consistent and does not break or create unintended predictions in the pipeline.</p><p id="92ea" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">People at Google wanted TFDV to be used right from the earliest stage in an ML process. Hence they ensured TFDV could be used with notebooks. We are going to do the same here.</p><p id="28a5" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">To begin, we need to install tensorflow-data-validation library using pip. Preferably create a virtual environment and start with your installations.</p><blockquote class="pt pu pv"><p id="384c" class="mi mj pw mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk"><strong class="mk fr">A note of caution</strong>: Prior to installation, ensure version compatibility in TFX libraries</p></blockquote><pre class="nh ni nj nk nl px py pz bp qa bb bk"><span id="7e78" class="qb ot fq py b bg qc qd l qe qf">pip install tensorflow-data-validation</span></pre><p id="f4c7" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">The following are the steps we will follow for the data validation process:</p><ol class=""><li id="83af" class="mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd qg qh qi bk">Generating Statistics from Training Data</li><li id="fea6" class="mi mj fq mk b go qj mm mn gr qk mp mq mr ql mt mu mv qm mx my mz qn nb nc nd qg qh qi bk">Infering Schema from Training Data</li><li id="0647" class="mi mj fq mk b go qj mm mn gr qk mp mq mr ql mt mu mv qm mx my mz qn nb nc nd qg qh qi bk">Generating Statistics for Evaluation Data and Comparing it with Training Data</li><li id="432a" class="mi mj fq mk b go qj mm mn gr qk mp mq mr ql mt mu mv qm mx my mz qn nb nc nd qg qh qi bk">Identifying and Fixing Anomalies</li><li id="c015" class="mi mj fq mk b go qj mm mn gr qk mp mq mr ql mt mu mv qm mx my mz qn nb nc nd qg qh qi bk">Checking for Drifts and Data Skew</li><li id="d061" class="mi mj fq mk b go qj mm mn gr qk mp mq mr ql mt mu mv qm mx my mz qn nb nc nd qg qh qi bk">Save the Schema</li></ol><p id="d92f" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">We will be using 3 types of datasets here; training data, evaluation data and serving data, to mimic real-time usage. The ML model is trained using the training data. Evaluation data aka test data is a part of the data that is designated to test the model as soon as the training phase is completed. Serving data is presented to the model in the production environment for making predictions.</p><p id="ce25" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">The entire code discussed in this article is available in my GitHub repo. You can download it from <a class="af nx" href="https://github.com/akila29/TF_Transform_Demo" rel="noopener ugc nofollow" target="_blank">here</a>.</p><h1 id="34ec" class="os ot fq bf ou ov ow gq ox oy oz gt pa pb pc pd pe pf pg ph pi pj pk pl pm pn bk">Step 0: Preparations</h1><p id="6477" class="pw-post-body-paragraph mi mj fq mk b go po mm mn gr pp mp mq mr pq mt mu mv pr mx my mz ps nb nc nd fj bk">We will be using the spaceship titanic dataset from Kaggle. You can learn more and download the dataset using this <a class="af nx" href="https://www.kaggle.com/competitions/spaceship-titanic" rel="noopener ugc nofollow" target="_blank">link</a>.</p><figure class="nh ni nj nk nl nm ne nf paragraph-image"><div role="button" tabindex="0" class="nn no ed np bh nq"><div class="ne nf qo"><img src="../Images/ba359827d9aca475e8ef604afc070ae1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dF0vHGezMyWLuu6UGtGLXQ.png"/></div></div><figcaption class="ns nt nu ne nf nv nw bf b bg z dx">Sample view of Spaceship Titanic Dataset</figcaption></figure><p id="dcfc" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">The data is composed of a mixture of numerical and categorical data. It is a classification dataset, and the class label is <code class="cx qp qq qr py b">Transported</code>. It holds the value True or False.</p><figure class="nh ni nj nk nl nm ne nf paragraph-image"><div class="ne nf qs"><img src="../Images/9b5b6032c887d15e46860375ccd13c44.png" data-original-src="https://miro.medium.com/v2/resize:fit:992/format:webp/1*QZ6U6A_MYdRYe14ubwYoRg.png"/></div><figcaption class="ns nt nu ne nf nv nw bf b bg z dx">Data Description</figcaption></figure><p id="f025" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">The necessary imports are done, and paths for the csv file is defined. The actual dataset contains the training and the test data. I have manually introduced some errors and saved the file as ‘titanic_test_anomalies.csv’ (This file is not available in Kaggle. You can download it from my GitHub repository <a class="af nx" href="https://github.com/akila29/TF_Transform_Demo" rel="noopener ugc nofollow" target="_blank">link</a>).</p><p id="4ece" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Here, we will be using ANOMALOUS_DATA as the evaluation data and TEST_DATA as serving data.</p><pre class="nh ni nj nk nl px py pz bp qa bb bk"><span id="a019" class="qb ot fq py b bg qc qd l qe qf">import tensorflow_data_validation as tfdv<br/>import tensorflow as tf<br/><br/>TRAIN_DATA = '/data/titanic_train.csv'<br/>TEST_DATA = '/data/titanic_test.csv'<br/>ANOMALOUS_DATA = '/data/titanic_test_anomalies.csv'</span></pre><h1 id="0653" class="os ot fq bf ou ov ow gq ox oy oz gt pa pb pc pd pe pf pg ph pi pj pk pl pm pn bk">Step 1: Generating Statistics from Training Data</h1><p id="3fab" class="pw-post-body-paragraph mi mj fq mk b go po mm mn gr pp mp mq mr pq mt mu mv pr mx my mz ps nb nc nd fj bk">First step is to analyze the training data and identify its statistical properties. TFDV has the <code class="cx qp qq qr py b">generate_statistics_from_csv </code>function, which directly reads data from a csv file. TFDV also has a <code class="cx qp qq qr py b">generate_statistics_from_tfrecord</code> function if you have the data as a <code class="cx qp qq qr py b">TFRecord</code> .</p><p id="bfec" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">The <code class="cx qp qq qr py b">visualize_statistics</code> function presents an 8 point summary, along with helpful charts that can help us understand the underlying statistics of the data. This is called the Facets view. Some critical details that needs our attention are highlighted in red. Loads of other features to analyze the data are available here. Play around and get to know it better.</p><pre class="nh ni nj nk nl px py pz bp qa bb bk"><span id="cda3" class="qb ot fq py b bg qc qd l qe qf"># Generate statistics for training data<br/>train_stats=tfdv.generate_statistics_from_csv(TRAIN_DATA)<br/>tfdv.visualize_statistics(train_stats)</span></pre><figure class="nh ni nj nk nl nm ne nf paragraph-image"><div role="button" tabindex="0" class="nn no ed np bh nq"><div class="ne nf qt"><img src="../Images/083119251429614e2406c036aeabbae3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VgVlHAYEZn7K-x1a37Wbyg.png"/></div></div><figcaption class="ns nt nu ne nf nv nw bf b bg z dx">Statistics generated for the dataset</figcaption></figure><p id="297e" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Here we see missing values in Age and RoomService features that needs to be imputed. We also see that RoomService has 65.52% zeros. It is the way this particular data is distributed, so we do not consider it an anomaly, and we move ahead.</p><h1 id="5153" class="os ot fq bf ou ov ow gq ox oy oz gt pa pb pc pd pe pf pg ph pi pj pk pl pm pn bk">Step 2: Infering Schema from Training Data</h1><p id="4088" class="pw-post-body-paragraph mi mj fq mk b go po mm mn gr pp mp mq mr pq mt mu mv pr mx my mz ps nb nc nd fj bk">Once all the issues have been satisfactorily resolved, we infer the schema using the <code class="cx qp qq qr py b">infer_schema</code> function.</p><pre class="nh ni nj nk nl px py pz bp qa bb bk"><span id="5386" class="qb ot fq py b bg qc qd l qe qf">schema=tfdv.infer_schema(statistics=train_stats)<br/>tfdv.display_schema(schema=schema)</span></pre><p id="7e30" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Schema is usually presented in two sections. The first section presents details like the data type, presence, valency and its domain. The second section presents values that the domain constitutes.</p><figure class="nh ni nj nk nl nm ne nf paragraph-image"><div class="ne nf qu"><img src="../Images/9ab5c3d72692c0ed60ed099f0200770e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1034/format:webp/1*pfl7172geWkgx04YyM6uQw.png"/></div><figcaption class="ns nt nu ne nf nv nw bf b bg z dx">Section 1: Details about Features</figcaption></figure><figure class="nh ni nj nk nl nm ne nf paragraph-image"><div class="ne nf qv"><img src="../Images/efd9ef3bd5d36330c2bf8bb9b17010ea.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*YkHRvEYMH-F8wW7FS9kYjg.png"/></div><figcaption class="ns nt nu ne nf nv nw bf b bg z dx">Section 2: Domain Values</figcaption></figure><p id="7c95" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">This is the initial raw schema, we will be refining this in the later steps.</p><h1 id="31e5" class="os ot fq bf ou ov ow gq ox oy oz gt pa pb pc pd pe pf pg ph pi pj pk pl pm pn bk">Step 3: Generating Statistics for Evaluation Data and Comparing it with Training Data</h1><p id="2baa" class="pw-post-body-paragraph mi mj fq mk b go po mm mn gr pp mp mq mr pq mt mu mv pr mx my mz ps nb nc nd fj bk">Now we pick up the evaluation data and generate the statistics. We need to understand how anomalies need to be handled, so we are going to use ANOMALOUS_DATA as our evaluation data. We have manually introduced anomalies into this data.</p><p id="6228" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">After generating the statistics, we visualize the data. Visualization can be applied for the evaluation data alone (like we did for the training data), however it makes more sense to compare the statistics of evaluation data with the training statistics. This way we can understand how different the evaluation data is from the training data.</p><pre class="nh ni nj nk nl px py pz bp qa bb bk"><span id="01e2" class="qb ot fq py b bg qc qd l qe qf"># Generate statistics for evaluation data<br/><br/>eval_stats=tfdv.generate_statistics_from_csv(ANOMALOUS_DATA)<br/><br/>tfdv.visualize_statistics(lhs_statistics = train_stats, rhs_statistics = eval_stats,<br/>                          lhs_name = "Training Data", rhs_name = "Evaluation Data")</span></pre><figure class="nh ni nj nk nl nm ne nf paragraph-image"><div role="button" tabindex="0" class="nn no ed np bh nq"><div class="ne nf qw"><img src="../Images/6ac2d32e901e679439959c38c0ca4dbf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k-ZC_OOArg9RCYYYHEwwbw.png"/></div></div><figcaption class="ns nt nu ne nf nv nw bf b bg z dx">Comparison of Statistics of the Training data and the Evaluation data</figcaption></figure><p id="2583" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Here we can see that RoomService feature is absent in the evaluation data (Big Red Flag). The other features seem fairly ok, as they exhibit distributions similar to the training data.</p><p id="b473" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">However, eyeballing is not sufficient in a production environment, so we are going to ask TFDV to actually analyze and report if everything is OK.</p><h1 id="00f9" class="os ot fq bf ou ov ow gq ox oy oz gt pa pb pc pd pe pf pg ph pi pj pk pl pm pn bk">Step 4: Identifying and Fixing Anomalies</h1><p id="f44d" class="pw-post-body-paragraph mi mj fq mk b go po mm mn gr pp mp mq mr pq mt mu mv pr mx my mz ps nb nc nd fj bk">Our next step is to validate the statistics obtained from the evaluation data. We are going to compare it with the schema that we had generated with the training data. The <code class="cx qp qq qr py b">display_anomalies</code> function will give us a tabulated view of the anomalies TFDV has identified and a description as well.</p><pre class="nh ni nj nk nl px py pz bp qa bb bk"><span id="ac3a" class="qb ot fq py b bg qc qd l qe qf"># Identifying Anomalies<br/>anomalies=tfdv.validate_statistics(statistics=eval_stats, schema=schema)<br/>tfdv.display_anomalies(anomalies)</span></pre><figure class="nh ni nj nk nl nm ne nf paragraph-image"><div role="button" tabindex="0" class="nn no ed np bh nq"><div class="ne nf qx"><img src="../Images/b76570fc516d2e98687a33433a4ab109.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bJ37NIKLAPE9F6rht1RTLw.png"/></div></div><figcaption class="ns nt nu ne nf nv nw bf b bg z dx">Anomaly List provided by TFDV</figcaption></figure><p id="5025" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">From the table, we see that our evaluation data is missing 2 columns (Transported and RoomService), Destination feature has an additional value called ‘Anomaly’ in its domain (which was not present in the training data), CryoSleep and VIP features have values ‘TRUE’ and ‘FALSE’ which is not present in the training data, finally, 5 features contain integer values, while the schema expects floating point values.</p><p id="cb1f" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">That’s a handful. So let’s get to work.</p><p id="ba06" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">There are two ways to fix anomalies; either process the evaluation data (manually) to ensure it fits the schema or modify schema to ensure these anomalies are accepted. Again a domain expert has to decide on which anomalies are acceptable and which mandates data processing.</p><p id="8d0a" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Let us start with the ‘Destination’ feature. We found a new value ‘Anomaly’, that was missing in the domain list from the training data. Let us add it to the domain and say that it is also an acceptable value for the feature.</p><pre class="nh ni nj nk nl px py pz bp qa bb bk"><span id="0140" class="qb ot fq py b bg qc qd l qe qf"># Adding a new value for 'Destination'<br/>destination_domain=tfdv.get_domain(schema, 'Destination')<br/>destination_domain.value.append('Anomaly')<br/><br/>anomalies=tfdv.validate_statistics(statistics=eval_stats, schema=schema)<br/>tfdv.display_anomalies(anomalies)</span></pre><p id="95d3" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">We have removed this anomaly, and the anomaly list does not show it anymore. Let us move to the next one.</p><figure class="nh ni nj nk nl nm ne nf paragraph-image"><div role="button" tabindex="0" class="nn no ed np bh nq"><div class="ne nf qy"><img src="../Images/5af7cb267e286bd12f213f7627219f4d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1Xhnq2KPcdWVPqhOotR5eQ.png"/></div></div><figcaption class="ns nt nu ne nf nv nw bf b bg z dx">Destination Anomaly has been resolved</figcaption></figure><p id="421b" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Looking at the VIP and CryoSleep domains, we see that the training data has lowercase values while the evaluation data has the same values in uppercase. One option is to pre-process the data and ensure that all the data is converted to lower or uppercase. However, we are going to add these values in the domain. Since, VIP and CryoSleep use the same set of values(true and false), we set the domain of CryoSleep to use VIP’s domain.</p><pre class="nh ni nj nk nl px py pz bp qa bb bk"><span id="fd85" class="qb ot fq py b bg qc qd l qe qf"># Adding data in CAPS to domain for VIP and CryoSleep<br/><br/>vip_domain=tfdv.get_domain(schema, 'VIP')<br/>vip_domain.value.extend(['TRUE','FALSE'])<br/><br/># Setting domain of one feature to another<br/>tfdv.set_domain(schema, 'CryoSleep', vip_domain)<br/><br/>anomalies=tfdv.validate_statistics(statistics=eval_stats, schema=schema)<br/>tfdv.display_anomalies(anomalies)</span></pre><figure class="nh ni nj nk nl nm ne nf paragraph-image"><div role="button" tabindex="0" class="nn no ed np bh nq"><div class="ne nf qz"><img src="../Images/dd243f90d74ec3b97e25f251f7709010.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R4TxIfOqo8uel5OT6jcx2g.png"/></div></div><figcaption class="ns nt nu ne nf nv nw bf b bg z dx">Resolved anomalies from CryoSleep and VIP</figcaption></figure><p id="ed4f" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">It is fairly safe to convert integer features to float. So, we ask the evaluation data to infer data types from the schema of the training data. This solves the issue related to data types.</p><pre class="nh ni nj nk nl px py pz bp qa bb bk"><span id="0a00" class="qb ot fq py b bg qc qd l qe qf"># INT can be safely converted to FLOAT. So we can safely ignore it and ask TFDV to use schema<br/><br/>options = tfdv.StatsOptions(schema=schema, infer_type_from_schema=True)<br/>eval_stats=tfdv.generate_statistics_from_csv(ANOMALOUS_DATA, stats_options=options)<br/><br/>anomalies=tfdv.validate_statistics(statistics=eval_stats, schema=schema)<br/>tfdv.display_anomalies(anomalies)</span></pre><figure class="nh ni nj nk nl nm ne nf paragraph-image"><div class="ne nf ra"><img src="../Images/92c72092ec74cac90fd4ad70c57f5ec0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1312/format:webp/1*GCD9FiGAEB6t56NHdV-STg.png"/></div><figcaption class="ns nt nu ne nf nv nw bf b bg z dx">Resolved datatype issue</figcaption></figure><p id="b071" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Finally, we end up with the last set of anomalies; 2 columns that are present in the Training data are missing in the Evaluation data.</p><p id="3dfa" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">‘Transported’ is the class label and it will obviously not be available in the Evalutation data. To solve cases where we know that training and evaluation features might differ from each other, we can create multiple environments. Here we create a Training and a Serving environment. We specify that the ‘Transported’ feature will be available in the Training environment but will not be available in the Serving environment.</p><pre class="nh ni nj nk nl px py pz bp qa bb bk"><span id="8cc8" class="qb ot fq py b bg qc qd l qe qf"># Transported is the class label and will not be available in Evaluation data.<br/># To indicate that we set two environments; Training and Serving<br/><br/>schema.default_environment.append('Training')<br/>schema.default_environment.append('Serving')<br/><br/>tfdv.get_feature(schema, 'Transported').not_in_environment.append('Serving')<br/><br/>serving_anomalies_with_environment=tfdv.validate_statistics(<br/>    statistics=eval_stats, schema=schema, environment='Serving')<br/><br/>tfdv.display_anomalies(serving_anomalies_with_environment)</span></pre><p id="9787" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">‘RoomService’ is a required feature that is not available in the Serving environment. Such cases call for manual interventions by domain experts.</p><p id="a960" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Keep resolving issues until you get this output.</p><figure class="nh ni nj nk nl nm ne nf paragraph-image"><div role="button" tabindex="0" class="nn no ed np bh nq"><div class="ne nf rb"><img src="../Images/6d1f86bc09f29744bb1e7e7ab96d015c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9zG71r_0WILfwYcRX4z6YQ.png"/></div></div><figcaption class="ns nt nu ne nf nv nw bf b bg z dx">All Anomalies Resolved</figcaption></figure><p id="598c" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">All the anomalies have been resolved</p><h1 id="ac6e" class="os ot fq bf ou ov ow gq ox oy oz gt pa pb pc pd pe pf pg ph pi pj pk pl pm pn bk">Step 5: Training-Serving Drift and Skew Detection</h1><p id="b809" class="pw-post-body-paragraph mi mj fq mk b go po mm mn gr pp mp mq mr pq mt mu mv pr mx my mz ps nb nc nd fj bk">The next step is to check for drifts and skews. Skew occurs due to irregularity in the distribution of data. Initially when a model is trained, its predictions are usually perfect. However, as time goes by, the data distribution changes and misclassification errors start to increase, this is called drift. These issues require model retraining.</p><p id="9a2e" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">L-infinity distance is used to measure skew and drift. A threshold value is set based on the L-infinity distance. If the difference between the analyzed features in training and serving environment exceeds the given threshold, the feature is considered to have experienced drift. A similar threshold based approach is followed for skew. For our example, we have set the threshold level to be 0.01 for both drift and skew.</p><pre class="nh ni nj nk nl px py pz bp qa bb bk"><span id="cb6d" class="qb ot fq py b bg qc qd l qe qf">serving_stats = tfdv.generate_statistics_from_csv(TEST_DATA)<br/><br/># Skew Comparator<br/>spa_analyze=tfdv.get_feature(schema, 'Spa')<br/>spa_analyze.skew_comparator.infinity_norm.threshold=0.01<br/><br/># Drift Comparator<br/>CryoSleep_analyze=tfdv.get_feature(schema, 'CryoSleep')<br/>CryoSleep_analyze.drift_comparator.infinity_norm.threshold=0.01<br/><br/>skew_anomalies=tfdv.validate_statistics(statistics=train_stats, schema=schema,<br/>                                        previous_statistics=eval_stats,<br/>                                        serving_statistics=serving_stats)<br/>tfdv.display_anomalies(skew_anomalies)</span></pre><p id="96b8" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">We can see that the skew level exhibited by ‘Spa’ is acceptable (as it is not listed in the anomaly list), however, ‘CryoSleep’ exhibits high drift levels. When creating automated pipelines, these anomalies could be used as triggers for automated model retraining.</p><figure class="nh ni nj nk nl nm ne nf paragraph-image"><div role="button" tabindex="0" class="nn no ed np bh nq"><div class="ne nf rc"><img src="../Images/74229d1ba539bc27649b3fd74c0a075d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*79RygBj6D57yJZ0_dij_xQ.png"/></div></div><figcaption class="ns nt nu ne nf nv nw bf b bg z dx">High Skew in CryoSleep</figcaption></figure><h1 id="ddef" class="os ot fq bf ou ov ow gq ox oy oz gt pa pb pc pd pe pf pg ph pi pj pk pl pm pn bk">Step 6: Save the Schema</h1><p id="0fbf" class="pw-post-body-paragraph mi mj fq mk b go po mm mn gr pp mp mq mr pq mt mu mv pr mx my mz ps nb nc nd fj bk">After resolving all the anomalies, the schema could be saved as an artifact, or could be saved in the metadata repository and could be used in the ML pipeline.</p><pre class="nh ni nj nk nl px py pz bp qa bb bk"><span id="3a25" class="qb ot fq py b bg qc qd l qe qf"># Saving the Schema<br/>from tensorflow.python.lib.io import file_io<br/>from google.protobuf import text_format<br/><br/>file_io.recursive_create_dir('schema')<br/>schema_file = os.path.join('schema', 'schema.pbtxt')<br/>tfdv.write_schema_text(schema, schema_file)</span></pre><pre class="rd px py pz bp qa bb bk"><span id="e7a5" class="qb ot fq py b bg qc qd l qe qf"># Loading the Schema<br/>loaded_schema= tfdv.load_schema_text(schema_file)<br/>loaded_schema</span></pre><p id="7669" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">You can download the notebook and the data files from my GitHub repository using this <a class="af nx" href="https://github.com/akila29/TF_Transform_Demo" rel="noopener ugc nofollow" target="_blank">link</a></p><h1 id="eefe" class="os ot fq bf ou ov ow gq ox oy oz gt pa pb pc pd pe pf pg ph pi pj pk pl pm pn bk">Other options to look into</h1><p id="c225" class="pw-post-body-paragraph mi mj fq mk b go po mm mn gr pp mp mq mr pq mt mu mv pr mx my mz ps nb nc nd fj bk">You can read the following articles to know what your choices are and how to select the right framework for your ML pipeline project</p><div class="ny nz oa ob oc od"><a href="https://eitca.org/artificial-intelligence/eitc-ai-gcml-google-cloud-machine-learning/google-cloud-ai-platform/setting-up-ai-platform-pipelines/examination-review-setting-up-ai-platform-pipelines/what-are-the-advantages-and-differences-between-tfx-sdk-and-kubeflow-pipelines-sdk-and-how-should-you-choose-between-them-when-creating-your-own-pipeline/?source=post_page-----9770311eb7ce--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab ig"><div class="of ab co cb og oh"><h2 class="bf fr hw z io oi iq ir oj it iv fp bk">What are the advantages and differences between TFX SDK and Kubeflow Pipelines SDK, and how should…</h2><div class="ok l"><h3 class="bf b hw z io oi iq ir oj it iv dx">The TFX SDK (TensorFlow Extended Software Development Kit) and Kubeflow Pipelines SDK are two powerful tools that can…</h3></div><div class="ol l"><p class="bf b dy z io oi iq ir oj it iv dx">eitca.org</p></div></div><div class="om l"><div class="re l oo op oq om or lq od"/></div></div></a></div><div class="ny nz oa ob oc od"><a href="https://www.restack.io/docs/mlflow-knowledge-mlflow-vs-tensorflow-extended?source=post_page-----9770311eb7ce--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="oe ab ig"><div class="of ab co cb og oh"><h2 class="bf fr hw z io oi iq ir oj it iv fp bk">MLflow vs TensorFlow Extended Comparison</h2><div class="ok l"><h3 class="bf b hw z io oi iq ir oj it iv dx">Explore the differences between MLflow and TensorFlow Extended for managing machine learning workflows.</h3></div><div class="ol l"><p class="bf b dy z io oi iq ir oj it iv dx">www.restack.io</p></div></div><div class="om l"><div class="rf l oo op oq om or lq od"/></div></div></a></div><p id="6316" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Thanks for reading my article. If you like it, please encourage by giving me a few claps, and if you are in the other end of the spectrum, let me know what can be improved in the comments. Ciao.</p><p id="ae9b" class="pw-post-body-paragraph mi mj fq mk b go ml mm mn gr mo mp mq mr ms mt mu mv mw mx my mz na nb nc nd fj bk">Unless otherwise noted, all images are by the author.</p></div></div></div></div>    
</body>
</html>