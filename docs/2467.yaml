- en: Mastering Sample Size Calculations
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 精通样本大小计算
- en: 原文：[https://towardsdatascience.com/mastering-sample-size-calculations-75afcddd2ff3?source=collection_archive---------6-----------------------#2024-10-09](https://towardsdatascience.com/mastering-sample-size-calculations-75afcddd2ff3?source=collection_archive---------6-----------------------#2024-10-09)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://towardsdatascience.com/mastering-sample-size-calculations-75afcddd2ff3?source=collection_archive---------6-----------------------#2024-10-09](https://towardsdatascience.com/mastering-sample-size-calculations-75afcddd2ff3?source=collection_archive---------6-----------------------#2024-10-09)
- en: A/B Testing, Reject Inference, and How to Get the Right Sample Size for Your
    Experiments
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: A/B 测试、拒绝推断以及如何为实验获取正确的样本大小
- en: '[](https://medium.com/@lucasbraga461?source=post_page---byline--75afcddd2ff3--------------------------------)[![Lucas
    Braga](../Images/a652476cfec8d4f129d2d47a64c3e8c3.png)](https://medium.com/@lucasbraga461?source=post_page---byline--75afcddd2ff3--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--75afcddd2ff3--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--75afcddd2ff3--------------------------------)
    [Lucas Braga](https://medium.com/@lucasbraga461?source=post_page---byline--75afcddd2ff3--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/@lucasbraga461?source=post_page---byline--75afcddd2ff3--------------------------------)[![Lucas
    Braga](../Images/a652476cfec8d4f129d2d47a64c3e8c3.png)](https://medium.com/@lucasbraga461?source=post_page---byline--75afcddd2ff3--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--75afcddd2ff3--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--75afcddd2ff3--------------------------------)
    [Lucas Braga](https://medium.com/@lucasbraga461?source=post_page---byline--75afcddd2ff3--------------------------------)'
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--75afcddd2ff3--------------------------------)
    ·17 min read·Oct 9, 2024
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: ·发表于 [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--75afcddd2ff3--------------------------------)
    ·阅读时间 17 分钟·2024年10月9日
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '![](../Images/1a94f5016a3129b52d57233ef1ea9dbd.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1a94f5016a3129b52d57233ef1ea9dbd.png)'
- en: Image created by the author
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 图片由作者制作
- en: 'There are different statistical formulas for different scenarios. The first
    question to ask is: are you **comparing two groups**, such as in an **A/B test**,
    or are you **selecting a sample from a population** that is large enough to represent
    it?'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 针对不同的场景，有不同的统计公式。首先要问的问题是：你是在**比较两组**数据，比如在**A/B 测试**中，还是在**从一个足够大的群体中选择样本**，以使其能够代表该群体？
- en: The latter is typically used in cases like holdout groups in transactions. These
    holdout groups can be crucial for assessing the performance of fraud prevention
    rules or for reject inference, where machine learning models for fraud detection
    are retrained. The holdout group is beneficial because it contains transactions
    that weren’t blocked by any rules or models, providing an unbiased view of performance.
    However, to ensure the holdout group is representative, you need to select a sample
    size that accurately reflects the population, which, together with sample sizing
    for A/B testing, we’ll explore it in this article.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 后者通常用于像交易中的保留组这样的场景。这些保留组对于评估欺诈预防规则的性能或拒绝推断非常关键，在这种情况下，欺诈检测的机器学习模型会重新训练。保留组的优势在于，它包含了没有被任何规则或模型阻止的交易，从而提供了一个不偏不倚的性能视角。然而，为了确保保留组具有代表性，你需要选择一个能准确反映群体的样本大小，这一点将在本文中与
    A/B 测试的样本大小一起探讨。
- en: After determining whether you’re **comparing two groups** (like in A/B testing)
    or **taking a representative sample** (like for reject inference), the next step
    is to define your success metric. **Is it a proportion or an absolute number?**
    For example, **comparing two proportions** could involve conversion rates or default
    rates, where the number of default transactions is divided by the total number
    of transactions. On the other hand, **comparing two means** applies when dealing
    with absolute values, such as total revenue or GMV (Gross Merchandise Value).
    In this case, you would compare the average revenue per customer, assuming customer-level
    randomization in your experiment.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 在确定是否**比较两组**（如 A/B 测试）或**选择一个代表性样本**（如拒绝推断）之后，下一步是定义你的成功指标。**它是一个比例还是一个绝对数值？**例如，**比较两个比例**可能涉及转化率或违约率，其中违约交易的数量除以交易总数。另一方面，**比较两个均值**适用于处理绝对值的情况，比如总收入或
    GMV（商品交易总值）。在这种情况下，你会比较每个客户的平均收入，假设你的实验中存在客户级别的随机化。
- en: 1\. Comparing two groups (e.g. A/B testing) — Sample Size
  id: totrans-11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 1\. 比较两组（例如 A/B 测试）——样本大小
- en: The section 1.1 is about comparing two means, but most of the principles presented
    there will be the same for section 1.2.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 第1.1节是关于比较两个均值的，但这里提出的大多数原理在第1.2节中也适用。
- en: 1.1\. Comparing two Means (metric the average of an absolute number)
  id: totrans-13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 1.1\. 比较两个均值（度量绝对数值的平均值）
- en: 'In this scenario, we are comparing two groups: a control group and a treatment
    group. The control group consists of customers with access to €100 credit through
    a lending program, while the treatment group consists of customers with access
    to €200 credit under the same program.'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，我们比较两个组：一个控制组和一个处理组。控制组由通过借贷计划获得100欧元信用额度的客户组成，而处理组由通过同一计划获得200欧元信用额度的客户组成。
- en: The goal of the experiment is to determine whether increasing the credit limit
    leads to higher customer spending.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 实验的目标是确定是否增加信用额度会导致客户支出增加。
- en: Our success metric is defined as the **average amount spent per customer per
    week**, measured in euros.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 我们的成功度量定义为**每位客户每周的平均支出金额**，以欧元为单位。
- en: With the goal and success metric established, in a typical A/B test, we would
    also define the hypothesis, the randomization unit (in this case, the customer),
    and the target population (new customers granted credit). However, since the focus
    of this document is on sample size, we will not go into those details here.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 在确立目标和成功度量后，在典型的A/B测试中，我们还会定义假设、随机化单元（在本例中为客户）以及目标人群（获得信用的新客户）。然而，由于本文的重点是样本量，我们将在这里不讨论这些细节。
- en: 'We will compare the **average weekly spending per customer** between the control
    group and the treatment group. Let’s proceed with calculating this metric using
    the following script:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将比较控制组和处理组之间的**每位客户每周的平均支出**。接下来，我们将使用以下脚本来计算这个度量：
- en: '*Script 1: Computing the success metric, branch: Germany, period: 2024–05–01
    to 2024–07–31.*'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: '*脚本 1：计算成功度量，分支：德国，周期：2024年5月1日至2024年7月31日。*'
- en: '[PRE0]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: In the results, we observe the metric **avg_amount_spent_eur_per_customer**
    on a weekly basis. Over the last four weeks, the values have remained relatively
    stable, ranging between 35 and 54 euros. However, when considering all weeks over
    the past two months, the variance is higher. (See Image 1 for reference.)
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 在结果中，我们观察到每周的度量**avg_amount_spent_eur_per_customer**。在过去的四周里，数值保持相对稳定，介于35欧元和54欧元之间。然而，考虑到过去两个月的所有周，方差较大。（请参见图像
    1 作为参考。）
- en: '![](../Images/279deef453754e038e447a2186f57ef8.png)'
  id: totrans-22
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/279deef453754e038e447a2186f57ef8.png)'
- en: '*Image 1: Results of the script 1.*'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: '*图像 1：脚本 1 的结果。*'
- en: Next, we calculate the variance of the success metric. To do this, we will use
    **Script 2** to compute both the variance and the average of the weekly spending
    across all weeks.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们计算成功度量的方差。为此，我们将使用**脚本 2**来计算所有周的方差和平均值。
- en: '*Script 2: Query to compute the variance of the success metric and average
    over all weeks.*'
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: '*脚本 2：查询计算成功度量的方差，并计算所有周的平均值。*'
- en: '[PRE1]'
  id: totrans-26
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: The result from **Script 2** shows that the variance is approximately 145.8
    (see Image 2). Additionally, the **average amount spent per user**, considering
    all weeks over the past two months, is **49.5 euros**.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: '**脚本 2**的结果显示方差约为145.8（请参见图像 2）。此外，考虑到过去两个月的所有周，**每位用户的平均消费金额**为**49.5欧元**。'
- en: '![](../Images/64278faf0614a71b9041fb7f28ac45ad.png)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/64278faf0614a71b9041fb7f28ac45ad.png)'
- en: '*Image 2: Results of Script 2.*'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: '*图像 2：脚本 2 的结果。*'
- en: Now that we’ve calculated the metric and found the average weekly spending per
    customer to be approximately **49.5 euros**, we can define the **Minimum Detectable
    Effect (MDE)**. Given the increase in credit from €100 to €200, we aim to detect
    a **10% increase** in spending, which corresponds to a new average of **54.5 euros**
    per customer per week.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们已经计算出度量并发现每位客户的平均每周支出约为**49.5欧元**，我们可以定义**最小可检测效应（MDE）**。鉴于信用从100欧元增加到200欧元，我们旨在检测**10%的支出增加**，这相当于每位客户每周的新的平均值为**54.5欧元**。
- en: 'With the variance calculated (145.8) and the MDE established, we can now plug
    these values into the formula to calculate the **sample size** required. We’ll
    use default values for **alpha (5%)** and **beta (20%)**:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 计算方差（145.8）并确定MDE后，我们可以将这些值代入公式中，计算所需的**样本量**。我们将使用默认值**alpha（5%）**和**beta（20%）**：
- en: '**Significance Level (Alpha’s default value is α = 5%)**: The alpha is a predetermined
    threshold used as a criteria to reject the null hypothesis. Alpha is the type
    I error (false positive), and the p-value needs to be lower than the alpha, so
    that we can reject the null hypothesis.'
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**显著性水平（Alpha的默认值为α = 5%）**：Alpha是一个预定的阈值，用作拒绝零假设的标准。Alpha是I类错误（假阳性），p值需要低于Alpha，才能拒绝零假设。'
- en: '**Statistical Power (Beta’s default value is β = 20%)**: It’s the probability
    that a test correctly rejects the null hypothesis when the alternative hypothesis
    is true, i.e. detecting an effect when the effect is present. Statistical Power
    = 1 — β, and β is the type II error (false negative).'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**统计功效（Beta的默认值为β = 20%）**：这是测试在替代假设为真时正确拒绝零假设的概率，即在效应存在时检测到效应。统计功效 = 1 — β，β是II类错误（假阴性）。'
- en: 'Here is the formula to calculate the required sample size per group (control
    and treatment) for comparing two means in a typical A/B test scenario:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 这是计算在典型的A/B测试场景中每组（对照组和治疗组）所需样本量的公式：
- en: '![](../Images/3319033fd8fc46b6a2bfc7d696caa84f.png)'
  id: totrans-35
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3319033fd8fc46b6a2bfc7d696caa84f.png)'
- en: '*Image 3: Formula to calculate sample size when comparing two means.*'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: '*图像 3：计算比较两个均值时样本量的公式。*'
- en: '**n** is the sample size per group.'
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**n**是每组的样本量。'
- en: '**σ²** is the variance of the metric being tested (in this case, **145.8**).
    The factor 2σ² is used because we calculate the **pooled variance**, making it
    unbiased when comparing two samples.'
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**σ²**是正在测试的度量的方差（在本例中为**145.8**）。因子2σ²被使用，因为我们计算的是**合并方差**，这样在比较两个样本时不会产生偏差。'
- en: '**δ (Delta)**, represents the **minimum detectable difference in means** (effect
    size), which is the change we want to detect. That is calculated as: δ² = (μ₁
    — μ₂)² , where **μ₁** is the mean of the control group and **μ₂** is the mean
    of the treatment group.'
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**δ（德尔塔）**表示**最小可检测的均值差异**（效应大小），即我们希望检测的变化。其计算公式为：δ² = (μ₁ — μ₂)²，其中**μ₁**是对照组的均值，**μ₂**是治疗组的均值。'
- en: '**Zα/2**​ is the **z-score** for the corresponding confidence level (e.g.,
    **1.96** for **95% confidence level**).'
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Zα/2**是与相应置信水平对应的**z值**（例如，**1.96**对应于**95%置信水平**）。'
- en: '**Zβ** is the **z-score** associated with the desired power of the test (e.g.,
    **0.84** for **80% power**).'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Zβ**是与所需测试功效相关的**z值**（例如，**0.84**对应于**80%功效**）。'
- en: '[PRE2]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Try it on my web app calculator at [Sample Size Calculator](https://github.com/lucasbraga461/sample-size-calculator),
    as shown in **App Screenshot 1**:'
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 在我的网页应用程序计算器中尝试，[样本量计算器](https://github.com/lucasbraga461/sample-size-calculator)，如**应用截图
    1**所示：
- en: '**Confidence Level**: 95%'
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**置信水平**：95%'
- en: '**Statistical Power**: 80%'
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**统计功效**：80%'
- en: '**Variance**: 145.8'
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**方差**：145.8'
- en: '**Difference to Detect (Delta)**: 5 (because the expected change is from €49.50
    to €54.50)'
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**需要检测的差异（德尔塔）**：5（因为预期的变化是从€49.50到€54.50）'
- en: '![](../Images/713d7337eda7cae42862e030b17ae896.png)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/713d7337eda7cae42862e030b17ae896.png)'
- en: '*App screenshot 1: Calculating the sample for comparing two means.*'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '*应用截图 1：计算比较两个均值的样本量。*'
- en: Based on the previous calculation, we would need **92 users** in the control
    group and **92 users** in the treatment group, for a total of **184 samples**.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 根据之前的计算，我们需要**92个用户**在对照组中，**92个用户**在治疗组中，总共需要**184个样本**。
- en: Now, let’s explore how changing the **Minimum Detectable Effect (MDE)** impacts
    the sample size. Smaller MDEs require larger sample sizes. For example, if we
    were aiming to detect a change of only **€1 increase** on average per user, instead
    of the **€5 increase (10%)** we used previously, the required sample size would
    increase significantly.
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们探讨一下改变**最小可检测效应（MDE）**如何影响样本量。较小的MDE需要更大的样本量。例如，如果我们希望检测每个用户平均**€1的增加**，而不是之前使用的**€5的增加（10%）**，所需的样本量将显著增加。
- en: The smaller the MDE, the more sensitive the test needs to be, which means we
    need a larger sample to reliably detect such a small effect.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: MDE越小，测试需要越敏感，这意味着我们需要更大的样本量才能可靠地检测到如此微小的效应。
- en: '[PRE3]'
  id: totrans-53
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'We enter the following parameters into the web app calculator at [Sample Size
    Calculator](https://github.com/lucasbraga461/sample-size-calculator), as shown
    in **App Screenshot 2**:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将以下参数输入到[样本量计算器](https://github.com/lucasbraga461/sample-size-calculator)的网页应用程序计算器中，如**应用截图
    2**所示：
- en: '**Confidence Level**: 95%'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**置信水平**：95%'
- en: '**Statistical Power**: 80%'
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**统计功效**：80%'
- en: '**Variance**: 145.8'
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**方差**：145.8'
- en: '**Difference to Detect (Delta)**: 1 (because the expected change is from €49.50
    to €50.50)'
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**需要检测的差异（德尔塔）**：1（因为预期的变化是从€49.50到€50.50）'
- en: '![](../Images/dadc8ff02400ac38d2c7af78ab2fb1f8.png)'
  id: totrans-59
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/dadc8ff02400ac38d2c7af78ab2fb1f8.png)'
- en: '*App screenshot 2: Calculating the sample for comparing two means with Delta
    = 1.*'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: '*应用截图 2：计算 Delta = 1 时比较两个均值的样本量。*'
- en: To detect a smaller effect, such as a **€1 increase** per user, we would require
    **2,287 users** in the control group and **2,287 users** in the treatment group,
    resulting in a total of **4,574 samples**.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 为了检测更小的效应，例如每个用户**增加 1 欧元**，我们需要**2,287 个用户**在对照组，**2,287 个用户**在处理组，总共需要**4,574
    个样本**。
- en: Next, we’ll adjust the **statistical power** and **significance level** to recompute
    the required sample size. But first, let’s take a look at the **z-score table**
    to understand how the **Z-value** is derived.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我们将调整**统计功效**和**显著性水平**，重新计算所需的样本量。但首先，让我们看一下**z 值表**，以了解如何推导出**z 值**。
- en: We’ve set **beta = 0.2**, meaning the current statistical power is **80%**.
    Referring to the z-score table (see **Image 4**), this corresponds to a **z-score
    of 0.84**, which is the value used in our previous formula.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 我们已经设置了**β = 0.2**，这意味着当前的统计功效为**80%**。参考 z 值表（见**图像 4**），这对应于**z 值为 0.84**，这是我们之前公式中使用的值。
- en: '![](../Images/0e6df69db82894b33b17d0e9ac808d5f.png)'
  id: totrans-64
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/0e6df69db82894b33b17d0e9ac808d5f.png)'
- en: '*Image 4: Finding the z-score for a statistical power of 80% on z-score table.*'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: '*图像 4：在 z 值表中查找统计功效为 80% 时的 z 值。*'
- en: If we now adjust **beta to 10%**, which corresponds to a **statistical power
    of 90%**, we will find a **z-value of 1.28**. This value can be found on the z-score
    table (see **Image 5**).
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们现在将**β值调整为 10%**，即**统计功效为 90%**，我们将得到**z 值为 1.28**。该值可以在 z 值表中找到（见**图像 5**）。
- en: '[PRE4]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: With the adjustment to a **beta of 10%** (statistical power of 90%) and using
    the **z-value of 1.28**, we now require **3,062 users** in both the control and
    treatment groups, for a total of **6,124 samples**.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 通过调整**β值为 10%**（统计功效为 90%）并使用**z 值为 1.28**，我们现在需要**3,062 个用户**在对照组和处理组中，每组总共**6,124
    个样本**。
- en: '![](../Images/a6d036fdb714dd539fce84c0d01c07e0.png)'
  id: totrans-69
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a6d036fdb714dd539fce84c0d01c07e0.png)'
- en: '*Image 5: Finding the z-score for a statistical power of 90% on the z-score
    table.*'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: '*图像 5：在 z 值表中查找统计功效为 90% 时的 z 值。*'
- en: Now, let’s determine how much traffic the **6,124 samples** represent. We can
    calculate this by finding the average volume of distinct customers per week. **Script
    3** will help us retrieve this information using the time period from **2024–05–01
    to 2024–07–31**.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们来确定**6,124 个样本**所代表的流量。我们可以通过计算每周不同客户的平均交易量来得出这个数据。**脚本 3**将帮助我们获取**2024
    年 5 月 1 日到 2024 年 7 月 31 日**期间的信息。
- en: '*Script 3: Query to calculate the average weekly volume of distinct customers.*'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: '*脚本 3：计算不同客户每周平均交易量的查询。*'
- en: '[PRE5]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: The result from **Script 3** shows that, on average, there are **185,443 distinct
    customers** every week (see **Image 5**). Therefore, the **6,124 samples** represent
    approximately **3.35%** of the total weekly customer base.
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: '**脚本 3**的结果显示，平均每周有**185,443 个不同客户**（见**图像 5**）。因此，**6,124 个样本**大约占总每周客户基数的**3.35%**。'
- en: '![](../Images/c2bdc30698591acd5f31b814526e949e.png)'
  id: totrans-75
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c2bdc30698591acd5f31b814526e949e.png)'
- en: '*Image 5: Results from Script 3.*'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: '*图像 5：脚本 3 的结果。*'
- en: 1.2\. Comparing two Proportions (e.g. conversion rate, default rate)
  id: totrans-77
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 1.2\. 比较两个比例（例如转化率、违约率）
- en: While most of the principles discussed in the previous section remain the same,
    the formula for comparing **two proportions** differs. This is because, instead
    of pre-computing the variance of the metric, we will now focus on the **expected
    proportions of success** in each group (see **Image 6**).
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然前一节讨论的大多数原则保持不变，但比较**两种比例**的公式有所不同。这是因为，我们不再预先计算指标的方差，而是将重点放在每个组的**预期成功比例**上（见**图像
    6**）。
- en: '![](../Images/d8c43c36156bef1324aebd54ec2e8021.png)'
  id: totrans-79
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d8c43c36156bef1324aebd54ec2e8021.png)'
- en: '*Image 6: Formula to calculate sample size for comparing two proportions.*'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: '*图像 6：计算比较两种比例的样本量的公式。*'
- en: 'Let’s return to the same scenario: we are comparing two groups. The control
    group consists of customers who have access to **€100 credit** on the **credit
    lending program**, while the treatment group consists of customers who have access
    to **€200 credit** in the same program.'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们回到相同的场景：我们正在比较两个组。对照组由可以获得**100 欧元信贷**的客户组成，信贷借款计划中的处理组由可以获得**200 欧元信贷**的客户组成。
- en: This time, the success metric we are focusing on is the **default rate**. This
    could be part of the same experiment discussed in **Section 1.1**, where the default
    rate acts as a **guardrail metric**, or it could be an entirely separate experiment.
    In either case, the hypothesis is that giving customers more credit could lead
    to a higher default rate.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 这次，我们关注的成功指标是**违约率**。这可能是**1.1节**中讨论的同一个实验的一部分，其中违约率作为**护栏指标**，也可能是完全独立的实验。无论是哪种情况，假设是给予客户更多信用可能会导致更高的违约率。
- en: The goal of this experiment is to determine whether an increase in credit limits
    results in a **higher default rate**.
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 本次实验的目标是确定信用额度的增加是否会导致**更高的违约率**。
- en: We define the success metric as the **average default rate** for all customers
    during the experiment week. Ideally, the experiment would run over a longer period
    to capture more data, but if that’s not possible, it’s essential to choose a **week
    that is unbiased**. You can verify this by analyzing the default rate over the
    past **12–16 weeks** to identify any specific patterns related to certain weeks
    of the month.
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将成功指标定义为实验周内所有客户的**平均违约率**。理想情况下，实验应持续更长时间以收集更多数据，但如果无法实现这一点，选择一个**没有偏差的星期**就显得尤为重要。你可以通过分析过去**12到16周**的违约率来验证这一点，从中找出与某些月份的特定星期相关的模式。
- en: Let’s examine the data. **Script 4** will display the **default rate per week**,
    and the results can be seen in **Image 7**.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们来查看数据。**脚本4**将显示**每周违约率**，结果可以在**图像7**中看到。
- en: '*Script 4: Query to retrieve default rate per week.*'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: '*脚本4：查询以获取每周违约率。*'
- en: '[PRE6]'
  id: totrans-87
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: Looking at the default rate metric, we notice some variability, particularly
    in the older weeks, but it has remained relatively stable over the past 5 weeks.
    The average default rate for the last 5 weeks is **0.070**.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 从违约率指标来看，我们注意到一些波动，尤其是在较早的几周，但过去5周的违约率相对稳定。过去5周的平均违约率为**0.070**。
- en: '![](../Images/acfeee9cf1209936b699b73877b1e6a1.png)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/acfeee9cf1209936b699b73877b1e6a1.png)'
- en: '*Image 7: Results of the default rate per week.*'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: '*图像7：每周违约率的结果。*'
- en: 'Now, let’s assume that this default rate will be representative of the control
    group. The next question is: what default rate in the treatment group would be
    considered unacceptable? We can set the threshold: if the default rate in the
    treatment group increases to **0.075**, it would be too high. However, anything
    up to **0.0749** would still be acceptable.'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，假设这个违约率代表了对照组。那么下一个问题是：在处理组中，什么样的违约率会被认为是不可接受的？我们可以设定一个阈值：如果处理组的违约率增加到**0.075**，就会被认为过高。然而，任何低于**0.0749**的违约率仍然是可以接受的。
- en: A default rate of **0.075** represents approximately **7.2% increase** from
    the control group rate of **0.070**. This difference — 7.2% — is our **Minimum
    Detectable Effect (MDE)**.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 违约率为**0.075**意味着相较于对照组的**0.070**，增加了大约**7.2%**。这个差异——7.2%——是我们的**最小可检测效应 (MDE)**。
- en: With these data points, we are now ready to compute the required **sample size**.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 有了这些数据点，我们现在可以计算所需的**样本大小**。
- en: '[PRE7]'
  id: totrans-94
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'We enter the following parameters into the web app calculator at [Sample Size
    Calculator](https://github.com/lucasbraga461/sample-size-calculator), as shown
    in **App Screenshot 3**:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将以下参数输入到[样本大小计算器](https://github.com/lucasbraga461/sample-size-calculator)的网页应用程序中，如**应用截图3**所示：
- en: '**Confidence Level**: 95%'
  id: totrans-96
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**置信水平**：95%'
- en: '**Statistical Power**: 80%'
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**统计功效**：80%'
- en: '**First Proportion (p1)**: 0.070'
  id: totrans-98
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第一次比例 (p1)**：0.070'
- en: '**Second Proportion (p2)**: 0.075'
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**第二次比例 (p2)**：0.075'
- en: '![](../Images/b4b40f485edaa98373743b979f70ec20.png)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b4b40f485edaa98373743b979f70ec20.png)'
- en: '*App screenshot 3: Calculating the sample size for comparing two proportions.*'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: '*应用截图3：计算比较两种比例的样本大小。*'
- en: To detect a **7.2% increase** in the default rate (from **0.070** to **0.075**),
    we would need **42,171 users** in both the control group and the treatment group,
    resulting in a total of **84,343 samples**.
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 为了检测违约率的**7.2%增长**（从**0.070**到**0.075**），我们需要在对照组和处理组中各有**42,171个用户**，因此总样本数为**84,343个**。
- en: A sample size of **84,343** is quite large! We may not even have enough customers
    to run this analysis. But let’s explore why this is the case. We haven’t changed
    the default parameters for **alpha** and **beta**, meaning we kept the **significance
    level** at the default **5%** and the **statistical power** at the default **80%**.
    As we’ve discussed earlier, we could have been more conservative by choosing a
    lower significance level to reduce the chance of false positives, or we could
    have increased the statistical power to minimize the risk of false negatives.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 样本大小为**84,343**相当大！我们可能甚至没有足够的客户来进行这个分析。但让我们探讨一下为什么会这样。我们没有改变**alpha**和**beta**的默认参数，这意味着我们将**显著性水平**保持在默认的**5%**，并将**统计功效**保持在默认的**80%**。正如我们之前讨论过的，我们本可以通过选择较低的显著性水平来减少假阳性的机会，或者我们可以提高统计功效来最小化假阴性的风险。
- en: 'So, what contributed to the large sample size? Is it the **MDE** of **7.2%**?
    The short answer: **not exactly**.'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，是什么导致了如此大的样本量？是**7.2%的MDE**吗？简短的回答是：**不完全是**。
- en: 'Consider this alternative scenario: we maintain the same **significance level
    (5%)**, **statistical power (80%)**, and **MDE (7.2%)**, but imagine that the
    **default rate (p₁)** was **0.23 (23%)** instead of **0.070 (7.0%)**. With a **7.2%
    MDE**, the new default rate for the treatment group (**p₂**) would be **0.2466
    (24.66%)**. Notice that this is still a **7.2% MDE**, but the proportions are
    significantly higher than **0.070 (7.0%)** and **0.075 (7.5%)**.'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 考虑这种替代情境：我们保持相同的**显著性水平（5%）**、**统计功效（80%）**和**MDE（7.2%）**，但假设**默认比例（p₁）**是**0.23（23%）**而不是**0.070（7.0%）**。在**7.2%的MDE**下，治疗组的新的默认比例（**p₂**）将是**0.2466（24.66%）**。注意，这仍然是**7.2%的MDE**，但比例明显高于**0.070（7.0%）**和**0.075（7.5%）**。
- en: Now, when we perform the sample size calculation using these new values of **p₁
    = 0.23** and **p₂ = 0.2466**, the results will differ. Let’s compute that next.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，当我们使用这些新的值**p₁ = 0.23** 和 **p₂ = 0.2466**进行样本量计算时，结果会有所不同。接下来，我们来计算一下。
- en: '[PRE8]'
  id: totrans-107
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: With the new default rates (**p₁ = 0.23** and **p₂ = 0.2466**), we would need
    **10,325 users** in both the control and treatment groups, resulting in a total
    of **20,649 samples**. This is much more manageable compared to the previous sample
    size of 84,343\. However, it’s important to note that the default rates in this
    scenario are in a completely different range.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 使用新的默认比例（**p₁ = 0.23** 和 **p₂ = 0.2466**），我们在对照组和治疗组中各需要**10,325个用户**，总共需要**20,649个样本**。与之前的84,343样本相比，这样的样本量更加可管理。然而，值得注意的是，这种情况下的默认比例处于完全不同的范围。
- en: The key takeaway is that **lower success rates** (like default rates around
    **7%**) require **larger sample sizes**. When the proportions are smaller, detecting
    even modest differences (like a 7.2% increase) becomes more challenging, thus
    requiring more data to achieve the same statistical power and significance level.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 关键的结论是，**较低的成功率**（如接近**7%**的默认比例）需要**更大的样本量**。当比例较小的时候，检测到即使是适度的差异（比如7.2%的增长）也变得更加困难，因此需要更多的数据才能实现相同的统计功效和显著性水平。
- en: 2\. Sampling a population
  id: totrans-110
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 2\. 抽样一个群体
- en: This case differs from the A/B testing scenario, as we are now focusing on determining
    a **sample size from a single group**. The goal is to take a sample that accurately
    represents the population, allowing us to run an analysis and then extrapolate
    the results to estimate what would happen across the entire population.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 这个案例与A/B测试场景有所不同，因为我们现在专注于从**单一群体**中确定**样本量**。目标是选取一个能够准确代表群体的样本，从而进行分析并推断结果，进而估算整个群体可能发生的情况。
- en: Even though we are not comparing two groups, **sampling from a population**
    (a single group) still requires deciding whether you are estimating a **mean**
    or a **proportion**. The formulas for these scenarios are quite similar to those
    used in A/B testing.
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
  zh: 即使我们不在比较两个群体，**从群体中抽样**（一个群体）仍然需要决定你是在估算**均值**还是**比例**。这两种情况的公式与A/B测试中使用的公式非常相似。
- en: Take a look at **images 8** and **9**. Did you notice the similarities when
    comparing **image 8** with **image 3** (sample size formula for comparing two
    means) and when comparing **image 9** with **image 6** (sample size formula for
    comparing two proportions)? They are indeed quite similar.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 看一下**图像8**和**图像9**。当你将**图像8**与**图像3**（比较两个均值的样本量公式）进行对比，或者将**图像9**与**图像6**（比较两个比例的样本量公式）进行对比时，你是否注意到了相似之处？它们确实非常相似。
- en: '![](../Images/5eda2848fc5b628130f111cc12b69c25.png)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/5eda2848fc5b628130f111cc12b69c25.png)'
- en: '*Image 8: Sample size formula to estimate the mean of a population.*'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: '*图像 8：用于估算总体均值的样本量公式。*'
- en: 'In the case of estimating the mean:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 在估算均值的情况下：
- en: From image 8, the formula for sampling from one group, however, uses **E**,
    which stands for the **Error**.
  id: totrans-117
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从图像 8 中，抽样自单一组的公式则使用了**E**，表示**误差**。
- en: From image 3, the formula for comparing two groups uses **delta (δ)** to compare
    the difference between the two means.
  id: totrans-118
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从图像 3 中，比较两组的公式使用了**delta (δ)** 来比较两者均值之间的差异。
- en: '![](../Images/60be487bef3d722c56c371ad2c62b607.png)'
  id: totrans-119
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/60be487bef3d722c56c371ad2c62b607.png)'
- en: '*Image 9: Sample size formula to estimate the proportion of a population.*'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: '*图像 9：用于估算总体比例的样本量公式。*'
- en: 'In the case of estimating proportions:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 在估算比例的情况下：
- en: From image 9, for sampling from a single group, the formula for proportions
    also uses **E** instead, representing the **Error**.
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从图像 9 可以看出，单组抽样的比例公式也使用了**E**，代表**误差**。
- en: From image 6, the formula for comparing two groups uses the **MDE (Minimum Detectable
    Effect)**, similar to delta, to compare the difference between two proportions.
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从图像 6 中，比较两组的公式使用了**MDE（最小可检测效应）**，类似于差值，用于比较两种比例之间的差异。
- en: Now, when should we use each of these formulas? Let’s explore two practical
    examples — one for estimating a **mean** and another for estimating a **proportion**.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 那么，我们什么时候使用这些公式呢？让我们探讨两个实际例子——一个用于估算**均值**，另一个用于估算**比例**。
- en: 2.1\. Sampling a population — Estimating the mean
  id: totrans-125
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 2.1\. 抽样总体 — 估算均值
- en: Let’s say you want to better assess the **risk of fraud**, and to do so, you
    aim to estimate the **average order value of fraudulent transactions** by country
    and per week. This can be quite challenging because, ideally, most fraudulent
    transactions are already being blocked. To get a clearer picture, you would take
    a **holdout group** that is free of rules and models, which would serve as a reference
    for calculating the true average order value of fraudulent transactions.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你希望更好地评估**欺诈风险**，为此，你打算估算每个国家每周的**欺诈交易平均订单值**。这可能相当具有挑战性，因为理想情况下，大多数欺诈交易已经被阻止。为了获得更清晰的图像，你将采用一个**保留组**，它不受任何规则和模型的影响，作为计算欺诈交易的真实平均订单值的参考。
- en: 'Suppose you select a specific country, and after reviewing historical data,
    you find that:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 假设你选择了一个特定的国家，并在回顾历史数据后发现：
- en: The variance of this metric is **€905**.
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 该指标的方差为**€905**。
- en: The average order value of fraudulent transactions is **€100**.
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 欺诈交易的平均订单值为**€100**。
- en: (You can refer to **Scripts 1 and 2** for calculating the success metric and
    variance.)
  id: totrans-130
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: （你可以参考**脚本 1 和 2**来计算成功指标和方差。）
- en: Since the variance is **€905**, the **standard deviation** (square root of variance)
    is approximately **€30**. Now, using a **significance level of 5%**, which corresponds
    to a **z-score of 1.96**, and assuming you’re comfortable with a **10% margin
    of error** (representing an Error of **€10**, or 10% of €100), the **confidence
    interval** at 95% would mean that with the correct sample size, you can say with
    **95% confidence** that the average value falls between **€90 and €110**.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 由于方差为**€905**，**标准差**（方差的平方根）约为**€30**。现在，使用**5%的显著性水平**，对应的**z-score为1.96**，并假设你能接受**10%的误差范围**（代表**€10**的误差，或是€100的10%），那么在95%的**置信区间**下，意味着在正确的样本量下，你可以**95%的置信度**断言平均值落在**€90到€110**之间。
- en: 'Now, plugging these inputs into the sample size formula:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，将这些输入值代入样本量公式：
- en: '[PRE9]'
  id: totrans-133
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'We enter the following parameters into the web app calculator at [Sample Size
    Calculator](https://github.com/lucasbraga461/sample-size-calculator), as shown
    in **App Screenshot 4**:'
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将以下参数输入到网页应用计算器中，在[样本量计算器](https://github.com/lucasbraga461/sample-size-calculator)中，如**应用截图
    4**所示：
- en: '**Confidence Level**: 95%'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**置信水平**：95%'
- en: '**Variance**: 905'
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**方差**：905'
- en: '**Error**: 10'
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**误差**：10'
- en: '![](../Images/372ea787d2fa0e5d445df9000f6a8d38.png)'
  id: totrans-138
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/372ea787d2fa0e5d445df9000f6a8d38.png)'
- en: '*App screenshot 4: Calculating the sample size for estimating the mean when
    sampling a population.*'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: '*应用截图 4：在抽样一个总体时，计算估算均值的样本量。*'
- en: The result is that you would need **35 samples** to estimate the **average order
    value of fraudulent transactions** per country per week. However, that’s not the
    final sample size.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 结果是，你需要**35个样本**来估算每个国家每周的**欺诈交易平均订单值**。然而，这还不是最终的样本量。
- en: 'Since fraudulent transactions are relatively rare, you need to adjust for the
    **proportion of fraudulent transactions**. If the proportion of fraudulent transactions
    is **1%**, the actual number of samples you need to collect is:'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 由于欺诈交易相对较少，你需要调整**欺诈交易的比例**。如果欺诈交易的比例为**1%**，那么你需要收集的实际样本数量为：
- en: '[PRE10]'
  id: totrans-142
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Thus, you would need 3,500 samples to ensure that fraudulent transactions are
    properly represented.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，你需要3,500个样本，以确保欺诈交易得到适当的代表。
- en: 2.2\. Sampling a population — Estimating a proportion
  id: totrans-144
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 2.2. 抽样总体——估计一个比例
- en: In this scenario, our fraud rules and models are blocking a significant number
    of transactions. To assess how well our rules and models perform, we need to let
    a portion of the traffic bypass the rules and models so that we can evaluate the
    **actual false positive rate**. This group of transactions that passes through
    without any filtering is known as a **holdout group**. This is a common practice
    in fraud data science teams because it allows for both evaluating rule and model
    performance and reusing the holdout group for **reject inference**.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 在这种情况下，我们的欺诈规则和模型已经阻止了大量交易。为了评估我们的规则和模型的效果，我们需要让一部分流量绕过规则和模型，以便评估**实际的假阳性率**。这部分未经过滤的交易被称为**留存组**。这是欺诈数据科学团队中的常见做法，因为它既能评估规则和模型的表现，又能将留存组用于**拒绝推断**。
- en: Although we won’t go into detail about reject inference here, it’s worth briefly
    summarizing. **Reject inference** involves using the holdout group of unblocked
    transactions to learn patterns that help improve transaction blocking decisions.
    Several methods exist for this, with **fuzzy augmentation** being a popular one.
    The idea is to relabel previously rejected transactions using the holdout group’s
    data to train new models. This is particularly important in fraud modeling, where
    fraud rates are typically low (often less than 1%, and sometimes as low as 0.1%
    or lower). Increasing labeled data can improve model performance significantly.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管我们在这里不会详细讨论拒绝推断，但值得简要总结一下。**拒绝推断**涉及使用未被阻止的交易的留存组数据，学习有助于改进交易阻止决策的模式。对此有多种方法，其中**模糊增强**是一种流行的方法。其基本思路是使用留存组的数据重新标记之前被拒绝的交易，并用这些数据训练新的模型。在欺诈建模中，这尤其重要，因为欺诈率通常较低（通常低于1%，有时甚至低于0.1%）。增加标记数据可以显著提升模型表现。
- en: Now that we understand the need to estimate a **proportion**, let’s dive into
    a practical use case to find out how many samples are needed.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们明白了估计**比例**的需求，接下来我们将深入探讨一个实际应用案例，看看需要多少样本。
- en: For a certain branch, you analyze historical data and find that it processes
    **50,000,000 orders** in a month, of which **50,000 are fraudulent**, resulting
    in a **0.1% fraud rate**. Using a **significance level of 5% (alpha)** and a **margin
    of error of 25%**, we aim to estimate the true fraud proportion within a **confidence
    interval of 95%**. This means if the true fraud rate is **0.001 (0.1%)**, we would
    be estimating a range between **0.00075** and **0.00125**, with an Error of **0.00025**.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 对于某一分支，你分析历史数据发现该分支每月处理**50,000,000个订单**，其中**50,000个订单是欺诈的**，导致**0.1%的欺诈率**。使用**5%的显著性水平（alpha）**和**25%的误差范围**，我们旨在估计真实的欺诈比例，置信区间为**95%**。这意味着，如果真实的欺诈率为**0.001（0.1%）**，我们估计的范围应在**0.00075**和**0.00125**之间，错误为**0.00025**。
- en: Please note that margin of error and Error are two different things, the margin
    of error is a percentage value, and the Error is an absolute value. In the case
    where the fraud rate is 0.1% if we have a margin of error of 25% that represents
    an Error of 0.00025.
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，误差范围（margin of error）和错误（Error）是两个不同的概念，误差范围是一个百分比值，而错误是一个绝对值。在欺诈率为0.1%的情况下，如果我们的误差范围是25%，那么它代表的错误为0.00025。
- en: 'Let’s apply the formula:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们应用公式：
- en: '**Zα/2** = 1.96 (z-score for 95% confidence level)'
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Zα/2** = 1.96（95%置信水平的z值）'
- en: '**E** = 0.00025 (Error)'
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**E** = 0.00025（错误）'
- en: '**p** = 0.001 (fraud rate)'
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**p** = 0.001（欺诈率）'
- en: '[PRE11]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'We enter the following parameters into the web app calculator at [Sample Size
    Calculator](https://github.com/lucasbraga461/sample-size-calculator), as shown
    in **App Screenshot 5**:'
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在[样本大小计算器](https://github.com/lucasbraga461/sample-size-calculator)的网页应用程序中输入以下参数，如**应用截图5**所示：
- en: '**Confidence Level**: 95%'
  id: totrans-156
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Confidence Level**: 95%'
- en: '**Proportion**: 0.001'
  id: totrans-157
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Proportion**: 0.001'
- en: '**Error**: 0.00025'
  id: totrans-158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Error**: 0.00025'
- en: '![](../Images/1b45a66985a09866e1bc154afe9004be.png)'
  id: totrans-159
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1b45a66985a09866e1bc154afe9004be.png)'
- en: '*App screenshot 5: Calculating the sample size for estimating a proportion
    when sampling a population.*'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: '*应用截图5：计算估算比例的样本大小，当从一个总体中抽样时。*'
- en: Thus, **61,404 samples** are required in total. Given that there are **50,000,000
    transactions** in a month, it would take **less than 1 hour** to collect this
    many samples if the holdout group represented **100% of the traffic**. However,
    this isn’t practical for a reliable experiment.
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，**共需61,404个样本**。假设一个月内有**50,000,000笔交易**，如果保留组代表**100%的流量**，收集这些样本将花费**不到1小时**。然而，这对于一个可靠的实验来说并不现实。
- en: Instead, you would want to **distribute the traffic** across several days to
    avoid **seasonality issues**. Ideally, you would collect data over at least a
    week, ensuring representation from all weekdays while avoiding holidays or peak
    seasons. If you need to gather **61,404 samples** in a week, you would aim for
    **8,772 samples per day**. Since the daily traffic is around **1,666,666 orders**,
    the holdout group would need to represent **0.53% of the total transactions**
    each day, running over the course of a week.
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 相反，你应该**将流量分布**到几天，以避免**季节性问题**。理想情况下，你应收集至少一周的数据，确保覆盖所有工作日，并避免假期或高峰季节。如果你需要在一周内收集**61,404个样本**，那么你需要每天收集**8,772个样本**。由于每日流量约为**1,666,666个订单**，保留组每天需要代表**0.53%的总交易量**，并持续一周。
- en: Final notes
  id: totrans-163
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 最后的备注
- en: 'If you’d like to perform these calculations in Python, here are the relevant
    functions:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: 如果你想在Python中执行这些计算，以下是相关的函数：
- en: '[PRE12]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Here''s how you could calculate the sample size for comparing two means as
    in App screenshot 1 in section 1.1:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 下面是如何计算与第1.1节中应用截图1类似的两组均值比较的样本量：
- en: '[PRE13]'
  id: totrans-167
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'These functions are also available in the GitHub repository: [GitHub Sample
    Size Calculator](https://github.com/lucasbraga461/sample-size-calculator), this
    is also where you can find the link to the Interactive Sample Size Calculator.'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 这些功能也可以在GitHub仓库中找到：[GitHub样本大小计算器](https://github.com/lucasbraga461/sample-size-calculator)，你还可以在那里找到交互式样本大小计算器的链接。
- en: '**Disclaimer**: The images that resemble the results of a Google BigQuery job
    have been created by the author. The numbers shown are not based on any business
    data but were manually generated for illustrative purposes. The same applies to
    the SQL scripts — they are not from any businesses and were also manually generated.
    However, they are designed to **closely resemble** what a company using **Google
    BigQuery** as a framework might encounter.'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: '**免责声明**：与Google BigQuery作业结果相似的图像由作者创建。所示数字并非基于任何商业数据，而是为了说明目的手动生成的。SQL脚本也是如此——它们并非来自任何企业，也都是手动生成的。然而，它们旨在**与使用**Google
    BigQuery**作为框架的公司可能遇到的情况**高度相似。'
- en: Calculator written in Python and deployed in Google Cloud Run (Serverless environment)
    using a Docker container and Streamlit, see [code in GitHub](https://github.com/lucasbraga461/sample-size-calculator)
    for reference.
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 该计算器使用Python编写，并在Google Cloud Run（无服务器环境）中通过Docker容器和Streamlit部署，参考请见[GitHub上的代码](https://github.com/lucasbraga461/sample-size-calculator)。
