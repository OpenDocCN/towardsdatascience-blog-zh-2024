- en: 'Marketing Science 101: How to Analyze Geo-Based Campaigns With Synthetic Control'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/how-to-analyze-geo-based-campaigns-with-synthetic-control-a90b839479a8?source=collection_archive---------8-----------------------#2024-05-22](https://towardsdatascience.com/how-to-analyze-geo-based-campaigns-with-synthetic-control-a90b839479a8?source=collection_archive---------8-----------------------#2024-05-22)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Using Meta’s GeoLift Library
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@mandymliu?source=post_page---byline--a90b839479a8--------------------------------)[![Mandy
    Liu](../Images/ca4530dd41121dc7ab6d1ec9134bb08d.png)](https://medium.com/@mandymliu?source=post_page---byline--a90b839479a8--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--a90b839479a8--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--a90b839479a8--------------------------------)
    [Mandy Liu](https://medium.com/@mandymliu?source=post_page---byline--a90b839479a8--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--a90b839479a8--------------------------------)
    ·6 min read·May 22, 2024
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/35d2615d2d8eab8cdb7d716962c85c55.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Z](https://unsplash.com/@dead____artist?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: '*(If you are not a Medium member, read the full story* [*here*](https://medium.com/towards-data-science/how-to-analyze-geo-based-campaigns-with-synthetic-control-a90b839479a8?sk=41d22feddba967359a2c1471215a6212)*)*'
  prefs: []
  type: TYPE_NORMAL
- en: Navigating the complexities of location-based testing can be challenging.
  prefs: []
  type: TYPE_NORMAL
- en: Luckily, [GeoLift](https://facebookincubator.github.io/GeoLift/docs/intro) is
    here to optimize the process.
  prefs: []
  type: TYPE_NORMAL
- en: 'Developed by Meta’s Marketing Science team, this open-sourced library is designed
    for conducting geo-based experiments. It enables us to:'
  prefs: []
  type: TYPE_NORMAL
- en: Effortlessly select test markets, and
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Generate a synthetic control market to benchmark against your chosen test locations
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: While the GeoLift documentation offers a comprehensive guide on selecting test
    markets, this article will focus specifically on **how to create and utilize a
    synthetic control market**.
  prefs: []
  type: TYPE_NORMAL
- en: Let’s dive in.
  prefs: []
  type: TYPE_NORMAL
- en: Synthetic control method (SCM)
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The graphs illustrate the comparison between the “difference in difference”
    method and the synthetic control method (SCM).
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/0e3507b10492d1be57b427f2fb35c480.png)![](../Images/374975efcbf4583aa6c8008deaaf0a9f.png)'
  prefs: []
  type: TYPE_IMG
- en: Generated by Author using ChatGPT x Wolfram
  prefs: []
  type: TYPE_NORMAL
- en: According to Wikipedia, SCM
  prefs: []
  type: TYPE_NORMAL
- en: is designed to estimate the potential outcomes for a treatment group had the
    treatment not been applied. Unlike the difference in differences approach, SCM
    adjusts for time-varying confounders by weighting the control group to closely
    resemble the treatment group prior to the intervention
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Simply put, SCM constructs a “parallel universe” that allows you to **observe
    potential outcomes if the campaign had not been launched**, enabling a clear comparison
    and measurement of the campaign’s true incremental effects
  prefs: []
  type: TYPE_NORMAL
- en: Streamlined guide to creating synthetic control
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**1\. Process data**'
  prefs: []
  type: TYPE_NORMAL
- en: '**2\. Generate weights**'
  prefs: []
  type: TYPE_NORMAL
- en: '**3\. Visualize synthetic control**'
  prefs: []
  type: TYPE_NORMAL
- en: '**4\. Measure lift**'
  prefs: []
  type: TYPE_NORMAL
- en: The first two steps are detailed in the GeoLift documentation. I’ll include
    the code and output here for consistency.
  prefs: []
  type: TYPE_NORMAL
- en: We’ll execute the initial steps in R and the final two in Python.
  prefs: []
  type: TYPE_NORMAL
- en: If you’re primarily a Python user, don’t worry — the R code is straightforward
    and easy to follow. I promise it will be a breeze!
  prefs: []
  type: TYPE_NORMAL
- en: 1\. Process data
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**What your data should look like:**'
  prefs: []
  type: TYPE_NORMAL
- en: Daily or weekly granularity
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: At least 4–5x the test duration of pre-campaign historical data
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 20 or more geo-units
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: More on [best practices](https://facebookincubator.github.io/GeoLift/docs/Best%20Practices/BestPractices)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Install packages:**'
  prefs: []
  type: TYPE_NORMAL
- en: Install R and RStudio [here](https://posit.co/download/rstudio-desktop/)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Install GeoLift package [here](https://facebookincubator.github.io/GeoLift/docs/GettingStarted/InstallingR)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Load data:**'
  prefs: []
  type: TYPE_NORMAL
- en: Load GeoLift data included in GeoLift package into R. The data is simulated
    of 40 US cities across 90 days, from 2021–01–01 to 2021–03–31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Check data
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Format data
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '*Y_id* is your key performance indicator, such as revenue or active user count.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*X = c()* allows you to include optional covariates that dynamically correlate
    with your objective metric, such as user retention, rather than static metrics
    like city population or median income.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 2\. Generate weights
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Let’s say our experiment is going to be in Austin, Texas. Our objective is to
    create a synthetic control that closely mirrors Austin’s conditions before the
    experiment begins.
  prefs: []
  type: TYPE_NORMAL
- en: '**Create weights:**'
  prefs: []
  type: TYPE_NORMAL
- en: Specify Austin as test city
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '*pretreatment_end_time = 90* uses the 90 days of historical data before the
    test begins to synthesize a control city. Adjust this duration as needed to fit
    your experiment'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: To test in multiple cities, specify them in *locations*, for example, *locations
    = c(“austin”, “dallas”)*
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**To exclude any markets from control:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: Then feed *GeoTestData_PreTest_Excl* into the *GetWeights* function above.
  prefs: []
  type: TYPE_NORMAL
- en: '**Display top weights:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: '**Download weights and market data to csv:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 3\. Visualize synthetic control
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Now that we have the weights file, we’ll create a synthetic control geo to compare
    against our test market, Austin.
  prefs: []
  type: TYPE_NORMAL
- en: '**Set up:**'
  prefs: []
  type: TYPE_NORMAL
- en: Import packages in Python
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: Read data
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/cac3289e17affc0face75ec36d0a873f.png)![](../Images/cdf25bd7dfd363629c72bd8b784ac7c2.png)'
  prefs: []
  type: TYPE_IMG
- en: Created by author in Jupyter notebook
  prefs: []
  type: TYPE_NORMAL
- en: '**Combine weights and cities together to create a single control:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: '**Visualize Austin vs. synthetic control**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/ab8e346385d8339fdfa3a609e2d6e775.png)'
  prefs: []
  type: TYPE_IMG
- en: Created by author in Jupyter notebook
  prefs: []
  type: TYPE_NORMAL
- en: '**Check correlation:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: The correlation between Austin and the synthetic control stands at *0.950* —
    solid!
  prefs: []
  type: TYPE_NORMAL
- en: Measure lift
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: There is a slight twist.
  prefs: []
  type: TYPE_NORMAL
- en: Although Austin and its control show high correlation, the graph reveals that
    the control consistently registers higher values.
  prefs: []
  type: TYPE_NORMAL
- en: To facilitate a straightforward comparison, we can apply a multiplier to align
    the pre-launch values.
  prefs: []
  type: TYPE_NORMAL
- en: '**Create multiplier:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: '*M = 0.9556415990151904*'
  prefs: []
  type: TYPE_NORMAL
- en: '**Simulate post-launch data:**'
  prefs: []
  type: TYPE_NORMAL
- en: Create two weeks’ data after launch date on 2021–04–01
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: '**Visualize Austin vs. adjusted control:**'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: '![](../Images/e0032aafd669b12d6e589c5163de86f1.png)'
  prefs: []
  type: TYPE_IMG
- en: Created by author in Jupyter notebook
  prefs: []
  type: TYPE_NORMAL
- en: We’ve created a compelling graph that beautifully illustrates the different
    before and after launch!
  prefs: []
  type: TYPE_NORMAL
- en: Take-away
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: While real-life data may be more complex, comparing the test market and synthetic
    control enables us to observe incremental lift over time
  prefs: []
  type: TYPE_NORMAL
- en: Since we use historical data to calibrate the control group closely to the treatment
    group before intervention, the synthetic method often yields more reliable and
    interpretable results than the difference in difference approach.
  prefs: []
  type: TYPE_NORMAL
- en: Resources
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Github [link](https://github.com/mandymliu/geolift) for everything in this note
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Meta GeoLift [blog](https://facebookincubator.github.io/GeoLift/blog)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Meta GeoLift [github](https://github.com/facebookincubator/GeoLift/tree/GeoLiftPython)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: GeoLift user Facebook [group](https://www.facebook.com/groups/1225502237950330)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'You might also enjoy this:'
  prefs: []
  type: TYPE_NORMAL
- en: '[](/3-painful-mistakes-i-made-as-a-junior-data-scientist-df06b9513b47?source=post_page-----a90b839479a8--------------------------------)
    [## 3 Painful Mistakes I Made as a Junior Data Scientist'
  prefs: []
  type: TYPE_NORMAL
- en: Learn from them to fast-track your career today
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: towardsdatascience.com](/3-painful-mistakes-i-made-as-a-junior-data-scientist-df06b9513b47?source=post_page-----a90b839479a8--------------------------------)
  prefs: []
  type: TYPE_NORMAL
- en: '*Connect with me:* [*Twitter/X*](https://x.com/Mandy_L_) *|* [*LinkedIn*](https://www.linkedin.com/in/mandy-liu-2551724a/)'
  prefs: []
  type: TYPE_NORMAL
