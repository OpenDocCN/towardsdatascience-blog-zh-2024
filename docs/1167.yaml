- en: 'Time Series Forecasting: A Practical Guide to Exploratory Data Analysis'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 时间序列预测：探索性数据分析实用指南
- en: 原文：[https://towardsdatascience.com/time-series-forecasting-a-practical-guide-to-exploratory-data-analysis-a101dc5f85b1?source=collection_archive---------0-----------------------#2024-05-09](https://towardsdatascience.com/time-series-forecasting-a-practical-guide-to-exploratory-data-analysis-a101dc5f85b1?source=collection_archive---------0-----------------------#2024-05-09)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://towardsdatascience.com/time-series-forecasting-a-practical-guide-to-exploratory-data-analysis-a101dc5f85b1?source=collection_archive---------0-----------------------#2024-05-09](https://towardsdatascience.com/time-series-forecasting-a-practical-guide-to-exploratory-data-analysis-a101dc5f85b1?source=collection_archive---------0-----------------------#2024-05-09)
- en: How to use Exploratory Data Analysis to drive information from time series data
    and enhance feature engineering using Python
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何利用探索性数据分析从时间序列数据中提取信息，并使用Python增强特征工程
- en: '[](https://medium.com/@maicolnicolini96?source=post_page---byline--a101dc5f85b1--------------------------------)[![Maicol
    Nicolini](../Images/97e78725ba70c95e340b76527c358498.png)](https://medium.com/@maicolnicolini96?source=post_page---byline--a101dc5f85b1--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--a101dc5f85b1--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--a101dc5f85b1--------------------------------)
    [Maicol Nicolini](https://medium.com/@maicolnicolini96?source=post_page---byline--a101dc5f85b1--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/@maicolnicolini96?source=post_page---byline--a101dc5f85b1--------------------------------)[![Maicol
    Nicolini](../Images/97e78725ba70c95e340b76527c358498.png)](https://medium.com/@maicolnicolini96?source=post_page---byline--a101dc5f85b1--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--a101dc5f85b1--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--a101dc5f85b1--------------------------------)
    [Maicol Nicolini](https://medium.com/@maicolnicolini96?source=post_page---byline--a101dc5f85b1--------------------------------)'
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--a101dc5f85b1--------------------------------)
    ·15 min read·May 9, 2024
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: ·发表于[Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--a101dc5f85b1--------------------------------)
    ·15分钟阅读·2024年5月9日
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '![](../Images/32bbea6cf3c9513a36265783549ae925.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/32bbea6cf3c9513a36265783549ae925.png)'
- en: Photo by [Ales Krivec](https://unsplash.com/@aleskrivec?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 由[Ales Krivec](https://unsplash.com/@aleskrivec?utm_source=medium&utm_medium=referral)拍摄，来源于[Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
- en: Introduction
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 引言
- en: 'Time series analysis certainly represents one of the most widespread topics
    in the field of data science and machine learning: whether predicting financial
    events, energy consumption, product sales or stock market trends, this field has
    always been of great interest to businesses.'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 时间序列分析无疑是数据科学和机器学习领域最广泛的主题之一：无论是预测金融事件、能源消耗、产品销售还是股市趋势，这个领域一直是企业关注的重点。
- en: Obviously, the great increase in data availability, combined with the constant
    progress in machine learning models, has made this topic even more interesting
    today. Alongside traditional forecasting methods derived from statistics (e.g.
    regressive models, ARIMA models, exponential smoothing), techniques relating to
    machine learning (e.g. tree-based models) and deep learning (e.g. LSTM Networks,
    CNNs, Transformer-based Models) have emerged for some time now.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 显然，数据可用性的极大增加，加上机器学习模型的不断进步，使得这个话题今天更加引人关注。除了传统的统计预测方法（如回归模型、ARIMA模型、指数平滑），与机器学习（如基于树的模型）和深度学习（如LSTM网络、CNN、基于Transformer的模型）相关的技术已经存在一段时间了。
- en: 'Despite the huge differences between these techniques, there is a preliminary
    step that must be done, no matter what the model is: *Exploratory Data Analysis.*'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管这些技术之间存在巨大差异，但无论模型是什么，都必须完成一个初步步骤：*探索性数据分析*。
- en: 'In statistics, **Exploratory Data Analysis** (EDA) is a discipline consisting
    in analyzing and visualizing data in order to summarize their main characteristics
    and gain relevant information from them. This is of considerable importance in
    the data science field because it allows to lay the foundations to another important
    step: *feature engineering*. That is, the practice that consists on creating,
    transforming and extracting features from the dataset so that the model can work
    to the best of its possibilities.'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 在统计学中，**探索性数据分析**（EDA）是一门分析和可视化数据的学科，旨在总结其主要特征并从中获取相关信息。这在数据科学领域具有重要意义，因为它为另一个重要步骤奠定了基础：*特征工程*。即，创建、转换和提取数据集特征的实践，以便模型能够发挥最佳性能。
- en: The objective of this article is therefore to define a clear exploratory data
    analysis template, focused on time series, which can summarize and highlight the
    most important characteristics of the dataset. To do this, we will use some common
    Python libraries such as *Pandas*, *Seaborn* and S*tatsmodel*.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，本文的目标是定义一个清晰的探索性数据分析模板，专注于时间序列，可以总结并突出数据集的最重要特征。为此，我们将使用一些常见的Python库，如*Pandas*、*Seaborn*和*Statsmodel*。
- en: Data
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据
- en: 'Let’s first define the dataset: for the purposes of this article, we will take
    Kaggle’s [**Hourly Energy Consumption**](https://www.kaggle.com/datasets/robikscube/hourly-energy-consumption)data.
    This dataset relates to PJM Hourly Energy Consumption data, a regional transmission
    organization in the United States, that serves electricity to Delaware, Illinois,
    Indiana, Kentucky, Maryland, Michigan, New Jersey, North Carolina, Ohio, Pennsylvania,
    Tennessee, Virginia, West Virginia, and the District of Columbia.'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们首先定义数据集：为了本文的目的，我们将使用Kaggle的[**每小时能源消耗**](https://www.kaggle.com/datasets/robikscube/hourly-energy-consumption)数据集。该数据集与PJM每小时能源消耗数据有关，PJM是美国一个区域传输组织，向特拉华州、伊利诺伊州、印第安纳州、肯塔基州、马里兰州、密歇根州、新泽西州、北卡罗来纳州、俄亥俄州、宾夕法尼亚州、田纳西州、弗吉尼亚州、西弗吉尼亚州和哥伦比亚特区提供电力。
- en: The hourly power consumption data comes from PJM’s website and are in megawatts
    (MW).
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 每小时的电力消耗数据来自PJM网站，单位为兆瓦（MW）。
- en: Exploratory Data Analysis
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 探索性数据分析
- en: Let’s now define which are the most significant analyses to be performed when
    dealing with time series.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们定义在处理时间序列时需要进行的最重要的分析。
- en: 'For sure, one of the most important thing is to plot the data: graphs can highlight
    many features, such as patterns, unusual observations, changes over time, and
    relationships between variables. As already said, the insight that emerge from
    these plots must then be taken into consideration, as much as possible, into the
    forecasting model. Moreover, some mathematical tools such as descriptive statistics
    and time series decomposition, will also be very useful.'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，其中最重要的事情之一是绘制数据图表：图形可以突出显示许多特征，如模式、异常观察、随时间变化的变化以及变量之间的关系。如前所述，从这些图表中得出的见解必须尽可能地纳入预测模型中。此外，一些数学工具，如描述性统计和时间序列分解，也将非常有用。
- en: 'Said that, the EDA I’m proposing in this article consists on six steps: Descriptive
    Statistics, Time Plot, Seasonal Plots, Box Plots, Time Series Decomposition, Lag
    Analysis.'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 也就是说，本文提出的探索性数据分析（EDA）包含六个步骤：描述性统计、时间图、季节性图、箱型图、时间序列分解、滞后分析。
- en: 1\. Descriptive Statistics
  id: totrans-21
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1\. 描述性统计
- en: Descriptive statistic is a summary statistic that quantitatively describes or
    summarizes features from a collection of structured data.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 描述性统计是定量描述或总结结构化数据集合特征的汇总统计量。
- en: 'Some metrics that are commonly used to describe a dataset are: measures of
    central tendency (e.g. *mean*, *median*), measures of dispersion (e.g. *range*,
    *standard deviation*), and measure of position (e.g. *percentiles*, *quartile*).
    All of them can be summarized by the so called **five number summary**, which
    include: minimum, first quartile (Q1), median or second quartile (Q2), third quartile
    (Q3) and maximum of a distribution.'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 描述数据集时常用的一些指标包括：集中趋势度量（例如*均值*、*中位数*）、离散程度度量（例如*范围*、*标准差*）和位置度量（例如*百分位数*、*四分位数*）。所有这些指标都可以通过所谓的**五数汇总**进行总结，其中包括：最小值、第一四分位数（Q1）、中位数或第二四分位数（Q2）、第三四分位数（Q3）和分布的最大值。
- en: 'In Python, these information can be easily retrieved using the well know `describe`
    method from Pandas:'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 在Python中，这些信息可以通过Pandas中著名的`describe`方法轻松检索：
- en: '[PRE0]'
  id: totrans-25
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '![](../Images/569c28931bca7ee75e4366dbbd6b91db.png)'
  id: totrans-26
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/569c28931bca7ee75e4366dbbd6b91db.png)'
- en: 1\. PJME statistic summary.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 1\. PJME统计汇总。
- en: 2\. Time plot
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2\. 时间图
- en: The obvious graph to start with is the time plot. That is, the observations
    are plotted against the time they were observed, with consecutive observations
    joined by lines.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 开始时，最明显的图表是时间图。这意味着，观测结果是根据其观测时间绘制的，连续的观测点通过线条连接。
- en: 'In Python , we can use Pandas and Matplotlib:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Python 中，我们可以使用 Pandas 和 Matplotlib：
- en: '[PRE1]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '![](../Images/d9bd55add95ba151a92842566151524f.png)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d9bd55add95ba151a92842566151524f.png)'
- en: 2.1 PJME Consumption Time Plot.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 2.1 PJME 消耗时间图。
- en: 'This plot already provides several information:'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 这个图表已经提供了若干信息：
- en: As we could expect, the pattern shows yearly seasonality.
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 正如我们所预期的，图形显示了年度季节性变化。
- en: Focusing on a single year, it seems that more pattern emerges. Likely, the consumptions
    will have a peak in winter and one another in summer, due to the greater electricity
    consumption.
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 聚焦于单一年份时，似乎会有更多的模式出现。很可能，能耗在冬季会有一个高峰，夏季也会有一个高峰，原因是更大的电力消耗。
- en: The series does not exhibit a clear increasing/decreasing trend over the years,
    the average consumptions remains stationary.
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 该系列没有表现出明确的增长/下降趋势，平均能耗保持稳定。
- en: There is an anomalous value around 2023, probably it should be imputed when
    implementing the model.
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 在2023年左右出现了一个异常值，可能在实现模型时应该进行补偿。
- en: 3\. Seasonal Plots
  id: totrans-39
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3. 季节性图
- en: A seasonal plot is fundamentally a time plot where data are plotted against
    the individual “seasons” of the series they belong.
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 季节性图基本上是一个时间图，其中数据根据其所属的各个“季节”进行绘制。
- en: 'Regarding energy consumption, we usually have hourly data available, so there
    could be several seasonality: *yearly*, *weekly*, *daily*. Before going deep into
    these plots, let’s first set up some variables in our Pandas dataframe:'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
  zh: 关于能源消耗，我们通常有每小时的数据，因此可能会有几种季节性：*年度*、*每周*、*每日*。在深入分析这些图表之前，我们先在 Pandas 数据框中设置一些变量：
- en: '[PRE2]'
  id: totrans-42
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 3.1 Seasonal plot — Yearly consumption
  id: totrans-43
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.1 季节性图 — 年度消费
- en: A very interesting plot is the one referring to the energy consumption grouped
    by year over months, this highlights yearly seasonality and can inform us about
    ascending/descending trends over the years.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 一个非常有趣的图表是关于按年分组的每月能耗图，这突出了年度季节性变化，并且可以告诉我们多年间的上升/下降趋势。
- en: 'Here is the Python code:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 这是 Python 代码：
- en: '[PRE3]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '![](../Images/d81109dc87e66d8794e60ec39136e05a.png)'
  id: totrans-47
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d81109dc87e66d8794e60ec39136e05a.png)'
- en: 3.1 PJME Yearly Seasonal Plot
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 3.1 PJME 年度季节性图
- en: 'This plot shows every year has actually a very predefined pattern: the consumption
    increases significantly during winter and has a peak in summer (due to heating/cooling
    systems), while has a minima in spring and in autumn when no heating or cooling
    is usually required.'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 该图显示每年实际上有一个非常预定义的模式：冬季消费显著增加，夏季达到峰值（由于供暖/制冷系统），而春季和秋季通常不需要供暖或制冷，因此消费最小。
- en: Furthermore, this plot tells us that’s not a clear increasing/decreasing pattern
    in the overall consumptions across years.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，该图告诉我们，在整体能耗上，跨年并没有明确的增长/下降趋势。
- en: 3.2 Seasonal plot — Weekly consumption
  id: totrans-51
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.2 季节性图 — 每周消费
- en: Another useful plot is the weekly plot, it depicts the consumptions during the
    week over months and can also suggest if and how weekly consumptions are changing
    over a single year.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个有用的图表是每周图表，它描绘了每月内一周的能耗变化，还可以提示我们能耗在单一年份中的变化情况。
- en: 'Let’s see how to figure it out with Python:'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们看看如何用 Python 来解决这个问题：
- en: '[PRE4]'
  id: totrans-54
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '![](../Images/072c928e8b54ab3ce70e7607a0e5f7f1.png)'
  id: totrans-55
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/072c928e8b54ab3ce70e7607a0e5f7f1.png)'
- en: 3.2 PJME Weekly Seasonal Plot
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 3.2 PJME 每周季节性图
- en: 3.3 Seasonal plot — Daily consumption
  id: totrans-57
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.3 季节性图 — 日常消费
- en: Finally, the last seasonal plot I want to show is the daily consumption plot.
    As you can guess, it represents how consumption change over the day. In this case,
    data are first grouped by day of week and then aggregated taking the mean.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我想展示的最后一个季节性图是日常能耗图。如你所猜测，它表示能耗在一天内的变化。在这种情况下，数据首先按星期几分组，然后聚合计算均值。
- en: 'Here’s the code:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 这是代码：
- en: '[PRE5]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '![](../Images/9e0cc04edfadccf0216f2b1c90e5e291.png)'
  id: totrans-61
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/9e0cc04edfadccf0216f2b1c90e5e291.png)'
- en: 3.3 PJME Daily Seasonal Plot
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 3.3 PJME 日常季节性图
- en: Often, this plot show a very typical pattern, someone calls it “M profile” since
    consumptions seems to depict an “M” during the day. Sometimes this pattern is
    clear, others not (like in this case).
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，这个图显示出一个非常典型的模式，有人称之为“M型”，因为能耗似乎在一天内形成一个“M”形。有时这个模式很明显，有时则不明显（就像在这个案例中）。
- en: However, this plots usually shows a relative peak in the middle of the day (from
    10 am to 2 pm), then a relative minima (from 2 pm to 6 pm) and another peak (from
    6 pm to 8 pm). Finally, it also shows the difference in consumptions from weekends
    and other days.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，这些图表通常显示出一天中间的相对峰值（从上午10点到下午2点），然后是一个相对的最低值（从下午2点到6点），再到另一个峰值（从下午6点到8点）。最后，它还显示了周末和其他日期的消费差异。
- en: 3.4 Seasonal plot — Feature Engineering
  id: totrans-65
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3.4 季节性图表 — 特征工程
- en: Let’s now see how to use this information for feature engineering. Let’s suppose
    we are using some ML model that requires good quality features (e.g. ARIMA models
    or tree-based models).
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们看看如何使用这些信息进行特征工程。假设我们正在使用一些需要高质量特征的机器学习模型（例如ARIMA模型或基于树的模型）。
- en: 'These are the main evidences coming from seasonal plots:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是来自季节性图表的主要证据：
- en: 'Yearly consumptions do not change a lot over years: this suggests the possibility
    to use, when available, yearly seasonality features coming from lag or exogenous
    variables.'
  id: totrans-68
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 年度消费在几年间变化不大：这提示我们可以在可用的情况下，使用来自滞后或外生变量的年度季节性特征。
- en: 'Weekly consumptions follow the same pattern across months: this suggests to
    use weekly features coming from lag or exogenous variables.'
  id: totrans-69
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 每周的消费在各个月份间遵循相同的模式：这提示我们可以使用来自滞后或外生变量的每周特征。
- en: 'Daily consumption differs from normal days and weekends: this suggest to use
    categorical features able to identify when a day is a normal day and when it is
    not.'
  id: totrans-70
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 日常消费在普通工作日和周末有所不同：这提示我们可以使用类别特征来识别某一天是否为普通工作日。
- en: 4\. Box Plots
  id: totrans-71
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 4\. 箱型图
- en: 'Boxplot are a useful way to identify how data are distributed. Briefly, boxplots
    depict percentiles, which represent 1st (Q1), 2nd (Q2/median) and 3rd (Q3) quartile
    of a distribution and whiskers, which represent the range of the data. Every value
    beyond the whiskers can be thought as an *outlier*, more in depth, whiskers are
    often computed as:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 箱型图是识别数据分布的一种有用方式。简而言之，箱型图描绘了分位数，代表分布的第1四分位数（Q1）、第2四分位数（Q2/中位数）和第3四分位数（Q3），以及须状线，代表数据的范围。任何超出须状线的值都可以被视为*异常值*，更深入地说，须状线通常是通过以下方式计算的：
- en: '![](../Images/06e5f1fe1b65dbcd7f018e268cf2ba24.png)'
  id: totrans-73
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/06e5f1fe1b65dbcd7f018e268cf2ba24.png)'
- en: 4\. Whiskers Formula
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: 4\. 须状线公式
- en: 4.1 Box Plots — Total consumption
  id: totrans-75
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 4.1 箱型图 — 总消费
- en: 'Let’s first compute the box plot regarding the total consumption, this can
    be easily done with *Seaborn*:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 首先让我们计算关于总消费的箱型图，这可以通过*Seaborn*轻松完成：
- en: '[PRE6]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '![](../Images/bcb675b3d2364e13ed03d36cc3cbc140.png)'
  id: totrans-78
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/bcb675b3d2364e13ed03d36cc3cbc140.png)'
- en: 4.1 PJME Boxplot
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 4.1 PJME 箱型图
- en: Even if this plot seems not to be much informative, it tells us we are dealing
    with a Gaussian-like distribution, with a tail more accentuated towards the right.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 即使这个图表看起来信息不多，它告诉我们我们正处理一个类似高斯分布的情况，且尾部在右侧更加突出。
- en: 4.2 Box Plots — Day month distribution
  id: totrans-81
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 4.2 箱型图 — 天月分布
- en: 'A very interesting plot is the day/month box plot. It is obtained creating
    a “day month” variable and grouping consumptions by it. Here is the code, referring
    only from year 2017:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 一个非常有趣的图表是按天/月分箱图。它是通过创建一个“天 月”变量并按此变量对消费进行分组得到的。以下是代码，只涉及从2017年开始的数据：
- en: '[PRE7]'
  id: totrans-83
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '![](../Images/6ebf1b885874f81ddd75c7a79a975425.png)'
  id: totrans-84
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/6ebf1b885874f81ddd75c7a79a975425.png)'
- en: 4.2 PJME Year/Month Boxplot
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 4.2 PJME 年/月箱型图
- en: It can be seen that consumption are less uncertain in summer/winter months (i.e.
    when we have peaks) while are more dispersed in spring/autumn (i.e. when temperatures
    are more variable). Finally, consumption in summer 2018 are higher than 2017,
    maybe due to a warmer summer. When feature engineering, remember to include (if
    available) the temperature curve, probably it can be used as an exogenous variable.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 可以看出，夏季/冬季月份的消费不确定性较低（即，当我们有峰值时），而春季/秋季则更为分散（即，当温度更为变化时）。最后，2018年夏季的消费高于2017年，可能是由于夏季气温较高。在进行特征工程时，请记得包含（如果有的话）温度曲线，它可能作为外生变量使用。
- en: 4.3 Box Plots — Day distribution
  id: totrans-87
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 4.3 箱型图 — 天分布
- en: Another useful plot is the one referring consumption distribution over the week,
    this is similar to the weekly consumption seasonal plot.
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个有用的图表是显示一周内消费分布的图表，这与每周消费季节性图表类似。
- en: '[PRE8]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '![](../Images/ad9f40a6f45d4957e36315b08229a7a7.png)'
  id: totrans-90
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/ad9f40a6f45d4957e36315b08229a7a7.png)'
- en: 4.3 PJME Day Boxplot
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 4.3 PJME 天箱型图
- en: As seen before, consumptions are noticeably lower on weekends. Anyway, there
    are several outliers pointing out that calendar features like “day of week” for
    sure are useful but could not fully explain the series.
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所见，消费在周末明显较低。不过，有几个异常值表明像“星期几”这样的日历特征确实有用，但可能无法完全解释该序列。
- en: 4.4 Box Plots — Hour distribution
  id: totrans-93
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 4.4 箱型图 — 小时分布
- en: 'Let’s finally see hour distribution box plot. It is similar to the daily consumption
    seasonal plot since it provides how consumptions are distributed over the day.
    Following, the code:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: 最后我们来看小时分布箱型图。它与每日消费季节性图类似，因为它展示了消费如何在一天内分布。接下来是代码：
- en: '[PRE9]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '![](../Images/807ad6d26cec4a5520a05176ff392043.png)'
  id: totrans-96
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/807ad6d26cec4a5520a05176ff392043.png)'
- en: 4.4 PJME Hour Boxplot
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 4.4 PJME小时箱型图
- en: Note that the “M” shape seen before is now much more crushed. Furthermore there
    are a lot of outliers, this tells us data not only relies on daily seasonality
    (e.g. the consumption on today’s 12 am is similar to the consumption of yesterday
    12 am) but also on something else, probably some exogenous climatic feature like
    temperature or humidity.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，之前看到的“M”形状现在变得更加压缩。此外，有很多离群点，这告诉我们数据不仅依赖于日常季节性（例如今天12点的消费与昨天12点的消费相似），还依赖于其他因素，可能是某些外部气候因素，如温度或湿度。
- en: 5\. Time Series Decomposition
  id: totrans-99
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 5. 时间序列分解
- en: As already said, time series data can exhibit a variety of patterns. Often,
    it is helpful to split a time series into several components, each representing
    an underlying pattern category.
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，时间序列数据可能表现出多种模式。通常，将时间序列分解为多个成分，每个成分代表一个潜在的模式类别，这对分析非常有帮助。
- en: 'We can think of a time series as comprising three components: a *trend* component,
    a *seasonal* component and a *remainder* component (containing anything else in
    the time series). For some time series (e.g., energy consumption series), there
    can be more than one seasonal component, corresponding to different seasonal periods
    (daily, weekly, monthly, yearly).'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以将时间序列看作由三个成分组成：*趋势*成分、*季节性*成分和*残差*成分（包含时间序列中的其他所有因素）。对于某些时间序列（例如，能源消费序列），可能存在多个季节性成分，对应不同的季节周期（每日、每周、每月、每年）。
- en: 'There are two main type of decomposition: *additive* and *multiplicative*.'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 时间序列分解有两种主要类型：*加性*和*乘性*。
- en: 'For the additive decomposition, we represent a series (𝑦) as the sum of a seasonal
    component (𝑆), a trend (𝑇) and a remainder (𝑅):'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 对于加性分解，我们将一个时间序列（𝑦）表示为季节性成分（𝑆）、趋势（𝑇）和残差（𝑅）的和：
- en: '![](../Images/e17ee10b8116c19d217f65fd55260dfd.png)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e17ee10b8116c19d217f65fd55260dfd.png)'
- en: 'Similarly, a multiplicative decomposition can be written as:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，乘性分解可以写成：
- en: '![](../Images/e242c6a97fc1dad2ad2fc5598e1b1ea4.png)'
  id: totrans-106
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e242c6a97fc1dad2ad2fc5598e1b1ea4.png)'
- en: Generally speaking, additive decomposition best represent series with constant
    variance while multiplicative decomposition best suits time series with non-stationary
    variances.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 一般来说，加性分解最适合方差恒定的序列，而乘性分解最适合方差非平稳的时间序列。
- en: 'In Python, time series decomposition can be easily fulfilled with *Statsmodel*
    library:'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 在Python中，时间序列分解可以通过*Statsmodel*库轻松实现：
- en: '[PRE10]'
  id: totrans-109
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '![](../Images/1e6aac354ac11d476f1aa4d7b27c75ec.png)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1e6aac354ac11d476f1aa4d7b27c75ec.png)'
- en: 5.1 PJME Series Decomposition — Additive Decompose.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 5.1 PJME系列分解 — 加性分解。
- en: '![](../Images/ce50a9bfc23a07acefea8bb56927df5f.png)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/ce50a9bfc23a07acefea8bb56927df5f.png)'
- en: 5.2 PJME Series Decomposition — Multiplicative Decompose.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 5.2 PJME系列分解 — 乘性分解。
- en: 'The above plots refers to 2017\. In both cases, we see the trend has several
    local peaks, with higher values in summer. From the seasonal component, we can
    see the series actually has several periodicities, this plot highlights more the
    weekly one, but if we focus on a particular month (January) of the same year,
    daily seasonality emerges too:'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 上述图表是指2017年。在这两种情况下，我们可以看到趋势有几个局部峰值，夏季的值较高。从季节性成分中，我们可以看到序列实际上有几个周期性，这个图突出显示了每周的周期性，但如果我们专注于同一年（2017年）中的某个月（如1月），日常季节性也会显现出来：
- en: '[PRE11]'
  id: totrans-115
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '![](../Images/38852e4d20f443b471e67673aa590562.png)'
  id: totrans-116
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/38852e4d20f443b471e67673aa590562.png)'
- en: 5.3 PJME Series Decomposition — Additive Decompose, focus on January 2017.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 5.3 PJME系列分解 — 加性分解，关注2017年1月。
- en: '![](../Images/c81aba4ff062cc4f588cb56dc5a7fe2f.png)'
  id: totrans-118
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c81aba4ff062cc4f588cb56dc5a7fe2f.png)'
- en: 5.4 PJME Series Decomposition — Multiplicative Decompose, focus on January 2017.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 5.4 PJME系列分解 — 乘性分解，关注2017年1月。
- en: 6\. Lag Analysis
  id: totrans-120
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 6. 滞后分析
- en: In time series forecasting, a lag is simply a past value of the series. For
    example, for daily series, the first lag refers to the value the series had the
    previous day, the second to the value of the day before and so on.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 在时间序列预测中，滞后是指序列的过去值。例如，对于日常序列，第一个滞后是指序列前一天的值，第二个滞后是指前两天的值，以此类推。
- en: 'Lag analysis is based on computing correlations between the series and a lagged
    version of the series itself, this is also called *autocorrelation.* For a k-lagged
    version of a series, we define the autocorrelation coefficient as:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 滞后分析基于计算序列与该序列的滞后版本之间的相关性，这也称为*自相关*。对于k滞后的序列，我们定义自相关系数为：
- en: '![](../Images/012a2b1804fb4a04bed04ce8fa487838.png)'
  id: totrans-123
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/012a2b1804fb4a04bed04ce8fa487838.png)'
- en: Where *y* bar represent the mean value of the series and *k* the lag.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 其中，*y* bar表示序列的均值，*k*表示滞后。
- en: The autocorrelation coefficients make up the *autocorrelation function* (ACF)
    for the series, this is simply a plot depicting the auto-correlation coefficient
    versus the number of lags taken into consideration.
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 自相关系数构成了序列的*自相关函数*（ACF），这只是一个图表，展示了自相关系数与所考虑滞后数量之间的关系。
- en: When data has a trend, the autocorrelations for small lags are usually large
    and positive because observations close in time are also nearby in value. When
    data show seasonality, autocorrelation values will be larger in correspondence
    of seasonal lags (and multiples of the seasonal period) than for other lags. Data
    with both trend and seasonality will show a combination of these effects.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 当数据具有趋势时，小滞后的自相关通常很大且为正，因为时间接近的观测值也通常数值相近。当数据呈现季节性时，与季节滞后（以及季节周期的倍数）对应的自相关值将大于其他滞后的自相关值。具有趋势和季节性的数据将表现出这些效应的组合。
- en: In practice, a more useful function is the *partial autocorrelation function*
    (PACF). It is similar to the ACF, except that it shows only the direct autocorrelation
    between two lags. For example, the partial autocorrelation for lag 3 refers to
    the only correlation lag 1 and 2 do not explain. In other words, the partial correlation
    refers to the direct effect a certain lag has on the current time value.
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，更有用的函数是*部分自相关函数*（PACF）。它类似于ACF，只不过它只显示两个滞后之间的直接自相关。例如，滞后3的部分自相关指的是滞后1和滞后2无法解释的相关性。换句话说，部分自相关指的是某个滞后对当前时间值的直接影响。
- en: Before moving to the Python code, it is important to highlight that autocorrelation
    coefficient emerges more clearly if the series is *stationary,* so often is better
    to first differentiate the series to stabilize the signal.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: 在进入Python代码之前，需要强调的是，如果序列是*平稳*的，自相关系数会更为明显，因此通常最好先对序列进行差分以稳定信号。
- en: 'Said that, here is the code to plot PACF for different hours of the day:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 话虽如此，下面是绘制不同时间段PACF的代码：
- en: '[PRE12]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: '![](../Images/44dbff41f17b2e610d813960ecfb0c5b.png)'
  id: totrans-131
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/44dbff41f17b2e610d813960ecfb0c5b.png)'
- en: 6.1 PJME Lag Analysis — Partial Auto Correlation Function (h=0).
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: 6.1 PJME滞后分析 — 部分自相关函数（h=0）。
- en: '![](../Images/d7d2d2e6976b720b7bff2e0a9c82c8e8.png)'
  id: totrans-133
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d7d2d2e6976b720b7bff2e0a9c82c8e8.png)'
- en: 6.2 PJME Lag Analysis — Partial Auto Correlation Function (h=4).
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 6.2 PJME滞后分析 — 部分自相关函数（h=4）。
- en: '![](../Images/a32acfd15df172f5e3ace8d54843d633.png)'
  id: totrans-135
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a32acfd15df172f5e3ace8d54843d633.png)'
- en: 6.3 PJME Lag Analysis — Partial Auto Correlation Function (h=8).
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 6.3 PJME滞后分析 — 部分自相关函数（h=8）。
- en: '![](../Images/30eaf2c891649106e9ec2e6a1ce93aa4.png)'
  id: totrans-137
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/30eaf2c891649106e9ec2e6a1ce93aa4.png)'
- en: 6.4 PJME Lag Analysis — Partial Auto Correlation Function (h=12).
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 6.4 PJME滞后分析 — 部分自相关函数（h=12）。
- en: '![](../Images/9337dca06ee8f7ca5b4ff221128e89f9.png)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/9337dca06ee8f7ca5b4ff221128e89f9.png)'
- en: 6.5 PJME Lag Analysis — Partial Auto Correlation Function (h=16).
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 6.5 PJME滞后分析 — 部分自相关函数（h=16）。
- en: '![](../Images/9f5f6bfa3c2cba4da0413c467eac4548.png)'
  id: totrans-141
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/9f5f6bfa3c2cba4da0413c467eac4548.png)'
- en: 6.6 PJME Lag Analysis — Partial Auto Correlation Function (h=20).
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 6.6 PJME滞后分析 — 部分自相关函数（h=20）。
- en: As you can see, the PACF simply consists on plotting Pearson partial auto-correlation
    coefficients for different lags. Of course, the non-lagged series shows a perfect
    auto-correlation with itself, so lag 0 will always be 1\. The blue band represent
    the *confidence interval:* if a lag exceed that band, then it is statistically
    significant and we can assert it is has great importance.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 如你所见，PACF实际上就是绘制不同滞后的Pearson部分自相关系数。当然，未滞后的序列与自身有完美的自相关，因此滞后0的自相关系数永远是1。蓝色区域表示*置信区间*：如果某个滞后超过了这个区间，则说明该滞后在统计上是显著的，我们可以断言它具有重要性。
- en: 6.1 Lag analysis — Feature Engineering
  id: totrans-144
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 6.1 滞后分析 — 特征工程
- en: Lag analysis is one of the most impactful study on time series feature engineering.
    As already said, a lag with high correlation is an important lag for the series,
    then it should be taken into consideration.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 滞后分析是时间序列特征工程中最具影响力的研究之一。如前所述，具有高相关性的滞后是序列中重要的滞后，因此应予以考虑。
- en: A widely used feature engineering technique consists on making an **hourly division**
    of the dataset. That is, splitting data in 24 subset, each one referring to an
    hour of the day. This has the effect to regularize and smooth the signal, making
    it more simple to forecast.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 一种广泛使用的特征工程技术是对数据集进行**按小时划分**。即将数据划分为24个子集，每个子集对应一天中的一个小时。这种做法有助于平滑信号，使其更加规律，从而更易于预测。
- en: Each subset should then be feature engineered, trained and fine-tuned. The final
    forecast will be achieved combining the results of these 24 models. Said that,
    every hourly model will have its peculiarities, most of them will regard important
    lags.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 每个子集应进行特征工程，训练并进行微调。最终的预测将通过结合这24个模型的结果来实现。话虽如此，每个小时的模型都会有其特殊性，其中大部分将涉及重要的滞后。
- en: 'Before moving on, let’s define two types of lag we can deal with when doing
    lag analysis:'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: 在继续之前，让我们定义在进行滞后分析时可以处理的两种滞后类型：
- en: '**Auto-regressive lags**: lags close to lag 0, for which we expect high values
    (recent lags are more likely to predict the present value). They are a representation
    on how much trend the series shows.'
  id: totrans-149
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**自回归滞后**：接近滞后0的滞后，我们预期其值较高（近期的滞后更可能预测当前值）。它们是序列中趋势的体现。'
- en: '**Seasonal lags**: lags referring to seasonal periods. When hourly splitting
    the data, they usually represent weekly seasonality.'
  id: totrans-150
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**季节性滞后**：指与季节性周期相关的滞后。当按小时划分数据时，它们通常代表每周的季节性。'
- en: Note that auto-regressive lag 1 can also be taught as a *daily seasonal lag*
    for the series.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 请注意，自回归滞后1也可以被视为系列的*日常季节性滞后*。
- en: Let’s now discuss about the PACF plots printed above.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 现在让我们讨论一下上面打印的PACF图。
- en: Night Hours
  id: totrans-153
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 夜间小时
- en: Consumption on night hours (0, 4) relies more on auto-regressive than on weekly
    lags, since the most important are all localized on the first five. Seasonal periods
    such as 7, 14, 21, 28 seems not to be too much important, this advises us to pay
    particular attention on lag 1 to 5 when feature engineering.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
  zh: 夜间小时（0, 4）的消费更多依赖于自回归滞后而非周滞后，因为最重要的滞后都集中在前五个。像7、14、21、28这样的季节性周期似乎并不太重要，这提醒我们在进行特征工程时要特别关注滞后1到5。
- en: Day Hours
  id: totrans-155
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 日间小时
- en: Consumption on day hours (8, 12, 16, 20) exhibit both auto-regressive and seasonal
    lags. This particularly true for hours 8 and 12 - when consumption is particularly
    high — while seasonal lags become less important approaching the night. For these
    subsets we should also include seasonal lag as well as auto-regressive ones.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 白天小时（8, 12, 16, 20）的消费展现出自回归滞后和季节性滞后两者的特征。特别是对于8点和12点的小时——这时消费量特别高——而季节性滞后在接近夜间时变得不那么重要。对于这些子集，我们也应该包括季节性滞后以及自回归滞后。
- en: 'Finally, here are some tips when feature engineering lags:'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，这里有一些关于特征工程滞后的建议：
- en: Do not to take into consideration too many lags since this will probably lead
    to over fitting. Generally, auto-regressive lags goes from 1 to 7, while weekly
    lags should be 7, 14, 21 and 28\. But it’s not mandatory to take each of them
    as features.
  id: totrans-158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不要考虑过多的滞后，因为这可能导致过拟合。通常，自回归滞后从1到7，而周滞后应该是7、14、21和28。然而，是否将它们作为特征并不是强制性的。
- en: Taking into consideration lags that are not auto-regressive or seasonal is usually
    a bad idea since they could bring to overfitting as well. Rather, try to understand
    while a certain lag is important.
  id: totrans-159
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 考虑非自回归或非季节性的滞后通常是一个坏主意，因为它们也可能导致过拟合。相反，尝试理解某个滞后为什么重要。
- en: Transforming lags can often lead to more powerful features. For example, seasonal
    lags can be aggregated using a weighted mean to create a single feature representing
    the seasonality of the series.
  id: totrans-160
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 转换滞后通常会导致更强大的特征。例如，季节性滞后可以通过加权均值进行聚合，创建一个单一特征来表示序列的季节性。
- en: Free Resources
  id: totrans-161
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 免费资源
- en: 'Finally, I would like to mention a very useful (and free) book explaining time
    series, which I have personally used a lot: [Forecasting: Principles and Practice](https://otexts.com/fpp3/).'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: '最后，我想提到一本非常有用（且免费的）解释时间序列的书，我个人使用过很多次：[Forecasting: Principles and Practice](https://otexts.com/fpp3/)。'
- en: Even though it is meant to use R instead of Python, this textbook provides a
    great introduction to forecasting methods, covering the most important aspects
    of time series analysis.
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管这本教材旨在使用R而非Python，但它为预测方法提供了很好的介绍，涵盖了时间序列分析的最重要方面。
- en: Conclusion
  id: totrans-164
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 结论
- en: The aim of this article was to present a comprehensive Exploratory Data Analysis
    template for time series forecasting.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: 本文的目的是提供一个全面的时间序列预测探索性数据分析模板。
- en: EDA is a fundamental step in any type of data science study since it allows
    to understand the nature and the peculiarities of the data and lays the foundation
    to feature engineering, which in turn can dramatically improve model performance.
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: EDA（探索性数据分析）是任何数据科学研究中的基础步骤，因为它有助于理解数据的性质和特点，并为特征工程奠定基础，特征工程反过来可以显著提升模型的性能。
- en: We have then described some of the most used analysis for time series EDA, these
    can be both statistical/mathematical and graphical. Obviously, the intention of
    this work was only to give a practical framework to start with, subsequent investigations
    need to be carried out based on the type of historical series being examined and
    the business context.
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
  zh: 我们接着描述了一些最常用的时间序列EDA分析方法，这些方法既可以是统计/数学性的，也可以是图形化的。显然，本工作的目的是提供一个实践框架供大家入手，后续的研究需要根据所研究的历史序列类型和业务背景进行进一步的探索。
- en: Thanks for having followed me until the end.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 感谢你一直跟随我直到最后。
- en: '*Unless otherwise noted, all images are by the author.*'
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: '*除非另有说明，所有图片均来自作者。*'
