<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>RFM Segmentation: Unleashing Customer Insights</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>RFM Segmentation: Unleashing Customer Insights</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/rfm-segmentation-unleashing-customer-insights-da58deae4eb9?source=collection_archive---------3-----------------------#2024-07-02">https://towardsdatascience.com/rfm-segmentation-unleashing-customer-insights-da58deae4eb9?source=collection_archive---------3-----------------------#2024-07-02</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="34b0" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">Transforming customer data into actionable insights with RFM segmentation</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://vitorihaldijiran.medium.com/?source=post_page---byline--da58deae4eb9--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Vito Rihaldijiran" class="l ep by dd de cx" src="../Images/bc704b6dbbe4c36c5d35d1b83810094f.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*g5pkpZz6G8Mtu1g8Gc_VJA.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--da58deae4eb9--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://vitorihaldijiran.medium.com/?source=post_page---byline--da58deae4eb9--------------------------------" rel="noopener follow">Vito Rihaldijiran</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--da58deae4eb9--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">8 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Jul 2, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj lc ld ab q ee le lf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count la lb">1</span></p></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lg k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lh an ao ap id li lj lk" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep ll cn"><div class="l ae"><div class="ab cb"><div class="lm ln lo lp lq lr ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk ml"><img src="../Images/15afc30be2bebf92fe9cf36a084f28ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*l5tifELfa3zk9bAW"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Cover photo by Author generated in DALL-E</figcaption></figure></div></div></div><div class="ab cb nc nd ne nf" role="separator"><span class="ng by bm nh ni nj"/><span class="ng by bm nh ni nj"/><span class="ng by bm nh ni"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><h1 id="b2ef" class="nk nl fq bf nm nn no gq np nq nr gt ns nt nu nv nw nx ny nz oa ob oc od oe of bk">Part 1: RFM Segmentation</h1><p id="d554" class="pw-post-body-paragraph og oh fq oi b go oj ok ol gr om on oo op oq or os ot ou ov ow ox oy oz pa pb fj bk">The methods vary when we talk about customer segmentation. Well, it depends on what we aim to achieve, but the primary purpose of customer segmentation is to <strong class="oi fr">put customers in different kinds of groups according to their similarities.</strong> This method, in practical applications, will help businesses specify their market segments with tailored marketing strategies based on the information from the segmentation.</p><p id="6202" class="pw-post-body-paragraph og oh fq oi b go pc ok ol gr pd on oo op pe or os ot pf ov ow ox pg oz pa pb fj bk">RFM segmentation is one example of customer segmentation. <strong class="oi fr">RFM stands for recency, frequency, </strong>and<strong class="oi fr"> monetary.</strong> This technique is prevalent in commercial businesses due to its straightforward yet powerful approach. According to its abbreviation, we can define each metric in RFM as follows:</p><ul class=""><li id="ee24" class="og oh fq oi b go pc ok ol gr pd on oo op pe or os ot pf ov ow ox pg oz pa pb ph pi pj bk"><strong class="oi fr">Recency (R)</strong>: When was the last time customers made a purchase? Customers who have recently bought something are more inclined to make another purchase, unlike customers who haven’t made a purchase in a while.</li><li id="baa4" class="og oh fq oi b go pk ok ol gr pl on oo op pm or os ot pn ov ow ox po oz pa pb ph pi pj bk"><strong class="oi fr">Frequency (F)</strong>: How often do customers make purchases? Customers who buy frequently are seen as more loyal and valuable.</li><li id="9f73" class="og oh fq oi b go pk ok ol gr pl on oo op pm or os ot pn ov ow ox po oz pa pb ph pi pj bk"><strong class="oi fr">Monetary (M)</strong>: How much money a customer spends? We value customers who spend more money as they are valuable to our business.</li></ul><p id="5ef2" class="pw-post-body-paragraph og oh fq oi b go pc ok ol gr pd on oo op pe or os ot pf ov ow ox pg oz pa pb fj bk">The workflow of RFM segmentation is relatively straightforward. First, we collect data about customer transactions in a selected period. Please ensure we already know when the customer is transacting, how many quantities of particular products the customer buys in each transaction, and how much money the customer spends. After that, we will do the scoring. There are so many thresholds available for us to consider, but how about we opt for a scale ranging from 1 to 5 to evaluate each —where 1 represents the lowest score while 5 stands for the highest score. In the final step, we combine the three scores to create customer segments. For example, the customer who has the highest RFM score (5 in recency, frequency, and monetary) is seen as loyal, while the customer with the lowest RFM score (1 in recency, frequency, and monetary) is seen as a churning user.</p><p id="b10b" class="pw-post-body-paragraph og oh fq oi b go pc ok ol gr pd on oo op pe or os ot pf ov ow ox pg oz pa pb fj bk">In the following parts of the article, we will create an RFM segmentation utilizing a popular unsupervised learning technique known as <strong class="oi fr">K-Means.</strong></p><h1 id="f43c" class="nk nl fq bf nm nn pp gq np nq pq gt ns nt pr nv nw nx ps nz oa ob pt od oe of bk">Part 2: Practical Example</h1><p id="b07b" class="pw-post-body-paragraph og oh fq oi b go oj ok ol gr om on oo op oq or os ot ou ov ow ox oy oz pa pb fj bk">We don’t need to collect the data in this practical example because we already have the dataset. We will use the <strong class="oi fr">Online Retail II dataset</strong> from <a class="af pu" href="https://archive.ics.uci.edu/" rel="noopener ugc nofollow" target="_blank">the UCI Machine Learning Repository.</a> The dataset is licensed under <strong class="oi fr">CC BY 4.0</strong> and eligible for commercial use. You can access the dataset for free through this <a class="af pu" href="https://archive.ics.uci.edu/dataset/502/online+retail+ii" rel="noopener ugc nofollow" target="_blank">link</a>.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk pv"><img src="../Images/25afc79f6e81ba117aa9142225177f24.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PAFRNr3D84L_TtBxSdb1IA.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Figure 1: Online retail II dataset by Author</figcaption></figure><p id="04e9" class="pw-post-body-paragraph og oh fq oi b go pc ok ol gr pd on oo op pe or os ot pf ov ow ox pg oz pa pb fj bk">The dataset has all the information regarding customer transactions in online retail businesses, such as <strong class="oi fr">InvoiceDate</strong>, <strong class="oi fr">Quantity</strong>, and <strong class="oi fr">Price</strong>. There are two files in the dataset, but we will use the <strong class="oi fr">“Year 2010–2011”</strong> version in this example. Now, let’s do the code.</p><p id="da32" class="pw-post-body-paragraph og oh fq oi b go pc ok ol gr pd on oo op pe or os ot pf ov ow ox pg oz pa pb fj bk"><strong class="oi fr">Step 1: Data Preparation</strong></p><p id="cb70" class="pw-post-body-paragraph og oh fq oi b go pc ok ol gr pd on oo op pe or os ot pf ov ow ox pg oz pa pb fj bk">The first step is we do the data preparation. We do this as follows:</p><pre class="mm mn mo mp mq pw px py bp pz bb bk"><span id="85c4" class="qa nl fq px b bg qb qc l qd qe"># Load libraries<br/>library(readxl) # To read excel files in R<br/>library(dplyr) # For data manipulation purpose<br/>library(lubridate) # To work with dates and times<br/>library(tidyr) # For data manipulation (use in drop_na)<br/>library(cluster) # For K-Means clustering<br/>library(factoextra) # For data visualization in the context of clustering<br/>library(ggplot2) # For data visualization<br/><br/># Load the data<br/>data &lt;- read_excel("online_retail_II.xlsx", sheet = "Year 2010-2011")<br/><br/># Remove missing Customer IDs<br/>data &lt;- data %&gt;% drop_na(`Customer ID`)<br/><br/># Remove negative or zero quantities and prices<br/>data &lt;- data %&gt;% filter(Quantity &gt; 0, Price &gt; 0)<br/><br/># Calculate the Monetary value<br/>data &lt;- data %&gt;% mutate(TotalPrice = Quantity * Price)<br/><br/># Define the reference date for Recency calculation<br/>reference_date &lt;- as.Date("2011-12-09")</span></pre><p id="79e8" class="pw-post-body-paragraph og oh fq oi b go pc ok ol gr pd on oo op pe or os ot pf ov ow ox pg oz pa pb fj bk">The data preparation process is essential because the segmentation will refer to the data we process in this step. After we load the libraries and load the data, we perform the following steps:</p><ul class=""><li id="5069" class="og oh fq oi b go pc ok ol gr pd on oo op pe or os ot pf ov ow ox pg oz pa pb ph pi pj bk"><strong class="oi fr">Remove missing customer IDs:</strong> Ensuring each transaction has a valid Customer ID is crucial for accurate customer segmentation.</li><li id="40ef" class="og oh fq oi b go pk ok ol gr pl on oo op pm or os ot pn ov ow ox po oz pa pb ph pi pj bk"><strong class="oi fr">Remove negative or zero quantities and prices:</strong> Negative or zero values for Quantity or Price are not meaningful for RFM analysis, as they could represent returns or errors.</li><li id="bcbc" class="og oh fq oi b go pk ok ol gr pl on oo op pm or os ot pn ov ow ox po oz pa pb ph pi pj bk"><strong class="oi fr">Calculate monetary value:</strong> We calculate it by multiplying Quantity and Price. Later we will group the metrics, one of them in monetary by customer id.</li><li id="867a" class="og oh fq oi b go pk ok ol gr pl on oo op pm or os ot pn ov ow ox po oz pa pb ph pi pj bk"><strong class="oi fr">Define reference date:</strong> This is very important to determine the Recency value. After examining the dataset, we know the date “2011–12–09” is the most recent date in it, so set it as the reference date. The reference date calculates how many days have passed since each customer’s last transaction.</li></ul><p id="9f15" class="pw-post-body-paragraph og oh fq oi b go pc ok ol gr pd on oo op pe or os ot pf ov ow ox pg oz pa pb fj bk">The data will be look like this after this step:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qf"><img src="../Images/05577585c9c68f3d5f89e2b2a616b618.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zZnoa9XhPqw7lp9xVE1cXw.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Figure 2: The dataset after data preparation by Author</figcaption></figure><p id="6a01" class="pw-post-body-paragraph og oh fq oi b go pc ok ol gr pd on oo op pe or os ot pf ov ow ox pg oz pa pb fj bk"><strong class="oi fr">Step 2: Calculate &amp; Scale RFM Metrics</strong></p><p id="b094" class="pw-post-body-paragraph og oh fq oi b go pc ok ol gr pd on oo op pe or os ot pf ov ow ox pg oz pa pb fj bk">In this step, we’ll calculate each metric and scale those before the clustering part. We do this as follows:</p><pre class="mm mn mo mp mq pw px py bp pz bb bk"><span id="53eb" class="qa nl fq px b bg qb qc l qd qe"># Calculate RFM metrics<br/>rfm &lt;- data %&gt;%<br/>  group_by(`Customer ID`) %&gt;%<br/>  summarise(<br/>    Recency = as.numeric(reference_date - max(as.Date(InvoiceDate))),<br/>    Frequency = n_distinct(Invoice),<br/>    Monetary = sum(TotalPrice)<br/>  )<br/><br/># Assign scores from 1 to 5 for each RFM metric<br/>rfm &lt;- rfm %&gt;%<br/>  mutate(<br/>    R_Score = ntile(Recency, 5),<br/>    F_Score = ntile(Frequency, 5),<br/>    M_Score = ntile(Monetary, 5)<br/>  )<br/><br/># Scale the RFM scores<br/>rfm_scaled &lt;- rfm %&gt;%<br/>  select(R_Score, F_Score, M_Score) %&gt;%<br/>  scale()</span></pre><p id="b3be" class="pw-post-body-paragraph og oh fq oi b go pc ok ol gr pd on oo op pe or os ot pf ov ow ox pg oz pa pb fj bk">We divide this step into three parts:</p><ul class=""><li id="ad13" class="og oh fq oi b go pc ok ol gr pd on oo op pe or os ot pf ov ow ox pg oz pa pb ph pi pj bk"><strong class="oi fr">Calculate RFM metrics:</strong> We make a new dataset called <strong class="oi fr">RFM</strong>. We start by grouping by CustomerID so that each customer’s subsequent calculations are performed individually. Then, we calculate each metric. We calculate <strong class="oi fr">Recency</strong> by subtracting the reference date by the most recent transaction date for each customer, <strong class="oi fr">Frequency</strong> by counting the number of unique Invoice for each customer, and <strong class="oi fr">Monetary</strong> by summing the TotalPrice for all transactions for each customer.</li><li id="902e" class="og oh fq oi b go pk ok ol gr pl on oo op pm or os ot pn ov ow ox po oz pa pb ph pi pj bk"><strong class="oi fr">Assign scores 1 to 5:</strong> The scoring helps categorize the customers from highest to lowest RFM, with 5 being the highest and 1 being the lowest.</li><li id="da9d" class="og oh fq oi b go pk ok ol gr pl on oo op pm or os ot pn ov ow ox po oz pa pb ph pi pj bk"><strong class="oi fr">Scale the scores:</strong> We then scale the score for each metric. This scaling ensures that each RFM score contributes equally to the clustering process, avoiding the dominance of any one metric due to different ranges or units.</li></ul><p id="c99b" class="pw-post-body-paragraph og oh fq oi b go pc ok ol gr pd on oo op pe or os ot pf ov ow ox pg oz pa pb fj bk">After we complete this step, the result in the RFM dataset will look like this:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qg"><img src="../Images/7a69ed57746eeb70dbdad8b5546cabb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2oZxT3OUgLYuCMlC0ZfEnQ.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Figure 3: RFM scoring by Author</figcaption></figure><p id="36f6" class="pw-post-body-paragraph og oh fq oi b go pc ok ol gr pd on oo op pe or os ot pf ov ow ox pg oz pa pb fj bk">And the scaled dataset will look like this:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk qh"><img src="../Images/9eb174803b47fbce81e8e455d1e24b93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1384/format:webp/1*RtPg1X4-ZHPSYCuMB1aVnQ.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Figure 4: Scaled RFM dataset by Author</figcaption></figure><p id="e04a" class="pw-post-body-paragraph og oh fq oi b go pc ok ol gr pd on oo op pe or os ot pf ov ow ox pg oz pa pb fj bk"><strong class="oi fr">Step 3: K-Means Clustering</strong></p><p id="a5fa" class="pw-post-body-paragraph og oh fq oi b go pc ok ol gr pd on oo op pe or os ot pf ov ow ox pg oz pa pb fj bk">Now we come to the final step, K-Means Clustering. We do this by:</p><pre class="mm mn mo mp mq pw px py bp pz bb bk"><span id="e91b" class="qa nl fq px b bg qb qc l qd qe"># Determine the optimal number of clusters using the Elbow method<br/>fviz_nbclust(rfm_scaled, kmeans, method = "wss")<br/><br/># Perform K-means clustering<br/>set.seed(123)<br/>kmeans_result &lt;- kmeans(rfm_scaled, centers = 4, nstart = 25)<br/><br/># Add cluster assignment to the original RFM data<br/>rfm &lt;- rfm %&gt;% mutate(Cluster = kmeans_result$cluster)<br/><br/># Visualize the clusters<br/>fviz_cluster(kmeans_result, data = rfm_scaled, <br/>             geom = "point",<br/>             ellipse.type = "convex",<br/>             palette = "jco",<br/>             ggtheme = theme_minimal(),<br/>             main = "Online Retail RFM Segmentation",<br/>             pointsize = 3) +<br/>  theme(<br/>    plot.title = element_text(size = 15, face = "bold"),<br/>    axis.title.x = element_blank(),  <br/>    axis.title.y = element_blank(),  <br/>    axis.text = element_blank(),     <br/>    axis.ticks = element_blank(),    <br/>    legend.title = element_text(size = 12, face = "bold"),<br/>    legend.text = element_text(size = 10)<br/>  )</span></pre><p id="8520" class="pw-post-body-paragraph og oh fq oi b go pc ok ol gr pd on oo op pe or os ot pf ov ow ox pg oz pa pb fj bk">The first part of this step is determining<strong class="oi fr"> the optimal number of clusters using the elbow method</strong>. The method is <strong class="oi fr">wss</strong> or “within-cluster sum of squares”, which measures the compactness of the clusters. This method works by choosing the number of clusters at the point where the wss starts to diminish rapidly, and forming an “elbow.” The elbow diminishes at <strong class="oi fr">4.</strong></p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk qi"><img src="../Images/f31a0e0cfcebc074f7dbdab20075cfdd.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*aGC5LI8C6iJ-fd48aitfxA.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Figure 5: Elbow method implementation by Author</figcaption></figure><p id="338a" class="pw-post-body-paragraph og oh fq oi b go pc ok ol gr pd on oo op pe or os ot pf ov ow ox pg oz pa pb fj bk">The next part is we do the clustering. We specify 4 as the number of clusters and 25 as random sets of initial cluster centers and then choose the best one based on the lowest within-cluster sum of squares. Then, add it to the cluster to the <strong class="oi fr">RFM</strong> dataset. The visualization of the cluster can be seen below:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk qi"><img src="../Images/1ed1e05f0ca2691483b0eefdf0814928.png" data-original-src="https://miro.medium.com/v2/resize:fit:900/format:webp/1*tPuAHlNnisRXX_irA26rEg.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Figure 6: Cluster visualization by Author</figcaption></figure><p id="0bea" class="pw-post-body-paragraph og oh fq oi b go pc ok ol gr pd on oo op pe or os ot pf ov ow ox pg oz pa pb fj bk">Note that the sizes of the clusters in the plot are not directly related to the count of customers in each cluster. The visualization shows the spread of the data points in each cluster based on the scaled RFM scores (R_Score, F_Score, M_Score) rather than the number of customers.</p><h1 id="8670" class="nk nl fq bf nm nn pp gq np nq pq gt ns nt pr nv nw nx ps nz oa ob pt od oe of bk">Part 3: Summary</h1><p id="b922" class="pw-post-body-paragraph og oh fq oi b go oj ok ol gr om on oo op oq or os ot ou ov ow ox oy oz pa pb fj bk">With running this code, the summary of RFM segmentation can be seen as follows:</p><pre class="mm mn mo mp mq pw px py bp pz bb bk"><span id="553a" class="qa nl fq px b bg qb qc l qd qe"># Summary of each cluster<br/>rfm_summary &lt;- rfm %&gt;%<br/>  group_by(Cluster) %&gt;%<br/>  summarise(<br/>    Recency = mean(Recency),<br/>    Frequency = mean(Frequency),<br/>    Monetary = mean(Monetary),<br/>    Count = n()<br/>  )</span></pre><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qj"><img src="../Images/48f1d420337ac4cceb410ad2e32f9428.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*poEkGcpfxfozoH3-tPI8fg.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Figure 7: Summary of RFM segmentation by Author</figcaption></figure><p id="8516" class="pw-post-body-paragraph og oh fq oi b go pc ok ol gr pd on oo op pe or os ot pf ov ow ox pg oz pa pb fj bk">From the summary, we can get generate insights from each cluster. The suggestions will vary greatly. However, what I can think of if I were a Data Scientist in an online retail business is the following:</p><ul class=""><li id="de69" class="og oh fq oi b go pc ok ol gr pd on oo op pe or os ot pf ov ow ox pg oz pa pb ph pi pj bk"><strong class="oi fr">Cluster 1:</strong> They recently made a purchase — typically around a month ago — indicating recent engagement. This cluster of customers, however, tends to make purchases infrequently and spend relatively small amounts overall, averaging 1–2 purchases. Implementing retention campaigns based on these findings can prove to be very effective. Given their recent engagement, it would be beneficial to consider strategies such as follow-up emails or loyalty programs with personalized deals to encourage repeat purchases. This presents an opportunity to suggest additional products that complement their previous purchases, ultimately boosting this group’s average order value and overall spending.</li><li id="e2a4" class="og oh fq oi b go pk ok ol gr pl on oo op pm or os ot pn ov ow ox po oz pa pb ph pi pj bk"><strong class="oi fr">Cluster 2: </strong>The customers in this group recently purchased around two weeks ago and have shown frequent buying habits with significant spending. They are considered top customers, deserving VIP treatment: excellent customer service, special deals, and early access to new items. Utilizing their satisfaction, we could offer referral programs with bonuses and discounts for their family and friends, potentially growing our customer base and increasing overall sales.</li><li id="e95a" class="og oh fq oi b go pk ok ol gr pl on oo op pm or os ot pn ov ow ox po oz pa pb ph pi pj bk"><strong class="oi fr">Cluster 3: </strong>Customers in this segment have been inactive for over three months, even though their frequency and monetary value are moderate. To re-engage these customers, we should consider launching reactivation campaigns. Sending win-back emails with special discounts or showcasing new arrivals could entice them to return. Additionally, gathering feedback to uncover the reasons behind their lack of recent purchases and addressing any issues or concerns they may have can significantly improve their future experience and reignite their interest.</li><li id="3cf9" class="og oh fq oi b go pk ok ol gr pl on oo op pm or os ot pn ov ow ox po oz pa pb ph pi pj bk"><strong class="oi fr">Cluster 4: </strong>Customers in this group have only purchased in up to seven months, indicating a significant period of dormancy. They display the lowest frequency and monetary value, making them highly susceptible to churning. In these situations, it is essential to implement strategies designed explicitly for dormant customers. Sending important offer-based reactivation emails or personalized incentives usually proves effective in returning these customers to your business. Moreover, conducting exit surveys can help identify the reasons behind their inactivity, enabling you to enhance your offerings and customer service to better meet their needs and reignite their interest.</li></ul><p id="6e73" class="pw-post-body-paragraph og oh fq oi b go pc ok ol gr pd on oo op pe or os ot pf ov ow ox pg oz pa pb fj bk">Congrats! you already know how to conduct RFM Segmentation using K-Means, now it’s your turn to do the same way with your own dataset.</p></div></div></div></div>    
</body>
</html>