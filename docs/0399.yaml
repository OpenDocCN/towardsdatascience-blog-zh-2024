- en: Powerful Collaboration of AI Agents with CrewAI
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: ÂéüÊñáÔºö[https://towardsdatascience.com/powerful-collaboration-of-ai-agents-with-crewai-17f84378430b?source=collection_archive---------3-----------------------#2024-02-12](https://towardsdatascience.com/powerful-collaboration-of-ai-agents-with-crewai-17f84378430b?source=collection_archive---------3-----------------------#2024-02-12)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: A hands-on marketing use case
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://toon-beerten.medium.com/?source=post_page---byline--17f84378430b--------------------------------)[![Toon
    Beerten](../Images/f169eaa8cefa00f17176955596972d57.png)](https://toon-beerten.medium.com/?source=post_page---byline--17f84378430b--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--17f84378430b--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--17f84378430b--------------------------------)
    [Toon Beerten](https://toon-beerten.medium.com/?source=post_page---byline--17f84378430b--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ¬∑Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--17f84378430b--------------------------------)
    ¬∑11 min read¬∑Feb 12, 2024
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/8e6b6dc2cf7f29bc959f6bdc65a4ae87.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by author ([with](https://huggingface.co/spaces/prodia/fast-stable-diffusion))
  prefs: []
  type: TYPE_NORMAL
- en: 'In this article, I‚Äôll show you how to orchestrate AI puppets to successfully
    tackle a real-life marketing challenge where the agents work together to:'
  prefs: []
  type: TYPE_NORMAL
- en: analyze customer data profiles
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: select the ideal products for targeted marketing
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: create compelling promotional text for those products.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We will use a new framework called [CrewAI](https://github.com/joaomdmoura/crewAI),
    enabling autonomous AI agents to collaborate and achieve common goals. Everything
    is documented in the provided [Colab notebook](https://colab.research.google.com/github/Toon-nooT/notebooks/blob/main/Marketing_Campaign__With_CrewAI.ipynb),
    so you can replicate and adapt it to your own use case.
  prefs: []
  type: TYPE_NORMAL
- en: What is CrewAI?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[CrewAI](https://docs.crewai.com/) is a new framework that facilitates the
    collaboration of AI agents. The agents can adopt specific roles, share common
    objectives, and ‚Äî as a whole ‚Äî function as an efficient team. It is open source
    and built upon [Langchain](https://www.langchain.com/). Some alternatives in the
    same field are [Microsofts AutoGen](https://microsoft.github.io/autogen/) and
    [ChatDev](https://github.com/OpenBMB/ChatDev).'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/4afc85d7770d80f5787167c25db39ee8.png)'
  prefs: []
  type: TYPE_IMG
- en: Image taken from official [documentation](https://joaomdmoura.github.io/crewAI/)
  prefs: []
  type: TYPE_NORMAL
- en: 'The main concepts of CrewAI revolve around three core entities: **Agents**,
    **Tasks**, and **Crews**.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Agents**: These are standalone units programmed to perform tasks , make decisions
    and communicate with other agents. They can use **Tools** which can be simple
    search functions or complex integrations involving other chains, APIs, etc.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Tasks**: Tasks are assignments or jobs that an AI agent needs to complete.
    They can include additional information like which agent should do it and what
    tools they might need.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: A **Crew** is a team of agents, each with a specific role, that work together
    to achieve a common goal. The process of forming a crew involves assembling agents,
    defining their tasks and establishing a sequence of task execution.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: To test out what it‚Äôs capable of, I devised the following scenario‚Ä¶
  prefs: []
  type: TYPE_NORMAL
- en: '**Marketing Challenge**'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Imagine you are the head of a local retailer. Next week you‚Äôll run a promotion
    campaign on 12 products. Which products will you target to which customers? As
    you can imagine, it makes very little sense to promote lipstick to male clients.
    Can this be optimized with AI?
  prefs: []
  type: TYPE_NORMAL
- en: 'Through use of loyalty cards and datamining, you have access to a database
    with the customer personality analysis. This helps to understand the characteristics,
    preferences and behaviors of customers. With a well designed prompt (see notebook)
    I got this dataset of customers in seconds:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'For the possible campaign products I came up with these:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: These were especially chosen because I expect to see correlations. For example
    between the promotion of diapers to the number of toddlers and wagyu steak to
    the household income. Can the agents work together to discover this logic by using
    common sense?
  prefs: []
  type: TYPE_NORMAL
- en: '**Implementation**'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'My first crew will target the right products by selecting the 3 most suited
    for each specific customer. In this crew, I created three agents:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Chief Promotion Director**: gets the main task, oversees work of others'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Customer Profiler**: to create an understanding of the customer'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Product Specialist**: expertly links products to customers'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Each needs a role, goal and backstory. We can use natural language for this.
    In my [notebook](https://github.com/Toon-nooT/notebooks) it became this:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'The following **task** is given to agent **Chief Promotion Director**, who
    delegates work to the other agents:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'All agents interact with each other until agent Chief Promotion Director is
    happy and ends the task. To better understand what happens when this crew is kicked
    off, I created this schematic:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/677abbd30b9354d5e71d11dfaddd2035.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by author
  prefs: []
  type: TYPE_NORMAL
- en: 'The second crew will write a short promotional text alongside the product.
    It should also be in line with what can be deducted from the customers data. For
    this I create an additional **Creative Content Creator** agent:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'This agent will work together with the previous ‚Äòboss‚Äô agent in a new crew
    with the following task:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'Each agent is linked to Large Language Model that it will use. I linked them
    to the [Mistral API](https://docs.mistral.ai/). I first integrated their Mistral
    7B Instruct v0.2 model, but it reasoned very strangely, such as this explanation
    for selecting diapers: ‚Äú*Although the customer is currently single, they might
    have children in the future. Diapers are a practical investment for potential
    parenthood, as they are essential for the care of infants and toddlers.*‚Äù'
  prefs: []
  type: TYPE_NORMAL
- en: 'That was solved by upgrading to a bigger model: Mixtral 8x7B. I haven‚Äôt seen
    any such logic flaws again.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Results**'
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'With my two crews set up, it‚Äôs time to let them loose on the 10 customers.
    By setting the verbose mode to 2, I am able to see behind the screen and follow
    the agents thoughts and interactions. E.g.:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 'Now, let‚Äôs dissect two customers in detail. The first customer was:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'Giving that to the **profiler agent**, its response is: ‚Äú*Our customer is a
    single woman in her late 20s or early 30s with a moderate income. She enjoys wine
    and vegetables, likely cooking for herself. She doesn‚Äôt have children and has
    a higher education background, suggesting she might be more health-conscious and
    have a busy lifestyle. She doesn‚Äôt use coupons often, indicating she might prefer
    convenience over savings.*‚Äù'
  prefs: []
  type: TYPE_NORMAL
- en: 'The **product specialist** agent responds with: ‚Äú*Based on the customer profile,
    I recommend the following products:*'
  prefs: []
  type: TYPE_NORMAL
- en: '*Fresh Lettuce: Given her interest in vegetables, she might enjoy fresh lettuce
    as a healthy addition to her meals.*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Mascara: As a single woman, she might appreciate beauty products like mascara,
    fitting with her higher education and busy lifestyle.*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Spaghetti cans (ready to eat): Due to her busy lifestyle, she might not always
    have time to cook, making ready-to-eat spaghetti a convenient option.*‚Äù'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'These are very reasonable selections! Let‚Äôs see now what the other crew came
    up with as promotional messages. I pasted them in this mock up. The product messages
    are very spot on:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/87ce8b71f59b0114d515810727461338.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by author
  prefs: []
  type: TYPE_NORMAL
- en: 'Let‚Äôs have a look at how they managed with the 2nd customer:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: 'The profile built was very basic, but complete: ‚Äú*Customer was born in 1985,
    male, married, 90th percentile yearly household income, has 2 toddlers and 1 teenage
    kid, highest education is PhD, spends 80 $ on wine, 100 $ on vegetables, 120 $
    on toys, high coupon use.*‚Äù'
  prefs: []
  type: TYPE_NORMAL
- en: 'Here are the products selected and promoted:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/a71b809c7ac1fd13bcab5ede68f97436.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by author
  prefs: []
  type: TYPE_NORMAL
- en: The product selection and promo texts match very well with what is known of
    the customer. They picked Wagyu because of the high income, spaghetti because
    he‚Äôs a busy parent with 3 children and a game because he has teen kids.
  prefs: []
  type: TYPE_NORMAL
- en: 'Zooming out, here are my **observations** from the overall crew output:'
  prefs: []
  type: TYPE_NORMAL
- en: ‚úîÔ∏è diapers were only proposed to customers with toddlers
  prefs: []
  type: TYPE_NORMAL
- en: ‚úîÔ∏è mascara was only proposed to female customers
  prefs: []
  type: TYPE_NORMAL
- en: ‚úîÔ∏è wagyu was only proposed to highest income customers
  prefs: []
  type: TYPE_NORMAL
- en: ‚úîÔ∏è laundry detergent was 4 times proposed. Two times to women, but also twice
    to not-married (!) men
  prefs: []
  type: TYPE_NORMAL
- en: ‚úîÔ∏è cigarettes were never promoted (*pats Mixtral* ‚Äî good AI)
  prefs: []
  type: TYPE_NORMAL
- en: ‚úîÔ∏è all the accompanying texts were tailored to the customer without being creepily
    specific or containing hallucinations
  prefs: []
  type: TYPE_NORMAL
- en: ‚úîÔ∏è I never saw product suggestions that were out of place
  prefs: []
  type: TYPE_NORMAL
- en: That‚Äôs exactly what a marketer would be hoping for! The crew seems to be aware
    of some common-sense knowledge and can reason around it.
  prefs: []
  type: TYPE_NORMAL
- en: Ethicality
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: When I said common sense, please be aware that it is not a universal common
    sense. Each large language model has inherently a certain bias, based on the training
    data and training optimization (eg. RLHF).
  prefs: []
  type: TYPE_NORMAL
- en: 'For example: I found it striking that in my example the model proposed laundry
    detergent only to men when they are not married. Was this just by chance or is
    it supposing that married men in a household don‚Äôt take care of laundry? Maybe
    because the model has only seen couples where only women do the laundry? This
    might statistically be correct, but the fact is that we don‚Äôt know which other
    biases there are. We should be wary about putting these frameworks in production
    without scrutiny, as they may propagate stereotypes around gender, politics, religion,
    ethnicity, etc. It is still a field of ongoing research to mitigate these risks.
    For further reading I can suggest: OpenAI‚Äôs [blogpost](https://openai.com/blog/how-should-ai-systems-behave),
    [ü§ó Evaluate library](https://huggingface.co/blog/evaluating-llm-bias) and [practical
    tips](https://huggingface.co/blog/ethics-soc-2).'
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: My results demonstrate that the AI agents can reason to pick the best products
    based on customer profiles and provide spot-on promotional messages tailored to
    each customer, taking into account factors such as age, gender, marital status,
    and income.
  prefs: []
  type: TYPE_NORMAL
- en: We saw autonomous AI agents collaborate, delegate or be assigned a sub task,
    call for help and review each others work. When they do that, their output quality
    is significantly amplified, resulting in more reliable and common-sense decisions.
    Frameworks like CrewAI offer a straightforward, yet effective way to harness this
    power by allowing natural language instructions. I also touched on the subject
    of the common knowledge ingrained in LLMs and that there will be bias and one
    should strive for fairness.
  prefs: []
  type: TYPE_NORMAL
- en: 'This was just a simple example focused on marketing. There are so many other
    use cases: parsing data, an automatic social media poster, a markdown validator
    or a city trip planner ‚Ä¶ The possibilities are endless. Maybe it will help you
    with your next challenge?'
  prefs: []
  type: TYPE_NORMAL
- en: '[](https://colab.research.google.com/github/Toon-nooT/notebooks/blob/main/Marketing_Campaign__With_CrewAI.ipynb?source=post_page-----17f84378430b--------------------------------)
    [## Colab Notebook'
  prefs: []
  type: TYPE_NORMAL
- en: 'Powerful Collaboration of AI Agents with CrewAI: Marketing use case](https://colab.research.google.com/github/Toon-nooT/notebooks/blob/main/Marketing_Campaign__With_CrewAI.ipynb?source=post_page-----17f84378430b--------------------------------)  [##
    Home'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Cutting-edge framework for orchestrating role-playing, autonomous AI agents.
    By fostering collaborative intelligence‚Ä¶
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'docs.crewai.com](https://docs.crewai.com/?source=post_page-----17f84378430b--------------------------------)
    [](https://github.com/joaomdmoura/crewAI?source=post_page-----17f84378430b--------------------------------)
    [## GitHub - joaomdmoura/crewAI: Framework for orchestrating role-playing, autonomous
    AI agents. By‚Ä¶'
  prefs: []
  type: TYPE_NORMAL
- en: Framework for orchestrating role-playing, autonomous AI agents. By fostering
    collaborative intelligence, CrewAI‚Ä¶
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: github.com](https://github.com/joaomdmoura/crewAI?source=post_page-----17f84378430b--------------------------------)
  prefs: []
  type: TYPE_NORMAL
