<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Validating the Causal Impact of the Synthetic Control Method</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Validating the Causal Impact of the Synthetic Control Method</h1>
<blockquote>ÂéüÊñáÔºö<a href="https://towardsdatascience.com/validating-the-causal-impact-of-the-synthetic-control-method-2f3bf185f266?source=collection_archive---------6-----------------------#2024-06-08">https://towardsdatascience.com/validating-the-causal-impact-of-the-synthetic-control-method-2f3bf185f266?source=collection_archive---------6-----------------------#2024-06-08</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="1720" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">Causal AI, exploring the integration of causal reasoning into machine learning</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@raz1470?source=post_page---byline--2f3bf185f266--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Ryan O'Sullivan" class="l ep by dd de cx" src="../Images/7cd161d38d67d2c0b7da2d8f3e7d33fe.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*tAw1S072P0f0sUswKPN6VQ.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--2f3bf185f266--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://medium.com/@raz1470?source=post_page---byline--2f3bf185f266--------------------------------" rel="noopener follow">Ryan O'Sullivan</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">¬∑</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--2f3bf185f266--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">¬∑</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">10 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">¬∑</span></span></div><span data-testid="storyPublishDate">Jun 8, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj lc ld ab q ee le lf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count la lb">3</span></p></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lg k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lh an ao ap id li lj lk" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep ll cn"><div class="l ae"><div class="ab cb"><div class="lm ln lo lp lq lr ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk ml"><img src="../Images/242fd31202ca191c89090516f0165385.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cEuO0MxHSJbpWpSq"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Photo by <a class="af nc" href="https://unsplash.com/@irinainga05?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Irina Inga</a> on <a class="af nc" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="f5bb" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">What is this series of articles about?</h1><p id="561f" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">Welcome to my series on Causal AI, where we will explore the integration of causal reasoning into machine learning models. Expect to explore a number of practical applications across different business contexts.</p><p id="b818" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">In the last article we covered <em class="pa">measuring the intrinsic causal influence of your marketing campaigns</em>. In this article we will move onto <em class="pa">validating the causal impact of the synthetic controls</em>.</p><p id="f69e" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">If you missed the last article on intrinsic causal influence, check it out here:</p><div class="pb pc pd pe pf pg"><a rel="noopener follow" target="_blank" href="/measuring-the-intrinsic-causal-influence-of-your-marketing-campaigns-aa8354c26b7b?source=post_page-----2f3bf185f266--------------------------------"><div class="ph ab ig"><div class="pi ab co cb pj pk"><h2 class="bf fr hw z io pl iq ir pm it iv fp bk">Measuring The Intrinsic Causal Influence Of Your Marketing Campaigns</h2><div class="pn l"><h3 class="bf b hw z io pl iq ir pm it iv dx">Causal AI, exploring the integration of causal reasoning into machine learning</h3></div><div class="po l"><p class="bf b dy z io pl iq ir pm it iv dx">towardsdatascience.com</p></div></div><div class="pp l"><div class="pq l pr ps pt pp pu lr pg"/></div></div></a></div><h1 id="b876" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Introduction</h1><p id="98db" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">In this article we will focus on understanding the synthetic control method and exploring how we can validate the estimated causal impact.</p><p id="d103" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk"><strong class="ob fr">The following aspects will be covered:</strong></p><ul class=""><li id="11c9" class="nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou pv pw px bk">What is the synthetic control method?</li><li id="c7a8" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk">What challenge does it try to overcome?</li><li id="7955" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk">How can we validate the estimated causal impact?</li><li id="35fa" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk">A Python case study using realistic google trend data, demonstrating how we can validate the estimated causal impact of the synthetic controls.</li></ul><p id="bde6" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">The full notebook can be found here:</p><div class="pb pc pd pe pf pg"><a href="https://github.com/raz1470/causal_ai/blob/main/notebooks/synthetic%20controls%20-%20model%20training.ipynb?source=post_page-----2f3bf185f266--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="ph ab ig"><div class="pi ab co cb pj pk"><h2 class="bf fr hw z io pl iq ir pm it iv fp bk">causal_ai/notebooks/synthetic controls - model training.ipynb at main ¬∑ raz1470/causal_ai</h2><div class="pn l"><h3 class="bf b hw z io pl iq ir pm it iv dx">This project introduces Causal AI and how it can drive business value. - causal_ai/notebooks/synthetic controls - model‚Ä¶</h3></div><div class="po l"><p class="bf b dy z io pl iq ir pm it iv dx">github.com</p></div></div><div class="pp l"><div class="qd l pr ps pt pp pu lr pg"/></div></div></a></div><h1 id="95fc" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Synthetic Control Method</h1><h2 id="b4de" class="qe ne fq bf nf qf qg qh ni qi qj qk nl oi ql qm qn om qo qp qq oq qr qs qt qu bk">What is it?</h2><p id="6a6d" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">The synthetic control method is a causal technique which can be used to assess the causal impact of an intervention or treatment when a randomised control trial (RCT) or A/B test was not possible. It was originally proposed in 2003 by Abadie and Gardezabal. The following paper includes a great case study to help you understand the proposed method:</p><p id="0eb6" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk"><a class="af nc" href="https://web.stanford.edu/~jhain/Paper/JASA2010.pdf" rel="noopener ugc nofollow" target="_blank">https://web.stanford.edu/~jhain/Paper/JASA2010.pdf</a></p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qv"><img src="../Images/4876ac9837822ae299d7afa75560fe05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J8__BV-yRPBXUiRAQ2OKeA.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">User generated image</figcaption></figure><p id="f1d8" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Let‚Äôs cover some of the basics ourselves‚Ä¶ The synthetic control method creates a counterfactual version of the treatment unit by creating a weighted combination of control units that did not receive the intervention or treatment.</p><ul class=""><li id="5bb1" class="nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou pv pw px bk"><strong class="ob fr">Treated unit:</strong> The unit which receives the intervention.</li><li id="3dda" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk"><strong class="ob fr">Control units:</strong> A set of similar units which did not receive the intervention.</li><li id="85f0" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk"><strong class="ob fr">Counterfactual: </strong>Created as a weighted combination of the control units. Aim is to find weights for each control unit that result in a counterfactual which closely matches the treated unit in the pre-intervention period.</li><li id="9c6c" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk"><strong class="ob fr">Causal impact: </strong>The difference between the post-intervention treatment unit and counterfactual.</li></ul><p id="a34c" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">If we wanted to really simplify things, we could think of it as linear regression where each control unit is a feature and the treatment unit is the target. The pre-intervention period is our train set, and we use the model to score our post-intervention period. The difference between the actual and predicted is the causal impact.</p><p id="3785" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Below are a couple examples to bring it to life when we might consider using it:</p><ul class=""><li id="caa9" class="nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou pv pw px bk">When running a TV marketing campaign, we are unable to randomly assign the audience into those that can and can‚Äôt see the campaign. We could however, carefully select a region to trial the campaign and use the remaining regions as control units. Once we have measured the effect the campaign could be rolled out to other regions. This is often called a geo-lift test.</li><li id="04fc" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk">Policy changes which are brought into some regions but not others ‚Äî For example a local council may bring a policy change into force to reduce unemployment. Other regions where the policy wasn‚Äôt in place could be used as control units.</li></ul><h2 id="804c" class="qe ne fq bf nf qf qg qh ni qi qj qk nl oi ql qm qn om qo qp qq oq qr qs qt qu bk">What challenge does it try to overcome?</h2><p id="f5ed" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">When we combine high-dimensionality (lots of features) with limited observations, we can get a model which overfits.</p><p id="7cd7" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Let‚Äôs take the geo-lift example to illustrate. If we use weekly data from the last year as our pre-intervention period, this gives us 52 observations. If we then decide to test our intervention across countries in Europe, that will give us an observation to feature ratio of 1:1!</p><p id="a824" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Earlier we talked about how the synthetic control method could be implemented using linear regression. However, the observation to feature ratio mean it is very likely linear regression will overfit resulting in a poor causal impact estimate in the post-intervention period.</p><p id="537e" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">In linear regression the weights (coefficients) for each feature (control unit) could be negative or positive and they may sum to a number greater than 1. However, the synthetic control method learns the weights whilst applying the below constraints:</p><ul class=""><li id="6d2d" class="nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou pv pw px bk">Constraining weights to sum to 1</li><li id="8e36" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk">Constraining weights to be ‚â• 0</li></ul><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk qw"><img src="../Images/ab8a2f8a1d158f245bef617fcefd96b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:650/format:webp/1*pDgm07Qx9phx40w2FkcaDQ.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">User generate image</figcaption></figure><p id="c76d" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">These constraints help with regularisation and avoid extrapolation beyond the range of the observed data.</p><p id="1bb5" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">It is worth noting that in terms of regularisation, Ridge and Lasso regression can achieve this, and in some cases are reasonable alternatives. But we will test this out in the case study!</p><h2 id="ab95" class="qe ne fq bf nf qf qg qh ni qi qj qk nl oi ql qm qn om qo qp qq oq qr qs qt qu bk">How can we validate the estimated causal impact?</h2><p id="f72e" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">An arguably bigger challenge is the fact that we are unable to validate the estimated causal impact in the post-intervention period.</p><p id="56ab" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">How long should my pre-intervention period be? Are we sure we haven‚Äôt overfit our pre-intervention period? How can we know whether our model generalises well in the post intervention period? What if I want to try out different implementations of synthetic control method?</p><p id="70d3" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">We could randomly select a few observations from the pre-intervention period and hold them back for validation ‚Äî But we have already highlighted the challenge which comes from having limited observations so we may make things even worse!</p><p id="52e4" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">What if we could run some sort of pre-intervention simulation? Could that help us answer some of the questions highlighted above and gain confidence in our models estimated causal impact? All will be explained in the case study!</p><h1 id="80c6" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Case study</h1><h2 id="6a04" class="qe ne fq bf nf qf qg qh ni qi qj qk nl oi ql qm qn om qo qp qq oq qr qs qt qu bk">Background</h2><p id="1e92" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">After convincing Finance that brand marketing is driving some serious value, the marketing team approach you to ask about geo-lift testing. Someone from Facebook has told them it‚Äôs the next big thing (although it was the same person who told them Prophet was a good forecasting model) and they want to know whether they could use it to measure their new TV campaign which is coming up.</p><p id="9158" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">You are a little concerned, as the last time you ran a geo-lift test the marketing analytics team thought it was a good idea to play around with the pre-intervention period used until they had a nice big causal impact.</p><p id="cef0" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">This time round, you suggest that they run a ‚Äúpre-intervention simulation‚Äù after which you propose that the pre-intervention period is agreed before the test begins.</p><p id="42c6" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">So let‚Äôs explore what a ‚Äúpre-intervention simulation‚Äù looks like!</p><h2 id="9be9" class="qe ne fq bf nf qf qg qh ni qi qj qk nl oi ql qm qn om qo qp qq oq qr qs qt qu bk">Creating the data</h2><p id="fbcd" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">To make this as realistic as possible, I extracted some google trend data for the majority of countries in Europe. What the search term was isn‚Äôt relevant, just pretend it‚Äôs the sales for you company (and that you operate across Europe).</p><p id="0fb6" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">However, if you are interested in how I got the google trend data, check out my notebook:</p><div class="pb pc pd pe pf pg"><a href="https://github.com/raz1470/causal_ai/blob/main/notebooks/synthetic%20controls%20-%20data%20collection.ipynb?source=post_page-----2f3bf185f266--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="ph ab ig"><div class="pi ab co cb pj pk"><h2 class="bf fr hw z io pl iq ir pm it iv fp bk">causal_ai/notebooks/synthetic controls - data collection.ipynb at main ¬∑ raz1470/causal_ai</h2><div class="pn l"><h3 class="bf b hw z io pl iq ir pm it iv dx">This project introduces Causal AI and how it can drive business value. - causal_ai/notebooks/synthetic controls - data‚Ä¶</h3></div><div class="po l"><p class="bf b dy z io pl iq ir pm it iv dx">github.com</p></div></div><div class="pp l"><div class="qx l pr ps pt pp pu lr pg"/></div></div></a></div><p id="0211" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Below we can see the dataframe. We have sales for the past 3 years across 50 European countries. The marketing team plan to run their TV campaign in Great Britain.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qy"><img src="../Images/38a31d9ec200cba9a45b6c09bc9347b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4WHXUV8rfn4EU53oO8XK_g.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">User generated image</figcaption></figure><p id="7f03" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Now here comes the clever bit. We will simulate an intervention in the last 7 weeks of the time series.</p><pre class="mm mn mo mp mq qz ra rb bp rc bb bk"><span id="3e61" class="rd ne fq ra b bg re rf l rg rh">np.random.seed(1234)<br/><br/># Create intervention flag<br/>mask = (df['date'] &gt;= "2024-04-14") &amp; (df['date'] &lt;= "2024-06-02")<br/>df['intervention'] = mask.astype(int)<br/><br/>row_count = len(df)<br/><br/># Create intervention uplift<br/>df['uplift_perc'] = np.random.uniform(0.10, 0.20, size=row_count)<br/>df['uplift_abs'] = round(df['uplift_perc'] * df['GB'])<br/>df['y'] = df['GB']<br/>df.loc[df['intervention'] == 1, 'y'] = df['GB'] + df['uplift_abs']</span></pre><p id="a3a1" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Now let‚Äôs plot the actual and counterfactual sales across GB to bring what we have done to life:</p><pre class="mm mn mo mp mq qz ra rb bp rc bb bk"><span id="8b26" class="rd ne fq ra b bg re rf l rg rh">def synth_plot(df, counterfactual):<br/>    <br/>    plt.figure(figsize=(14, 8))<br/>    sns.set_style("white")<br/><br/>    # Create plot<br/>    sns.lineplot(data=df, x='date', y='y', label='Actual', color='b', linewidth=2.5)<br/>    sns.lineplot(data=df, x='date', y=counterfactual, label='Counterfactual', color='r', linestyle='--', linewidth=2.5)<br/>    plt.title('Synthetic Control Method: Actual vs. Counterfactual', fontsize=24)<br/>    plt.xlabel('Date', fontsize=20)<br/>    plt.ylabel('Metric Value', fontsize=20)<br/>    plt.legend(fontsize=16)<br/>    plt.gca().xaxis.set_major_formatter(plt.matplotlib.dates.DateFormatter('%Y-%m-%d'))<br/>    plt.xticks(rotation=90)<br/>    plt.grid(True, linestyle='--', alpha=0.5)<br/><br/>    # High the intervention point<br/>    intervention_date = '2024-04-07'<br/>    plt.axvline(pd.to_datetime(intervention_date), color='k', linestyle='--', linewidth=1)<br/>    plt.text(pd.to_datetime(intervention_date), plt.ylim()[1]*0.95, 'Intervention', color='k', fontsize=18, ha='right')<br/><br/>    plt.tight_layout()<br/>    plt.show()</span></pre><pre class="ri qz ra rb bp rc bb bk"><span id="a0bc" class="rd ne fq ra b bg re rf l rg rh">synth_plot(df, 'GB')</span></pre><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qv"><img src="../Images/4876ac9837822ae299d7afa75560fe05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*J8__BV-yRPBXUiRAQ2OKeA.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">User generated image</figcaption></figure><p id="4a3f" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">So now we have simulated an intervention, we can explore how well the synthetic control method will work.</p><h2 id="67ad" class="qe ne fq bf nf qf qg qh ni qi qj qk nl oi ql qm qn om qo qp qq oq qr qs qt qu bk">Pre-processing</h2><p id="93d9" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">All of the European countries apart from GB are set as control units (features). The treatment unit (target) is the sales in GB with the intervention applied.</p><pre class="mm mn mo mp mq qz ra rb bp rc bb bk"><span id="0535" class="rd ne fq ra b bg re rf l rg rh"># Delete the original target column so we don't use it as a feature by accident<br/>del df['GB']<br/><br/># set feature &amp; targets<br/>X = df.columns[1:50]<br/>y = 'y'</span></pre><h2 id="6d41" class="qe ne fq bf nf qf qg qh ni qi qj qk nl oi ql qm qn om qo qp qq oq qr qs qt qu bk">Regression</h2><p id="1b8f" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">Below I have setup a function which we can re-use with different pre-intervention periods and different regression models (e.g. Ridge, Lasso):</p><pre class="mm mn mo mp mq qz ra rb bp rc bb bk"><span id="dff2" class="rd ne fq ra b bg re rf l rg rh">def train_reg(df, start_index, reg_class):<br/>    <br/>    df_temp = df.iloc[start_index:].copy().reset_index()<br/>    <br/>    X_pre = df_temp[df_temp['intervention'] == 0][X]<br/>    y_pre = df_temp[df_temp['intervention'] == 0][y]<br/>    <br/>    X_train, X_test, y_train, y_test = train_test_split(X_pre, y_pre, test_size=0.10, random_state=42)<br/>    <br/>    model = reg_class<br/>    model.fit(X_train, y_train)<br/><br/>    yhat_train = model.predict(X_train)<br/>    yhat_test = model.predict(X_test)<br/><br/>    mse_train = mean_squared_error(y_train, yhat_train)<br/>    mse_test = mean_squared_error(y_test, yhat_test)<br/>    print(f"Mean Squared Error train: {round(mse_train, 2)}")<br/>    print(f"Mean Squared Error test: {round(mse_test, 2)}")<br/><br/>    r2_train = r2_score(y_train, yhat_train)<br/>    r2_test = r2_score(y_test, yhat_test)<br/>    print(f"R2 train: {round(r2_train, 2)}")<br/>    print(f"R2 test: {round(r2_test, 2)}")<br/>    <br/>    df_temp['pred'] = model.predict(df_temp.loc[:, X])<br/>    df_temp['delta'] = df_temp['y'] - df_temp['pred']<br/><br/>    pred_lift = df_temp[df_temp['intervention'] == 1]['delta'].sum()<br/>    actual_lift = df_temp[df_temp['intervention'] == 1]['uplift_abs'].sum()<br/>    abs_error_perc = abs(pred_lift - actual_lift) / actual_lift<br/>    print(f"Predicted lift: {round(pred_lift, 2)}")<br/>    print(f"Actual lift: {round(actual_lift, 2)}")<br/>    print(f"Absolute error percentage: {round(abs_error_perc, 2)}")<br/>    <br/>    return df_temp, abs_error_perc</span></pre><p id="7ea6" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">To start us off we keep things simple and use linear regression to estimate the causal impact, using a small pre-intervention period:</p><pre class="mm mn mo mp mq qz ra rb bp rc bb bk"><span id="b1ba" class="rd ne fq ra b bg re rf l rg rh">df_lin_reg_100, pred_lift_lin_reg_100 = train_reg(df, 100, LinearRegression())</span></pre><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk rj"><img src="../Images/e48bd5832d392f66cc7bd5be1945b135.png" data-original-src="https://miro.medium.com/v2/resize:fit:638/format:webp/1*W6_jqP4N3OjrxH9yFxBFlw.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">User generated image</figcaption></figure><p id="bb1a" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Looking at the results, linear regression doesn‚Äôt do great. But this isn‚Äôt surprising given the observation to feature ratio.</p><pre class="mm mn mo mp mq qz ra rb bp rc bb bk"><span id="489a" class="rd ne fq ra b bg re rf l rg rh">synth_plot(df_lin_reg_100, 'pred')</span></pre><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qv"><img src="../Images/5995e5ef2df8c9ec4a57f4df245e8be3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GqlHmKxDWu5XKQUcmXDHHw.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">User generated image</figcaption></figure><h2 id="b1b8" class="qe ne fq bf nf qf qg qh ni qi qj qk nl oi ql qm qn om qo qp qq oq qr qs qt qu bk">Synthetic control method</h2><p id="5990" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">Let‚Äôs jump right in and see how it compares to the synthetic control method. Below I have setup a similar function as before, but applying the synthetic control method using sciPy:</p><pre class="mm mn mo mp mq qz ra rb bp rc bb bk"><span id="8bec" class="rd ne fq ra b bg re rf l rg rh">def synthetic_control(weights, control_units, treated_unit):<br/>    <br/>    synthetic = np.dot(control_units.values, weights)<br/>    <br/>    return np.sqrt(np.sum((treated_unit - synthetic)**2))<br/><br/>def train_synth(df, start_index):<br/>    <br/>    df_temp = df.iloc[start_index:].copy().reset_index()<br/>    <br/>    X_pre = df_temp[df_temp['intervention'] == 0][X]<br/>    y_pre = df_temp[df_temp['intervention'] == 0][y]<br/>    <br/>    X_train, X_test, y_train, y_test = train_test_split(X_pre, y_pre, test_size=0.10, random_state=42)<br/>    <br/>    initial_weights = np.ones(len(X)) / len(X)<br/><br/>    constraints = ({'type': 'eq', 'fun': lambda w: np.sum(w) - 1})<br/><br/>    bounds = [(0, 1) for _ in range(len(X))]<br/><br/>    result = minimize(synthetic_control, <br/>                     initial_weights, <br/>                     args=(X_train, y_train),<br/>                     method='SLSQP', <br/>                     bounds=bounds, <br/>                     constraints=constraints,<br/>                     options={'disp': False, 'maxiter': 1000, 'ftol': 1e-9},<br/>    )<br/>    <br/>    optimal_weights = result.x<br/>    <br/>    yhat_train = np.dot(X_train.values, optimal_weights)<br/>    yhat_test = np.dot(X_test.values, optimal_weights)<br/>    <br/>    mse_train = mean_squared_error(y_train, yhat_train)<br/>    mse_test = mean_squared_error(y_test, yhat_test)<br/>    print(f"Mean Squared Error train: {round(mse_train, 2)}")<br/>    print(f"Mean Squared Error test: {round(mse_test, 2)}")<br/><br/>    r2_train = r2_score(y_train, yhat_train)<br/>    r2_test = r2_score(y_test, yhat_test)<br/>    print(f"R2 train: {round(r2_train, 2)}")<br/>    print(f"R2 test: {round(r2_test, 2)}")    <br/>    <br/>    df_temp['pred'] = np.dot(df_temp.loc[:, X].values, optimal_weights)<br/>    df_temp['delta'] = df_temp['y'] - df_temp['pred']<br/><br/>    pred_lift = df_temp[df_temp['intervention'] == 1]['delta'].sum()<br/>    actual_lift = df_temp[df_temp['intervention'] == 1]['uplift_abs'].sum()<br/>    abs_error_perc = abs(pred_lift - actual_lift) / actual_lift<br/>    print(f"Predicted lift: {round(pred_lift, 2)}")<br/>    print(f"Actual lift: {round(actual_lift, 2)}")<br/>    print(f"Absolute error percentage: {round(abs_error_perc, 2)}")<br/>    <br/>    return df_temp, abs_error_perc</span></pre><p id="2f72" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">I keep the pre-intervention period the same to create a fair comparison to linear regression:</p><pre class="mm mn mo mp mq qz ra rb bp rc bb bk"><span id="f65c" class="rd ne fq ra b bg re rf l rg rh">df_synth_100, pred_lift_synth_100 = train_synth(df, 100)</span></pre><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk rk"><img src="../Images/bb483c51df63e0e5df556624775d4e4e.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*qMNIS_HQehx6uyRihj6rSA.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">User generated image</figcaption></figure><p id="e526" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Wow! I‚Äôll be the first to admit I wasn‚Äôt expecting such a significant improvement!</p><pre class="mm mn mo mp mq qz ra rb bp rc bb bk"><span id="6353" class="rd ne fq ra b bg re rf l rg rh">synth_plot(df_synth_100, 'pred')</span></pre><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qv"><img src="../Images/8593cd13b5533eec365a1c92006b5ca2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mphCmZmxklPj6beyaHv-UQ.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">User generated image</figcaption></figure><h2 id="8cdf" class="qe ne fq bf nf qf qg qh ni qi qj qk nl oi ql qm qn om qo qp qq oq qr qs qt qu bk">Comparison of results</h2><p id="58ef" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">Let‚Äôs not get too carried away yet. Below we run a few more experiments exploring model types and pre-interventions periods:</p><pre class="mm mn mo mp mq qz ra rb bp rc bb bk"><span id="cfe3" class="rd ne fq ra b bg re rf l rg rh"># run regression experiments<br/>df_lin_reg_00, pred_lift_lin_reg_00 = train_reg(df, 0, LinearRegression())<br/>df_lin_reg_100, pred_lift_lin_reg_100 = train_reg(df, 100, LinearRegression())<br/>df_ridge_00, pred_lift_ridge_00 = train_reg(df, 0, RidgeCV())<br/>df_ridge_100, pred_lift_ridge_100 = train_reg(df, 100, RidgeCV())<br/>df_lasso_00, pred_lift_lasso_00 = train_reg(df, 0, LassoCV())<br/>df_lasso_100, pred_lift_lasso_100 = train_reg(df, 100, LassoCV())<br/><br/># run synthetic control experiments<br/>df_synth_00, pred_lift_synth_00 = train_synth(df, 0)<br/>df_synth_100, pred_lift_synth_100 = train_synth(df, 100)<br/><br/>experiment_data = {<br/>    "Method": ["Linear", "Linear", "Ridge", "Ridge", "Lasso", "Lasso", "Synthetic Control", "Synthetic Control"],<br/>    "Data Size": ["Large", "Small", "Large", "Small", "Large",  "Small", "Large", "Small"],<br/>    "Value": [pred_lift_lin_reg_00, pred_lift_lin_reg_100, pred_lift_ridge_00, pred_lift_ridge_100,pred_lift_lasso_00, pred_lift_lasso_100, pred_lift_synth_00, pred_lift_synth_100]<br/>}<br/><br/>df_experiments = pd.DataFrame(experiment_data)</span></pre><p id="1ce4" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">We will use the code below to visualise the results:</p><pre class="mm mn mo mp mq qz ra rb bp rc bb bk"><span id="f78c" class="rd ne fq ra b bg re rf l rg rh"># Set the style<br/>sns.set_style="whitegrid"<br/><br/># Create the bar plot<br/>plt.figure(figsize=(10, 6))<br/>bar_plot = sns.barplot(x="Method", y="Value", hue="Data Size", data=df_experiments, palette="muted")<br/><br/># Add labels and title<br/>plt.xlabel("Method")<br/>plt.ylabel("Absolute error percentage")<br/>plt.title("Synthetic Controls - Comparison of Methods Across Different Data Sizes")<br/>plt.legend(title="Data Size")<br/><br/># Show the plot<br/>plt.show()</span></pre><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk rl"><img src="../Images/36d5fbbe62a6070db05e30c377ffbfe3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r298bHi6BusIITt-y557Mw.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">User generated image</figcaption></figure><p id="f7ed" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">The results for the small dataset are really interesting! As expected, regularisation helped improve the causal impact estimates. The synthetic control then took it one step further!</p><p id="22e3" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">The results of the large dataset suggest that longer pre-intervention periods aren‚Äôt always better.</p><p id="fc26" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">However, the thing I want you to take away is how valuable carrying out a pre-intervention simulation is. There are so many avenues you could explore with your own dataset!</p><h1 id="eee5" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Closing thoughts</h1><p id="feb8" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">Today we explored the synthetic control method and how you can validate the causal impact. I‚Äôll leave you with a few final thoughts:</p><ul class=""><li id="fb98" class="nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou pv pw px bk">The simplicity of the synthetic control method make it one of the most widely used technique from the causal AI toolbox.</li><li id="33cc" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk">Unfortunately it is also the most widely abused ‚Äî Lets run the R CausalImpact package, changing the pre-intervention period until we see an uplift we like. üò≠</li><li id="1990" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk">This is where I highly recommend running pre-intervention simulations to agree test design upfront.</li><li id="938b" class="nz oa fq ob b go py od oe gr pz og oh oi qa ok ol om qb oo op oq qc os ot ou pv pw px bk">Synthetic control method is a heavily researched area. It‚Äôs worth checking out the proposed adaptions Augmented SC, Robust SC and Penalized SC.</li></ul><h1 id="b37b" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Resources</h1><p id="759f" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk"><em class="pa">Alberto Abadie, Alexis Diamond &amp; Jens Hainmueller (2010) Synthetic Control Methods for Comparative Case Studies: Estimating the Effect of California‚Äôs Tobacco Control Program, Journal of the American Statistical Association, 105:490, 493‚Äì505, DOI: 10.1198/jasa.2009.ap08746</em></p></div></div></div><div class="ab cb rm rn ro rp" role="separator"><span class="rq by bm rr rs rt"/><span class="rq by bm rr rs rt"/><span class="rq by bm rr rs"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="cda6" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Follow me if you want to continue this journey into Causal AI ‚Äî In the next article we will look at enhancing marketing mix modelling with Causal AI.</p></div></div></div></div>    
</body>
</html>