<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>How to Create an LLM-Powered app to Convert Text to Presentation Slides: GenSlide — A Step-by-step Guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>How to Create an LLM-Powered app to Convert Text to Presentation Slides: GenSlide — A Step-by-step Guide</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-llms-to-create-presentation-slides-genslide-a-step-by-step-guide-31f7588ffb5e?source=collection_archive---------1-----------------------#2024-07-29">https://towardsdatascience.com/how-to-use-llms-to-create-presentation-slides-genslide-a-step-by-step-guide-31f7588ffb5e?source=collection_archive---------1-----------------------#2024-07-29</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="gr gs gt gu gv ab"><div><div class="ab gw"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@mehdi.mka?source=post_page---byline--31f7588ffb5e--------------------------------" rel="noopener follow"><div class="l gx gy by gz ha"><div class="l ed"><img alt="Mehdi Mohammadi" class="l ep by dd de cx" src="../Images/4fba46a01526ee9a58f35d6162becdd3.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*kDLAU5iOJdz2QHgmux2shQ.jpeg"/><div class="hb by l dd de em n hc eo"/></div></div></a></div></div><div class="hd ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--31f7588ffb5e--------------------------------" rel="noopener follow"><div class="l he hf by gz hg"><div class="l ed"><img alt="Towards Data Science" class="l ep by br hh cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hb by l br hh em n hc eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hi ab q"><div class="ab q hj"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hk hl bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hm" data-testid="authorName" href="https://medium.com/@mehdi.mka?source=post_page---byline--31f7588ffb5e--------------------------------" rel="noopener follow">Mehdi Mohammadi</a></p></div></div></div><span class="hn ho" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hk hl dx"><button class="hp hq ah ai aj ak al am an ao ap aq ar hr hs ht" disabled="">Follow</button></p></div></div></span></div></div><div class="l hu"><span class="bf b bg z dx"><div class="ab cn hv hw hx"><div class="hy hz ab"><div class="bf b bg z dx ab ia"><span class="ib l hu">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hm ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--31f7588ffb5e--------------------------------" rel="noopener follow"><p class="bf b bg z ic id ie if ig ih ii ij bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hn ho" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">8 min read</span><div class="ik il l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Jul 29, 2024</span></div></span></div></span></div></div></div><div class="ab cp im in io ip iq ir is it iu iv iw ix iy iz ja jb"><div class="h k w ea eb q"><div class="jr l"><div class="ab q js jt"><div class="pw-multi-vote-icon ed ib ju jv jw"><div class=""><div class="jx jy jz ka kb kc kd am ke kf kg jw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kh ki kj kk kl km kn"><p class="bf b dy z dx"><span class="jy">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao jx kq kr ab q ee ks kt" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="kp"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count ko kp">2</span></p></button></div></div></div><div class="ab q jc jd je jf jg jh ji jj jk jl jm jn jo jp jq"><div class="ku k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al kv an ao ap hr kw kx ky" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep kz cn"><div class="l ae"><div class="ab cb"><div class="la lb lc ld le lf ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al kv an ao ap hr lg lh kt li lj lk ll lm s ln lo lp lq lr ls lt u lu lv lw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al kv an ao ap hr lg lh kt li lj lk ll lm s ln lo lp lq lr ls lt u lu lv lw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al kv an ao ap hr lg lh kt li lj lk ll lm s ln lo lp lq lr ls lt u lu lv lw"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="ma mb mc md me mf lx ly paragraph-image"><div role="button" tabindex="0" class="mg mh ed mi bh mj"><div class="lx ly lz"><img src="../Images/836f3d41c515d3dd6e133fd5c8e8d41a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1hdyyzWWlz6craO9MUNRLg.jpeg"/></div></div><figcaption class="ml mm mn lx ly mo mp bf b bg z dx">Photo by <a class="af mq" href="https://unsplash.com/@mitchel3uo?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Mitchell Luo</a> on <a class="af mq" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="9c60" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">In this post, I am going to share how you can create a simple yet powerful application that uses LLMs to convert your written content into concise PowerPoint slides. The good part: You even run your own LLM service, so</p><ul class=""><li id="d2b4" class="mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr bk">you keep your data private, and</li><li id="0d33" class="mr ms fq mt b mu ns mw mx my nt na nb nc nu ne nf ng nv ni nj nk nw nm nn no np nq nr bk">no cost to call LLM APIs.</li></ul><h1 id="7c4e" class="nx ny fq bf nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou bk">Getting Started</h1><p id="a864" class="pw-post-body-paragraph mr ms fq mt b mu ov mw mx my ow na nb nc ox ne nf ng oy ni nj nk oz nm nn no fj bk">Reaching the power of GenSlide is straightforward. Follow these steps to set up and run this tool on your machine.</p><h1 id="e527" class="nx ny fq bf nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou bk">Step 1: Create project folder</h1><p id="3b88" class="pw-post-body-paragraph mr ms fq mt b mu ov mw mx my ow na nb nc ox ne nf ng oy ni nj nk oz nm nn no fj bk">Begin by creating the project folder in your local machine:</p><pre class="pa pb pc pd pe pf pg ph bp pi bb bk"><span id="33be" class="pj ny fq pg b bg pk pl l pm pn">mkdir GenSlide</span></pre><p id="0ef8" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">After completing all the steps, the final file structure would look like this:</p><pre class="pa pb pc pd pe pf pg ph bp pi bb bk"><span id="4f29" class="pj ny fq pg b bg pk pl l pm pn">GenSlide<br/>├── frontend<br/>│   ├── llm_call.py<br/>│   ├── slide_deck.py<br/>│   ├── slide_gen.py<br/>│   └── ui.py<br/>├── llm-service<br/>│   ├── consts.py<br/>│   └── gpt.py<br/>└── requirements.txt</span></pre><p id="60da" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">The first file we create contains packages list. Create a file named <code class="cx po pp pq pg b">requirements.txt</code>. Add the following package dependencies to the file.</p><pre class="pa pb pc pd pe pf pg ph bp pi bb bk"><span id="66da" class="pj ny fq pg b bg pk pl l pm pn">pillow==10.3.0<br/>lxml==5.2.2<br/>XlsxWriter==3.2.0<br/>python-pptx==0.6.23<br/>gpt4all==2.7.0<br/>Flask==2.2.5<br/>Flask-Cors==4.0.0<br/>streamlit==1.34.0</span></pre><p id="c3c4" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">Specifically, we’re leveraging the <code class="cx po pp pq pg b">gpt4all</code> package to run a large language model (LLM) server on a local machine. To dive deeper into <code class="cx po pp pq pg b">gpt4all</code>, refer to their <a class="af mq" href="https://docs.gpt4all.io/" rel="noopener ugc nofollow" target="_blank"><strong class="mt fr">official documentation</strong></a>.</p><p id="60e9" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">We also use <code class="cx po pp pq pg b"><a class="af mq" href="https://streamlit.io/" rel="noopener ugc nofollow" target="_blank">streamlit</a></code> package to create the user interface.</p><h1 id="7bad" class="nx ny fq bf nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou bk">Step 2: Setting Up the Environment</h1><p id="94b7" class="pw-post-body-paragraph mr ms fq mt b mu ov mw mx my ow na nb nc ox ne nf ng oy ni nj nk oz nm nn no fj bk">Next, create a virtual environment and install the necessary packages:</p><pre class="pa pb pc pd pe pf pg ph bp pi bb bk"><span id="d2ae" class="pj ny fq pg b bg pk pl l pm pn">python -m venv ./venv<br/>source ./venv/bin/activate<br/>pip install -r requirements.txt</span></pre><p id="41d7" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk"><em class="pr">Note:</em> Ensure that you are using a Python version other than <code class="cx po pp pq pg b">3.9.7</code>, as <code class="cx po pp pq pg b">streamlit</code> is incompatible with that version. For this tutorial I used Python version <code class="cx po pp pq pg b">3.12</code>.</p><h1 id="4e11" class="nx ny fq bf nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou bk">Step 3: Implement LLM Service</h1><p id="3330" class="pw-post-body-paragraph mr ms fq mt b mu ov mw mx my ow na nb nc ox ne nf ng oy ni nj nk oz nm nn no fj bk">Our LLM service should be able to receive a text as input and generate a summary of the key points of the text as output. It should organize the output in a list of JSON objects. We’ll specify these details in the prompt definition. Let’s first create a folder for LLM service.</p><pre class="pa pb pc pd pe pf pg ph bp pi bb bk"><span id="36e7" class="pj ny fq pg b bg pk pl l pm pn">mkdir llm-service</span></pre><p id="dff6" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">We arrange the implementation into two <strong class="mt fr">.py</strong> files in this folder.</p><ol class=""><li id="6bd3" class="mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no ps nq nr bk"><strong class="mt fr">consts.py</strong></li></ol><p id="4344" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">Here we need to define the name of LLM model we want to use. You can see the list of models that can be used here: <a class="af mq" href="https://docs.gpt4all.io/gpt4all_python/home.html#load-llm" rel="noopener ugc nofollow" target="_blank">https://docs.gpt4all.io/gpt4all_python/home.html#load-llm</a>. Meta’s Llama model performs good for this task.</p><pre class="pa pb pc pd pe pf pg ph bp pi bb bk"><span id="072a" class="pj ny fq pg b bg pk pl l pm pn">LLM_MODEL_NAME = "Meta-Llama-3-8B-Instruct.Q4_0.gguf"</span></pre><p id="5814" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">We also define the prompt message here that includes the instructions to the LLM as well as some examples of the desired output. We ask the output to be in JSON format, so it would be easier for us to process and create a presentation.</p><pre class="pa pb pc pd pe pf pg ph bp pi bb bk"><span id="6aa8" class="pj ny fq pg b bg pk pl l pm pn">PROMPT = """<br/>Summarize the input text and arrange it in an array of JSON objects to to be suitable for a powerpoint presentation. <br/>                    Determine the needed number of json objects (slides) based on the length of the text. <br/>                    Each key point in a slide should be limited to up to 10 words. <br/>                    Consider maximum of 5 bullet points per slide. <br/>                    Return the response as an array of json objects. <br/>                    The first item in the list must be a json object for the title slide. <br/>                    This is a sample of such json object:<br/>{<br/>"id": 1,<br/>"title_text": "My Presentation Title",<br/>"subtitle_text": "My presentation subtitle",<br/>"is_title_slide": "yes"<br/>}<br/> And here is the sample of json data for slides:<br/>{"id": 2, title_text": "Slide 1 Title", "text": ["Bullet 1", "Bullet 2"]},<br/>{"id": 3, title_text": "Slide 2 Title", "text": ["Bullet 1", "Bullet 2", "Bullet 3"]}<br/><br/>Please make sure the json object is correct and valid. <br/>Don't output explanation. I just need the JSON array as your output.<br/>"""</span></pre><p id="22ee" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">2. <strong class="mt fr">gpt.py</strong></p><p id="e17f" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">Here we want to create a Flask application that receives HTTP POST requests from the clients and call the LLM model to extract the summary in a JSON representation.</p><p id="4ae7" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">First things first; import dependencies.</p><pre class="pa pb pc pd pe pf pg ph bp pi bb bk"><span id="7f68" class="pj ny fq pg b bg pk pl l pm pn">from flask import Flask, request<br/>from flask_cors import CORS<br/>import traceback<br/>import logging<br/>import os<br/>from consts import LLM_MODEL_NAME, PROMPT<br/><br/>from gpt4all import GPT4All</span></pre><p id="1d40" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">Define the host IP, port, Flask app and allow Cross-Origin Resource Sharing.</p><pre class="pa pb pc pd pe pf pg ph bp pi bb bk"><span id="5f30" class="pj ny fq pg b bg pk pl l pm pn">logger = logging.getLogger()<br/><br/>HOST = '0.0.0.0'<br/>PORT = 8081<br/><br/>app = Flask(__name__)<br/>CORS(app)</span></pre><p id="090a" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">Define a base folder to store the LLM model. Here with <em class="pr">“MODEL_PATH”</em> environment variable we overwrite the default location of models set by gpt4all. Now the models will be stored in the project folder under <em class="pr">“gpt_models/gpt4all/”</em>. When GPT4All class is instantiated for the first time, it will look for the <em class="pr">model_name</em> in the <em class="pr">model_path</em> (it’s argument), if not found, will look into <em class="pr">MODEL_PATH</em>. If not found, it will start to download the model.</p><pre class="pa pb pc pd pe pf pg ph bp pi bb bk"><span id="682f" class="pj ny fq pg b bg pk pl l pm pn">try:<br/>    base_folder = os.path.dirname(__file__)<br/>    base_folder = os.path.dirname(base_folder)<br/>    gpt_models_folder = os.path.join(base_folder, "gpt_models/gpt4all/")<br/>    if not os.path.exists(gpt_models_folder):<br/>        os.makedirs(gpt_models_folder, exist_ok=True)<br/>    model_folder = os.environ.get("MODEL_PATH", gpt_models_folder)<br/>    llm_model = GPT4All(model_name=LLM_MODEL_NAME, model_path=model_folder)<br/>except Exception:<br/>    raise ValueError("Error loading LLM model.")</span></pre><p id="4dc2" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">Define a function to call the <em class="pr">generate()</em> function of the LLM model and return the response. We may set optional parameters such as <em class="pr">temperature</em> and <em class="pr">max_tokens</em>.</p><pre class="pa pb pc pd pe pf pg ph bp pi bb bk"><span id="a699" class="pj ny fq pg b bg pk pl l pm pn">def generate_text(content):<br/>    prompt = PROMPT + f"\n{content}"<br/><br/>    with llm_model.chat_session():<br/>        output = llm_model.generate(prompt, temp=0.7, max_tokens=1024)<br/>        output = output.strip()<br/><br/>        return output</span></pre><p id="193c" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">Define a POST API to receive clients’ requests. Requests come in the form of JSON objects <em class="pr">{“content”:”…”}</em>. We will use this <em class="pr">“content”</em> value and call the <em class="pr">generate_text()</em> method defined above. If everything goes well, we send the output along with an 200 HTTP (OK) status code. Otherwise an “Error” message and status code 500 is returned.</p><pre class="pa pb pc pd pe pf pg ph bp pi bb bk"><span id="765d" class="pj ny fq pg b bg pk pl l pm pn">@app.route('/api/completion', methods=['POST'])<br/>def completion():<br/>    try:<br/>        req = request.get_json()<br/>        words = req.get('content')<br/>        if not words:<br/>            raise ValueError("No input word.")<br/>        output = generate_text(words)<br/>        return output, 200<br/>    except Exception:<br/>        logger.error(traceback.format_exc())<br/>        return "Error", 500</span></pre><p id="dd0a" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">Run the Flask app.</p><pre class="pa pb pc pd pe pf pg ph bp pi bb bk"><span id="47cb" class="pj ny fq pg b bg pk pl l pm pn">if __name__ == '__main__':<br/>    # run web server<br/>    app.run(host=HOST,<br/>            debug=True,  # automatic reloading enabled<br/>            port=PORT)</span></pre><h1 id="9e4c" class="nx ny fq bf nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou bk">Step 4: Implement front end</h1><p id="1048" class="pw-post-body-paragraph mr ms fq mt b mu ov mw mx my ow na nb nc ox ne nf ng oy ni nj nk oz nm nn no fj bk">Frontend is where we get the user’s input and interact with the LLM service and finally create the PowerPoint slides.</p><p id="76ef" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">Inside the project folder, create a folder named frontend.</p><pre class="pa pb pc pd pe pf pg ph bp pi bb bk"><span id="1d53" class="pj ny fq pg b bg pk pl l pm pn">mkdir frontend</span></pre><p id="d8ef" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">The implementation falls into 4 Python files.</p><ol class=""><li id="41a0" class="mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no ps nq nr bk"><strong class="mt fr">llm_call.py</strong></li></ol><p id="10e5" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">This would be where we send the POST requests to the LLM server. We set our LLM server on <em class="pr">localhost</em> port <em class="pr">8081</em>. We enclose the input text into a JSON object with the key <em class="pr">“content”</em>. The output of the call should be a JSON string.</p><pre class="pa pb pc pd pe pf pg ph bp pi bb bk"><span id="e864" class="pj ny fq pg b bg pk pl l pm pn">import requests<br/><br/>URL = "http://127.0.0.1:8081"<br/><br/>CHAT_API_ENDPOINT = f"{URL}/api/completion"<br/><br/>def chat_completion_request(content):<br/>    headers = {'Content-type': 'application/json'}<br/>    data = {'content': content}<br/><br/>    req = requests.post(url=CHAT_API_ENDPOINT, headers=headers, json=data)<br/>    json_extracted = req.text<br/>    return json_extracted</span></pre><p id="8910" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">2. <strong class="mt fr">slide_deck.py</strong></p><p id="fe43" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">Here we use <code class="cx po pp pq pg b">pptx</code> package to create PowerPoint slides. The list of JSON objects contains the information to add slides to the presentation. For detailed information about <code class="cx po pp pq pg b">pptx</code> package refer to their <a class="af mq" href="https://python-pptx.readthedocs.io/en/latest/" rel="noopener ugc nofollow" target="_blank">documentation</a>.</p><pre class="pa pb pc pd pe pf pg ph bp pi bb bk"><span id="3e47" class="pj ny fq pg b bg pk pl l pm pn">import os<br/><br/>from pptx import Presentation<br/>from pptx.util import Inches<br/><br/>class SlideDeck:<br/><br/>    def __init__(self, output_folder="generated"):<br/>        self.prs = Presentation()<br/>        self.output_folder = output_folder<br/><br/>    def add_slide(self, slide_data):<br/>        prs = self.prs<br/>        bullet_slide_layout = prs.slide_layouts[1]<br/>        slide = prs.slides.add_slide(bullet_slide_layout)<br/>        shapes = slide.shapes<br/><br/>        # Title<br/>        title_shape = shapes.title<br/>        title_shape.text = slide_data.get("title_text", "")<br/><br/>        # Body<br/>        if "text" in slide_data:<br/>            body_shape = shapes.placeholders[1]<br/>            tf = body_shape.text_frame<br/>            for bullet in slide_data.get("text", []):<br/>                p = tf.add_paragraph()<br/>                p.text = bullet<br/>                p.level = 0<br/><br/>                if "p1" in slide_data:<br/>                    p = tf.add_paragraph()<br/>                    p.text = slide_data.get("p1")<br/>                    p.level = 1<br/><br/>        if "img_path" in slide_data:<br/>            cur_left = 6<br/>            for img_path in slide_data.get("img_path", []):<br/>                top = Inches(2)<br/>                left = Inches(cur_left)<br/>                height = Inches(4)<br/>                pic = slide.shapes.add_picture(img_path, left, top, height=height)<br/>                cur_left += 1<br/><br/>    def add_title_slide(self, title_page_data):<br/>        # title slide<br/>        prs = self.prs<br/>        title_slide_layout = prs.slide_layouts[0]<br/>        slide = prs.slides.add_slide(title_slide_layout)<br/>        title = slide.shapes.title<br/>        subtitle = slide.placeholders[1]<br/>        if "title_text" in title_page_data:<br/>            title.text = title_page_data.get("title_text")<br/>        if "subtitle_text" in title_page_data:<br/>            subtitle.text = title_page_data.get("subtitle_text")<br/><br/>    def create_presentation(self, title_slide_info, slide_pages_data=[]):<br/>        try:<br/>            file_name = title_slide_info.get("title_text").\<br/>                lower().replace(",", "").replace(" ", "-")<br/>            file_name += ".pptx"<br/>            file_name = os.path.join(self.output_folder, file_name)<br/>            self.add_title_slide(title_slide_info)<br/>            for slide_data in slide_pages_data:<br/>                self.add_slide(slide_data)<br/><br/>            self.prs.save(file_name)<br/>            return file_name<br/>        except Exception as e:<br/>            raise e</span></pre><p id="a54b" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">3. <strong class="mt fr">slide_gen.py</strong></p><p id="0fdb" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">Let’s break it into smaller snippets.</p><p id="ab18" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">Here, after importing necessary packages, create a folder to store the generated <em class="pr">.pptx</em> files.</p><pre class="pa pb pc pd pe pf pg ph bp pi bb bk"><span id="41f5" class="pj ny fq pg b bg pk pl l pm pn">import json<br/>import os<br/><br/>from slide_deck import SlideDeck<br/>from llm_call import chat_completion_request<br/><br/>FOLDER = "generated"<br/><br/>if not os.path.exists(FOLDER):<br/>    os.makedirs(FOLDER)</span></pre><p id="7a51" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">Then define these two methods:</p><ul class=""><li id="9d5e" class="mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no np nq nr bk">A method to invoke <code class="cx po pp pq pg b">chat_completion_request</code> and send the request to the LLM and parse the JSON string,</li><li id="cebe" class="mr ms fq mt b mu ns mw mx my nt na nb nc nu ne nf ng nv ni nj nk nw nm nn no np nq nr bk">A method that gets the output of previous method and instantiate a <code class="cx po pp pq pg b">SlideDeck</code> to fill in the PowerPoint slides.</li></ul><pre class="pa pb pc pd pe pf pg ph bp pi bb bk"><span id="f144" class="pj ny fq pg b bg pk pl l pm pn">def generate_json_list_of_slides(content):<br/>    try:<br/>        resp = chat_completion_request(content)<br/>        obj = json.loads(resp)<br/>        return obj<br/>    except Exception as e:<br/>        raise e<br/><br/>def generate_presentation(content):<br/>    deck = SlideDeck()<br/>    slides_data = generate_json_list_of_slides(content)<br/>    title_slide_data = slides_data[0]<br/>    slides_data = slides_data[1:]<br/>    return deck.create_presentation(title_slide_data, slides_data)</span></pre><p id="2cf0" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">4.<strong class="mt fr"> ui.py</strong></p><p id="cae5" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">We create a simple UI with an input text box. User can type in or copy/paste their text there and hit enter to start the slide generation. Upon completion of slide generation, a message is printed at the end of input text box. <code class="cx po pp pq pg b">streamlit</code> is very handy here.</p><pre class="pa pb pc pd pe pf pg ph bp pi bb bk"><span id="a429" class="pj ny fq pg b bg pk pl l pm pn">import traceback<br/>import streamlit as st<br/><br/>from slide_gen import generate_presentation<br/><br/>def create_ui():<br/>    st.write("""<br/># Gen Slides<br/>### Generating powerpoint slides for your text<br/>""")<br/><br/>    content = st.text_area(label="Enter your text:", height=400)<br/>    try:<br/>        if content:<br/>            filename = generate_presentation(content)<br/>            st.write(f"file {filename} is generated.")<br/>    except Exception:<br/>        st.write("Error in generating slides.")<br/>        st.write(traceback.format_exc())<br/><br/>if __name__ == "__main__":<br/>    create_ui()</span></pre><h1 id="7923" class="nx ny fq bf nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou bk">Step 5: Running the LLM Service</h1><p id="db60" class="pw-post-body-paragraph mr ms fq mt b mu ov mw mx my ow na nb nc ox ne nf ng oy ni nj nk oz nm nn no fj bk">Navigate to the <code class="cx po pp pq pg b">llm-service</code> folder and run the <code class="cx po pp pq pg b">gpt.py</code> file:</p><pre class="pa pb pc pd pe pf pg ph bp pi bb bk"><span id="443c" class="pj ny fq pg b bg pk pl l pm pn">cd llm-service<br/>python gpt.py</span></pre><p id="fd84" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk"><em class="pr">Note:</em> The first time you run this, the LLM model will be downloaded, which may take several minutes to complete.</p><h1 id="7219" class="nx ny fq bf nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou bk">Step 6: Launching the User Interface (UI)</h1><p id="8176" class="pw-post-body-paragraph mr ms fq mt b mu ov mw mx my ow na nb nc ox ne nf ng oy ni nj nk oz nm nn no fj bk">Now, it’s time to bring up the UI. Navigate to the <code class="cx po pp pq pg b">frontend</code> folder and run the <code class="cx po pp pq pg b">ui.py</code> file using Streamlit:</p><pre class="pa pb pc pd pe pf pg ph bp pi bb bk"><span id="cfca" class="pj ny fq pg b bg pk pl l pm pn">cd ..<br/>cd frontend<br/>streamlit run ui.py</span></pre><p id="640e" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">This command will launch the UI in your default web browser.</p><h1 id="fb2b" class="nx ny fq bf nz oa ob oc od oe of og oh oi oj ok ol om on oo op oq or os ot ou bk">Creating Your PowerPoint Presentation</h1><p id="076e" class="pw-post-body-paragraph mr ms fq mt b mu ov mw mx my ow na nb nc ox ne nf ng oy ni nj nk oz nm nn no fj bk">With the UI up and running, follow these simple steps to generate your presentation:</p><p id="9665" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk"><strong class="mt fr">1. Input Text:</strong> In the provided text box, input the content you’d like to transform into a presentation. Here is the sample you may use:</p><pre class="pa pb pc pd pe pf pg ph bp pi bb bk"><span id="4e95" class="pj ny fq pg b bg pk pl l pm pn">Artificial Intelligence is an idea that has been captivating society since the mid-20th century.<br/>It began with science fiction familiarizing the world with the concept but the idea wasn't fully seen in the scientific manner until Alan Turing, a polymath, was curious about the feasibility of the concept.<br/>Turing's groundbreaking 1950 paper, "Computing Machinery and Intelligence," posed fundamental questions about machine reasoning similar to human intelligence, significantly contributing to the conceptual groundwork of AI.<br/>The development of AI was not very rapid at first because of the high costs and the fact that computers were not able to store commands.<br/>This changed during the 1956 Dartmouth Summer Research Project on AI where there was an inspiring call for AI research, setting the precedent for two decades of rapid advancements in the field.</span></pre><p id="2833" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk"><strong class="mt fr">2. Generate Slides:</strong> Once you enter the text (followed by Command ⌘ + Enter keys in Mac), GenSlide will process it and create the presentation <code class="cx po pp pq pg b">.pptx</code>file.</p><p id="60af" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk"><strong class="mt fr">3. Access Your Slides:</strong> The newly created PowerPoint file will be saved in the<code class="cx po pp pq pg b">frontend/generated</code>folder.</p><figure class="pa pb pc pd pe mf lx ly paragraph-image"><div role="button" tabindex="0" class="mg mh ed mi bh mj"><div class="lx ly pt"><img src="../Images/8127336761624ea0134f3a49a73d7af9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RtWs8dcGQA_aBK6O3XoPuw.png"/></div></div><figcaption class="ml mm mn lx ly mo mp bf b bg z dx">User Interface to enter the text</figcaption></figure><figure class="pa pb pc pd pe mf lx ly paragraph-image"><div role="button" tabindex="0" class="mg mh ed mi bh mj"><div class="lx ly pu"><img src="../Images/9c3f1660e47c791da5305a77dc0ad38f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ywn8AdQOAAENdfi2CzrExQ.png"/></div></div><figcaption class="ml mm mn lx ly mo mp bf b bg z dx">Generated PowerPoint slides</figcaption></figure></div></div></div><div class="ab cb pv pw px py" role="separator"><span class="pz by bm qa qb qc"/><span class="pz by bm qa qb qc"/><span class="pz by bm qa qb"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="8339" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">Congratulations! The ability to automate slide generation is not just a technical achievement; it’s a time-saving marvel for professionals and students alike. For the next steps, the application can be extended to read the text from other formats like PDF files, MS Word documents, web pages and more. I would be happy to hear how you use or extend this project.</p><p id="8db2" class="pw-post-body-paragraph mr ms fq mt b mu mv mw mx my mz na nb nc nd ne nf ng nh ni nj nk nl nm nn no fj bk">For further enhancement and contributions, feel free to explore the repository on <a class="af mq" href="https://github.com/mehdimo/GenSlide" rel="noopener ugc nofollow" target="_blank">GitHub</a>. You can checkout the tutorial video as well.</p><figure class="pa pb pc pd pe mf"><div class="qd ic l ed"><div class="qe qf l"/></div></figure></div></div></div></div>    
</body>
</html>