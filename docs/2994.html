<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>CV VideoPlayer — Once and For All</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>CV VideoPlayer — Once and For All</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/cv-videoplayer-once-and-for-all-b7e1b3349975?source=collection_archive---------6-----------------------#2024-12-12">https://towardsdatascience.com/cv-videoplayer-once-and-for-all-b7e1b3349975?source=collection_archive---------6-----------------------#2024-12-12</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="18b6" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">A Python video player package made for computer vision research</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@daniel_92063?source=post_page---byline--b7e1b3349975--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Daniel Tomer" class="l ep by dd de cx" src="../Images/872d23ccef8f51ab54d69c99cb654955.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/0*VfVZBIqqdOhEq8FI.jpg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--b7e1b3349975--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://medium.com/@daniel_92063?source=post_page---byline--b7e1b3349975--------------------------------" rel="noopener follow">Daniel Tomer</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--b7e1b3349975--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">6 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Dec 12, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj lc ld ab q ee le lf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count la lb">3</span></p></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lg k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lh an ao ap id li lj lk" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep ll cn"><div class="l ae"><div class="ab cb"><div class="lm ln lo lp lq lr ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk ml"><img src="../Images/fe525d3da0b40b616d63db54a0c0a9fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r56kik4YLAL6ORO9qwH69g.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by author</figcaption></figure><p id="450f" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">When developing computer vision algorithms, the journey from concept to working implementation often involves countless iterations of watching, analyzing, and debugging video frames. As I dove deeper into computer vision projects, I found myself repeatedly writing the same boilerplate code for video visualization and debugging.</p><p id="556c" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">At some point, I decided enough was enough, so I created <a class="af ny" href="https://pypi.org/project/cvvideoplayer/" rel="noopener ugc nofollow" target="_blank"><strong class="ne fr">CV VideoPlayer</strong></a>, a Python-based open-source video player package, specifically designed for computer vision practitioners that will solve this problem once and for all.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk nz"><img src="../Images/fb722b9a39bac8d52043f3f1eedd1ce4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Eh0M1NtSedx8xnsJmpbRtQ.gif"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">CV video player “Double frame mode” with added visualizations and keyboard shortcuts. Image by author</figcaption></figure><h1 id="063b" class="oa ob fq bf oc od oe gq of og oh gt oi oj ok ol om on oo op oq or os ot ou ov bk">Debugging video-related algorithms is hard</h1><p id="a3bd" class="pw-post-body-paragraph nc nd fq ne b go ow ng nh gr ox nj nk nl oy nn no np oz nr ns nt pa nv nw nx fj bk">If you’ve ever developed an algorithm for video analysis, you’ve probably written some version of the following code to help you visualize and debug it:</p><pre class="mm mn mo mp mq pb pc pd bp pe bb bk"><span id="c747" class="pf ob fq pc b bg pg ph l pi pj">import cv2<br/><br/>cap = cv2.VideoCapture(&lt;video_path&gt;)<br/>ret = True<br/>while ret:<br/>  ret, frame = cap.read()<br/>  algo_output = some_video_analsys_algorithm(frame)<br/>  frame_to_display = visualizer(frame, algo_output)<br/>  cv2.imshow(frame_to_display)<br/>  cv2.waitKey()</span></pre><p id="327f" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">But in almost all projects I’ve worked on this code was rarely enough. As the project went on I found myself adding more and more functionality to help me understand what was going on.</p><p id="852f" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk"><strong class="ne fr">For example:</strong></p><ul class=""><li id="85a4" class="nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx pk pl pm bk">Navigation through the video back and forth frame by frame.</li><li id="ec66" class="nc nd fq ne b go pn ng nh gr po nj nk nl pp nn no np pq nr ns nt pr nv nw nx pk pl pm bk">The ability to record the output to a file.</li><li id="dfcc" class="nc nd fq ne b go pn ng nh gr po nj nk nl pp nn no np pq nr ns nt pr nv nw nx pk pl pm bk">Supporting sources other than a simple video file (frame folder, stream, remote storage, etc.)</li></ul><p id="18f0" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk"><strong class="ne fr">But the thing that annoyed me the most was the lack of interactivity</strong>. Using this kind of code, The visualization is created before rendering and cannot change once displayed. And, while this is okay for simple algorithms, for the more complex ones, there is just way too much information needed for each frame. And without the ability to decide, on the fly, what you want to display, you find yourself running the same video again and again, each time with different visualization parameters.</p><p id="9f6b" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">This process was tedious and exhausting.</p><h1 id="0415" class="oa ob fq bf oc od oe gq of og oh gt oi oj ok ol om on oo op oq or os ot ou ov bk">Enter CV VideoPlayer</h1><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk ps"><img src="../Images/321d31566897a63f73c1694372814775.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*CD84eaM8mpvEJMoa6ki50g.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by author</figcaption></figure><p id="7c94" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk"><a class="af ny" href="https://pypi.org/project/cvvideoplayer/" rel="noopener ugc nofollow" target="_blank">CV VideoPlayer</a> was born from the need for a simple customizable solution for interactively rendering videos and frames. It allows any number of overlays, sidebars, or any other frame edits, each of which can be easily switched on and off by the user during run time. let’s see an example of how this is done:</p><h2 id="1180" class="pt ob fq bf oc pu pv pw of px py pz oi nl qa qb qc np qd qe qf nt qg qh qi qj bk">Installation</h2><p id="8067" class="pw-post-body-paragraph nc nd fq ne b go ow ng nh gr ox nj nk nl oy nn no np oz nr ns nt pa nv nw nx fj bk">We start by installing the package using <code class="cx qk ql qm pc b">pip install cvvideoplayer</code></p><h2 id="5441" class="pt ob fq bf oc pu pv pw of px py pz oi nl qa qb qc np qd qe qf nt qg qh qi qj bk">Playing vanilla video</h2><p id="f44e" class="pw-post-body-paragraph nc nd fq ne b go ow ng nh gr ox nj nk nl oy nn no np oz nr ns nt pa nv nw nx fj bk">We can then import the video player and run an unedited video with the following code:</p><pre class="mm mn mo mp mq pb pc pd bp pe bb bk"><span id="67db" class="pf ob fq pc b bg pg ph l pi pj">from cvvideoplayer import create_video_player<br/><br/>VIDEO_OR_FRAME_FOLDER_PATH = "&lt;add local path here&gt;"<br/><br/>video_player = create_video_player(video_source=VIDEO_OR_FRAME_FOLDER_PATH)<br/>video_player.run()</span></pre><p id="faee" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">This will open the video player and allow you to play it with the spacebar or using the arrows, it will also add some default built-in <code class="cx qk ql qm pc b">frame-edit-callbacks</code> which we will elaborate on in the following section.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qn"><img src="../Images/0f99aa9cb9dbb81615f8607d90bafae6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*b6lh7LLf_8Kec6YloV5i4Q.gif"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Image by author</figcaption></figure><h1 id="4f34" class="oa ob fq bf oc od oe gq of og oh gt oi oj ok ol om on oo op oq or os ot ou ov bk">Editing the frames to add visualization</h1><p id="0b98" class="pw-post-body-paragraph nc nd fq ne b go ow ng nh gr ox nj nk nl oy nn no np oz nr ns nt pa nv nw nx fj bk">To add custom-built visualization to the video we can use the <code class="cx qk ql qm pc b">frame_edit_callbacks</code> argument of the <code class="cx qk ql qm pc b">create_video_player</code> constructor function like so:</p><pre class="mm mn mo mp mq pb pc pd bp pe bb bk"><span id="a10f" class="pf ob fq pc b bg pg ph l pi pj">from cvvideoplayer import VideoPlayer<br/><br/>VIDEO_OR_FRAME_FOLDER_PATH = "&lt;add local path here&gt;"<br/><br/>video_player = create_video_player(<br/>  video_source=VIDEO_OR_FRAME_FOLDER_PATH,<br/>  frame_edit_callbacks=[<br/>            FitFrameToScreen(),<br/>            FrameInfoOverlay(),<br/>            KeyMapOverlay(),<br/>        ]<br/>)<br/>video_player.run()</span></pre><p id="4f1c" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">When unspecified, the default list will be exactly the one in the example above.</p><h2 id="3e0d" class="pt ob fq bf oc pu pv pw of px py pz oi nl qa qb qc np qd qe qf nt qg qh qi qj bk">Built-in callbacks</h2><p id="5d7b" class="pw-post-body-paragraph nc nd fq ne b go ow ng nh gr ox nj nk nl oy nn no np oz nr ns nt pa nv nw nx fj bk">There are a bunch of built-in callbacks to use such as:</p><ul class=""><li id="f970" class="nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx pk pl pm bk"><code class="cx qk ql qm pc b">FitFrameToScreen</code> — Automatically resizes the frame to fit the screen size.</li><li id="ab43" class="nc nd fq ne b go pn ng nh gr po nj nk nl pp nn no np pq nr ns nt pr nv nw nx pk pl pm bk"><code class="cx qk ql qm pc b">FrameInfoOverlay</code> — Prints the frame number and original frame resolution on the top left corner.</li><li id="b45d" class="nc nd fq ne b go pn ng nh gr po nj nk nl pp nn no np pq nr ns nt pr nv nw nx pk pl pm bk"><code class="cx qk ql qm pc b">KeyMapOverlay</code> — Automatically detects and prints all available keyboard shortcuts (Also those added by the user).</li><li id="753b" class="nc nd fq ne b go pn ng nh gr po nj nk nl pp nn no np pq nr ns nt pr nv nw nx pk pl pm bk"><code class="cx qk ql qm pc b">DetectionCsvPlotter</code> — Plots Bounding boxes specified in a CSV with the following Header: frame_id, label, x1, y1, width, height, score</li><li id="0d53" class="nc nd fq ne b go pn ng nh gr po nj nk nl pp nn no np pq nr ns nt pr nv nw nx pk pl pm bk"><code class="cx qk ql qm pc b">FrameNormlizer</code> — Allows the user to adjust the dynamic range of the image.</li><li id="6d85" class="nc nd fq ne b go pn ng nh gr po nj nk nl pp nn no np pq nr ns nt pr nv nw nx pk pl pm bk"><code class="cx qk ql qm pc b">HistogramEqulizer</code> — self-explanatory</li></ul><p id="d99a" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">And more are added with each version.</p><h2 id="a150" class="pt ob fq bf oc pu pv pw of px py pz oi nl qa qb qc np qd qe qf nt qg qh qi qj bk">Creating a custom callback</h2><p id="6e36" class="pw-post-body-paragraph nc nd fq ne b go ow ng nh gr ox nj nk nl oy nn no np oz nr ns nt pa nv nw nx fj bk">Here is where the usefulness of the package shines. To add your own custom visualization you create a new class that inherits <code class="cx qk ql qm pc b">BaseFrameEditCallback</code> and implements the <code class="cx qk ql qm pc b">edit_frame</code> method, for example:</p><pre class="mm mn mo mp mq pb pc pd bp pe bb bk"><span id="227b" class="pf ob fq pc b bg pg ph l pi pj">class MyCallback(BaseFrameEditCallback):<br/>    def __init__(<br/>        self,<br/>        enable_by_default: bool = True,<br/>        enable_disable_key: Optional[str] = None,<br/>        additional_keyboard_shortcuts: Optional[List[KeyFunction]] = None<br/>        **any_other_needed_params<br/>    ):<br/>        super().__init__(<br/>            enable_by_default,<br/>            enable_disable_key,<br/>            additional_keyboard_shortcuts<br/>         )<br/><br/>    def edit_frame(<br/>        self,<br/>        video_player: "VideoPlayer",<br/>        frame: np.ndarray,<br/>        frame_num: int,<br/>        original_frame: np.ndarray,<br/>    ) -&gt; np.ndarray:<br/>        """<br/>        This function receives the displayed frame and should return it<br/>        after it has been altered in any way desirable by the user<br/><br/>        Args:<br/>            video_player: an instance fo VideoPlayer<br/>            frame (): the frame to be edited and displayed<br/>            frame_num ():<br/>            original_frame () the frame before any alterations<br/><br/>        Returns: the edited frame<br/>        """<br/>        frame = add_any_visalizations(frame)<br/>        return frame</span></pre><p id="73f7" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">Additionally, you can add setup and teardown methods by overriding these methods in the parent class:</p><pre class="mm mn mo mp mq pb pc pd bp pe bb bk"><span id="511d" class="pf ob fq pc b bg pg ph l pi pj">class MyCallback(BaseFrameEditCallback):<br/>    ... <br/>    def setup(self, video_player: "VideoPlayer", frame) -&gt; None:<br/>        """<br/>        Optionally configure more parameters according to the<br/>        first incoming frame<br/>        """<br/><br/>    def teardown(self) -&gt; None:<br/>        """<br/>        Optionally define how the callback should close when the<br/>        video player is closed<br/>        """</span></pre><h1 id="8f88" class="oa ob fq bf oc od oe gq of og oh gt oi oj ok ol om on oo op oq or os ot ou ov bk">Adding Custom keyboard shortcuts</h1><p id="e7b3" class="pw-post-body-paragraph nc nd fq ne b go ow ng nh gr ox nj nk nl oy nn no np oz nr ns nt pa nv nw nx fj bk">For each callback, CV Video Player allows you to add custom keyboard shortcuts that can change the visualization it does at run time.</p><p id="3d34" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">The most basic shortcut is enabling/disabling the callback and is created using the <code class="cx qk ql qm pc b">enable_disable_key</code> parameter like so:</p><pre class="mm mn mo mp mq pb pc pd bp pe bb bk"><span id="3b17" class="pf ob fq pc b bg pg ph l pi pj">my_callback = MyCallback(<br/>    enable_disable_key="ctrl+a"<br/>)</span></pre><p id="add3" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">The string passed here can be any combination of modifiers (ctrl, alt, and shift) with a letter or number for example: <strong class="ne fr">“crtl+alt+s”</strong>,<strong class="ne fr"> “g”</strong>, <strong class="ne fr">“shift+v”</strong>, <strong class="ne fr">“crtl+1”</strong> and so on.</p><p id="9479" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">To add shortcuts that change the visualization itself, you can override the<code class="cx qk ql qm pc b">additional_keyboard_shortcuts</code> property which returns a list of the dataclass<code class="cx qk ql qm pc b">KeyFunction</code> .</p><pre class="mm mn mo mp mq pb pc pd bp pe bb bk"><span id="81ad" class="pf ob fq pc b bg pg ph l pi pj">from cvvideoplayer import KeyFunction<br/><br/>class MyCallback(BaseFrameEditCallback):<br/>    ...<br/>    @property<br/>    def additional_keyboard_shortcuts(self) -&gt; List[KeyFunction]:<br/>      [<br/>          KeyFunction(<br/>              key="alt+r",<br/>              function=self.a_function_to_modify_the_visualiztion,<br/>              description="what this does"<br/>          )<br/>      ]</span></pre><p id="894c" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">A <code class="cx qk ql qm pc b">KeyFunction</code> is constructed using three arguments:</p><ul class=""><li id="57b2" class="nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx pk pl pm bk">The <code class="cx qk ql qm pc b">key</code> argument — Same as for <code class="cx qk ql qm pc b">enable_disable_key</code> , The string passed here can be any combination of modifiers (ctrl, alt, and shift) with a letter or number for example: <strong class="ne fr">“crtl+alt+s”</strong>,<strong class="ne fr"> “g”</strong>, <strong class="ne fr">“shift+v”</strong>, <strong class="ne fr">“crtl+1”</strong></li><li id="c693" class="nc nd fq ne b go pn ng nh gr po nj nk nl pp nn no np pq nr ns nt pr nv nw nx pk pl pm bk">The <code class="cx qk ql qm pc b">description</code> argument — This is used by the <code class="cx qk ql qm pc b">KeyMapOverlay</code> callback to print all the available shortcuts on the screen.</li><li id="a1a1" class="nc nd fq ne b go pn ng nh gr po nj nk nl pp nn no np pq nr ns nt pr nv nw nx pk pl pm bk">The <code class="cx qk ql qm pc b">function</code> argument — Has to be a function that accepts no arguments.</li></ul><p id="f407" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">In many cases, the KeyFunction will receive a function that toggles some boolean attribute of the callback, which will change something that the <code class="cx qk ql qm pc b">edit_frame</code>method does. So something like:</p><pre class="mm mn mo mp mq pb pc pd bp pe bb bk"><span id="715a" class="pf ob fq pc b bg pg ph l pi pj">from cvvideoplayer import KeyFunction<br/><br/>class MyCallback(BaseFrameEditCallback):<br/>...<br/>    @property<br/>    def additional_keyboard_shortcuts(self) -&gt; List[KeyFunction]:<br/>      [<br/>          KeyFunction(<br/>              key="alt+r",<br/>              function=self.a_function_to_modify_the_visualiztion,<br/>              description="what this does"<br/>          )<br/>      ]<br/>    def a_function_to_modify_the_visualiztion():<br/>        self._draw_something = bool(1 - self._draw_somthing)</span></pre><h1 id="902d" class="oa ob fq bf oc od oe gq of og oh gt oi oj ok ol om on oo op oq or os ot ou ov bk">Double Frame Mode</h1><p id="60e6" class="pw-post-body-paragraph nc nd fq ne b go ow ng nh gr ox nj nk nl oy nn no np oz nr ns nt pa nv nw nx fj bk">Many times, I found myself wanting to compare two different visualizations side by side. For example, comparing two detectors or an algorithm's output with the original frame without modifications, and so on.</p><p id="756d" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">To do that I added <code class="cx qk ql qm pc b">double_frame_mode</code> which can be turned on by:</p><pre class="mm mn mo mp mq pb pc pd bp pe bb bk"><span id="f786" class="pf ob fq pc b bg pg ph l pi pj">video_player = create_video_player(<br/>  ...<br/>  double_frame_mode=True<br/>)</span></pre><p id="ca70" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">The video at the beginning of this blog is an example of what this mode looks like.</p><p id="2185" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">In this mode, you can use “ctrl+1” and “ctrl+2" to decide which frame visualization you want to control with the keyboard.</p><p id="d2b8" class="pw-post-body-paragraph nc nd fq ne b go nf ng nh gr ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx fj bk">By default, both frames will have the same callbacks available but if you want different callbacks for the right frame you can use the <code class="cx qk ql qm pc b">right_frame_callback</code> argument to give the right frame a different set of callbacks (the left frame will have the ones passed to the <code class="cx qk ql qm pc b">frame_edit_callback</code> argument):</p><pre class="mm mn mo mp mq pb pc pd bp pe bb bk"><span id="10d1" class="pf ob fq pc b bg pg ph l pi pj">video_player = create_video_player(<br/>    ...<br/>    double_frame_mode=True<br/>    right_frame_callbacks = [callback1, callback2, ...]<br/>)</span></pre><h1 id="13a5" class="oa ob fq bf oc od oe gq of og oh gt oi oj ok ol om on oo op oq or os ot ou ov bk">To conclude</h1><p id="df2a" class="pw-post-body-paragraph nc nd fq ne b go ow ng nh gr ox nj nk nl oy nn no np oz nr ns nt pa nv nw nx fj bk">I Hope this tool comes in handy for all of you. If you have any ideas on how to improve it, please let me know in the issues tab on the project’s <a class="af ny" href="https://github.com/danieltomer1/CVVideoPlayer" rel="noopener ugc nofollow" target="_blank"><strong class="ne fr">GitHub page</strong></a>, and don’t forget to leave a star while you're at it :) …</p></div></div></div></div>    
</body>
</html>