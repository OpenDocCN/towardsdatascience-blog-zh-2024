- en: Calculating the Uncertainty Coefficient (Theil’s U) in Python
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/calculating-the-uncertainty-coefficient-thiels-u-in-python-fce72a02431b?source=collection_archive---------6-----------------------#2024-10-18](https://towardsdatascience.com/calculating-the-uncertainty-coefficient-thiels-u-in-python-fce72a02431b?source=collection_archive---------6-----------------------#2024-10-18)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![](../Images/04c7e4f655a5a8582663e539e22a9b4a.png)'
  prefs: []
  type: TYPE_IMG
- en: '**A measure of correlation between discrete (categorical) variables**'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@marclinder?source=post_page---byline--fce72a02431b--------------------------------)[![Marc
    Linder](../Images/3da574ad381525d372edc33359314aeb.png)](https://medium.com/@marclinder?source=post_page---byline--fce72a02431b--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--fce72a02431b--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--fce72a02431b--------------------------------)
    [Marc Linder](https://medium.com/@marclinder?source=post_page---byline--fce72a02431b--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--fce72a02431b--------------------------------)
    ·6 min read·Oct 18, 2024
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Theil’s U, also known as the uncertainty coefficient or entropy coefficient,
    quantifies the strength of association between two nominal variables. It assesses
    how much knowing the value of one variable reduces uncertainty about the other,
    providing a measure of association that ranges from 0 to 1\. A higher value indicates
    a stronger relationship, making Thiel’s U particularly useful in fields such as
    statistics and data science for exploring relationships within categorical data.
  prefs: []
  type: TYPE_NORMAL
- en: Theory
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Theil’s Uis a measure of nominal association based on the concept of information
    entropy. Suppose we have samples from two discrete random variables, X and Y.
  prefs: []
  type: TYPE_NORMAL
- en: 'Then the **entropy** of X is defined as:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/a463881597607b27f2ea05ce643aa028.png)'
  prefs: []
  type: TYPE_IMG
- en: Entropy of a single distribution X
  prefs: []
  type: TYPE_NORMAL
- en: 'And the **conditional entropy** of X given Y is defined as:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/5c0abd5d3ac3a97c71028eaa8da49c91.png)'
  prefs: []
  type: TYPE_IMG
- en: Conditional entropy of X given Y
  prefs: []
  type: TYPE_NORMAL
- en: 'We can then use the joint distribution (numerator) in combination with the
    marginal probabilities of X or Y to calculate the conditional distributions of
    X given Y (denominator) or Y given X, respectively, as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/207fe2a6272788408489805ef17fe7f9.png)'
  prefs: []
  type: TYPE_IMG
- en: Conditional distribution of x given y
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/53579c2995913f0471bf8794fff6c6bc.png)'
  prefs: []
  type: TYPE_IMG
- en: Conditional distribution of y given x
  prefs: []
  type: TYPE_NORMAL
- en: 'The result captures how the probability of one variable changes given the value
    of the other. We can calculate the probability of X given Y by using the joint
    probability of X and Y — that is, the probability of different combinations of
    X and Y — as well as the marginal probability of Y. We insert the result of their
    division into our formula for H(X) to obtain:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/74029c0a61945811f742ead740ab1c3d.png)'
  prefs: []
  type: TYPE_IMG
- en: Conditional entropy of X given Y
  prefs: []
  type: TYPE_NORMAL
- en: So much for the theory; here’s how we can calculate the conditional entropy
    of X given Y in Python.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'Once we have calculated the conditional entropy of X given Y, we can calculate
    Theil’s U. One last step is to calculate the entropy of X, which we defined at
    the beginning of this article. The uncertainty coefficient, or proficiency, is
    then calculated as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/e6aee30b9c16631e93a038b158183f0d.png)'
  prefs: []
  type: TYPE_IMG
- en: Theil’s U — Uncertainty coefficient or proficiency
  prefs: []
  type: TYPE_NORMAL
- en: 'Switching from theory to practice, this can be accomplished in Python using
    the following code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'Lastly we can then define a function that calculates the Theil’s values for
    every feature combination within a given dataset. We can do this in Python with
    the following code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: Code Example
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We will demonstrate the functionality of the code using the well-known **Iris
    dataset**. In addition to its numeric variables, the dataset contains a categorical
    variable, “species.” Traditional correlation measures, such as Pearson’s correlation,
    are limited in capturing relationships between categorical and numerical features.
    However, Thiel’s U can effectively measure the association between “species” and
    the other numerical features.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: The result is a heatmap of Thiel’s U for all variable pairs. Note that this
    measure has the advantage of being asymmetric, meaning the relationship between
    two variables can differ depending on the direction of analysis. For example,
    Thiel’s U can quantify how much information X provides about Y, which may not
    be the same as how much information Y provides about X.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/7b5e01021d8e96fa823b04594537fd82.png)'
  prefs: []
  type: TYPE_IMG
- en: Heatmap of Theil’s U values for all variable pairs
  prefs: []
  type: TYPE_NORMAL
- en: 'The interpretation of the results is relatively straightforward: Petal Length
    and Petal Width have the strongest associations with the categorical variable
    “species,” both with a value of 0.91\. This indicates that knowing the petal dimensions
    provides a high degree of information about the flower species. Sepal Length also
    has a moderate relationship with species at 0.55, meaning it offers some information
    about the species, though less than the petal measurements. Sepal Width has the
    weakest association with species at 0.33, indicating it provides relatively little
    information about the flower type. The relatively lower values between the sepal
    measurements and species highlight that petal dimensions are more informative
    for predicting species, which is consistent with the known characteristics of
    the Iris dataset.'
  prefs: []
  type: TYPE_NORMAL
- en: Conclusion
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In this article, we demonstrated how to calculate Theil’s U to assess associations
    between categorical and numerical variables. By applying this measure to the Iris
    dataset, we showed that petal dimensions provide significant insights into predicting
    flower species, highlighting the effectiveness of Theil’s U compared to traditional
    correlation methods.
  prefs: []
  type: TYPE_NORMAL
- en: '*Sources*'
  prefs: []
  type: TYPE_NORMAL
- en: 'Theil, H. (1958): *Economic Forecasts and Policy*. Amsterdam: North Holland.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Theil, H. (1966): *Applied Economic Forecasting*. Chicago: Rand McNally.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Bliemel, F. (1973): Theil’s Forecast Accuracy Coefficient: A Clarification,
    *Journal of Marketing Research* 10(4), pp. 444–446'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Note: Unless otherwise noted, all images are by the author.'
  prefs: []
  type: TYPE_NORMAL
