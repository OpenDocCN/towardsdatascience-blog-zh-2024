<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>How to use Zero-Shot Classification for Sentiment Analysis</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>How to use Zero-Shot Classification for Sentiment Analysis</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/how-to-use-zero-shot-classification-for-sentiment-analysis-abf7bd47ad25?source=collection_archive---------5-----------------------#2024-01-30">https://towardsdatascience.com/how-to-use-zero-shot-classification-for-sentiment-analysis-abf7bd47ad25?source=collection_archive---------5-----------------------#2024-01-30</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="955b" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">Exploring mental well-being insights with zero-shot classification</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@akaba_51202?source=post_page---byline--abf7bd47ad25--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Aminata Kaba" class="l ep by dd de cx" src="../Images/7c96699f24ce3d4c5346d6993db786e0.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*V-nl2VH64PyZBwHdRwWJ9w.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--abf7bd47ad25--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://medium.com/@akaba_51202?source=post_page---byline--abf7bd47ad25--------------------------------" rel="noopener follow">Aminata Kaba</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--abf7bd47ad25--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">9 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Jan 30, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj lc ld ab q ee le lf" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lb"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count la lb">6</span></p></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lg k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lh an ao ap id li lj lk" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep ll cn"><div class="l ae"><div class="ab cb"><div class="lm ln lo lp lq lr ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lh an ao ap id ls lt lf lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk ml"><img src="../Images/5c82732f630d9c80cd801aaa631045b0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yhTErpqf1eaLJgWC1cbACw.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx"><strong class="bf nc">Artwork by </strong><a class="af nd" href="https://medium.com/@create_self" rel="noopener"><strong class="bf nc">Vivian Peng</strong></a><strong class="bf nc"> — reposted with permission</strong></figcaption></figure><p id="19ee" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">Sentiment analysis is a powerful tool in natural language processing (NLP) for exploring public opinions and emotions in text. In the context of mental health, it can provide compelling insights into the holistic wellness of individuals. As a summer data science associate at The Rockefeller Foundation, I <a class="af nd" href="https://github.com/akaba09/redditmentalhealth" rel="noopener ugc nofollow" target="_blank">conducted a research project</a> using NLP techniques to explore Reddit discussions on depression before and after the COVID-19 pandemic. In order to better understand gender-related taboos around mental health and depression, I chose to analyze the distinctions between posts made by men and women.</p><p id="7675" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk"><strong class="ng fr">Different Types of Sentiment Analysis</strong></p><p id="f0b7" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">Traditionally, sentiment analysis classifies the overall emotions expressed in a piece of text into three categories: positive, negative, or neutral. But what if you were interested in exploring emotions at a more granular level — such as anticipation, fear, sadness, anger, etc.</p><p id="42e0" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">There are ways to do this using sentiment models that reference word libraries, like <a class="af nd" href="https://saifmohammad.com/WebPages/NRC-Emotion-Lexicon.htm" rel="noopener ugc nofollow" target="_blank">The NRC Emotion Lexicon</a>, which associates texts with eight basic emotions (anger, fear, anticipation, trust, surprise, sadness, joy, and disgust). However, the setup for this kind of analysis can be complicated, and the tradeoff may not be worth it.</p><p id="de9a" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">I found that zero-shot classification can easily be used to produce similar results. The term “zero-shot” comes from the concept that a model can classify data with zero prior exposure to the labels it is asked to classify. This eliminates the need for a training dataset, which is often time-consuming and resource-intensive to create. The model uses its general understanding of the relationships between words, phrases, and concepts to assign them into various categories.</p><p id="93cc" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">I was able to repurpose the use of zero-shot classification models for sentiment analysis by supplying emotions as labels to classify anticipation, anger, disgust, fear, joy, and trust.</p><p id="ca64" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">In this post, I’ll share how to quickly get started with sentiment analysis using zero-shot classification in 5 easy steps.</p><p id="decd" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">Platforms like HuggingFace simplify the implementation of these models. You can explore different models and test out the results to find which one to use by:</p><ol class=""><li id="71fb" class="ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz oa ob oc bk">Go to <a class="af nd" href="https://huggingface.co" rel="noopener ugc nofollow" target="_blank">https://huggingface.co</a></li><li id="74a3" class="ne nf fq ng b go od ni nj gr oe nl nm nn of np nq nr og nt nu nv oh nx ny nz oa ob oc bk">Click on the “Models” tab and select the type of NLP task you’re interested in</li><li id="53c1" class="ne nf fq ng b go od ni nj gr oe nl nm nn of np nq nr og nt nu nv oh nx ny nz oa ob oc bk">Choose one of the model cards, and this will lead you to the model interface</li><li id="7e02" class="ne nf fq ng b go od ni nj gr oe nl nm nn of np nq nr og nt nu nv oh nx ny nz oa ob oc bk">Pass in a string of text to see how the model performs</li></ol><p id="3ac4" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk"><strong class="ng fr">Here are a couple examples of how a sentiment analysis model performed compared to a zero-shot model.</strong></p><p id="60d5" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk"><strong class="ng fr">Sentiment Analysis</strong></p><p id="27c5" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">These models classify text into negative, neutral, and positive categories.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk oi"><img src="../Images/6cf49e13881fd3230c333d3adb3bfe26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*yRd_M_F7z4jKfM2n"/></div></div></figure><p id="cb76" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">You can see here that the nuance is quite limited and does not leave a lot of room for interpretation. Access to the model shown above can be found <a class="af nd" href="https://huggingface.co/cardiffnlp/twitter-roberta-base-sentiment-latest?text=I+dont+understand+what+going+on+with+me.+I%27ve+been+thinking+too+hard+lately." rel="noopener ugc nofollow" target="_blank">here</a> to test or run it.</p><p id="731a" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">These types of models are best used when you are looking to get a general pulse on the sentiment—whether the text is leaning positively or negatively.</p><p id="1fd9" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk"><strong class="ng fr">Zero-shot classification</strong></p><p id="e34f" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">These models classify text into any categories you want by inputting them as labels. Since I was looking at text around mental health, I included emotions as labels, including urgent, joy, sadness, fatigue, and anxiety.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk oi"><img src="../Images/9ac737e7590ffd3927e007b4e363f3b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*SkZOmhfbqc61m16W"/></div></div></figure><p id="48e0" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">You can see that with the zero-shot classification model, we can easily categorize the text into a more comprehensive representation of human emotions without needing any labeled data. The model can discern nuances and changes in emotions within the text by providing accuracy scores for each label. This is useful in mental health applications, where emotions often exist on a spectrum.</p><p id="c092" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">Now that I have identified that the zero-shot classification model is a better fit for my needs, I will walk through how to apply the model to a dataset.</p><p id="5bb2" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk"><strong class="ng fr">Implementation of the Zero-Shot Model</strong></p><p id="039f" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">Here are the requirements to run this example:</p><pre class="mm mn mo mp mq oj ok ol bp om bb bk"><span id="8067" class="on oo fq ok b bg op oq l or os">torch&gt;=1.9.0<br/>transformers&gt;=4.11.3 <br/>datasets&gt;=1.14.0 <br/>tokenizers&gt;=0.11.0<br/>pandas<br/>numpy</span></pre><p id="4369" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk"><strong class="ng fr">Step 1. Import libraries used</strong></p><p id="9338" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">In this example, I am using the <a class="af nd" href="https://huggingface.co/MoritzLaurer/DeBERTa-v3-base-mnli-fever-anli" rel="noopener ugc nofollow" target="_blank">DeBERTa-v3-base-mnli-fever-anli</a> zero-shot classifier from Hugging Face.</p><pre class="mm mn mo mp mq oj ok ol bp om bb bk"><span id="7161" class="on oo fq ok b bg op oq l or os"><br/># load hugging face library and model<br/><br/><br/>from transformers import pipeline<br/>classifier = pipeline("zero-shot-classification", model="MoritzLaurer/DeBERTa-v3-base-mnli-fever-anli")<br/><br/># load in pandas and numpy for data manipulation<br/>import pandas as pd<br/>import numpy as np</span></pre><p id="a3a3" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">Pipeline is the function used to call in pre-trained models from HuggingFace. Here I am passing on two arguments. You can get the values for these arguments from the model card:</p><ul class=""><li id="d4a6" class="ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz ot ob oc bk">`task`: The type of task the model is performing, passed as a string</li><li id="1fb7" class="ne nf fq ng b go od ni nj gr oe nl nm nn of np nq nr og nt nu nv oh nx ny nz ot ob oc bk">`model`: Name of the model you are using, passed as a string</li></ul><p id="d290" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk"><strong class="ng fr">Step 2. Read in your data</strong></p><p id="8336" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">Your data can be in any form, as long as there is a text column where each row contains a string of text. To follow along with this example, you can read in the <a class="af nd" href="https://raw.githubusercontent.com/akaba09/redditmentalhealth/main/code/dep.csv" rel="noopener ugc nofollow" target="_blank">Reddit depression dataset here</a>. This dataset is made available under the Public Domain Dedication and License v1.0.</p><pre class="mm mn mo mp mq oj ok ol bp om bb bk"><span id="9ae8" class="on oo fq ok b bg op oq l or os">#reading in data <br/>df = pd.read_csv("https://raw.githubusercontent.com/akaba09/redditmentalhealth/main/code/dep.csv")</span></pre><p id="6ca6" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">Here is a preview of the dataset we’ll be using:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk ou"><img src="../Images/2a916a26aebba2abd0d0a8b28ecc940d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1222/format:webp/0*Tu71mXj4NbZRXjBy"/></div></figure><p id="5e8b" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk"><strong class="ng fr">Step 3: Create a list of classes that you want to use for predicting sentiment</strong></p><p id="7186" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">This list will be used as labels for the model to predict each piece of text. For example, is the text exploring emotions such as anger or disgust? In this case, I am passing a list of emotions as labels. You can use as many or as few labels as you’d like.</p><pre class="mm mn mo mp mq oj ok ol bp om bb bk"><span id="9ec4" class="on oo fq ok b bg op oq l or os"># Creating a list of emotions to use as labels<br/>text_labels = ["anticipation", "anger", "disgust", "fear", "joy", "trust"]</span></pre><p id="10f4" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk"><strong class="ng fr">Step 4: Run the model prediction on one piece of text first</strong></p><p id="c6ce" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">Run the model on one piece of text first to understand what the model returns and how you want to shape it for your dataset.</p><pre class="mm mn mo mp mq oj ok ol bp om bb bk"><span id="87f7" class="on oo fq ok b bg op oq l or os"># Sample piece of text<br/>sample_text = "still have depression symptoms not as bad as they used to be in fact my therapist says im improving a lot but for the past years ive been stuck in this state of emotional numbness feeling disconnected from myself others and the world and time doesnt seem to be passing"<br/><br/># Run the model on the sample text<br/>classifier(sample_text, text_labels, multi_label = False)</span></pre><p id="5e5a" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">The <strong class="ng fr">classifier</strong> function is part of the Transformers library in HuggingFace and calls in the model you want to use. In this example, we are using <a class="af nd" href="https://huggingface.co/MoritzLaurer/DeBERTa-v3-base-mnli-fever-anli" rel="noopener ugc nofollow" target="_blank">“DeBERTa-V4-base-mnli-fever-anli”</a> and it takes three positional arguments:</p><ul class=""><li id="bbe7" class="ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz ot ob oc bk">First position: a piece of text in string format. his variable can have any name. In this example, I named it `sample_text`</li><li id="6206" class="ne nf fq ng b go od ni nj gr oe nl nm nn of np nq nr og nt nu nv oh nx ny nz ot ob oc bk">Second position: list of labels you want to predict. This variable can have any name. In this example, I named it `text_labels`</li><li id="c7da" class="ne nf fq ng b go od ni nj gr oe nl nm nn of np nq nr og nt nu nv oh nx ny nz ot ob oc bk">Third position: `multi_label` takes a true or false argument. This determines whether each piece of text can have multiple labels or only one label per text. In this example, I am only interested in one label per text.</li></ul><p id="5aac" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk"><strong class="ng fr">Here’s the output you get from the sample text:</strong></p><pre class="mm mn mo mp mq oj ok ol bp om bb bk"><span id="c1ff" class="on oo fq ok b bg op oq l or os">#output <br/># {'sequence': ' still have depression symptoms not as bad as they used to be in fact my therapist says im improving a lot but for the past years ive been stuck in this state of emotional numbness feeling disconnected from myself others and the world and time doesnt seem to be passing',<br/> # 'labels': ['anticipation', 'trust', 'joy', 'disgust', 'fear', 'anger'],<br/> # 'scores': [0.6039842963218689,<br/>   #0.1163715273141861,<br/>   #0.074860118329525,<br/>   #0.07247171550989151,<br/>   #0.0699692890048027,<br/>   #0.0623430535197258]}</span></pre><p id="7454" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">The model returns a dictionary with the following keys and values”</p><ul class=""><li id="ca03" class="ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz ot ob oc bk">“sequence”: The piece of text we passed in</li><li id="0102" class="ne nf fq ng b go od ni nj gr oe nl nm nn of np nq nr og nt nu nv oh nx ny nz ot ob oc bk">“labels”: The list of labels for the model predictions in descending order of confidence.</li><li id="1850" class="ne nf fq ng b go od ni nj gr oe nl nm nn of np nq nr og nt nu nv oh nx ny nz ot ob oc bk">“scores”: This returns a list of scores that represent the model’s confidence in its predictions in descending order. The order is correlated to the labels, so the first element in the scores list is reflective of the first element in the labels list. In this example, the model has predicted “anticipation” with a 0.604 confidence level.</li></ul><p id="3196" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk"><strong class="ng fr">Step 5: Write a custom function to make predictions on the entire dataset and include the labels as part of the dataframe <br/></strong>Seeing the structure of the dictionary output from the model, I can write a custom function to apply the predictions to all my data. In this example, I am only interested in keeping one sentiment for each piece of text. This function will take in your dataframe and return a new dataframe that includes two new columns—one for your sentiment label and one for the model score.</p><pre class="mm mn mo mp mq oj ok ol bp om bb bk"><span id="be66" class="on oo fq ok b bg op oq l or os">def predict_sentiment(df, text_column, text_labels):<br/>    <br/>"""<br/>    Predict the sentiment for a piece of text in a dataframe.<br/><br/>    Args:<br/>        df (pandas.DataFrame): A DataFrame containing the text data to perform sentiment analysis on.<br/>        text_column (str): The name of the column in the DataFrame that contains the text data.<br/>        text_labels (list): A list of text labels for sentiment classification.<br/><br/>    Returns:<br/>        pandas.DataFrame: A DataFrame containing the original data with additional columns for the predicted <br/>        sentiment label and corresponding score.<br/><br/>    Raises:<br/>        ValueError: If the DataFrame (df) does not contain the specified text_column.<br/><br/>    Example:<br/>        # Assuming df is a pandas DataFrame and text_labels is a list of text labels<br/>        result = predict_sentiment(df, "text_column_name", text_labels)<br/>    """<br/>    <br/>    result_list = []<br/>    for index, row in df.iterrows():<br/>        sequence_to_classify = row[text_column]<br/>        result = classifier(sequence_to_classify, text_labels, multi_label = False)<br/>        result['sentiment'] = result['labels'][0]<br/>        result['score'] = result['scores'][0]<br/>        result_list.append(result)<br/>    result_df = pd.DataFrame(result_list)[['sequence','sentiment', 'score']]<br/>    result_df = pd.merge(df, result_df, left_on = "text", right_on="sequence", how = "left")<br/>    return result_df</span></pre><p id="6c43" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">This function iterates over your dataframe and parses the dictionary result for each row. Since I am only interested in the sentiment with the highest score, I am selecting the first label by indexing it into the list with result[‘labels’][0]. If you want to take the top three sentiments, for example, you can update with a range result[‘labels’][0:3]. Similarly, if you want the top three scores, you can update with a range result[‘scores’][0:3].</p><p id="b225" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk"><strong class="ng fr">Now you can run the function on your dataframe!</strong></p><pre class="mm mn mo mp mq oj ok ol bp om bb bk"><span id="0e63" class="on oo fq ok b bg op oq l or os"># run prediction on df<br/><br/>results_df = predict_sentiment(df=df, text_column ="text", text_labels= text_labels)</span></pre><p id="9d51" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">Here I pass in three arguments:</p><ul class=""><li id="5e30" class="ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz ot ob oc bk">`df`: The name of your dataframe</li><li id="312b" class="ne nf fq ng b go od ni nj gr oe nl nm nn of np nq nr og nt nu nv oh nx ny nz ot ob oc bk">`text_column`: The name of the column in the dataframe that contains text. Pass this argument as a string.</li><li id="3ace" class="ne nf fq ng b go od ni nj gr oe nl nm nn of np nq nr og nt nu nv oh nx ny nz ot ob oc bk">`text_labels`: A list of text labels for sentiment classification</li></ul><p id="7d9f" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">This is a preview of what your returned data frame looks like:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk ov"><img src="../Images/3acf5ad446d2589b6a5dfe4f3aefa0cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*CZRexDaM_oRhuz8x"/></div></div></figure><p id="dd3a" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">For each piece of text, you can get the associated sentiment along with the model score.</p><p id="9e6e" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk"><strong class="ng fr">Conclusion</strong></p><p id="8dc3" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">Classic sentiment analysis models explore positive or negative sentiment in a piece of text, which can be limiting when you want to explore more nuance, like emotions, in the text.</p><p id="d58c" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">While you can explore emotions with sentiment analysis models, it usually requires a labeled dataset and more effort to implement. Zero-shot classification models are versatile and can generalize across a broad array of sentiments without needing labeled data or prior training.</p><p id="a621" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">As we explored in this example, zero-shot models take in a list of labels and return the predictions for a piece of text. We passed in a list of emotions as our labels, and the results were pretty good considering the model wasn’t trained on this type of emotional data. This type of classification is a valuable tool in analyzing mental health-related text, which allows us to gain a more comprehensive understanding of the emotional landscape and contributes to improved support for mental well-being.</p><p id="6e61" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk"><em class="ow">All images, unless otherwise noted, are by the author.</em></p></div></div></div><div class="ab cb ox oy oz pa" role="separator"><span class="pb by bm pc pd pe"/><span class="pb by bm pc pd pe"/><span class="pb by bm pc pd"/></div><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><p id="a3a4" class="pw-post-body-paragraph ne nf fq ng b go nh ni nj gr nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz fj bk">Low, D. M., Rumker, L., Torous, J., Cecchi, G., Ghosh, S. S., &amp; Talkar, T. (2020). Natural Language Processing Reveals Vulnerable Mental Health Support Groups and Heightened Health Anxiety on Reddit During COVID-19: Observational Study. <em class="ow">Journal of medical Internet research</em>, <em class="ow">22</em>(10), e22635.</p></div></div></div></div>    
</body>
</html>