# 如何免费自学因果推理

> 原文：[https://towardsdatascience.com/how-to-learn-causal-inference-on-your-own-for-free-98503abc0a06?source=collection_archive---------0-----------------------#2024-02-20](https://towardsdatascience.com/how-to-learn-causal-inference-on-your-own-for-free-98503abc0a06?source=collection_archive---------0-----------------------#2024-02-20)

## 适用于所有水平的终极自学指南

[](https://medium.com/@quentin.gallea?source=post_page---byline--98503abc0a06--------------------------------)[![Quentin Gallea, PhD](../Images/457af55dd9c6121da7ec97f8e2991c43.png)](https://medium.com/@quentin.gallea?source=post_page---byline--98503abc0a06--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--98503abc0a06--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--98503abc0a06--------------------------------) [Quentin Gallea, PhD](https://medium.com/@quentin.gallea?source=post_page---byline--98503abc0a06--------------------------------)

·发表于[Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--98503abc0a06--------------------------------) ·阅读时长12分钟·2024年2月20日

--

![](../Images/8a049a435a54acfdc9eae6ae66276ef0.png)

作者提供的图片

在每个人都专注于人工智能和预测推理时，脱颖而出需要掌握的不仅仅是预测，而是理解数据背后的“为什么”——换句话说，就是掌握**因果推理**。

> 你可能听说过“相关性不代表因果性”，但很少有人真正理解其含义，也很少有人知道何时可以自信地断言因果关系。

预测推理与因果推理之间的区别是深刻的，后者经常被忽视，导致代价高昂的错误。这两种方法的逻辑和模型差异巨大，本指南旨在帮助你掌握辨别因果关系的知识，做到自信应对。

![](../Images/7de3e7b123ce96d402fcc70bf3cb749c.png)

来自谷歌趋势的“因果推理”结果，揭示了最近快速增长的兴趣以及与机器学习的关联。图片由作者提供

我坚信因果推理无疑是当今最值得学习的技能之一，原因有三：

1.  它对几乎任何工作都极为有用，不仅限于数据科学家，还包括商业领袖和经理（见下一节）。

1.  它仍然是一个小众领域，真正的专家寥寥无几，但兴趣正在快速增长（见上图）。

1.  如谷歌趋势结果所示（见上图），*“因果机器学习”*是当前最新的关联趋势。因此，掌握因果推理将帮助你将这一知识与当前的人工智能焦点相连接，并使你走在前沿。

> **为了帮助你掌握因果推理，并在职场及其他领域拥有一项有价值的技能，我制作了这份自学指南，适合各个层次的人，不需要任何先决条件，并且完全由免费的在线资源组成。**

## 指南的计划：

1.  介绍：因果推理的关键概念

1.  技术工具

1.  随机化实验（A/B 测试）

1.  准实验设计

1.  高级话题

1.  结论

完整的视频指南

# 1\. 介绍：因果推理的关键概念

因果关系是研究因果与结果之间关系的领域，旨在回答诸如“为什么？”和“如果呢？”等关键问题。理解因果关系的概念对抗击气候变化、追求幸福以及战略决策至关重要。

需要因果推理的主要问题示例：

+   禁止燃油车会对污染产生什么影响？

+   某些健康问题传播背后的原因是什么？

+   减少屏幕时间是否能提高幸福感？

+   我们广告活动的投资回报率是多少？

在接下来的内容中，我将主要引用两本免费的电子书，这些书中包含Python代码和可以进行实验的数据。第一本电子书提供快速概览，而第二本则允许更深入地探讨内容。

1.  [勇敢与真实的因果推理](https://matheusfacure.github.io/python-causality-handbook/landing-page.html) *作者：Matheus Facure*

2\. [因果推理：混音带](https://mixtape.scunning.com/) *作者：Scott Cuningham*

![](../Images/b0a732ae531b63c5685ffb03178ffa90.png)

图片来源：Timo Elliott

## 1.1 因果推理的根本问题

让我们通过一个我们可能都熟悉的情境，深入了解理解因果推理所必需的最基本概念。

想象一下，你已经在电脑前工作了一整天，截止日期临近，你开始感到头痛。你还有几个小时的工作需要完成，于是你决定服用一颗药丸。过了一会儿，头痛消失了。

但是，接着你开始怀疑：真的是药丸起了作用吗？还是因为你喝了茶或休息了一下？令人着迷但最终也令人沮丧的一点是，回答这个问题是不可能的，因为所有这些效应是交叉混淆的。

> 确定是否是药丸治愈了你的头痛的唯一方法就是拥有两个平行世界。

在两个世界中，一个你服用了药丸，另一个你没有，或者理想情况下，你服用了安慰剂。只有在你感到在服用了药丸的世界中有所好转时，你才能证明药丸的因果效应，因为药丸是这两个世界之间唯一的区别。

不幸的是，我们无法访问平行世界来进行实验并评估因果关系。因此，许多因素是同时发生的并且相互混淆（例如，为头痛服药、喝茶和休息；在销售旺季增加广告支出；将更多警力分配到犯罪率较高的地区等）。

为了快速深入理解这一基本概念，而无需任何额外的技术知识，您可以阅读以下关于《Towards Data Science》的文章：

## 📚资源：

[因果关系的科学与艺术（第一部分）](/the-science-and-art-of-causality-part-1-5d6fb55b7a7c)

## 1.2 一些形式化：潜在结果

现在你理解了基本概念，是时候进一步理论化并正式化这些概念了。最常见的方法是潜在结果框架，它允许清晰地表达模型假设。这些假设对于明确问题和识别解决方案至关重要。

该模型中使用的主要符号是：

1.  Yᵢ(0) 代表个体 *i* 在未接受处理时的潜在结果。

1.  Yᵢ(1) 代表个体 *i* 在接受处理时的潜在结果。

请注意，使用了不同的符号。处理（1 或 0）的引用可能出现在括号中（如上所用），也可能以上标或下标形式出现。字母“Y”表示关注的结果，例如一个二元变量，当出现头痛时值为1，否则为0。下标“i”表示观察到的实体（例如，一个人、一只实验鼠、一座城市等）。最后，术语“处理”指的是你关心的“原因”（例如，一颗药丸、一则广告、一项政策等）。

使用这个符号，我们可以通过陈述因果推断的基本问题来指出：不可能同时观察到 Yᵢ(0) 和 Yᵢ(1)。换句话说，你永远无法在同一时刻观察到同一人接受和未接受处理后的结果。

虽然我们无法识别个体效应 Yᵢ(1)-Yᵢ(0)，但我们可以衡量平均处理效应（ATE）：E[Yᵢ(1)-Yᵢ(0)]。然而，如果两个组之间存在除处理外的系统性差异，这个平均处理效应将会有偏。

要深入了解这部分内容，您可以参考以下两章：

## 📚资源：

+   简要概述：[潜在结果（因果推断：勇敢与真实的指南）](https://matheusfacure.github.io/python-causality-handbook/01-Introduction-To-Causality.html)

+   深入阅读：[潜在结果（因果推断：混音带）](https://mixtape.scunning.com/04-potential_outcomes)

## 1.3 因果关系的可视化表示：有向（无环）图

可视化表示是减少认知负担、澄清假设并促进沟通的强大工具。在因果推断中，我们使用有向图。顾名思义，这些图描绘了各种元素（如头痛、药丸、茶）作为节点，通过单向箭头连接，显示因果关系的方向。（注：我故意没有提到与这些图相关的常见假设“无环性”，因为它超出了本概述的范围，但在本小节末尾的第二篇参考文献中有讨论。）

![](../Images/106b492182f63d0802f0c8049146bc1b.png)

有向图示例，图像来自作者

因果推断与预测推断的主要区别在于假定的潜在因果关系。这些关系通过一种特殊的图形——有向（无环）图明确表示。这个工具与潜在结果框架一起，构成了因果推断的核心，将帮助清晰地思考潜在问题，并因此找到评估因果关系的解决方案。

## 📚资源：

+   简短介绍：[有向无环图（勇敢且忠诚的因果推断）](https://matheusfacure.github.io/python-causality-handbook/04-Graphical-Causal-Models.html)

+   深入了解：[有向无环图（因果推断：混音带）](https://mixtape.scunning.com/03-directed_acyclical_graphs)

# 2. 技术工具

如果你想进一步深入并将这些方法应用于数据分析，你需要掌握两种技术工具。

+   对概率、统计和线性回归的基础理解。

+   掌握一款统计软件的使用。

## 2.1 概率、统计与线性回归

这些工具对于数据科学来说非常有价值，你可以专注于最重要的部分。此外，两本参考书中都有专门讨论这一主题的章节，重点讲解与因果推断相关的概念：

## 📚资源：

+   [概率与回归复习（因果推断：混音带）](https://mixtape.scunning.com/02-probability_and_regression)

+   [线性回归的非凡有效性（勇敢且忠诚的因果推断）](https://matheusfacure.github.io/python-causality-handbook/05-The-Unreasonable-Effectiveness-of-Linear-Regression.html?highlight=b+testing)

此外，在我看来，线性回归相关的一个非常有价值但常被忽视的话题是“坏控制”的概念。理解你应该控制哪些因素，以及哪些因素实际上会引发问题，这是关键。以下两篇参考文献将帮助你理解这个概念。

## 📚资源：

+   [你应该控制哪些变量？（Scott Cuningham的substack）](https://causalinf.substack.com/p/which-variables-do-i-need-to-control)

+   [好控制与坏控制速成课程（Cinelli等，2022）](https://ftp.cs.ucla.edu/pub/stat_ser/r493.pdf)

最后，理解固定效应回归对因果推断至关重要。这种回归方法允许我们考虑那些可能无法测量的（例如文化）或根本没有数据的混杂因素。

## 📚资源：

+   简介：[固定效应（《勇敢与真实的因果推断》）](https://matheusfacure.github.io/python-causality-handbook/14-Panel-Data-and-Fixed-Effects.html)

+   深入了解：[固定效应（《因果推断：混音带》）](https://mixtape.scunning.com/08-panel_data)

## 2.2 统计工具

有许多工具可以帮助我们进行因果推断和统计分析，在我看来，最好的工具是STATA、Python和R。

STATA专为统计学设计，尤其是计量经济学，使其成为一个极其强大的工具。它提供了来自前沿研究的最新包。然而，它价格昂贵且不够多功能。

另一方面，Python是当今领先的编程语言。它是开源的，功能非常多样化，这些都是它成为我首选的关键原因。此外，ChatGPT在处理Python相关问题时表现非常出色，这在这个人工智能时代是一个重要的优势。

R在统计学方面非常强大。R与Python之间的辩论仍在进行中，我将这个判断留给你。需要注意的是，R的多功能性不如Python，而且似乎ChatGPT在R上的熟练度不如Python。此外，我参考的两本主要书籍都包含了Python代码（《勇敢与真实的因果推断》；《因果推断：混音带》）。这进一步支持了将重点放在Python上的观点。

有成千上万的免费资源可以从零开始学习Python（如果你有更好的建议，请评论）。但如果你从零开始（完全没有编码经验），以下是我通常会推荐的资源：

## 📚资源：

+   [Python编程入门（Udemy）](https://www.udemy.com/course/pythonforbeginnersintro/)

+   [Python中的线性回归（Real Python）](https://realpython.com/linear-regression-in-python/)

# 3\. 随机实验（A/B测试）

在本指南的第一部分，我们发现了因果推断的基本问题。这个问题突显了评估因果关系的困难。那么我们能做什么呢？

通常，因果推断中最先提出并被认为是*“黄金标准”*的解决方案是随机实验（随机对照试验）。

从本质上讲，随机实验的思想是复制，或者至少尽可能接近一个平行世界的情景。这使我们能够隔离治疗（原因）的效果（后果）。

正如我在第一部分提到的[《面向数据科学》文章](https://medium.com/towards-data-science/the-science-and-art-of-causality-part-1-5d6fb55b7a7c)中解释的：

> “我们采取一个样本，希望它能代表一个更大的群体，并随机将受试者分配到两个组（治疗组和对照组）或更多组。受试者通常不知道自己是否接受治疗（这一过程称为盲法）。因此，这两个组可以说是可比的。由于唯一的区别是治疗，如果我们观察到一个效应，那么它可能是因果关系，前提是没有其他偏差存在。”

![](../Images/7c315c63ec7c96a8c206ccad2c64424a.png)

随机实验的简单表示。图片来源：作者。

## 📚资源：

+   [随机化实验（勇敢与真实的因果推断）](https://matheusfacure.github.io/python-causality-handbook/02-Randomised-Experiments.html)

+   [A/B 测试的简单完整指南](https://news.lunartech.ai/simple-and-complet-guide-to-a-b-testing-c34154d0ce5a)（Lunar Tech）

# 4. 准实验设计

控制实验并不总是可能的（例如，改变性别/种族以研究歧视）或符合伦理的（例如，暴露人类于致死剂量的污染物以研究呼吸道疾病）。

此外，随机化实验往往具有非常强的内部效度，但外部效度较弱。内部效度意味着在研究范围内能够精确地衡量因果关系，而外部效度则指的是将结果推广到研究范围之外的能力。

![](../Images/e9dce9018761941f16b6b949e2ea35da.png)

控制实验的主要限制之一是外部效度。图片来源：作者。

例如，医学研究广泛依赖于近亲繁殖的老鼠/小鼠。这些动物几乎拥有相同的基因组，过着相同的实验室生活，吃着相同的食物，等等。因此，当你用这些动物做控制实验时，几乎就像是在平行世界中工作，几乎是与克隆体打交道。然而，由于研究对象的同质性，外部效度较弱。此外，在控制实验中，通常整个环境都被控制，在某些情况下，这使得实验设定显得有些不现实，从而降低了结果的实用性。

让我通过以下研究论文来说明这一点。*《英国医学杂志》*（最具声望的医学期刊之一）上发表的一项研究发现，跳伞时使用降落伞对“死亡或重大创伤性伤害的复合指标”没有影响[(Yeh et al. (2018))](https://www.bmj.com/content/363/bmj.k5094)。在这项随机实验中，参与者从一架小型、静止在地面的飞机上跳下。这个荒谬的设定说明了在控制实验中，当实验设定不现实时，常常会出现的问题。论文的目的是提高医学研究人员对外部效度问题的关注，这是一个当前且严峻的挑战。

解决这个问题的一种方法是依赖其他方法，称为准实验设计。其理念是在自然环境中观察群体之间的准随机分配。“准随机”意味着一旦我们隔离或控制潜在的系统性差异，分配效果实际上就像随机分配一样。

## 4.1 示例

为了说明准实验设计的概念，我将解释一种方法——回归不连续设计（RDD）背后的直觉，这种方法用于衡量饮酒对死亡率的影响。

回归不连续设计（RDD）的理念是利用治疗分配中的不连续性（例如，地理边界、与年龄相关的行政法律等），在这些情况下，相似的个体或地点根据某一截止点接受不同的治疗。

例如，在Carpenter 和 Dobkin（2009）的研究《*饮酒对死亡率的影响*》中，作者利用法定最低饮酒年龄的分界点，研究饮酒对死亡率的即时影响。

![](../Images/da2603e8976b80bdbe6021bec83b13bb.png)

与移动交通事故相关的死亡率在21岁时突然上升，可以说是由于饮酒引起的。复现（Carpenter 和 Dobkin (2009)）的主要结果。图片由作者提供。

本研究的理论是，饮酒的人与不饮酒的人通常无法直接比较，因为存在许多其他系统性差异（例如年龄、社会经济状况、各种疾病的风险等）。然而，通过比较刚刚低于21岁和刚刚超过21岁的个体，可以认为他们非常相似，假设在那个年龄没有其他显著变化。这种方法可以更清楚地将死亡率变化归因于饮酒行为。这个例子，连同数据和代码，也包含在下一个子节4.2 方法末尾提供的第一个参考中。

## 4.2 方法

有许多方法可以使用。然而，我建议你按照以下顺序学习这三种方法：

1.  回归不连续设计（RDD）

1.  差分中的差分（Diff-in-Diff）

1.  工具变量（IV）

这三种方法在学术研究中是标准方法，同时也广泛应用于行业。它们共同构成了一个工具箱，可以帮助你在各种场景下解决因果问题。

## 📚资源：

+   简介：[回归不连续设计（勇敢和真实的因果推断）](https://matheusfacure.github.io/python-causality-handbook/16-Regression-Discontinuity-Design.html)

+   深入了解：[回归不连续设计（因果推断：混音带）](https://mixtape.scunning.com/06-regression_discontinuity)

+   简介：[差分中的差分（勇敢和真实的因果推断）](https://matheusfacure.github.io/python-causality-handbook/13-Difference-in-Differences.html)

+   深入了解：[差分中的差分（因果推断：混音带）](https://mixtape.scunning.com/09-difference_in_differences)

+   差分法示例：[ChatGPT对Stack Overflow的影响](/how-ai-is-changing-the-way-we-code-36ff30262e65)

+   简介：[工具变量（勇敢与真实的因果推断）](https://matheusfacure.github.io/python-causality-handbook/08-Instrumental-Variables.html)

+   深入探讨：[工具变量（因果推断：混音带）](https://mixtape.scunning.com/07-instrumental_variables)

# 6\. 高级主题

当然，因果推断是非常丰富的。掌握这些工具将使你在因果推断领域中游刃有余。然而，还有其他潜在的主题值得探索。以下是一些列表：

## 📚 合成控制（非常流行且增长最快的准实验方法）：

+   简介：[合成控制（勇敢与真实的因果推断）](https://matheusfacure.github.io/python-causality-handbook/15-Synthetic-Control.html)

+   简介：[合成差分法（勇敢与真实的因果推断）](https://matheusfacure.github.io/python-causality-handbook/25-Synthetic-Diff-in-Diff.html)

+   深入探讨：[合成控制（因果推断：混音带）](https://mixtape.scunning.com/10-synthetic_control)

## 📚 因果机器学习（结合因果推断和机器学习两者的优势）：

+   [机器学习与因果推断：短期课程](https://www.gsb.stanford.edu/faculty-research/labs-initiatives/sil/research/methods/ai-machine-learning/short-course)（斯坦福大学）

+   [因果机器学习：调查与开放问题（Kaddour 等，2022）](https://arxiv.org/abs/2206.15475)

+   !收费！[因果分析：影响评估与因果机器学习在R中的应用](https://mitpress.mit.edu/9780262545914/causal-analysis/)（马丁·胡贝尔）

## 📚 因果发现

+   !收费！[Python中的因果推断与发现](https://www.packtpub.com/product/causal-inference-and-discovery-in-python/9781804612989)

# 6\. 结论

遵循本指南将为你提供扎实的理论基础和全面的工具箱，帮助你将因果推断融入你的技能集。这些概念不仅仅局限于衡量你工作的因果效应；它们还能提升你的批判性思维能力。新闻、政治、‘专家’、经理以及其他人中，滥用因果声明的情况屡见不鲜。应用这些概念可以减少被操控的风险。这个工具箱在日常的朋友讨论或团队会议中也能发挥作用，尤其是在做决策或反思观察时。

当然，这仅仅是开始。要真正整合并掌握这些技能，实践至关重要。我鼓励你选择一个相关的问题，寻找数据，并使用本指南中提供的工具尝试回答它。然后，将这个项目纳入你的作品集中，以展示你的新知识。

**享受这段令人兴奋的旅程，解答那永无止境的“为什么”问题。**
