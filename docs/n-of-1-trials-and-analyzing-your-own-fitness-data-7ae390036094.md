# N-of-1 试验与分析你自己的健身数据

> 原文：[https://towardsdatascience.com/n-of-1-trials-and-analyzing-your-own-fitness-data-7ae390036094?source=collection_archive---------3-----------------------#2024-04-20](https://towardsdatascience.com/n-of-1-trials-and-analyzing-your-own-fitness-data-7ae390036094?source=collection_archive---------3-----------------------#2024-04-20)

## 喝酒后我真的睡得更差吗？

[](https://medium.com/@meretelutz?source=post_page---byline--7ae390036094--------------------------------)[![Merete Lutz](../Images/1aea07c518e5fe5f75d455c0c10d67af.png)](https://medium.com/@meretelutz?source=post_page---byline--7ae390036094--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--7ae390036094--------------------------------)[![Towards Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--7ae390036094--------------------------------) [Merete Lutz](https://medium.com/@meretelutz?source=post_page---byline--7ae390036094--------------------------------)

·发表于[Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--7ae390036094--------------------------------) ·阅读时间：11分钟·2024年4月20日

--

![](../Images/e3dc926753046c1811a7cbf5c18f3921.png)

图片由[Luke Chesser](https://unsplash.com/@lukechesser?utm_source=medium&utm_medium=referral)提供，来源于[Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)

我第一次听说N-of-1试验是在2018年，当时我还是一名流行病学的硕士生。我在我的*中级流行病学与临床研究方法*课上，听了一位[Dr. Eric Daza](https://www.ericjdaza.com/)博士关于N-of-1研究设计的讲座。N-of-1研究可以看作是一项临床试验，旨在研究某一干预措施对个体患者的疗效。当时，这种方法学是一个新兴的实践，具有个性化医学和优化个人医疗保健的有希望的前景。

在讲座的最后，他提到N-of-1实验是一些对Fitbit着迷并熟悉统计学的人的兴趣爱好。这些数据科学家能够获取自己的生物识别数据，进行实验和分析，以优化他们的睡眠、锻炼和饮食。我对此感到非常着迷。

这次讲座的时机简直太完美了。我在过去的五年里一直是女子排球队的学生运动员，正准备开始我将持续五年的职业排球生涯。我刚开始使用[Whoop](https://www.whoop.com/)带子来追踪我的锻炼、睡眠和恢复，手头有了这些新的数据。我正在学习统计学和研究设计，而现在我知道如何将它们应用到实践中，也许还能在我的新职业生涯中占得先机。

在接下来的一年半里，我通过我的Whoop设备严格记录了所有数据，但最终停止佩戴该设备，因为当时公司不允许你下载自己的数据。快进到几年后，现在我是英属哥伦比亚大学的数据科学硕士生。我掌握了更多的分析方法，而且Whoop终于允许你访问你的旧数据！现在，比以往任何时候，我终于可以进行自己的N-of-1研究，回答当时我所困惑的一些问题。

在进行分析之前，我们必须首先定义N-of-1研究框架，并回顾一下历史上因果医学研究的方法。

## 随机对照试验（RCT）

现代医学研究的黄金标准是随机对照试验（RCT）。假设我们想知道一种新药是否能够降低心脏病发作的风险。在RCT中，一组患者会被随机分配到治疗组（服用药物）或对照组（服用安慰剂）。研究人员巧妙地设计了这个实验，使得两组之间的个体具有相似的特征，唯一的主要区别就是他们是否服用药物。我们会跟踪这些人一段时间，记录发生的心脏病发作事件。在实验结束时，我们统计每组中的数据，进行一些统计分析，以便比较两组之间的心脏病发作发生率，看看是否存在统计学上显著的差异。

RCT是因果推断中极为强大的工具，使我们能够发现某种干预是否会导致期望的反应。它们是应用医学研究的历史支柱，但由于它们过于强调结果的普适性，受到了一定的限制。当RCT进行时，最终的目标是为更广泛的群体设定一个新的实践标准，而不仅仅是研究参与者。我们根据样本对整体人群做出推断，在此过程中，我们往往会忽略个体反应的差异。这种做法几乎与医学的目标相违背，因为医学的目标是为个体患者提供治疗。

## N-of-1试验

N-of-1试验通过将RCT（随机对照试验）研究设计应用于个体层面，解决了这个局限性。它们使我们能够探索患者对特定治疗的反应差异，并通过减少在次优治疗上花费的时间，帮助改善患者的治疗效果。尽管N-of-1研究的理念已经存在一段时间，但现在由于技术的进步，收集数据变得更加容易，这类研究也变得更加可行。

N-of-1试验并不总是个性化医学的答案。对于像传染病这样的快速变化的疾病，你可能没有时间进行这种个性化的试验，最好采取更为普适的方法。然而，对于慢性病的治疗，N-of-1试验提供了一条极具前景的途径，有助于改善健康结果。这些病症可能不会直接威胁生命，并且可以在长时间内观察到。这为尝试不同的干预提供了机会，旨在找到最佳治疗方法。

除了医学领域，你还可以将N-of-1试验应用到日常生活中。我们有多少人尝试过新的药物、饮食、补充品、锻炼或睡眠习惯，却很难确定它是否有效？很难明确说明干预是否有效，因为大多数现有的证据都是轶事性质的，或者难以量化。通过结合N-of-1研究框架和你从可穿戴健康追踪器获取的生物数据，你可以获得确凿的证据，从而做出你知道会带来改变的生活方式调整。

## 实践中的N-of-1试验

为了给你展示这种方法的实际应用，我将基于从2018年4月27日到2019年10月5日从我的Whoop手环收集的一些数据进行分析。我们这项N-of-1研究的研究问题是：

*饮酒会导致睡眠质量差吗？*

作为一名运动员和流行病学家，我非常清楚酒精对睡眠、运动表现和整体健康的危害。我常常听说运动员不应饮酒，然而，别人告诉你是一回事，而亲眼看到证据又是另一回事。当我开始佩戴Whoop时，我注意到每次饮酒后，睡眠评分（由Whoop应用计算得出的指标）都会下降。有时甚至第二天，我也能看到这种影响。这些观察促使我想进行自己的分析，现在我终于完成了。

## 数据说明

我们分析中关注的两个变量是睡眠表现评分和酒精消费量。睡眠表现评分的范围是从0到100，是由Whoop应用通过生物数据计算得出的指标，包括呼吸频率、浅睡眠时长、慢波睡眠时长和快速眼动睡眠时长。

酒精消费变量是对问题“你昨天有喝酒吗？”的回答，该问题是Whoop用户在每天早晨醒来时回答的。我总是如实而一致地回答这些问题，尽管我们的数据存在局限，因为应用程序并未询问摄入了多少酒精。这意味着所有的酒精消费量都被视为相同，这排除了我们对关系进行更深入分析的机会。在我们的酒精数据中存在一些缺失值，但这些缺失的数据被用“没有”填充，因为根据个人经验，如果我前一晚喝酒了，我肯定会在应用程序中标明。

## 探索性数据分析

任何分析的第一步都是进行一些探索性数据分析（EDA）。这只是为了大致了解我们的数据是什么样的，并创建一个可视化图形，帮助我们指导进一步的研究。

![](../Images/debfee335eb6b56e97359b387385d8e4.png)

图1. 按酒精摄入水平分布的睡眠表现分数的探索性图表。

从上面的箱形图可以看出，当没有摄入酒精时，平均睡眠分数似乎较高，并且分布较为集中。奇怪的是，当没有摄入酒精时，睡眠表现分数似乎有更多的异常值。也许旅行日和时差反应能解释这些异常值，因为在这段样本期间，我曾出国旅行5次。

现在我们已经对感兴趣的数据有了一个初步了解，是时候深入进行统计分析了。

## 假设检验

为了回答我们的研究问题，我将进行假设检验。假设检验是一种统计方法，允许我们基于某些样本数据对总体做出推断。在这种情况下，我们试图推断我饮酒与当晚睡眠质量差之间是否存在关联。我们没有关于我一生中每个晚上酒精摄入与睡眠情况的数据，因此我们使用样本数据作为代理进行研究。

假设检验的第一步是制定假设。‘零假设’是假设没有有趣的现象发生，或者不存在关系或效果。在我们的案例中，**零假设**是：*摄入酒精和未摄入酒精的晚上，平均睡眠表现没有差异。*

‘备择假设’是与零假设相对立的假设，声称实际上有某种有趣的现象发生。在我们的例子中，**备择假设**是：*摄入酒精和未摄入酒精的晚上，平均睡眠表现存在差异。*

## 选择统计检验

要评估这些假设哪个为真，我们必须选择一个统计检验方法。我们想知道我在饮酒的夜晚与未饮酒的夜晚，平均睡眠得分是否不同，因此我们将使用均值差异来进行检验。具体来说，我们的**检验统计量**是：*无酒精的平均睡眠表现 - 有酒精的平均睡眠表现*

现在我们已经定义了框架，我们可以使用R来计算检验统计量并评估我们的假设。

## **在R中进行分析**

从我们的样本数据中，我们可以计算出观察到的检验统计量。以下是R中的代码：

```py
test_stat <- data |> 
  specify(formula = sleep_performance ~ alcohol) |> 
  calculate(
    stat = "diff in means",
    order = c("No", "Yes")
  )
```

我们的检验统计量是8.01。这个数字意味着，在我没有饮酒的夜晚，平均睡眠得分比我饮酒的夜晚高8.01分。

接下来的分析步骤是从我们的样本数据生成一个零分布。零分布表示如果我们从总体中重复抽取样本，可能观察到的所有不同的检验统计量值。该分布反映了由于随机抽样引起的检验统计量的变异。下面是用R生成零分布的过程：

```py
set.seed(42) #Setting seed for reproducibility

null_distribution <- data |> 
  specify(formula = sleep_performance ~ alcohol) |> 
  hypothesize(null = "independence") |> 
  generate(reps = 1000, type = "permute") |> 
  calculate(
    stat = "diff in means",
    order = c("No", "Yes")
  )
```

上述操作是从数据中进行有放回的抽样，并计算这些样本的均值差异。我们执行这一过程1000次，以生成足够大的分布，从而判断我们的观察到的检验统计量是否具有显著性。

在得到零分布和检验统计量后，我们可以计算出双侧p值，显著性水平为0.05。p值可以理解为在零假设成立的前提下，观察到的检验统计量与我们的观测值一样极端或更极端的概率。简单来说，它表示如果不存在真实的关联，看到这个结果的可能性有多大。我们在R中计算双侧p值，如下所示，因为我们关心检验统计量是否比预期更大或更小。

```py
p_value <- null_distribution|> 
  get_p_value(test_stat, direction = "both")
```

我们的p值是0.017，这意味着在显著性水平alpha=0.05下，我们的发现具有统计学意义，这是统计学中通常接受的显著性水平。这意味着我们发现的睡眠得分差异是显著的！我们有证据拒绝零假设并接受备择假设；在饮酒与未饮酒的夜晚之间，睡眠表现的均值存在差异。

我在下面包含了一个有用的可视化图，展示了零分布、检验统计量和95%的分位数范围。灰色条形表示从我们的1000个样本中计算出的许多可能的检验统计量，橙色线表示这些值的密度。蓝色虚线表示该分布的97.5百分位数和2.5百分位数，在这些范围之外，我们的检验统计量（以红色表示）被显示为显著。

![](../Images/bd0ee5455070a26ba696894ad32bb841.png)

图2。零假设下检验统计量的分布（酒精消费对平均睡眠得分无影响）

## **最终结论**

好吧，结果证明我的教练们一直都是对的！我们的分析发现，当我*没有*消费酒精时，我的平均睡眠得分比我*消费*酒精时高出8.01分。这一差异被发现具有统计学意义，p值为0.017，这意味着我们拒绝零假设，支持备择假设。这个统计结果支持了我的个人经验，给了我一个可以信赖的定量结果。

## 进一步探索

既然我已经完成了这项初步分析，我可以在数据中探索更多的关联，甚至使用更复杂的方法，如预测和机器学习模型。

这项分析是一个非常基础的N-of-1研究示例，也有其局限性。我的研究是观察性的而非实验性的，我们不能声明因果关系，因为有许多其他混杂变量是我的Whoop设备没有测量到的。如果我想找到因果关系，我需要精心设计研究，记录所有可能的混杂因素，并找到一种方法让我在治疗过程中保持盲目。N-of-1研究在临床环境之外很难进行，但我们仍然可以通过向数据提出简单问题来发现有意义的关联和关系。

我希望在这个教程之后，你能够主动从任何可以获得的健身追踪器中下载你的数据，并进行尝试。我知道每个人都能提出一个关于某个变量如何影响健康的假设，但大多数人没有意识到，你离获得该问题的量化答案比你想象的要近。

## 参考文献与进一步阅读

[1] Davidson, K., Cheung, K., Friel, C., & Suls, J. (2022)。将数据科学引入N-of-1设计、统计学、应用案例、未来及“ N-of-1”试验这一称谓。哈佛数据科学评论，（特刊第3期）。[https://doi.org/10.1162/99608f92.116c43fe](https://doi.org/10.1162/99608f92.116c43fe)

[2] Lillie EO, Patay B, Diamant J, Issell B, Topol EJ, Schork NJ. N-of-1临床试验：个性化医学的终极策略？个体化医学。2011年3月；8(2):161–173。doi: 10.2217/pme.11.7。PMID: 21695041；PMCID: PMC3118090。

[3] Daza EJ. 使用反事实框架进行N-of-1试验的自我追踪时间序列数据因果分析。方法与信息医学。2018年2月；57(1):e10-e21。doi: 10.3414/ME16–02–0044。2018年4月5日电子出版。PMID: 29621835；PMCID: PMC6087468。

[4] Schork, N. 个性化医学：是时候进行单人试验了。*自然* **520**，609–611（2015）。[https://doi.org/10.1038/520609a](https://doi.org/10.1038/520609a)
