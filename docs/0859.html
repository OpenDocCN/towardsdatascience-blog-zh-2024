<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Explore All Ways to Implement Data Security in Power BI with RLS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Explore All Ways to Implement Data Security in Power BI with RLS</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/explore-all-ways-to-implement-rls-rules-ee4a402db39a?source=collection_archive---------4-----------------------#2024-04-03">https://towardsdatascience.com/explore-all-ways-to-implement-rls-rules-ee4a402db39a?source=collection_archive---------4-----------------------#2024-04-03</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="5341" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx"><em class="hd">Implementing row-level security in Power BI is a recurring task for </em>developers. We use various techniques to do so<em class="hd">. Let’s look at some of them.</em></h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="he hf hg hh hi ab"><div><div class="ab hj"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@salvatorecagliari?source=post_page---byline--ee4a402db39a--------------------------------" rel="noopener follow"><div class="l hk hl by hm hn"><div class="l ed"><img alt="Salvatore Cagliari" class="l ep by dd de cx" src="../Images/a24b0cefab6e707cfee06cde9e857559.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/da:true/resize:fill:88:88/0*pOkUYGxmbbFyWocH"/><div class="ho by l dd de em n hp eo"/></div></div></a></div></div><div class="hq ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--ee4a402db39a--------------------------------" rel="noopener follow"><div class="l hr hs by hm ht"><div class="l ed"><img alt="Towards Data Science" class="l ep by br hu cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="ho by l br hu em n hp eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hv ab q"><div class="ab q hw"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hx hy bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hz" data-testid="authorName" href="https://medium.com/@salvatorecagliari?source=post_page---byline--ee4a402db39a--------------------------------" rel="noopener follow">Salvatore Cagliari</a></p></div></div></div><span class="ia ib" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hx hy dx"><button class="ic id ah ai aj ak al am an ao ap aq ar ie if ig" disabled="">Follow</button></p></div></div></span></div></div><div class="l ih"><span class="bf b bg z dx"><div class="ab cn ii ij ik"><div class="il im ab"><div class="bf b bg z dx ab in"><span class="io l ih">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hz ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--ee4a402db39a--------------------------------" rel="noopener follow"><p class="bf b bg z ip iq ir is it iu iv iw bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="ia ib" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">12 min read</span><div class="ix iy l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Apr 3, 2024</span></div></span></div></span></div></div></div><div class="ab cp iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo"><div class="h k w ea eb q"><div class="ke l"><div class="ab q kf kg"><div class="pw-multi-vote-icon ed io kh ki kj"><div class=""><div class="kk kl km kn ko kp kq am kr ks kt kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l ku kv kw kx ky kz la"><p class="bf b dy z dx"><span class="kl">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kk lb lc ab q ee ld le" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lf"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg></button></div></div></div><div class="ab q jp jq jr js jt ju jv jw jx jy jz ka kb kc kd"><div class="lg k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lh an ao ap ie li lj lk" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep ll cn"><div class="l ae"><div class="ab cb"><div class="lm ln lo lp lq lr ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lh an ao ap ie ls lt le lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lh an ao ap ie ls lt le lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lh an ao ap ie ls lt le lu lv lw lx ly s lz ma mb mc md me mf u mg mh mi"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk ml"><img src="../Images/60d3dfeaaf055fa3c953ebabf3927744.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*DOiMCg1Ivl0t5_sp"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Photo by <a class="af nc" href="https://unsplash.com/@davidclode?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">David Clode</a> on <a class="af nc" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="4d30" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Introduction</h1><p id="6381" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">When we regulate data access in Power BI solutions, we must implement RLS (Row-level security).</p><p id="9552" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">RLS works through the implementation of RLS Roles, which contain the access logic to control data access.</p><p id="76c9" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">This logic is defined by DAX expressions and can be very simple and all the way to very complex.</p><p id="452a" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">As I already wrote a few articles about this topic here on Medium, I decided to collect the different methods into one guide instead of having different places where you must search for information.</p><p id="921f" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">In the end, I will analyze them side-by-side and recommend which approach is the best.</p><p id="191e" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">I will reference my other pieces if available. You can find the links to them in the References section at the end of this piece.</p><h1 id="ca6f" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Variants</h1><p id="c371" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">We have the following variants to implement RLS:</p><ul class=""><li id="bb0d" class="nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou pa pb pc bk">Simple Lookup table</li><li id="4726" class="nz oa fq ob b go pd od oe gr pe og oh oi pf ok ol om pg oo op oq ph os ot ou pa pb pc bk">Using Hierarchies</li><li id="074c" class="nz oa fq ob b go pd od oe gr pe og oh oi pf ok ol om pg oo op oq ph os ot ou pa pb pc bk">Complex DAX Expressions</li><li id="f443" class="nz oa fq ob b go pd od oe gr pe og oh oi pf ok ol om pg oo op oq ph os ot ou pa pb pc bk">Bonus: Using SCD2 Dimensions</li></ul><h1 id="bab4" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">How to identify the users</h1><p id="b7be" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">You can jump to the next section if you are familiar with building RLS roles.</p><p id="0032" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Each RLS role uses one of the two basic approaches:</p><ol class=""><li id="0584" class="nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou pi pb pc bk">Identifying the user</li><li id="4b92" class="nz oa fq ob b go pd od oe gr pe og oh oi pf ok ol om pg oo op oq ph os ot ou pi pb pc bk">Applying an access-logic</li></ol><p id="f018" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">The first approach is based on a list of the users mapped to the data they have access to.</p><p id="e33c" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">So, when you have a table with a list of users (in the form of Mail Addresses), you can compare the current user using the <a class="af nc" href="https://dax.guide/userprincipalname/" rel="noopener ugc nofollow" target="_blank">USERPRINCIPALNAME()</a> function.</p><p id="51c8" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">The following Measure uses this Function to show the current user:</p><pre class="mm mn mo mp mq pj pk pl bp pm bb bk"><span id="cead" class="pn ne fq pk b bg po pp l pq pr">Current User = USERPRINCIPALNAME()</span></pre><p id="bbf2" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Now, I can add it to a Card Visual to get the following result:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk ps"><img src="../Images/dc3c8b2adfe42e7d386e7529805def5c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1150/format:webp/1*9yYkyYwQfraUTT6T4yFtqg.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Figure 1 — Result of simple Measure for the current User (Domain hidden for Data protection) (Figure by the Author)</figcaption></figure><p id="5fbb" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">I can use this function in my RLS role(s) to check the data against the current user.</p><p id="eed6" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">This is the basic principle of the first approach.</p><p id="6d8d" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">The other approach is to use DAX logic to implement an access logic. This logic can be simple or as complicated as needed.</p><p id="9b85" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">You will see two examples of this approach later on.</p><h1 id="a6c6" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Simple Lookup table</h1><p id="4297" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">This is the simplest approach.</p><p id="b03e" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">I need a list of users with a reference to the user who needs access to the data.</p><p id="72bb" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Each user has a reference to a subset of data within my data model.</p><p id="3684" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Consider the following table with the Sales Channels:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk pt"><img src="../Images/01688dffc52de40b790b123fdb9b2481.png" data-original-src="https://miro.medium.com/v2/resize:fit:918/format:webp/1*qsm8bTaS0unPlM2Lo9fDlQ.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Figure 2 — Channel table, which will be restricted by a lookup table (Figure by the Author)</figcaption></figure><p id="358a" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">I want to limit my users’ access to one or more defined channels.</p><p id="34b2" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">To achieve this, I need a table with the user mapping of the Channels.</p><p id="9fdb" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Something like this:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk pu"><img src="../Images/e9c55d82669724e2e1f25ee24a4cb441.png" data-original-src="https://miro.medium.com/v2/resize:fit:636/format:webp/1*MR9_c33SKhLGM5fAFdymvA.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Figure 3 — User-Mapping for the Channels (Figure by the Author)</figcaption></figure><p id="796a" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">I import this table into my Power BI file and add a Relationship to the Channel table.</p><p id="6013" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">But, in this case, I must change the Default Relationship between the two tables to this:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk pv"><img src="../Images/abc3e0b19edae5a895a7f5e1a26d529b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1340/format:webp/1*Hu9Tu09Xut8ki0ofvM_EvA.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Figure 4- Relationship between the Channel and the Channel-Accesslist tables (Figure by the Author)</figcaption></figure><p id="9389" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">These settings are necessary because Power BI would create a Many-to-One relationship, where the Channel table (on the one side) would filter the Channel-Accesslist table (on the Many side).</p><p id="16e7" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Therefore, I must change the Relationship settings to ensure that the Filter moves from the Channel-Accesslist to the Channel table and applies the security filter to it.</p><p id="36ca" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Next, I must create an RLS role for the Channel-Accesslist table:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk pw"><img src="../Images/661a4cd2079636128ad09b7c11fa2356.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gGPjzOyjh4r64Mh_iSbnJg.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Figure 5 — Create an RLS-Role for the Channel-Accesslist (Figure by the Author)</figcaption></figure><p id="eabd" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Don’t forget to click the Save button to save the role addition before closing the dialog.</p><p id="b819" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">This DAX expression must return either TRUE or FALSE, regardless of complexity. Returning a resultset or a value is not permitted.</p><p id="5dd9" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">To test the Access for John Doe, I can click on the “View as” button, select the RLS role I want to test and enter a Mail Address (which is the Principalusername) to apply the selected role to the given user:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk px"><img src="../Images/dfd572293fe3eaf0646370646cc0f31f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QaWJgm5js_caGrvESRNieg.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Figure 6 — Test the RLS role for John Doe (Figure by the Author)</figcaption></figure><p id="674f" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">When I test the Access, I will get this for John Doe:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk py"><img src="../Images/c144e774ef9fc2f52a3dd74b2172e1aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1214/format:webp/1*ZlzX31tBJmPsOwo8mZrsig.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Figure 7 — Result of RLS test for John Doe (Figure by the Author)</figcaption></figure><p id="c68a" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">This is the expected result.</p><h1 id="f673" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Using Hierarchies</h1><p id="3c7f" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">Using hierarchies with RLS is a slightly different story.</p><p id="2a49" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Let’s look at this example:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk pz"><img src="../Images/90942588cda99b3b13cf5d3b924b69c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:744/format:webp/1*VLl7dDLekikXxvJMpnFmCw.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Figure 8 — Example with product hierarchy (Figure by the Author)</figcaption></figure><p id="059e" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Now, let’s assume we have Salespeople responsible for single Product Categories. Therefore, they must see only the Subcategories and the Products assigned to them.</p><p id="956d" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">To set the permissions, we leverage Power BI possibilities to filter one column in a table and Cross-filter all other columns.</p><p id="e5cc" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Look at the following picture from the source database, which explains filter propagation for a Hierarchy (The Data is the same as in Power BI, but I renamed to columns in Power BI):</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk qa"><img src="../Images/ba5528001ad02becc33bae1fe47a8ddb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1066/format:webp/1*haEzoEBsb8886enQVT41_g.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Figure 9 — Filter propagation for a hierarchy (Figure by the Author)</figcaption></figure><p id="31d6" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">As you can see, when a Filter is applied to the Category column, it is automatically applied to the other columns, which define the hierarchy.</p><p id="f576" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Therefore, we only need a filter on the Category column.</p><p id="6ee3" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Of course, this only applies to hierarchies in this form.</p><p id="e168" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">If you have parent-child hierarchies, this doesn’t work anymore.</p><p id="2275" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">You can read this article to get a hint on how to solve this challenge:</p><div class="qb qc qd qe qf qg"><a href="https://medium.com/microsoft-power-bi/finding-managers-in-organizational-hierarchies-f3911a5f3e22?source=post_page-----ee4a402db39a--------------------------------" rel="noopener follow" target="_blank"><div class="qh ab ih"><div class="qi ab co cb qj qk"><h2 class="bf fr hx z ip ql ir is qm iu iw fp bk">Finding managers in organizational hierarchies</h2><div class="qn l"><h3 class="bf b hx z ip ql ir is qm iu iw dx">Organizational hierarchies are one of the most common hierarchies in data. But, finding managers can be challenging…</h3></div><div class="qo l"><p class="bf b dy z ip ql ir is qm iu iw dx">medium.com</p></div></div><div class="qp l"><div class="qq l qr qs qt qp qu lr qg"/></div></div></a></div><p id="6bc4" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">However, as Power BI doesn’t support parent-child hierarchies, we must flatten (Convert from parent-child to column-oriented) them in any case to use them meaningfully. I added a link to a helpful article showing how to do it in the References section at the end of this article.</p><p id="a155" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Now, back to the flattened hierarchy.</p><p id="9302" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">We have two possibilities now.</p><ol class=""><li id="b6e6" class="nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou pi pb pc bk">Create a table like in the first approach, assigning users to each Category.</li><li id="87c8" class="nz oa fq ob b go pd od oe gr pe og oh oi pf ok ol om pg oo op oq ph os ot ou pi pb pc bk">Create roles for each Category and assign the users to the role.</li></ol><p id="6a78" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">As mentioned, the first approach is the same as above.</p><p id="b9fa" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Therefore, I will show you the second approach.</p><p id="8af0" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Like before, I create an RLS role. But this time, the expression directly filters the Product Category.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qv"><img src="../Images/2cc0a6b0af93f937a7ddf9cd8ccf929c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*PgpJvuDTu4VMQ7ep3LzWjQ.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Figure 10 — Define RLS-Role for Product-Category “Computers” (Figure by the Author)</figcaption></figure><p id="03be" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">When I test the RLS-Role, this time without entering a User Mail-Address, I get this result:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk qw"><img src="../Images/321467d9ba7ee8ef1acc6ea79ca47473.png" data-original-src="https://miro.medium.com/v2/resize:fit:1126/format:webp/1*oKFXEuQZUIJXe9WikJCSkQ.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Figure 11 — Result of testing the RLS-Role for the “Computers” Category (Figure by the Author)</figcaption></figure><p id="8020" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Again, this is the expected result.</p><p id="1053" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Consequently, I need to create one RLS-Role for each product category.</p><p id="e686" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">This allows me to segregate the user access or give one user access to multiple product categories.</p><p id="68b5" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">However, as new Categories can be added to the data, I must add new RLS roles to cover access to them. Without a new role (Or roles), the new Category will not be visible to anyone.</p><h1 id="e641" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Complex DAX expressions</h1><p id="9f89" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">Whenever the access rules are too complicated to implement with a classic data model, I need a more sophisticated method to control access to the data.</p><p id="600f" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Here, we need complex DAX expressions.</p><p id="5707" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Consider this table:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk qx"><img src="../Images/e0088284f119fe3264e977115deea301.png" data-original-src="https://miro.medium.com/v2/resize:fit:1210/format:webp/1*euu0D4O7gLHBWdvhKazn2g.png"/></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Figure 12 — Access list per user and Category and Brand (Figure by the Author)</figcaption></figure><p id="9cd6" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Each listed user must have access only to the products in the assigned combination of category and brand.</p><p id="96c7" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">For example, John Doe has access to the Product categories “TV and Video” and “Computers” but only to the Brands “Contoso” and “Adventureworks”. And Sam Sample has access only to the Products Category “Home Appliances” from “Northwind Traders, “Litware” and “Proseware”, even though there are four more Brands for “Home Appliances”.</p><p id="2f41" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">As Power BI (like any other Tabular Model with Microsoft products) doesn’t allow creating Relationships between tables based on more than one column, I cannot integrate this table into the data model and use the standard method.</p><p id="d65a" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Therefore, I must create an RLS role using DAX.</p><p id="3c37" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">To find the matching rows between two tables, I use the <a class="af nc" href="https://dax.guide/lookupvalue/" rel="noopener ugc nofollow" target="_blank">LOOKUPVALUES()</a> function to apply an RLS role on the Product table:</p><pre class="mm mn mo mp mq pj pk pl bp pm bb bk"><span id="3509" class="pn ne fq pk b bg po pp l pq pr">NOT ISBLANK(<br/>  LOOKUPVALUE('Accesslist by Category and Brand'[UserMailaddress]<br/>                ,'Accesslist by Category and Brand'[Category]<br/>                  ,'Product'[Category]<br/>                ,'Accesslist by Category and Brand'[Brand]<br/>                  ,'Product'[Brand]<br/>                ,'Accesslist by Category and Brand'[UserMailaddress]<br/>                  ,USERPRINCIPALNAME()<br/>          )<br/>  )</span></pre><p id="dd69" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">As stated above, I must return either TRUE or FALSE. Therefore, I use <a class="af nc" href="https://dax.guide/op/not/" rel="noopener ugc nofollow" target="_blank">NOT</a> <a class="af nc" href="https://dax.guide/isblank/" rel="noopener ugc nofollow" target="_blank">ISBLANK()</a> to get the needed result. When I find a matching row, I get a non-blank result, and NOT ISBLANK() returns TRUE.</p><p id="19f6" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">When testing the RLS role with John Doe, I get the needed result:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qy"><img src="../Images/f9f513b1cf0211202cdf24b77525ccbc.png" data-original-src="https://miro.medium.com/v2/resize:fit:880/format:webp/1*eXsv9Eg9n-9DwsEIHVv6Ng.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Figure 13 — Result when applying the RLS role for the Category and the Brand to John Doe (Figure by the Author)</figcaption></figure><p id="9016" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">As this is a very simple expression, I wanted to find another way to do it to show you the possibilities of complex expressions.</p><p id="5782" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">This is the DAX expression I came up with as an RLS role on the Product table to show off my DAX skills:</p><pre class="mm mn mo mp mq pj pk pl bp pm bb bk"><span id="a348" class="pn ne fq pk b bg po pp l pq pr">CONTAINS(<br/>  -- Construct the table from the AccessList table<br/>  CALCULATETABLE(<br/>      SUMMARIZE('Accesslist by Category and Brand'<br/>                ,'Accesslist by Category and Brand'[Category]<br/>                ,'Accesslist by Category and Brand'[Brand]<br/>                )<br/><br/>  -- Filter the table by the current User<br/>  -- To get only the rows to which the User has access<br/>    ,'Accesslist by Category and Brand'[UserMailaddress] = USERPRINCIPALNAME()<br/>    )<br/><br/>  -- Compare the Rows from the AccessList table using COMBINE to the Product table<br/>  -- TRUE is returned only when the values correspond<br/>  ,'Accesslist by Category and Brand'[Category]<br/>  ,'Product'[Category]<br/>  ,'Accesslist by Category and Brand'[Brand]<br/>  ,'Product'[Brand]<br/>  )</span></pre><p id="11df" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">This approach shows that more complex expressions are possible as RLS roles and how to construct them in Power BI.</p><p id="8d9b" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">I use the approach in my article on developing and testing RLS Rules (Link in the References section below) to get the correct approach for the Expression.</p><p id="e70d" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Then, I use the approach in the DAX query to find the correct solution for the RLS editor.</p><p id="c555" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">In my approach, I use the <a class="af nc" href="https://dax.guide/contains/" rel="noopener ugc nofollow" target="_blank">CONTAINS()</a> function to compare the Access List with the Product table.</p><p id="480e" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">The CONTAINS() function allows me to compare multiple columns from two tables and find the matching rows.</p><p id="5c67" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">As you can see from the Comments in the expression, I construct the table from the AccessList table while filtering it with the USERPRINCIPALNAME() for the Input of CONTAINS().</p><p id="54fe" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Afterward, I compare the columns one by one to find the matching rows for the current user.</p><p id="c766" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">However, both RLS roles have a significant effect on performance.</p><p id="87f0" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">I observed a three times longer execution time than without the RLS role applied.</p><p id="e0a4" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">The rule is applied to each row of the Product table to determine whether the combination of Category and Brand is allowed in the result set.</p><p id="bc8b" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">OK, the DAX engine works more efficiently than explained here, but the principle is correct.</p><p id="e65f" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">What can be a more efficient alternative?</p><p id="cdaf" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">For example, I can add calculated columns as an artificial key to be able to add a Relationship between these two tables:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk qz"><img src="../Images/cad7af1ae4f0dfb4f8aa4fb96362a6d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*A37mhHr9kI5K0786cPolRw.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Figure 14 — Composite Keys with concatenated Category and Brand (Figure by the Author)</figcaption></figure><p id="bc5f" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">I used Power Query to add a calculated column to both tables (“Product” &amp; “Accesslist by Category and Brand”). Now I have a key column on both tables, which I can use for the Relationship:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk ra"><img src="../Images/b7a5d7be5928870eaaefd4d7e70985d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t9fh8EN_nXUdYQUGOjAlrw.png"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Figure 15 — Relationship using the CompositeKey columns (Figure by the Author)</figcaption></figure><p id="452b" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Now, I can use the first approach (RLS role expression: [UserMailaddress] = USERPRINCIPALNAME()) to implement the access control.</p><p id="1a55" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">The result is the same with all three approaches. But the last uses a much simpler and more efficient approach.</p><p id="308b" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Anyway, the example shown here is based on the limited possibilities in the Contoso data model.</p><p id="b4e0" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">You might find much more complex situations in your data that cannot be solved with the first approach. You must develop a DAX expression to implement the rule in such cases.</p><h1 id="1ea8" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Bonus: Using SCD2 Dimensions</h1><p id="7c97" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">The dimension tables will likely be historized when we access a classic Data warehouse.</p><p id="fc85" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Imagine that you, as a customer, are registered in a database of a company with multiple stores, which assigns you to a store based on your geographic location.</p><p id="fc94" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Over time, you might change your address. This might change the assignment to the geographic assignment.</p><p id="8f17" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">In such a case, two rows exist in the Data warehouse for you:</p><ul class=""><li id="1e41" class="nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou pa pb pc bk">One with the old Address</li><li id="5417" class="nz oa fq ob b go pd od oe gr pe og oh oi pf ok ol om pg oo op oq ph os ot ou pa pb pc bk">One with the new address</li></ul><p id="2caf" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Each row has a validity time (Valid-From and -To).</p><p id="870b" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">This means we must take extra care when defining the RLS role, considering which data we must allow access to and which we must not.</p><p id="0a33" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">This is necessary to ensure that the right salesperson can access your data for the correct validity window.</p><p id="2734" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">I already wrote an article on this topic, and I invite you to read it to learn more about it:</p><div class="qb qc qd qe qf qg"><a rel="noopener follow" target="_blank" href="/handling-historisations-in-power-bi-30dc43e9e6f?source=post_page-----ee4a402db39a--------------------------------"><div class="qh ab ih"><div class="qi ab co cb qj qk"><h2 class="bf fr hx z ip ql ir is qm iu iw fp bk">Handling historisations in Power BI</h2><div class="qn l"><h3 class="bf b hx z ip ql ir is qm iu iw dx">In reporting, historisation is everything. But besides the usual time series data, we need to look at the historisation…</h3></div><div class="qo l"><p class="bf b dy z ip ql ir is qm iu iw dx">towardsdatascience.com</p></div></div><div class="qp l"><div class="rb l qr qs qt qp qu lr qg"/></div></div></a></div><h1 id="7399" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">Conclusion</h1><p id="5cac" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">What I haven’t mentioned yet is that as soon as you publish the Power BI file to the Power BI Service, you must assign the users to the RLS roles to ensure that the rules are applied to them.</p><p id="c750" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Read this for more guidance:</p><div class="qb qc qd qe qf qg"><a href="https://learn.microsoft.com/en-us/power-bi/enterprise/service-admin-rls?source=post_page-----ee4a402db39a--------------------------------#working-with-members" rel="noopener  ugc nofollow" target="_blank"><div class="qh ab ih"><div class="qi ab co cb qj qk"><h2 class="bf fr hx z ip ql ir is qm iu iw fp bk">Row-level security (RLS) with Power BI - Power BI</h2><div class="qn l"><h3 class="bf b hx z ip ql ir is qm iu iw dx">How to configure row-level security for imported semantic models, and DirectQuery, within the Power BI service.</h3></div><div class="qo l"><p class="bf b dy z ip ql ir is qm iu iw dx">learn.microsoft.com</p></div></div><div class="qp l"><div class="rc l qr qs qt qp qu lr qg"/></div></div></a></div><p id="ff88" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">As you have seen, the most straightforward approach is the most efficient way to implement RLS roles.</p><p id="7aa6" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">In cases where complex rules must be applied, I try to translate them into an Access List that is as simple as possible. In an optimal case, this list resembles the example shown in the first approach.</p><p id="d368" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">This way, I avoid writing complicated DAX expressions in the RLS role and losing efficiency and performance.</p><p id="a9f9" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">In one of my projects, I was challenged to restrict two separate tables with the same List of permissions.</p><p id="9633" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">In that case, I duplicated the table with the User-/Access-List and filtered both tables with it.</p><p id="3a49" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Then, I added the same DAX-Expression as an RLS role to both tables, and the magic worked.</p><p id="621d" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">One of my colleagues once said, “I can make your Data model slow with little effort by implementing a complicated or inefficient RLS role.”</p><p id="03e0" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">This is very true, and we have to be careful not to be tempted to fall into the trap of being too ambitious and stuck to the idea of writing a cool DAX expression to show off our DAX competency.<br/> The user will not be very grateful for a slow Report.</p><p id="dd48" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">One more note when implementing RLS roles:</p><p id="d44c" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">SQLBI created an interesting video about limitations in DAX when RLS is in place:</p><figure class="mm mn mo mp mq mr"><div class="rd ip l ed"><div class="re rf l"/></div></figure><p id="95d7" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">It is essential to know these restrictions to avoid error messages or wrong results when writing DAX Measures.</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div role="button" tabindex="0" class="ms mt ed mu bh mv"><div class="mj mk rg"><img src="../Images/b05cf17aece3197f9296e2bca5b553e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*0e9EitfHkUXhwS3p"/></div></div><figcaption class="mx my mz mj mk na nb bf b bg z dx">Photo by <a class="af nc" href="https://unsplash.com/@aaronburden?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Aaron Burden</a> on <a class="af nc" href="https://unsplash.com/?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="bef1" class="nd ne fq bf nf ng nh gq ni nj nk gt nl nm nn no np nq nr ns nt nu nv nw nx ny bk">References</h1><p id="21a8" class="pw-post-body-paragraph nz oa fq ob b go oc od oe gr of og oh oi oj ok ol om on oo op oq or os ot ou fj bk">Microsoft documentation on Row-level security in Power BI:</p><div class="qb qc qd qe qf qg"><a href="https://learn.microsoft.com/en-us/power-bi/enterprise/service-admin-rls?source=post_page-----ee4a402db39a--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qh ab ih"><div class="qi ab co cb qj qk"><h2 class="bf fr hx z ip ql ir is qm iu iw fp bk">Row-level security (RLS) with Power BI - Power BI</h2><div class="qn l"><h3 class="bf b hx z ip ql ir is qm iu iw dx">How to configure row-level security for imported semantic models, and DirectQuery, within the Power BI service.</h3></div><div class="qo l"><p class="bf b dy z ip ql ir is qm iu iw dx">learn.microsoft.com</p></div></div><div class="qp l"><div class="rh l qr qs qt qp qu lr qg"/></div></div></a></div><p id="6873" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">To transform the parent-child hierarchy into a classic hierarchy, I follow the methods described by Data Mozart:</p><div class="qb qc qd qe qf qg"><a href="https://data-mozart.com/finding-the-right-path-understanding-parent-child-hierarchies-in-power-bi/?source=post_page-----ee4a402db39a--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qh ab ih"><div class="qi ab co cb qj qk"><h2 class="bf fr hx z ip ql ir is qm iu iw fp bk">Finding the right PATH - Understanding parent-child hierarchies in Power BI! - Data Mozart</h2><div class="qn l"><h3 class="bf b hx z ip ql ir is qm iu iw dx">Different data source systems store the data in different ways! Parent-child hierarchies may be a decent challenge to…</h3></div><div class="qo l"><p class="bf b dy z ip ql ir is qm iu iw dx">data-mozart.com</p></div></div><div class="qp l"><div class="ri l qr qs qt qp qu lr qg"/></div></div></a></div><p id="a958" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">This Article by RADACAD explains how to implement RLS with an organizational hierarchy:</p><div class="qb qc qd qe qf qg"><a href="https://radacad.com/dynamic-row-level-security-in-power-bi-with-organizational-hierarchy-and-multiple-positions-in-many-to-many-relationship-part-1?source=post_page-----ee4a402db39a--------------------------------" rel="noopener  ugc nofollow" target="_blank"><div class="qh ab ih"><div class="qi ab co cb qj qk"><h2 class="bf fr hx z ip ql ir is qm iu iw fp bk">Dynamic Row Level Security in Power BI with Organizational Hierarchy and Multiple Positions in…</h2><div class="qn l"><h3 class="bf b hx z ip ql ir is qm iu iw dx">I have written previously about Dynamic Row Level Security, and some of the patterns of it. Two of the most common…</h3></div><div class="qo l"><p class="bf b dy z ip ql ir is qm iu iw dx">radacad.com</p></div></div><div class="qp l"><div class="rj l qr qs qt qp qu lr qg"/></div></div></a></div><p id="45ca" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Here are the links to all the articles I wrote about implementing RLS Rules and all other related topics.</p><div class="qb qc qd qe qf qg"><a rel="noopener follow" target="_blank" href="/handling-historisations-in-power-bi-30dc43e9e6f?source=post_page-----ee4a402db39a--------------------------------"><div class="qh ab ih"><div class="qi ab co cb qj qk"><h2 class="bf fr hx z ip ql ir is qm iu iw fp bk">Handling historisations in Power BI</h2><div class="qn l"><h3 class="bf b hx z ip ql ir is qm iu iw dx">In reporting, historisation is everything. But besides the usual time series data, we need to look at the historisation…</h3></div><div class="qo l"><p class="bf b dy z ip ql ir is qm iu iw dx">towardsdatascience.com</p></div></div><div class="qp l"><div class="rb l qr qs qt qp qu lr qg"/></div></div></a></div><div class="qb qc qd qe qf qg"><a rel="noopener follow" target="_blank" href="/develop-and-test-rls-rules-in-power-bi-9dc705945feb?source=post_page-----ee4a402db39a--------------------------------"><div class="qh ab ih"><div class="qi ab co cb qj qk"><h2 class="bf fr hx z ip ql ir is qm iu iw fp bk">Develop and test RLS Rules in Power BI</h2><div class="qn l"><h3 class="bf b hx z ip ql ir is qm iu iw dx">Very often, not all Users should have permission to access all data in a Report. Here I will explain how to develop RLS…</h3></div><div class="qo l"><p class="bf b dy z ip ql ir is qm iu iw dx">towardsdatascience.com</p></div></div><div class="qp l"><div class="rk l qr qs qt qp qu lr qg"/></div></div></a></div><div class="qb qc qd qe qf qg"><a rel="noopener follow" target="_blank" href="/how-to-get-performance-data-from-power-bi-with-dax-studio-b7f11b9dd9f9?source=post_page-----ee4a402db39a--------------------------------"><div class="qh ab ih"><div class="qi ab co cb qj qk"><h2 class="bf fr hx z ip ql ir is qm iu iw fp bk">How to get performance data from Power BI with DAX Studio</h2><div class="qn l"><h3 class="bf b hx z ip ql ir is qm iu iw dx">Sometimes we have a slow Report, and we need to figure out why. We will see how to collect performance data and the…</h3></div><div class="qo l"><p class="bf b dy z ip ql ir is qm iu iw dx">towardsdatascience.com</p></div></div><div class="qp l"><div class="rl l qr qs qt qp qu lr qg"/></div></div></a></div><p id="a3fb" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">I use the Contoso sample dataset, as I did in my previous articles. You can download the ContosoRetailDW Dataset for free from Microsoft <a class="af nc" href="https://www.microsoft.com/en-us/download/details.aspx?id=18279" rel="noopener ugc nofollow" target="_blank">here</a>.</p><p id="584e" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">The Contoso Data can be freely used under the MIT License, as described <a class="af nc" href="https://github.com/microsoft/Power-BI-Embedded-Contoso-Sales-Demo" rel="noopener ugc nofollow" target="_blank">here</a>.</p><div class="qb qc qd qe qf qg"><a href="https://medium.com/@salvatorecagliari/subscribe?source=post_page-----ee4a402db39a--------------------------------" rel="noopener follow" target="_blank"><div class="qh ab ih"><div class="qi ab co cb qj qk"><h2 class="bf fr hx z ip ql ir is qm iu iw fp bk">Get an email whenever Salvatore Cagliari publishes.</h2><div class="qn l"><h3 class="bf b hx z ip ql ir is qm iu iw dx">Get an email whenever Salvatore Cagliari publishes. By signing up, you will create a Medium account if you don't…</h3></div><div class="qo l"><p class="bf b dy z ip ql ir is qm iu iw dx">medium.com</p></div></div><div class="qp l"><div class="rm l qr qs qt qp qu lr qg"/></div></div></a></div><p id="d315" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">I make my articles accessible to everyone, even though Medium has a paywall. This allows me to earn a little for each reader, but I turn it off so you can read my pieces without cost.</p><p id="1362" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">You can support my work, which I do during my free time, through</p><p id="0b1a" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk"><a class="af nc" href="https://buymeacoffee.com/salvatorecagliari" rel="noopener ugc nofollow" target="_blank">https://buymeacoffee.com/salvatorecagliari</a></p><p id="a530" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Or scan this QR Code:</p><figure class="mm mn mo mp mq mr mj mk paragraph-image"><div class="mj mk rn"><img src="../Images/e7ac062070dcd7a00dcf995ad7e95434.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*btH95UXO7gboS30eZMk6ug.png"/></div></figure><p id="2912" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Any support is greatly appreciated and helps me find more time to create more content for you.</p><p id="3543" class="pw-post-body-paragraph nz oa fq ob b go ov od oe gr ow og oh oi ox ok ol om oy oo op oq oz os ot ou fj bk">Thank you a lot.</p></div></div></div></div>    
</body>
</html>