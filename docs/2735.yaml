- en: Creating Dynamic Pivots on Snowflake Tables with dbt
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://towardsdatascience.com/creating-dynamic-pivots-on-snowflake-tables-with-dbt-9f61457b0adf?source=collection_archive---------3-----------------------#2024-11-09](https://towardsdatascience.com/creating-dynamic-pivots-on-snowflake-tables-with-dbt-9f61457b0adf?source=collection_archive---------3-----------------------#2024-11-09)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Leverage dbt and its advanced scripting functionality to generate dynamic pivot
    tables that adapt to changing pivot values
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '[](https://medium.com/@broepke?source=post_page---byline--9f61457b0adf--------------------------------)[![Brian
    Roepke](../Images/0b7ef72cbfc9acda69fde14127d65dcf.png)](https://medium.com/@broepke?source=post_page---byline--9f61457b0adf--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--9f61457b0adf--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--9f61457b0adf--------------------------------)
    [Brian Roepke](https://medium.com/@broepke?source=post_page---byline--9f61457b0adf--------------------------------)'
  prefs: []
  type: TYPE_NORMAL
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--9f61457b0adf--------------------------------)
    ·6 min read·Nov 9, 2024
  prefs: []
  type: TYPE_NORMAL
- en: --
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/29f9a6689356cfa53648b58e68f1b501.png)'
  prefs: []
  type: TYPE_IMG
- en: Photo by [Possessed Photography](https://unsplash.com/@possessedphotography?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  prefs: []
  type: TYPE_NORMAL
- en: What are Pivoted Tables?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: When dealing with tabular data, you often will have that data laid out in a
    format that best suits day-to-day operations. For example, rows that represent
    purchase transactions for different customers.
  prefs: []
  type: TYPE_NORMAL
- en: A pivot table allows you to rotate rows into columns, creating a more organized
    and digestible format for large datasets. You can also aggregate data, such as
    calculating sums, averages, or counts, and display these results as unique columns
    for each summarized category.
  prefs: []
  type: TYPE_NORMAL
- en: Let’s take a look at a visual that will help describe it. Here, we’re grouping
    by the user value, then taking the sum of the count of each transaction and creating
    a unique column for each product.
  prefs: []
  type: TYPE_NORMAL
- en: '![](../Images/8c1fe2260e7376d743d8c0089421a221.png)'
  prefs: []
  type: TYPE_IMG
- en: Image by Author
  prefs: []
  type: TYPE_NORMAL
- en: The Manual Approach
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Most of us will approach this by writing SQL with case statements for each category.
    While this works for simple cases, if you…
  prefs: []
  type: TYPE_NORMAL
