["```py\nDESCRIBE SELECT * FROM ST_READOSM('monaco-latest.osm.pbf');\n\n┌─────────────┬──────────────────────────────────────────────┬─────────┬─────────┬─────────┬─────────┐\n│ column_name │                 column_type                  │  null   │   key   │ default │  extra  │\n│   varchar   │                   varchar                    │ varchar │ varchar │ varchar │ varchar │\n├─────────────┼──────────────────────────────────────────────┼─────────┼─────────┼─────────┼─────────┤\n│ kind        │ ENUM('node', 'way', 'relation', 'changeset') │ YES     │ NULL    │ NULL    │ NULL    │\n│ id          │ BIGINT                                       │ YES     │ NULL    │ NULL    │ NULL    │\n│ tags        │ MAP(VARCHAR, VARCHAR)                        │ YES     │ NULL    │ NULL    │ NULL    │\n│ refs        │ BIGINT[]                                     │ YES     │ NULL    │ NULL    │ NULL    │\n│ lat         │ DOUBLE                                       │ YES     │ NULL    │ NULL    │ NULL    │\n│ lon         │ DOUBLE                                       │ YES     │ NULL    │ NULL    │ NULL    │\n│ ref_roles   │ VARCHAR[]                                    │ YES     │ NULL    │ NULL    │ NULL    │\n│ ref_types   │ ENUM('node', 'way', 'relation')[]            │ YES     │ NULL    │ NULL    │ NULL    │\n└─────────────┴──────────────────────────────────────────────┴─────────┴─────────┴─────────┴─────────┘\n```", "```py\nSELECT COUNT(*) as total_elements\nFROM ST_READOSM('monaco-latest.osm.pbf');\n\n┌────────────────┐\n│ total_elements │\n│     int64      │\n├────────────────┤\n│          35782 │\n└────────────────┘\n\nSELECT kind, COUNT(*) as total_elements\nFROM ST_READOSM('monaco-latest.osm.pbf')\nGROUP BY 1;\n\n┌──────────────────────────────────────────────┬────────────────┐\n│                     kind                     │ total_features │\n│ enum('node', 'way', 'relation', 'changeset') │     int64      │\n├──────────────────────────────────────────────┼────────────────┤\n│ node                                         │          30643 │\n│ way                                          │           4849 │\n│ relation                                     │            290 │\n└──────────────────────────────────────────────┴────────────────┘\n```", "```py\nSELECT *\nFROM ST_READOSM('monaco-latest.osm.pbf')\nWHERE kind = 'node'\nLIMIT 5;\n\n┌──────────────────────┬──────────┬─────────────────────────────┬─────────┬────────────────────┬────────────────────┬───────────┬───────────────────────────────────┐\n│         kind         │    id    │            tags             │  refs   │        lat         │        lon         │ ref_roles │             ref_types             │\n│ enum('node', 'way'…  │  int64   │    map(varchar, varchar)    │ int64[] │       double       │       double       │ varchar[] │ enum('node', 'way', 'relation')[] │\n├──────────────────────┼──────────┼─────────────────────────────┼─────────┼────────────────────┼────────────────────┼───────────┼───────────────────────────────────┤\n│ node                 │ 21911883 │                             │         │ 43.737117500000004 │  7.422909300000001 │           │                                   │\n│ node                 │ 21911886 │ {crossing=zebra, crossing…  │         │ 43.737239900000006 │  7.423498500000001 │           │                                   │\n│ node                 │ 21911894 │                             │         │ 43.737773100000005 │          7.4259193 │           │                                   │\n│ node                 │ 21911901 │                             │         │ 43.737762100000005 │ 7.4267099000000005 │           │                                   │\n│ node                 │ 21911908 │                             │         │         43.7381906 │           7.426961 │           │                                   │\n└──────────────────────┴──────────┴─────────────────────────────┴─────────┴────────────────────┴────────────────────┴───────────┴───────────────────────────────────┘\n\nSELECT *\nFROM ST_READOSM('monaco-latest.osm.pbf')\nWHERE kind = 'way'\nLIMIT 5;\n\n┌──────────────────────┬─────────┬──────────────────────┬─────────────────────────────────────────┬────────┬────────┬───────────┬───────────────────────────────────┐\n│         kind         │   id    │         tags         │                  refs                   │  lat   │  lon   │ ref_roles │             ref_types             │\n│ enum('node', 'way'…  │  int64  │ map(varchar, varch…  │                 int64[]                 │ double │ double │ varchar[] │ enum('node', 'way', 'relation')[] │\n├──────────────────────┼─────────┼──────────────────────┼─────────────────────────────────────────┼────────┼────────┼───────────┼───────────────────────────────────┤\n│ way                  │ 4097656 │ {highway=secondary…  │ [21912089, 7265761724, 1079750744, 21…  │        │        │           │                                   │\n│ way                  │ 4098197 │ {highway=tertiary,…  │ [21918500, 10723812919, 1204288480, 2…  │        │        │           │                                   │\n│ way                  │ 4224972 │ {highway=residenti…  │ [25177418, 4939779378, 4939779381, 49…  │        │        │           │                                   │\n│ way                  │ 4224978 │ {access=no, addr:c…  │ [25178088, 25178091, 25178045, 251780…  │        │        │           │                                   │\n│ way                  │ 4226740 │ {highway=secondary…  │ [25192130, 6444966483, 1737389127, 64…  │        │        │           │                                   │\n└──────────────────────┴─────────┴──────────────────────┴─────────────────────────────────────────┴────────┴────────┴───────────┴───────────────────────────────────┘\n\nSELECT *\nFROM ST_READOSM('monaco-latest.osm.pbf')\nWHERE kind = 'relation'\nLIMIT 5;\n\n┌──────────────────────┬───────┬──────────────────────┬──────────────────────┬────────┬────────┬──────────────────────┬─────────────────────────────────────────────┐\n│         kind         │  id   │         tags         │         refs         │  lat   │  lon   │      ref_roles       │                  ref_types                  │\n│ enum('node', 'way'…  │ int64 │ map(varchar, varch…  │       int64[]        │ double │ double │      varchar[]       │      enum('node', 'way', 'relation')[]      │\n├──────────────────────┼───────┼──────────────────────┼──────────────────────┼────────┼────────┼──────────────────────┼─────────────────────────────────────────────┤\n│ relation             │  7385 │ {ISO3166-2=FR-06, …  │ [1701090139, 32665…  │        │        │ [admin_centre, lab…  │ [node, node, way, way, way, way, way, way…  │\n│ relation             │  8654 │ {ISO3166-2=FR-PAC,…  │ [26761400, 1251610…  │        │        │ [admin_centre, lab…  │ [node, node, way, way, way, way, way, way…  │\n│ relation             │ 11980 │ {ISO3166-1=FR, ISO…  │ [17807753, 1363947…  │        │        │ [admin_centre, lab…  │ [node, node, relation, relation, relation…  │\n│ relation             │ 36990 │ {ISO3166-1=MC, ISO…  │ [1790048269, 77077…  │        │        │ [admin_centre, out…  │ [node, way, way, way, way, way, way, way,…  │\n│ relation             │ 90352 │ {admin_level=2, bo…  │ [770774507, 377944…  │        │        │ [outer, outer, out…  │ [way, way, way, way, way, way, way, way, …  │\n└──────────────────────┴───────┴──────────────────────┴──────────────────────┴────────┴────────┴──────────────────────┴─────────────────────────────────────────────┘\n```", "```py\nSELECT\n    id,\n    tags,\n    ST_POINT(lon, lat) geometry\nFROM ST_READOSM('monaco-latest.osm.pbf')\nWHERE kind = 'node'\n    AND tags IS NOT NULL\n    AND cardinality(tags) > 0;\n\n┌─────────────┬─────────────────────────────────────────────────────────┬──────────────────────────────────────────────┐\n│     id      │                          tags                           │                   geometry                   │\n│    int64    │                  map(varchar, varchar)                  │                   geometry                   │\n├─────────────┼─────────────────────────────────────────────────────────┼──────────────────────────────────────────────┤\n│    21911886 │ {crossing=zebra, crossing:island=no, crossing_ref=zeb…  │ POINT (7.423498500000001 43.737239900000006) │\n│    21912962 │ {crossing=zebra, crossing_ref=zebra, highway=crossing}  │ POINT (7.426912100000001 43.737912800000004) │\n│    21914341 │ {crossing=uncontrolled, crossing_ref=zebra, highway=c…  │ POINT (7.4233732 43.737010000000005)         │\n│    21915639 │ {highway=traffic_signals}                               │ POINT (7.4256003 43.7404449)                 │\n│    21917308 │ {bus=yes, name=Monte-Carlo (Casino), public_transport…  │ POINT (7.4259854 43.740984700000006)         │\n│    21918329 │ {crossing=marked, crossing:markings=yes, highway=cros…  │ POINT (7.427889100000001 43.7423616)         │\n│    21918589 │ {crossing=marked, crossing:island=yes, crossing:marki…  │ POINT (7.4317478 43.7472774)                 │\n│    21918697 │ {crossing=marked, crossing:island=no, crossing:markin…  │ POINT (7.432645000000001 43.747892900000004) │\n│    21918939 │ {bus=yes, name=Portier, public_transport=stop_position} │ POINT (7.430429800000001 43.741472800000004) │\n│    21919093 │ {crossing=marked, crossing:markings=yes, crossing_ref…  │ POINT (7.4352171 43.748160000000006)         │\n│        ·    │                   ·                                     │                  ·                           │\n│        ·    │                   ·                                     │                  ·                           │\n│        ·    │                   ·                                     │                  ·                           │\n│ 11450012980 │ {direction=forward, highway=give_way}                   │ POINT (7.416853100000001 43.735809700000004) │\n│ 11450012981 │ {direction=forward, highway=give_way}                   │ POINT (7.416783000000001 43.735872900000004) │\n│ 11450012982 │ {direction=forward, highway=give_way}                   │ POINT (7.416664900000001 43.735887000000005) │\n│ 11450012983 │ {direction=forward, highway=give_way}                   │ POINT (7.4166968 43.7356945)                 │\n│ 11451922579 │ {bus=yes, highway=bus_stop, name=Larvotto, public_tra…  │ POINT (7.435032400000001 43.7481639)         │\n│ 11451922580 │ {bus=yes, highway=bus_stop, name=Grimaldi Forum, publ…  │ POINT (7.4311343 43.7442067)                 │\n│ 11451922581 │ {bench=yes, bus=yes, highway=bus_stop, name=Portier, …  │ POINT (7.430357300000001 43.742209100000004) │\n│ 11451922582 │ {bench=no, bin=no, bus=yes, highway=bus_stop, lit=yes…  │ POINT (7.4107674 43.7296193)                 │\n│ 11451922600 │ {direction=backward, highway=give_way}                  │ POINT (7.4105622 43.7291648)                 │\n│ 11452057060 │ {direction=backward, highway=give_way}                  │ POINT (7.419164 43.737116)                   │\n├─────────────┴─────────────────────────────────────────────────────────┴──────────────────────────────────────────────┤\n│ 3167 rows (20 shown)                                                                                       3 columns │\n└──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘\n```", "```py\nCREATE TEMP TABLE matching_ways AS \nSELECT id, tags\nFROM ST_READOSM('monaco-latest.osm.pbf')\nWHERE kind = 'way' AND tags IS NOT NULL AND cardinality(tags) > 0;\n\nSELECT * FROM matching_ways;\n\n┌────────────┬─────────────────────────────────────────────────────────────────┐\n│     id     │                              tags                               │\n│   int64    │                      map(varchar, varchar)                      │\n├────────────┼─────────────────────────────────────────────────────────────────┤\n│    4097656 │ {highway=secondary, lanes=2, lit=yes, maxspeed=30, name=Avenu…  │\n│    4098197 │ {highway=tertiary, lanes=2, lit=yes, name=Boulevard d`Italie,…  │\n│    4224972 │ {highway=residential, lit=yes, name=Avenue des Papalins, onew…  │\n│    4224978 │ {access=no, addr:country=MC, leisure=pitch, lit=yes, sport=so…  │\n│    4226740 │ {highway=secondary, lanes=2, lit=yes, maxspeed=50, name=Boule…  │\n│    4227155 │ {area=yes, highway=pedestrian, lit=yes, name=Place du Palais,…  │\n│    4227156 │ {access=no, bus=yes, demolished:highway=service, oneway=yes, …  │\n│    4227157 │ {highway=residential, name=Rue des Remparts, oneway=yes, surf…  │\n│    4227158 │ {highway=residential, name=Rue Philibert Florence, oneway=yes…  │\n│    4227164 │ {highway=secondary, lanes=2, lit=yes, name=Virage Antony Nogu…  │\n│       ·    │                                ·                                │\n│       ·    │                                ·                                │\n│       ·    │                                ·                                │\n│ 1230247124 │ {bench=no, bin=yes, bus=yes, check_date=2023-12-10, covered=y…  │\n│ 1230273018 │ {access=yes, leisure=playground, wheelchair=yes}                │\n│ 1230273019 │ {highway=footway, surface=paving_stones}                        │\n│ 1230398878 │ {abandoned:railway=rail, highway=primary, lanes=2, lit=yes, m…  │\n│ 1233828725 │ {highway=service, lit=yes, name=Place Moulins, oneway=yes}      │\n│ 1233828726 │ {highway=tertiary, junction=roundabout, lanes=2, lit=yes, non…  │\n│ 1233853668 │ {highway=secondary, lanes=2, lit=yes, maxspeed=50, name=Boule…  │\n│ 1238339144 │ {cycleway:left=lane, highway=tertiary, lanes=2, lit=yes, maxs…  │\n│ 1238339145 │ {cycleway:left=lane, highway=tertiary, lanes=2, lit=yes, maxs…  │\n│ 1239415633 │ {footway=sidewalk, highway=footway}                             │\n├────────────┴─────────────────────────────────────────────────────────────────┤\n│ 4786 rows (20 shown)                                               2 columns │\n└──────────────────────────────────────────────────────────────────────────────┘\n```", "```py\nCREATE TEMP TABLE matching_ways_with_nodes_refs AS\nSELECT id, UNNEST(refs) as ref, UNNEST(range(length(refs))) as ref_idx\nFROM ST_READOSM('monaco-latest.osm.pbf')\nSEMI JOIN matching_ways USING (id)\nWHERE kind = 'way';\n\nSELECT * FROM matching_ways_with_nodes_refs;\n\n┌───────────┬────────────┬─────────┐\n│    id     │    ref     │ ref_idx │\n│   int64   │   int64    │  int64  │\n├───────────┼────────────┼─────────┤\n│   4097656 │   21912089 │       0 │\n│   4097656 │ 7265761724 │       1 │\n│   4097656 │ 1079750744 │       2 │\n│   4097656 │ 2104793864 │       3 │\n│   4097656 │ 6340961560 │       4 │\n│   4097656 │ 1110560507 │       5 │\n│   4097656 │   21912093 │       6 │\n│   4097656 │ 6340961559 │       7 │\n│   4097656 │   21912095 │       8 │\n│   4097656 │ 7265762803 │       9 │\n│      ·    │      ·     │       · │\n│      ·    │      ·     │       · │\n│      ·    │      ·     │       · │\n│ 151154357 │ 7927855820 │       2 │\n│ 151154358 │ 1868015912 │       0 │\n│ 151154358 │ 1868015910 │       1 │\n│ 151154358 │ 1868015900 │       2 │\n│ 151154358 │ 4437858221 │       3 │\n│ 151154358 │ 1868015889 │       4 │\n│ 151154358 │ 1790048390 │       5 │\n│ 151154358 │ 1868015881 │       6 │\n│ 151154358 │ 1868015894 │       7 │\n│ 151154358 │ 1868015896 │       8 │\n├───────────┴────────────┴─────────┤\n│  ? rows (>9999 rows, 20 shown)   │\n└──────────────────────────────────┘\n```", "```py\nCREATE TEMP TABLE required_nodes_with_geometries AS\nSELECT id, ST_POINT(lon, lat) geometry\nFROM ST_READOSM('monaco-latest.osm.pbf') nodes\nSEMI JOIN matching_ways_with_nodes_refs\nON nodes.id = matching_ways_with_nodes_refs.ref\nWHERE kind = 'node';\n\nSELECT * FROM required_nodes_with_geometries;\n\n┌────────────┬──────────────────────────────────────────────┐\n│     id     │                   geometry                   │\n│   int64    │                   geometry                   │\n├────────────┼──────────────────────────────────────────────┤\n│ 4547239708 │ POINT (7.4219302 43.7307441)                 │\n│ 4547239709 │ POINT (7.421943700000001 43.730763)          │\n│ 4547239710 │ POINT (7.421885100000001 43.7308797)         │\n│ 4547239711 │ POINT (7.421869 43.730828200000005)          │\n│ 4547239712 │ POINT (7.4218596 43.7307865)                 │\n│ 4547239713 │ POINT (7.4219166 43.7307701)                 │\n│ 4547239714 │ POINT (7.4220242 43.730742)                  │\n│ 4547239715 │ POINT (7.4220765 43.730725500000005)         │\n│ 4547239716 │ POINT (7.4220677 43.730680400000004)         │\n│ 4547239717 │ POINT (7.422105200000001 43.730662)          │\n│      ·     │                  ·                           │\n│      ·     │                  ·                           │\n│      ·     │                  ·                           │\n│ 9983243582 │ POINT (7.427689600000001 43.732439400000004) │\n│ 9983243583 │ POINT (7.4238021 43.7298837)                 │\n│ 9983243584 │ POINT (7.4272774 43.7321503)                 │\n│ 9983243585 │ POINT (7.4287133 43.7403807)                 │\n│ 9983243586 │ POINT (7.429299500000001 43.740351100000005) │\n│ 9983243587 │ POINT (7.4265819 43.7399094)                 │\n│ 9983243588 │ POINT (7.4275342 43.7323072)                 │\n│ 9983243589 │ POINT (7.427783700000001 43.732368)          │\n│ 9983243590 │ POINT (7.428839600000001 43.7402718)         │\n│ 9983243591 │ POINT (7.4269439 43.739707700000004)         │\n├────────────┴──────────────────────────────────────────────┤\n│ ? rows (>9999 rows, 20 shown)                   2 columns │\n└───────────────────────────────────────────────────────────┘\n```", "```py\nCREATE TEMP TABLE matching_ways_linestrings AS\nSELECT\n    matching_ways.id,\n    matching_ways.tags,\n    ST_MakeLine(list(nodes.geometry ORDER BY ref_idx ASC)) linestring\nFROM matching_ways\nJOIN matching_ways_with_nodes_refs\nON matching_ways.id = matching_ways_with_nodes_refs.id\nJOIN required_nodes_with_geometries nodes\nON matching_ways_with_nodes_refs.ref = nodes.id\nGROUP BY 1, 2;\n\nSELECT * FROM matching_ways_linestrings;\n\n┌────────────┬──────────────────────┬──────────────────────────────────────────┐\n│     id     │         tags         │                linestring                │\n│   int64    │ map(varchar, varch…  │                 geometry                 │\n├────────────┼──────────────────────┼──────────────────────────────────────────┤\n│    4227212 │ {highway=residenti…  │ LINESTRING (7.424979 43.73150620000000…  │\n│    4227230 │ {access=yes, admin…  │ LINESTRING (7.4220576 43.7321018, 7.42…  │\n│    4227273 │ {highway=secondary…  │ LINESTRING (7.4214168 43.7365583000000…  │\n│    4229325 │ {highway=secondary…  │ LINESTRING (7.4201113 43.7373194000000…  │\n│    4229900 │ {highway=secondary…  │ LINESTRING (7.4167819 43.7299324, 7.41…  │\n│    4230116 │ {highway=footway, …  │ LINESTRING (7.4302666 43.7467818, 7.43…  │\n│   24672725 │ {highway=residenti…  │ LINESTRING (7.4356746 43.7516752, 7.43…  │\n│   25082701 │ {area=yes, highway…  │ LINESTRING (7.421602 43.7370201, 7.421…  │\n│   31900562 │ {area=yes, floatin…  │ LINESTRING (7.422541900000001 43.73529…  │\n│   37794470 │ {admin_level=2, bo…  │ LINESTRING (7.438411400000001 43.74942…  │\n│       ·    │        ·             │                    ·                     │\n│       ·    │        ·             │                    ·                     │\n│       ·    │        ·             │                    ·                     │\n│ 1203859766 │ {landuse=grass}      │ LINESTRING (7.4172849 43.7324023000000…  │\n│ 1203859775 │ {landuse=grass}      │ LINESTRING (7.417039300000001 43.73209…  │\n│ 1218054879 │ {highway=footway, …  │ LINESTRING (7.4257143 43.7307631000000…  │\n│ 1229465608 │ {amenity=shelter, …  │ LINESTRING (7.417716100000001 43.73075…  │\n│ 1230102086 │ {footway=crossing,…  │ LINESTRING (7.414346 43.72708160000000…  │\n│ 1230123519 │ {footway=link, hig…  │ LINESTRING (7.4238967 43.7370229, 7.42…  │\n│ 1202747620 │ {crossing=unmarked…  │ LINESTRING (7.420526100000001 43.72671…  │\n│ 1203858289 │ {crossing=uncontro…  │ LINESTRING (7.4179021 43.7344211000000…  │\n│ 1203861575 │ {amenity=parking}    │ LINESTRING (7.430036100000001 43.74015…  │\n│ 1203861579 │ {landuse=construct…  │ LINESTRING (7.4323636 43.7423150000000…  │\n├────────────┴──────────────────────┴──────────────────────────────────────────┤\n│ 4786 rows (20 shown)                                               3 columns │\n└──────────────────────────────────────────────────────────────────────────────┘\n```", "```py\nWITH way_polygon_feature AS (\n    SELECT\n        id,\n        (\n            -- if first and last nodes are the same\n            ST_Equals(ST_StartPoint(linestring), ST_EndPoint(linestring))\n            -- if the element doesn't have any tags leave it as a Linestring\n            AND tags IS NOT NULL\n            -- if the element is specifically tagged 'area':'no' -> LineString\n            AND NOT (\n                list_contains(map_keys(tags), 'area')\n                AND list_extract(map_extract(tags, 'area'), 1) = 'no'\n            )\n        ) AS is_polygon\n    FROM matching_ways_linestrings\n)\nSELECT\n    matching_ways_linestrings.id,\n    matching_ways_linestrings.tags,\n    (CASE\n        WHEN is_polygon\n        THEN ST_MakePolygon(linestring)\n        ELSE linestring\n    END)::GEOMETRY AS geometry\nFROM matching_ways_linestrings\nJOIN way_polygon_feature\nON matching_ways_linestrings.id = way_polygon_feature.id;\n\n┌────────────┬──────────────────────┬──────────────────────────────────────────┐\n│     id     │         tags         │                 geometry                 │\n│   int64    │ map(varchar, varch…  │                 geometry                 │\n├────────────┼──────────────────────┼──────────────────────────────────────────┤\n│    4226740 │ {highway=secondary…  │ LINESTRING (7.422170500000001 43.73286…  │\n│    4227198 │ {highway=residenti…  │ LINESTRING (7.420338900000001 43.73223…  │\n│    4227216 │ {highway=service, …  │ LINESTRING (7.423448400000001 43.73268…  │\n│    4227242 │ {highway=secondary…  │ LINESTRING (7.4221786 43.7322418000000…  │\n│    4227272 │ {highway=secondary…  │ LINESTRING (7.422117500000001 43.73702…  │\n│    4229292 │ {foot=no, highway=…  │ LINESTRING (7.41643 43.7311373, 7.4168…  │\n│    4229577 │ {highway=residenti…  │ LINESTRING (7.4251499 43.7397216, 7.42…  │\n│    4230122 │ {alt_name=rue R. P…  │ LINESTRING (7.428823400000001 43.74602…  │\n│   25082741 │ {highway=secondary…  │ LINESTRING (7.4231414 43.7369886000000…  │\n│   25722909 │ {highway=footway, …  │ LINESTRING (7.423659300000001 43.73134…  │\n│       ·    │          ·           │                    ·                     │\n│       ·    │          ·           │                    ·                     │\n│       ·    │          ·           │                    ·                     │\n│ 1089844256 │ {handrail=no, high…  │ LINESTRING (7.4229453 43.7326080000000…  │\n│ 1089844296 │ {highway=footway}    │ LINESTRING (7.427017200000001 43.74044…  │\n│ 1202570722 │ {access=private, l…  │ POLYGON ((7.4263241 43.7390763, 7.4263…  │\n│  946167565 │ {disused:leisure=p…  │ POLYGON ((7.4276993 43.739335100000005…  │\n│ 1089844271 │ {highway=footway}    │ LINESTRING (7.4277667 43.732816, 7.427…  │\n│  335731716 │ {highway=footway}    │ LINESTRING (7.417764200000001 43.73439…  │\n│  779454018 │ {building=resident…  │ POLYGON ((7.4217522 43.7277202, 7.4218…  │\n│  943330855 │ {landuse=grass}      │ POLYGON ((7.4151844 43.7332252, 7.4152…  │\n│ 1089844229 │ {highway=steps, in…  │ LINESTRING (7.4274525 43.7328052, 7.42…  │\n│   49209608 │ {addr:city=Monaco,…  │ POLYGON ((7.4223448 43.7304076, 7.4221…  │\n├────────────┴──────────────────────┴──────────────────────────────────────────┤\n│ 4786 rows (20 shown)                                               3 columns │\n└──────────────────────────────────────────────────────────────────────────────┘\n```", "```py\nCREATE TEMP TABLE matching_relations AS \nSELECT id, tags\nFROM ST_READOSM('monaco-latest.osm.pbf')\nWHERE kind = 'relation' AND len(refs) > 0\n    AND tags IS NOT NULL AND cardinality(tags) > 0\n    AND list_contains(map_keys(tags), 'type')\n    AND list_has_any(map_extract(tags, 'type'), ['boundary', 'multipolygon']);\n\nSELECT * FROM matching_relations;\n\n┌──────────┬───────────────────────────────────────────────────────────────────┐\n│    id    │                               tags                                │\n│  int64   │                       map(varchar, varchar)                       │\n├──────────┼───────────────────────────────────────────────────────────────────┤\n│     7385 │ {ISO3166-2=FR-06, admin_level=6, alt_name:de=Meeralpen, border_…  │\n│     8654 │ {ISO3166-2=FR-PAC, admin_level=4, border_type=region, boundary=…  │\n│    36990 │ {ISO3166-1=MC, ISO3166-1:alpha2=MC, ISO3166-1:alpha3=MCO, admin…  │\n│   174558 │ {admin_level=8, boundary=administrative, name=Roquebrune-Cap-Ma…  │\n│   174562 │ {admin_level=8, boundary=administrative, name=Beausoleil, name:…  │\n│   174956 │ {admin_level=8, alt_name:it=Capo d`Aglio, boundary=administrati…  │\n│   174958 │ {admin_level=8, boundary=administrative, name=La Turbie, name:i…  │\n│   393226 │ {building=castle, castle_type=palace, charge=10€, email=visites…  │\n│   393481 │ {building=school, name=Pensionnat des Dames de Saint-Maur, type…  │\n│  1124039 │ {ISO3166-1=MC, ISO3166-1:alpha2=MC, ISO3166-1:alpha3=MCO, ISO31…  │\n│     ·    │                             ·                                     │\n│     ·    │                             ·                                     │\n│     ·    │                             ·                                     │\n│ 14399505 │ {area=yes, floating=yes, man_made=pier, type=multipolygon}        │\n│ 16248281 │ {building=apartments, name=F, type=multipolygon}                  │\n│ 16248282 │ {building=apartments, name=E, type=multipolygon}                  │\n│ 16248283 │ {building=apartments, name=D, type=multipolygon}                  │\n│ 16248284 │ {building=apartments, name=C, type=multipolygon}                  │\n│ 16248285 │ {building=apartments, name=B, type=multipolygon}                  │\n│ 16248286 │ {building=apartments, name=A, type=multipolygon}                  │\n│ 16250182 │ {addr:country=MC, alt_name=Parc de la Roseraie, leisure=park, n…  │\n│ 16261416 │ {natural=water, type=multipolygon, water=pond}                    │\n│ 16467322 │ {admin_level=2, boundary=land_area, land_area=administrative, n…  │\n├──────────┴───────────────────────────────────────────────────────────────────┤\n│ 78 rows (20 shown)                                                 2 columns │\n└──────────────────────────────────────────────────────────────────────────────┘\n```", "```py\nCREATE TEMP TABLE matching_relations_with_ways_refs AS\nWITH unnested_relation_refs AS (\n    SELECT\n        r.id,\n        UNNEST(refs) as ref,\n        UNNEST(ref_types) as ref_type,\n        UNNEST(ref_roles) as ref_role,\n        UNNEST(range(length(refs))) as ref_idx\n    FROM ST_READOSM('monaco-latest.osm.pbf') r\n    SEMI JOIN matching_relations USING (id)\n    WHERE kind = 'relation'\n)\nSELECT id, ref, ref_role, ref_idx\nFROM unnested_relation_refs\nWHERE ref_type = 'way';\n\nSELECT * FROM matching_relations_with_ways_refs;\n\n┌──────────┬───────────┬──────────┬─────────┐\n│    id    │    ref    │ ref_role │ ref_idx │\n│  int64   │   int64   │ varchar  │  int64  │\n├──────────┼───────────┼──────────┼─────────┤\n│     7385 │  30836152 │ outer    │       2 │\n│     7385 │ 889278953 │ outer    │       3 │\n│     7385 │ 889278956 │ outer    │       4 │\n│     7385 │ 889278957 │ outer    │       5 │\n│     7385 │ 889278958 │ outer    │       6 │\n│     7385 │ 889278962 │ outer    │       7 │\n│     7385 │ 960087656 │ outer    │       8 │\n│     7385 │  30836155 │ outer    │       9 │\n│     7385 │ 889278965 │ outer    │      10 │\n│     7385 │ 889278963 │ outer    │      11 │\n│       ·  │      ·    │   ·      │       · │\n│       ·  │      ·    │   ·      │       · │\n│       ·  │      ·    │   ·      │       · │\n│ 11278320 │  35150936 │ outer    │     197 │\n│ 11278320 │ 466647567 │ outer    │     198 │\n│ 11278320 │ 214008684 │ outer    │     199 │\n│ 11278320 │ 466647569 │ outer    │     200 │\n│ 11278320 │ 466647568 │ outer    │     201 │\n│ 11278320 │ 214008689 │ outer    │     202 │\n│ 11278320 │ 263776194 │ outer    │     203 │\n│ 11278320 │  31124893 │ outer    │     204 │\n│ 11278320 │  31124895 │ outer    │     205 │\n│ 11278320 │  31124899 │ outer    │     206 │\n├──────────┴───────────┴──────────┴─────────┤\n│ ? rows (>9999 rows, 20 shown)   4 columns │\n└───────────────────────────────────────────┘\n```", "```py\nCREATE TEMP TABLE required_ways_linestrings AS\nWITH ways_required_by_relations_with_nodes_refs AS (\n    SELECT id, UNNEST(refs) as ref, UNNEST(range(length(refs))) as ref_idx\n    FROM ST_READOSM('monaco-latest.osm.pbf') ways\n    SEMI JOIN matching_relations_with_ways_refs\n    ON ways.id = matching_relations_with_ways_refs.ref\n    WHERE kind = 'way'\n),\nnodes_required_by_relations_with_geometries AS (\n    SELECT id, ST_POINT(lon, lat) geometry\n    FROM ST_READOSM('monaco-latest.osm.pbf') nodes\n    SEMI JOIN ways_required_by_relations_with_nodes_refs\n    ON nodes.id = ways_required_by_relations_with_nodes_refs.ref\n    WHERE kind = 'node'\n)\nSELECT\n    ways.id,\n    ST_MakeLine(list(nodes.geometry ORDER BY ref_idx ASC)) linestring\nFROM ways_required_by_relations_with_nodes_refs ways\nJOIN nodes_required_by_relations_with_geometries nodes\nON ways.ref = nodes.id\nGROUP BY 1;\n\nSELECT * FROM required_ways_linestrings;\n\n┌────────────┬─────────────────────────────────────────────────────────────────┐\n│     id     │                           linestring                            │\n│   int64    │                            geometry                             │\n├────────────┼─────────────────────────────────────────────────────────────────┤\n│   37794470 │ LINESTRING (7.438411400000001 43.749422300000006, 7.4384056 4…  │\n│   87878917 │ LINESTRING (7.418041100000001 43.7256933, 7.4181547 43.725613…  │\n│   94252430 │ LINESTRING (7.4141873 43.729494100000004, 7.414203400000001 4…  │\n│   94399618 │ LINESTRING (7.4239717 43.740543100000004, 7.4238252 43.740372…  │\n│   94399736 │ LINESTRING (7.423881400000001 43.7402971, 7.4239411 43.740265…  │\n│  104863462 │ LINESTRING (7.424840000000001 43.731281800000005, 7.424917000…  │\n│  120114110 │ LINESTRING (7.420872 43.7370979, 7.4207787 43.7370534, 7.4206…  │\n│  156242249 │ LINESTRING (7.4294728 43.739895600000004, 7.429579500000001 4…  │\n│  165636038 │ LINESTRING (7.419717100000001 43.732398700000005, 7.419772900…  │\n│  169297863 │ LINESTRING (7.422815300000001 43.7321967, 7.4234109 43.732263…  │\n│       ·    │                                ·                                │\n│       ·    │                                ·                                │\n│       ·    │                                ·                                │\n│   24874398 │ LINESTRING (7.418523400000001 43.7247599, 7.419012800000001 4…  │\n│   92627424 │ LINESTRING (7.4166521 43.7322122, 7.4162303 43.73173910000000…  │\n│   94452829 │ LINESTRING (7.4317066 43.7469647, 7.4317998 43.7470371, 7.431…  │\n│  335740502 │ LINESTRING (7.4185151 43.7353633, 7.418442000000001 43.735298…  │\n│  398377193 │ LINESTRING (7.420872 43.7370979, 7.420939000000001 43.7371298…  │\n│  405529436 │ LINESTRING (7.417534900000001 43.7258914, 7.4175347 43.725833…  │\n│  423632259 │ LINESTRING (7.4212208 43.7320944, 7.421461300000001 43.732057…  │\n│  572935479 │ LINESTRING (7.427508100000001 43.7394168, 7.427496700000001 4…  │\n│  586494707 │ LINESTRING (7.4270357 43.739109000000006, 7.4269512 43.739155…  │\n│ 1202570715 │ LINESTRING (7.426448400000001 43.739491400000006, 7.4264682 4…  │\n├────────────┴─────────────────────────────────────────────────────────────────┤\n│ 141 rows (20 shown)                                                2 columns │\n└──────────────────────────────────────────────────────────────────────────────┘\n```", "```py\nCREATE TEMP TABLE matching_relations_with_ways_linestrings AS\nWITH unnested_relations_with_way_linestrings AS (\n    SELECT\n        r.id,\n        COALESCE(r.ref_role, 'outer') as ref_role,\n        r.ref,\n        w.linestring::GEOMETRY as geometry\n    FROM matching_relations_with_ways_refs r\n    JOIN required_ways_linestrings w\n    ON w.id = r.ref\n    ORDER BY r.id, r.ref_idx\n),\nany_outer_refs AS (\n    -- check if any way attached to the relation has the `outer` role\n    SELECT id, bool_or(ref_role == 'outer') has_any_outer_refs\n    FROM unnested_relations_with_way_linestrings\n    GROUP BY id\n)\nSELECT\n    unnested_relations_with_way_linestrings.* EXCLUDE (ref_role),\n    -- if none of the way refs has `outer` role - treat each ref as `outer`\n    CASE WHEN any_outer_refs.has_any_outer_refs\n        THEN unnested_relations_with_way_linestrings.ref_role\n        ELSE 'outer'\n    END as ref_role\nFROM unnested_relations_with_way_linestrings\nJOIN any_outer_refs\nON any_outer_refs.id = unnested_relations_with_way_linestrings.id;\n\nSELECT * FROM matching_relations_with_ways_linestrings;\n\n┌──────────┬───────────┬────────────────────────────────────────────┬──────────┐\n│    id    │    ref    │                  geometry                  │ ref_role │\n│  int64   │   int64   │                  geometry                  │ varchar  │\n├──────────┼───────────┼────────────────────────────────────────────┼──────────┤\n│     7385 │ 772081595 │ LINESTRING (7.415291600000001 43.7234393…  │ outer    │\n│     7385 │ 212810311 │ LINESTRING (7.4120416 43.7280955, 7.4123…  │ outer    │\n│     7385 │ 176533407 │ LINESTRING (7.412670800000001 43.7316348…  │ outer    │\n│     7385 │  37811853 │ LINESTRING (7.4127007 43.7346954, 7.4126…  │ outer    │\n│     7385 │  37794471 │ LINESTRING (7.428754700000001 43.7460174…  │ outer    │\n│     7385 │ 398372186 │ LINESTRING (7.436885 43.7519173, 7.43677…  │ outer    │\n│     7385 │  37794470 │ LINESTRING (7.438411400000001 43.7494223…  │ outer    │\n│     7385 │ 770774507 │ LINESTRING (7.439171000000001 43.7490109…  │ outer    │\n│     8654 │ 772081595 │ LINESTRING (7.415291600000001 43.7234393…  │ outer    │\n│     8654 │ 212810311 │ LINESTRING (7.4120416 43.7280955, 7.4123…  │ outer    │\n│       ·  │     ·     │                     ·                      │   ·      │\n│       ·  │     ·     │                     ·                      │   ·      │\n│       ·  │     ·     │                     ·                      │   ·      │\n│ 11546878 │ 840890844 │ LINESTRING (7.420754 43.735872900000004,…  │ outer    │\n│ 11546878 │ 840890848 │ LINESTRING (7.4207413 43.7356673, 7.4207…  │ outer    │\n│ 16467322 │ 772081595 │ LINESTRING (7.415291600000001 43.7234393…  │ outer    │\n│ 16467322 │ 212810311 │ LINESTRING (7.4120416 43.7280955, 7.4123…  │ outer    │\n│ 16467322 │ 176533407 │ LINESTRING (7.412670800000001 43.7316348…  │ outer    │\n│ 16467322 │  37811853 │ LINESTRING (7.4127007 43.7346954, 7.4126…  │ outer    │\n│ 16467322 │  37794471 │ LINESTRING (7.428754700000001 43.7460174…  │ outer    │\n│ 16467322 │ 398372186 │ LINESTRING (7.436885 43.7519173, 7.43677…  │ outer    │\n│ 16467322 │  37794470 │ LINESTRING (7.438411400000001 43.7494223…  │ outer    │\n│ 16467322 │ 770774507 │ LINESTRING (7.439171000000001 43.7490109…  │ outer    │\n├──────────┴───────────┴────────────────────────────────────────────┴──────────┤\n│ 410 rows (20 shown)                                                4 columns │\n└──────────────────────────────────────────────────────────────────────────────┘\n```", "```py\nCREATE TEMP TABLE matching_relations_with_merged_polygons AS\nWITH merged_linestrings AS (\n    SELECT\n        id,\n        ref_role,\n        UNNEST(\n            ST_Dump(ST_LineMerge(ST_Collect(list(geometry)))),\n            recursive := true\n        ),\n    FROM matching_relations_with_ways_linestrings\n    GROUP BY id, ref_role\n),\nrelations_with_linestrings AS (\n    SELECT\n        id,\n        ref_role,\n        -- ST_Dump returns column named `geom`\n        geom AS geometry,\n        row_number() OVER (PARTITION BY id) as geometry_id\n    FROM\n        merged_linestrings\n    -- discard linestrings with less than 4 points\n    WHERE ST_NPoints(geom) >= 4\n),\nvalid_relations AS (\n    SELECT id, is_valid\n    FROM (\n        SELECT\n            id,\n            bool_and(\n                -- Check if start point equals the end point\n                ST_Equals(ST_StartPoint(geometry), ST_EndPoint(geometry))\n            ) is_valid\n        FROM relations_with_linestrings\n        GROUP BY id\n    )\n    WHERE is_valid = true\n)\nSELECT \n    id,\n    ref_role,\n    ST_MakePolygon(geometry) geometry,\n    geometry_id\nFROM relations_with_linestrings\nSEMI JOIN valid_relations\nON relations_with_linestrings.id = valid_relations.id;\n\nSELECT * FROM matching_relations_with_merged_polygons;\n\n┌──────────┬──────────┬──────────────────────────────────────────┬─────────────┐\n│    id    │ ref_role │                 geometry                 │ geometry_id │\n│  int64   │ varchar  │                 geometry                 │    int64    │\n├──────────┼──────────┼──────────────────────────────────────────┼─────────────┤\n│  1369631 │ inner    │ POLYGON ((7.438232200000001 43.7511057…  │           1 │\n│  1369631 │ outer    │ POLYGON ((7.438008600000001 43.7502850…  │           2 │\n│  1484217 │ outer    │ POLYGON ((7.423010700000001 43.7307028…  │           1 │\n│  1484217 │ inner    │ POLYGON ((7.423114600000001 43.7305994…  │           2 │\n│  5986436 │ outer    │ POLYGON ((7.428754700000001 43.7460174…  │           1 │\n│  8269572 │ outer    │ POLYGON ((7.4287048 43.737701400000006…  │           1 │\n│  8269572 │ inner    │ POLYGON ((7.4284492 43.7375604, 7.4286…  │           2 │\n│ 16248286 │ outer    │ POLYGON ((7.426306200000001 43.7391565…  │           1 │\n│ 16248286 │ inner    │ POLYGON ((7.4263241 43.7390763, 7.4263…  │           2 │\n│ 16261416 │ inner    │ POLYGON ((7.417829200000001 43.731382,…  │           1 │\n│     ·    │   ·      │                    ·                     │           · │\n│     ·    │   ·      │                    ·                     │           · │\n│     ·    │   ·      │                    ·                     │           · │\n│  8280869 │ inner    │ POLYGON ((7.426753300000001 43.7388868…  │           2 │\n│  8280869 │ inner    │ POLYGON ((7.4270357 43.739109000000006…  │           3 │\n│  8280869 │ inner    │ POLYGON ((7.4271374 43.739011500000004…  │           4 │\n│  8280869 │ inner    │ POLYGON ((7.4272666 43.7389165, 7.4273…  │           5 │\n│ 11384697 │ outer    │ POLYGON ((7.427075 43.7315167, 7.42749…  │           1 │\n│ 11384697 │ inner    │ POLYGON ((7.426917700000001 43.7313266…  │           2 │\n│ 11384697 │ inner    │ POLYGON ((7.427001400000001 43.7313937…  │           3 │\n│ 11546878 │ outer    │ POLYGON ((7.4207413 43.7356673, 7.4207…  │           1 │\n│ 11538023 │ inner    │ POLYGON ((7.426528200000001 43.7329359…  │           1 │\n│ 11538023 │ outer    │ POLYGON ((7.426554 43.7328276, 7.42654…  │           2 │\n├──────────┴──────────┴──────────────────────────────────────────┴─────────────┤\n│ 88 rows (20 shown)                                                 4 columns │\n└──────────────────────────────────────────────────────────────────────────────┘\n```", "```py\nCREATE TEMP TABLE matching_relations_with_outer_polygons_with_holes AS\nWITH outer_polygons AS (\n    SELECT id, geometry_id, geometry\n    FROM matching_relations_with_merged_polygons\n    WHERE ref_role = 'outer'\n), inner_polygons AS (\n    SELECT id, geometry_id, geometry\n    FROM matching_relations_with_merged_polygons\n    WHERE ref_role = 'inner'\n)\nSELECT\n    op.id,\n    op.geometry_id,\n    ST_Difference(any_value(op.geometry), ST_Union_Agg(ip.geometry)) geometry\nFROM outer_polygons op\nJOIN inner_polygons ip\nON op.id = ip.id AND ST_WITHIN(ip.geometry, op.geometry)\nGROUP BY op.id, op.geometry_id;\n\nCREATE TEMP TABLE matching_relations_with_outer_polygons_without_holes AS\nWITH outer_polygons AS (\n    SELECT id, geometry_id, geometry\n    FROM matching_relations_with_merged_polygons\n    WHERE ref_role = 'outer'\n)\nSELECT\n    op.id,\n    op.geometry_id,\n    op.geometry\nFROM outer_polygons op\nANTI JOIN matching_relations_with_outer_polygons_with_holes opwh\nON op.id = opwh.id AND op.geometry_id = opwh.geometry_id;\n\nSELECT * FROM matching_relations_with_outer_polygons_with_holes\nUNION ALL\nSELECT * FROM matching_relations_with_outer_polygons_without_holes;\n\n┌──────────┬─────────────┬─────────────────────────────────────────────────────┐\n│    id    │ geometry_id │                      geometry                       │\n│  int64   │    int64    │                      geometry                       │\n├──────────┼─────────────┼─────────────────────────────────────────────────────┤\n│ 16248286 │           1 │ POLYGON ((7.4263139 43.7391602, 7.426324900000001…  │\n│  1369192 │           1 │ POLYGON ((7.4226247 43.7402251, 7.4227848 43.7396…  │\n│  8147763 │           1 │ POLYGON ((7.438223000000001 43.7477296, 7.4382403…  │\n│   393226 │           1 │ POLYGON ((7.4204802 43.731016700000005, 7.4203979…  │\n│ 11484092 │           4 │ POLYGON ((7.417896900000001 43.724827000000005, 7…  │\n│ 11384697 │           1 │ POLYGON ((7.4274934 43.731250700000004, 7.4267196…  │\n│  8269572 │           1 │ POLYGON ((7.4287166 43.7376724, 7.4287948 43.7376…  │\n│ 16261416 │           3 │ POLYGON ((7.4178309 43.731391, 7.417877000000001 …  │\n│ 16248284 │           1 │ POLYGON ((7.426637500000001 43.7394678, 7.4266485…  │\n│ 16248285 │           1 │ POLYGON ((7.426114600000001 43.739267600000005, 7…  │\n│     ·    │           · │                          ·                          │\n│     ·    │           · │                          ·                          │\n│     ·    │           · │                          ·                          │\n│ 11546879 │           1 │ POLYGON ((7.4209316 43.7356234, 7.421037 43.73562…  │\n│  2220206 │           1 │ POLYGON ((7.4120416 43.7280955, 7.412103900000001…  │\n│  5986438 │           1 │ POLYGON ((7.4191482 43.738887500000004, 7.4199833…  │\n│  2221178 │           1 │ POLYGON ((7.415860400000001 43.7313885, 7.416195 …  │\n│  2221179 │           1 │ POLYGON ((7.422280000000001 43.7367186, 7.4227584…  │\n│  2220208 │           1 │ POLYGON ((7.41849 43.730922400000004, 7.4185156 4…  │\n│  2254506 │           1 │ POLYGON ((7.432995900000001 43.7447102, 7.4329125…  │\n│  5986437 │           1 │ POLYGON ((7.4307593 43.745595, 7.4306621 43.74541…  │\n│  5986437 │           2 │ POLYGON ((7.4343358 43.7457085, 7.4341337 43.7455…  │\n│ 11546878 │           1 │ POLYGON ((7.4207413 43.7356673, 7.4207413 43.7357…  │\n├──────────┴─────────────┴─────────────────────────────────────────────────────┤\n│ 47 rows (20 shown)                                                 3 columns │\n└──────────────────────────────────────────────────────────────────────────────┘\n```", "```py\nWITH unioned_outer_geometries AS (\n    SELECT id, geometry\n    FROM matching_relations_with_outer_polygons_with_holes\n    UNION ALL\n    SELECT id, geometry\n    FROM matching_relations_with_outer_polygons_without_holes\n),\nfinal_geometries AS (\n    SELECT id, ST_Union_Agg(geometry) geometry\n    FROM unioned_outer_geometries\n    GROUP BY id\n)\nSELECT r_g.id, r.tags, r_g.geometry\nFROM final_geometries r_g\nJOIN matching_relations r\nON r.id = r_g.id;\n\n┌──────────┬──────────────────────┬────────────────────────────────────────────┐\n│    id    │         tags         │                  geometry                  │\n│  int64   │ map(varchar, varch…  │                  geometry                  │\n├──────────┼──────────────────────┼────────────────────────────────────────────┤\n│   393226 │ {building=castle, …  │ POLYGON ((7.4204802 43.731016700000005, …  │\n│   393481 │ {building=school, …  │ POLYGON ((7.423992800000001 43.731841800…  │\n│  1369191 │ {building=apartmen…  │ POLYGON ((7.4231004 43.7412894, 7.423314…  │\n│  1369192 │ {building=apartmen…  │ POLYGON ((7.4226247 43.7402251, 7.422784…  │\n│  1369193 │ {building=apartmen…  │ POLYGON ((7.424 43.7405491, 7.4240401 43…  │\n│  1369195 │ {building=apartmen…  │ POLYGON ((7.418679900000001 43.738187100…  │\n│  1369631 │ {addr:housenumber=…  │ POLYGON ((7.4379729 43.7502505, 7.437937…  │\n│  1369632 │ {addr:city=Monaco,…  │ POLYGON ((7.4317121 43.74709, 7.4318277 …  │\n│  1484190 │ {addr:city=Monaco,…  │ POLYGON ((7.425469 43.731494000000005, 7…  │\n│  1484217 │ {building=retail, …  │ POLYGON ((7.423202300000001 43.7307117, …  │\n│     ·    │          ·           │                     ·                      │\n│     ·    │          ·           │                     ·                      │\n│     ·    │          ·           │                     ·                      │\n│ 14399505 │ {area=yes, floatin…  │ POLYGON ((7.4195986 43.7265293, 7.419595…  │\n│ 16248281 │ {building=apartmen…  │ POLYGON ((7.4260438 43.739789800000004, …  │\n│ 16248282 │ {building=apartmen…  │ POLYGON ((7.426243100000001 43.7396824, …  │\n│ 16248283 │ {building=apartmen…  │ POLYGON ((7.426438200000001 43.739575200…  │\n│ 16248284 │ {building=apartmen…  │ POLYGON ((7.426637500000001 43.7394678, …  │\n│ 16248285 │ {building=apartmen…  │ POLYGON ((7.426114600000001 43.739267600…  │\n│ 16248286 │ {building=apartmen…  │ POLYGON ((7.4263139 43.7391602, 7.426324…  │\n│ 16250182 │ {addr:country=MC, …  │ POLYGON ((7.418348300000001 43.7256979, …  │\n│ 16261416 │ {natural=water, ty…  │ POLYGON ((7.4178309 43.731391, 7.4178770…  │\n│ 11546878 │ {addr:city=Monaco,…  │ POLYGON ((7.4207413 43.7356673, 7.420741…  │\n├──────────┴──────────────────────┴────────────────────────────────────────────┤\n│ 46 rows (20 shown)                                                 3 columns │\n└──────────────────────────────────────────────────────────────────────────────┘\n```", "```py\n>>> import quackosm as qosm\n>>> qosm.get_features_gdf('monaco-latest.osm.pbf')\n                                                              tags                                           geometry\nfeature_id                                                                                                           \nway/834616137                               {'highway': 'footway'}  LINESTRING (7.42133 43.72711, 7.42134 43.72710...\nway/408817108    {'addr:country': 'MC', 'building': 'yes', 'nam...  POLYGON ((7.43533 43.74965, 7.43534 43.74955, ...\nway/686435440                               {'highway': 'footway'}  LINESTRING (7.41381 43.73258, 7.41388 43.73266...\nnode/7799514898              {'name': 'Cino Bar', 'shop': 'kiosk'}                           POINT (7.42702 43.73118)\nway/143214794                                  {'building': 'yes'}  POLYGON ((7.42788 43.74437, 7.42786 43.74437, ...\n...                                                            ...                                                ...\nway/161882794    {'highway': 'secondary', 'lanes': '2', 'lit': ...  LINESTRING (7.42142 43.73656, 7.42147 43.73662...\nway/1082330089             {'highway': 'steps', 'incline': 'down'}  LINESTRING (7.42438 43.72990, 7.42440 43.72988...\nway/834313093    {'highway': 'service', 'smoothness': 'intermed...  LINESTRING (7.42709 43.73256, 7.42708 43.73262...\nway/94399451             {'addr:country': 'MC', 'building': 'yes'}  POLYGON ((7.41678 43.73699, 7.41661 43.73689, ...\nnode/2462515787  {'crossing': 'uncontrolled', 'highway': 'cross...                           POINT (7.41656 43.73208)\n\n[7940 rows x 2 columns]\n>>> qosm.convert_pbf_to_gpq('monaco-latest.osm.pbf')\nPosixPath('files/monaco-latest_nofilter_noclip_compact.geoparquet')\n```"]