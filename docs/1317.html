<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Physics-Informed Neural Network with Forcing Function</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Physics-Informed Neural Network with Forcing Function</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/physics-informed-neural-network-with-forcing-function-81f59aa24c39?source=collection_archive---------1-----------------------#2024-05-27">https://towardsdatascience.com/physics-informed-neural-network-with-forcing-function-81f59aa24c39?source=collection_archive---------1-----------------------#2024-05-27</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="23a3" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx"><strong class="al">Solving differential equations directly with neural networks<em class="hd"> (with code)</em></strong></h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="he hf hg hh hi ab"><div><div class="ab hj"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@john_morrow?source=post_page---byline--81f59aa24c39--------------------------------" rel="noopener follow"><div class="l hk hl by hm hn"><div class="l ed"><img alt="John Morrow" class="l ep by dd de cx" src="../Images/4a8ce62a0b4e1eb1cf77ecaba6b7ddcc.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*twJnjz8pLeX6QqNr6VUyRQ@2x.jpeg"/><div class="ho by l dd de em n hp eo"/></div></div></a></div></div><div class="hq ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--81f59aa24c39--------------------------------" rel="noopener follow"><div class="l hr hs by hm ht"><div class="l ed"><img alt="Towards Data Science" class="l ep by br hu cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="ho by l br hu em n hp eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hv ab q"><div class="ab q hw"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hx hy bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hz" data-testid="authorName" href="https://medium.com/@john_morrow?source=post_page---byline--81f59aa24c39--------------------------------" rel="noopener follow">John Morrow</a></p></div></div></div><span class="ia ib" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hx hy dx"><button class="ic id ah ai aj ak al am an ao ap aq ar ie if ig" disabled="">Follow</button></p></div></div></span></div></div><div class="l ih"><span class="bf b bg z dx"><div class="ab cn ii ij ik"><div class="il im ab"><div class="bf b bg z dx ab in"><span class="io l ih">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hz ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--81f59aa24c39--------------------------------" rel="noopener follow"><p class="bf b bg z ip iq ir is it iu iv iw bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="ia ib" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">7 min read</span><div class="ix iy l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">May 27, 2024</span></div></span></div></span></div></div></div><div class="ab cp iz ja jb jc jd je jf jg jh ji jj jk jl jm jn jo"><div class="h k w ea eb q"><div class="ke l"><div class="ab q kf kg"><div class="pw-multi-vote-icon ed io kh ki kj"><div class=""><div class="kk kl km kn ko kp kq am kr ks kt kj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l ku kv kw kx ky kz la"><p class="bf b dy z dx"><span class="kl">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kk ld le ab q ee lf lg" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="lc"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg><p class="bf b dy z dx"><span class="pw-responses-count lb lc">3</span></p></button></div></div></div><div class="ab q jp jq jr js jt ju jv jw jx jy jz ka kb kc kd"><div class="lh k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al li an ao ap ie lj lk ll" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep lm cn"><div class="l ae"><div class="ab cb"><div class="ln lo lp lq lr ls ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al li an ao ap ie lt lu lg lv lw lx ly lz s ma mb mc md me mf mg u mh mi mj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al li an ao ap ie lt lu lg lv lw lx ly lz s ma mb mc md me mf mg u mh mi mj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al li an ao ap ie lt lu lg lv lw lx ly lz s ma mb mc md me mf mg u mh mi mj"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="mn mo mp mq mr ms mk ml paragraph-image"><div role="button" tabindex="0" class="mt mu ed mv bh mw"><div class="mk ml mm"><img src="../Images/606da5e15190e1076896e6f2b0203807.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mPYovzCUGQGrL5nJIspK-w.jpeg"/></div></div><figcaption class="my mz na mk ml nb nc bf b bg z dx">image by agsandrew on iStock</figcaption></figure><p id="5b79" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">In physics, mathematics, economics, engineering, and many other fields, differential equations describe a function in terms of the derivatives of the variables. Put simply, when the rate of change of a variable in terms of other variables is involved, you will likely find a differential equation. Many <a class="af nz" href="https://en.wikipedia.org/wiki/List_of_named_differential_equations" rel="noopener ugc nofollow" target="_blank">examples</a> describe these relationships. A differential equation’s solution is typically derived through analytical or numerical methods.</p><p id="188e" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">While deriving the analytic solution can be a tedious or, in some cases, an impossible task, a physics-informed neural network (PINN) produces the solution directly from the differential equation, bypassing the analytic process. This innovative approach to solving differential equations is an important development in the field.</p><p id="632c" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">A <a class="af nz" href="https://medium.com/towards-data-science/inverse-physics-informed-neural-net-3b636efeb37e" rel="noopener">previous article</a> by the author used a PINN to find the solution to a differential equation describing a simple electronic circuit. This article explores the more challenging task of finding a solution when driving the circuit with a forcing function. Consider the following series-connected electronic circuit that comprises a resistor <em class="oa">R</em>, capacitor <em class="oa">C</em>, inductor <em class="oa">L</em>, and a sinusoidal voltage source <em class="oa">V sin(ωt)</em>. The behavior of the current flow, <em class="oa">i(t)</em>, in this circuit is described by Equation 1, a 2nd-order non-homogeneous differential equation with forcing function, <em class="oa">Vω/L cos(ωt)</em>.</p><figure class="mn mo mp mq mr ms mk ml paragraph-image"><div role="button" tabindex="0" class="mt mu ed mv bh mw"><div class="mk ml ob"><img src="../Images/db0fbad3f8570d544e8cd6e091cc7384.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KHoPFKmGSdMwCajubJE-pQ.png"/></div></div><figcaption class="my mz na mk ml nb nc bf b bg z dx">Figure 1: <strong class="bf oc">RLC circuit with sinusoidal voltage source</strong></figcaption></figure><figure class="mn mo mp mq mr ms mk ml paragraph-image"><div role="button" tabindex="0" class="mt mu ed mv bh mw"><div class="mk ml od"><img src="../Images/b214ed62114f959ed2d5f400852f2ac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fMliEc7xmRljnU3uDxxBxQ.png"/></div></div><figcaption class="my mz na mk ml nb nc bf b bg z dx"><strong class="bf oc">Equation 1</strong></figcaption></figure><h2 id="675b" class="oe of fq bf oc og oh oi oj ok ol om on nm oo op oq nq or os ot nu ou ov ow ox bk"><strong class="al">Analytic solution</strong></h2><p id="506a" class="pw-post-body-paragraph nd ne fq nf b go oy nh ni gr oz nk nl nm pa no np nq pb ns nt nu pc nw nx ny fj bk">The analytic solution to Equation 1 requires solving the equation for three cases depending upon the relationship between <em class="oa">λ</em> and <em class="oa">ω₀</em>. As seen below, each results in a complicated and unique formula for <em class="oa">i(t)</em>. In tests presented later in <strong class="nf fr">Results</strong>, these solutions will be compared against results produced by a PINN. The PINN will produce the solution directly from the differential equation without consideration of these cases.</p><p id="a7d7" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">(A detailed analytic solution by the author using Laplace transform techniques is available <a class="af nz" href="https://github.com/jmorrow1000/PINN-with-forcing-function" rel="noopener ugc nofollow" target="_blank">here</a>.)</p><p id="e358" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><strong class="nf fr">Case 1: Under-damped (</strong><em class="oa">λ/2 &lt; ω₀</em>)</p><p id="4dd6" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">Damping refers to how fast the circuit transitions from its starting transit to equilibrium. An under-damped response attempts to transition quickly but typically cycles through overshooting and undershooting before reaching equilibrium.</p><figure class="mn mo mp mq mr ms mk ml paragraph-image"><div role="button" tabindex="0" class="mt mu ed mv bh mw"><div class="mk ml pd"><img src="../Images/c338c1f20f47e542a90500e04b389766.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SAF8kblioFY956QoNlqYiQ.png"/></div></div><figcaption class="my mz na mk ml nb nc bf b bg z dx"><strong class="bf oc">Equation 2</strong></figcaption></figure><p id="81d2" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><strong class="nf fr">Case 2: Over-damped (</strong><em class="oa">λ/2 &gt;ω₀</em>)</p><p id="7712" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">An over-damped response slowly transitions from starting transit to equilibrium without undergoing cycles of overshooting and undershooting.</p><figure class="mn mo mp mq mr ms mk ml paragraph-image"><div role="button" tabindex="0" class="mt mu ed mv bh mw"><div class="mk ml pd"><img src="../Images/fc2cb05714bb5c7684e505a7173cea54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_jyFLuvMaRaqGCumVVlb4w.png"/></div></div><figcaption class="my mz na mk ml nb nc bf b bg z dx"><strong class="bf oc">Equation 3</strong></figcaption></figure><p id="f46e" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><strong class="nf fr">Case 3: Critically-damped (</strong><em class="oa">λ/2 = ω₀</em>)</p><p id="7493" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">A critically-damped response falls between under-damped and over-damped, delivering the fastest response from starting transit to equilibrium.</p><figure class="mn mo mp mq mr ms mk ml paragraph-image"><div role="button" tabindex="0" class="mt mu ed mv bh mw"><div class="mk ml pe"><img src="../Images/bdd758e22d8b82a78a8828fa598e6fcb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*up_88xnqjBIe6Mp-jVoD3Q.png"/></div></div><figcaption class="my mz na mk ml nb nc bf b bg z dx"><strong class="bf oc">Equation 4</strong></figcaption></figure><h2 id="d765" class="oe of fq bf oc og oh oi oj ok ol om on nm oo op oq nq or os ot nu ou ov ow ox bk"><strong class="al">PINN solution</strong></h2><p id="ef2f" class="pw-post-body-paragraph nd ne fq nf b go oy nh ni gr oz nk nl nm pa no np nq pb ns nt nu pc nw nx ny fj bk">PyTorch code is available <a class="af nz" href="https://github.com/jmorrow1000/PINN-with-forcing-function" rel="noopener ugc nofollow" target="_blank">here</a>.</p><p id="fb40" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">A neural network is typically trained with pairs of inputs and desired outputs. The inputs are applied to the neural network, and back-propagation adjusts the network’s weights and biases to minimize an objective function. The objective function represents the error in the neural network’s output compared to the desired output.</p><p id="330c" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">The objective function of a PINN, in contrast, requires three components: a residual component (<em class="oa">obj</em> <em class="oa">ᵣₑₛ</em>) and two initial condition components (<em class="oa">obj ᵢₙᵢₜ₁ </em>and <em class="oa">obj</em> <em class="oa">ᵢₙᵢₜ</em>₂). These are combined to produce the objective function:</p><figure class="mn mo mp mq mr ms mk ml paragraph-image"><div role="button" tabindex="0" class="mt mu ed mv bh mw"><div class="mk ml pf"><img src="../Images/19c6a8727252c5abf6ea24df3a4a16c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JniUnGx7p0m2FpJEW3uuSg.png"/></div></div><figcaption class="my mz na mk ml nb nc bf b bg z dx"><strong class="bf oc">Equation 5</strong></figcaption></figure><figure class="mn mo mp mq mr ms mk ml paragraph-image"><div class="mk ml pg"><img src="../Images/fff0ab3129a246ee2670d6d090921c40.png" data-original-src="https://miro.medium.com/v2/resize:fit:1216/format:webp/1*YUHC6BkcX9Sl1bObhSB9qQ.png"/></div><figcaption class="my mz na mk ml nb nc bf b bg z dx"><strong class="bf oc">PINN objective function</strong></figcaption></figure><p id="3ba6" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><strong class="nf fr">Residual</strong></p><p id="b5cd" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">The residual component is where <em class="oa">physics-informed</em> comes into play. This component, incorporating derivatives of the output, constrains the network to conform to the defining differential equation. The residual, Equation 6, is formed by rearranging Equation 1.</p><figure class="mn mo mp mq mr ms mk ml paragraph-image"><div role="button" tabindex="0" class="mt mu ed mv bh mw"><div class="mk ml ph"><img src="../Images/df65ffa7c3d425398f069611eb792afb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WV6QtrYhhTwM6NWu1lHegQ.png"/></div></div><figcaption class="my mz na mk ml nb nc bf b bg z dx"><strong class="bf oc">Equation 6</strong></figcaption></figure><p id="fa3d" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">During training, values of <em class="oa">t</em> are presented to the neural network’s input, resulting in a residual. Backpropagation then reduces the residual component of the objective to a minimum value close to <em class="oa">0</em> over all the training points. The residual component is given by:</p><figure class="mn mo mp mq mr ms mk ml paragraph-image"><div role="button" tabindex="0" class="mt mu ed mv bh mw"><div class="mk ml pi"><img src="../Images/f2d90cb6e39531082d56833d1673b0bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tpjAaors2lBotJgRqHzqBA.png"/></div></div><figcaption class="my mz na mk ml nb nc bf b bg z dx"><strong class="bf oc">Equation 7</strong></figcaption></figure><p id="99dc" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">The first and second derivatives, <em class="oa">di/dt</em> and <em class="oa">d²i/dt²</em>, required by Equation 6 are provided by the automatic differentiation function in the PyTorch and TensorFlow neural network platforms.</p><p id="8ddc" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><strong class="nf fr">Initial condition 1</strong></p><p id="713c" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">In this circuit example, the first initial condition requires that the PINN’s output, <em class="oa">i(t) = 0</em> when input <em class="oa">t = 0</em>. This is due to the sinusoidal source <em class="oa">V sin(t) = 0</em> at <em class="oa">t = 0</em>, resulting in no current flowing in the circuit. The objective component for initial condition 1 is given by Equation 8. During training, backpropagation will reduce this component to a value near <em class="oa">0</em>.</p><figure class="mn mo mp mq mr ms mk ml paragraph-image"><div role="button" tabindex="0" class="mt mu ed mv bh mw"><div class="mk ml pf"><img src="../Images/915dca72ab9b43afd54a753c473d2a35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Sb07BY4TeDICX4DcLe7Tkw.png"/></div></div><figcaption class="my mz na mk ml nb nc bf b bg z dx"><strong class="bf oc">Equation 8</strong></figcaption></figure><p id="9506" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><strong class="nf fr">Initial condition 2</strong></p><p id="21bf" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">The second initial condition requires that <em class="oa">L di/dt = 0</em> when input <em class="oa">t = 0</em>. It is derived from <a class="af nz" href="https://en.wikipedia.org/wiki/Kirchhoff%27s_circuit_laws" rel="noopener ugc nofollow" target="_blank">Kirchhoff’s voltage law</a> (i.e., the sum of voltage drops around a closed loop is zero). Specifically, at <em class="oa">t = 0</em> the following conditions exist in the circuit:</p><ul class=""><li id="8ddb" class="nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny pj pk pl bk">voltage source <em class="oa">V sin(ωt) = 0</em></li><li id="2f99" class="nd ne fq nf b go pm nh ni gr pn nk nl nm po no np nq pp ns nt nu pq nw nx ny pj pk pl bk">capacitor <em class="oa">C</em> has an initial charge of <em class="oa">Q = 0</em> , yielding a capacitor voltage of <em class="oa">V_cap = Q/C = 0</em></li><li id="37c1" class="nd ne fq nf b go pm nh ni gr pn nk nl nm po no np nq pp ns nt nu pq nw nx ny pj pk pl bk">voltage across the resistor <em class="oa">R</em> is <em class="oa">V_res = iR = 0</em>, since <em class="oa">i(t) = 0</em> (initial condition 1)</li><li id="67db" class="nd ne fq nf b go pm nh ni gr pn nk nl nm po no np nq pp ns nt nu pq nw nx ny pj pk pl bk">voltage across the inductor <em class="oa">L</em> is <em class="oa">V_ind = L di/dt</em></li><li id="6ce4" class="nd ne fq nf b go pm nh ni gr pn nk nl nm po no np nq pp ns nt nu pq nw nx ny pj pk pl bk">given the above conditions, the sum of the voltage drops around the circuit reduces to <em class="oa">L di/dt = 0</em></li></ul><p id="316f" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">The objective component for initial condition 2 is given by Equation 9. Backpropagation will reduce this component to a value near 0.</p><figure class="mn mo mp mq mr ms mk ml paragraph-image"><div role="button" tabindex="0" class="mt mu ed mv bh mw"><div class="mk ml pr"><img src="../Images/4c670e274daa775038f59303a0f9ebca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7MHlfjFLjuo6wATtzLZnTw.png"/></div></div><figcaption class="my mz na mk ml nb nc bf b bg z dx"><strong class="bf oc">Equation 9</strong></figcaption></figure><p id="cc32" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><strong class="nf fr">Objective plot</strong></p><p id="1273" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk">The following figure shows the reduction in the value of the objective during training:</p><figure class="mn mo mp mq mr ms mk ml paragraph-image"><div class="mk ml ps"><img src="../Images/073cb167d96415af82c2757de2813a30.png" data-original-src="https://miro.medium.com/v2/resize:fit:728/format:webp/1*ThHCGTpkxKNx1Bh9c5G9-A.png"/></div><figcaption class="my mz na mk ml nb nc bf b bg z dx"><strong class="bf oc">Objective plot</strong></figcaption></figure><h2 id="e1ba" class="oe of fq bf oc og oh oi oj ok ol om on nm oo op oq nq or os ot nu ou ov ow ox bk">Results</h2><p id="6bc4" class="pw-post-body-paragraph nd ne fq nf b go oy nh ni gr oz nk nl nm pa no np nq pb ns nt nu pc nw nx ny fj bk">The following test cases compare the response of the trained PINN to the appropriate analytic solution for each case. The circuit component values were chosen to produce the conditions of under-damped, overdamped, and critically-damped responses, as discussed above. All three cases are driven with a sinusoidal voltage source of <em class="oa">V = 10 volts</em> and <em class="oa">ω = 1.8 radians/second</em>. For each case, the capacitor and inductor values are <em class="oa">C = 0.3 farads</em> and <em class="oa">L = 1.51 henries</em>, respectively. The value of the resistor <em class="oa">R</em> is noted below for each case.</p><p id="5ad3" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><strong class="nf fr">Under-damped<br/></strong>(<em class="oa">R = 1.2 ohms</em>)</p><figure class="mn mo mp mq mr ms mk ml paragraph-image"><div class="mk ml pt"><img src="../Images/bebbbf47fa38540073e17b1920b45faa.png" data-original-src="https://miro.medium.com/v2/resize:fit:742/format:webp/1*OsJ3OU6pEikyWnk145_uSw.png"/></div><figcaption class="my mz na mk ml nb nc bf b bg z dx"><strong class="bf oc">Underdamped test case</strong></figcaption></figure><p id="a874" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><strong class="nf fr">Over-damped<br/></strong>(<em class="oa">R = 6.0 ohms</em>)</p><figure class="mn mo mp mq mr ms mk ml paragraph-image"><div class="mk ml pu"><img src="../Images/c951ac3a6978e890f3fd2e6443e3e9c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*_N-RVOB1KdgxAoDckYxKXQ.png"/></div><figcaption class="my mz na mk ml nb nc bf b bg z dx"><strong class="bf oc">Over-damped test case</strong></figcaption></figure><p id="cbb7" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><strong class="nf fr">Critically-damped<br/></strong>(<em class="oa">R = 4.487 ohms</em>)</p><figure class="mn mo mp mq mr ms mk ml paragraph-image"><div class="mk ml pv"><img src="../Images/be7a71c2f40b4bd4d3523ea3ffdadfc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:752/format:webp/1*mXDaOMYK5hFbfPd8HmCgHw.png"/></div><figcaption class="my mz na mk ml nb nc bf b bg z dx"><strong class="bf oc">critically-damped test case</strong></figcaption></figure><h2 id="c977" class="oe of fq bf oc og oh oi oj ok ol om on nm oo op oq nq or os ot nu ou ov ow ox bk">Conclusion</h2><p id="097f" class="pw-post-body-paragraph nd ne fq nf b go oy nh ni gr oz nk nl nm pa no np nq pb ns nt nu pc nw nx ny fj bk">In this article, a neural network with a custom objective function was used to successfully solve a differential equation describing an electronic circuit driven by a sinusoidal source. Typically, the solution to a differential equation is derived through a tedious analytic process or numerically. The example presented here demonstrates that a neural network can accurately solve these equations in a straightforward and efficient manner. As shown in the three test cases, the neural network response is identical to the analytic solution.</p><h2 id="4d8d" class="oe of fq bf oc og oh oi oj ok ol om on nm oo op oq nq or os ot nu ou ov ow ox bk">Appendix: PINN training notes</h2><ul class=""><li id="341c" class="nd ne fq nf b go oy nh ni gr oz nk nl nm pa no np nq pb ns nt nu pc nw nx ny pj pk pl bk">PINN structure:<br/> - input layer, 1 input<br/> - hidden layer, 128 neurons with GELU activation<br/> - hidden layer, 128 neurons with GELU activation<br/> - output layer, 1 neuron with linear activation</li><li id="adfc" class="nd ne fq nf b go pm nh ni gr pn nk nl nm po no np nq pp ns nt nu pq nw nx ny pj pk pl bk">The PINN is trained with 220 points in the time domain of 0 to 20 seconds. The number of points is controlled by the duration of the domain and a hyperparameter for the number of points per second, which is set to 11 points/sec for the test cases. This value gives a sufficient number of training points for each period of a sinusoidal driving source with <em class="oa">ω = 1.8</em>. For higher values of <em class="oa">ω</em>, more points per second are required, e.g., <em class="oa">ω = 4.0</em> requires 25 points/sec.</li><li id="ed05" class="nd ne fq nf b go pm nh ni gr pn nk nl nm po no np nq pp ns nt nu pq nw nx ny pj pk pl bk">The PINN is trained in batches of 32 points sampled from the set of all training points. The training points are randomly shuffled at every epoch.</li><li id="cadd" class="nd ne fq nf b go pm nh ni gr pn nk nl nm po no np nq pp ns nt nu pq nw nx ny pj pk pl bk">The learning rate starts at a value of 0.01 at the beginning of training and decreases by factor of 0.75 every 2000 epochs.</li><li id="1c54" class="nd ne fq nf b go pm nh ni gr pn nk nl nm po no np nq pp ns nt nu pq nw nx ny pj pk pl bk">The objective plot is an important indicator of successful training. As training progresses, the objective should decrease by several orders of magnitude and bottom out at a small value near 0. If training fails to produce this result, the hyperparameters will require adjustment. It is recommended to first try increasing the number of epochs and then increasing the number of training points per second.</li></ul><p id="1b98" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><strong class="nf fr">A pdf of this article is available </strong><a class="af nz" href="https://github.com/jmorrow1000/PINN-with-forcing-function" rel="noopener ugc nofollow" target="_blank"><strong class="nf fr">here</strong></a><strong class="nf fr">.</strong></p><p id="e726" class="pw-post-body-paragraph nd ne fq nf b go ng nh ni gr nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny fj bk"><em class="oa">All images, unless otherwise noted, are by the author.</em></p></div></div></div></div>    
</body>
</html>