<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Optimizing Marketing Campaigns with Budgeted Multi-Armed Bandits</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>Optimizing Marketing Campaigns with Budgeted Multi-Armed Bandits</h1>
<blockquote>原文：<a href="https://towardsdatascience.com/optimizing-marketing-campaigns-with-budgeted-multi-armed-bandits-a65fccd61878?source=collection_archive---------5-----------------------#2024-08-16">https://towardsdatascience.com/optimizing-marketing-campaigns-with-budgeted-multi-armed-bandits-a65fccd61878?source=collection_archive---------5-----------------------#2024-08-16</a></blockquote><div><div class="em fe ff fg fh fi"/><div class="fj fk fl fm fn"><div class="ab cb"><div class="ci bh ev ew ex ey"><div/><div><h2 id="bebb" class="pw-subtitle-paragraph gn fp fq bf b go gp gq gr gs gt gu gv gw gx gy gz ha hb hc cq dx">With demos, our new solution, and a video</h2><div><div class="speechify-ignore ab cp"><div class="speechify-ignore bh l"><div class="hd he hf hg hh ab"><div><div class="ab hi"><div><div class="bm" aria-hidden="false"><a href="https://medium.com/@vadim.arzamasov?source=post_page---byline--a65fccd61878--------------------------------" rel="noopener follow"><div class="l hj hk by hl hm"><div class="l ed"><img alt="Vadim Arzamasov" class="l ep by dd de cx" src="../Images/70ced2eafa6fc926052979875a0a4265.png" width="44" height="44" loading="lazy" data-testid="authorPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:88:88/1*sLla8xXL0qQuaiNDqAnTiw.jpeg"/><div class="hn by l dd de em n ho eo"/></div></div></a></div></div><div class="hp ab ed"><div><div class="bm" aria-hidden="false"><a href="https://towardsdatascience.com/?source=post_page---byline--a65fccd61878--------------------------------" rel="noopener follow"><div class="l hq hr by hl hs"><div class="l ed"><img alt="Towards Data Science" class="l ep by br ht cx" src="../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto" data-original-src="https://miro.medium.com/v2/resize:fill:48:48/1*CJe3891yB1A1mzMdqemkdg.jpeg"/><div class="hn by l br ht em n ho eo"/></div></div></a></div></div></div></div></div><div class="bn bh l"><div class="ab"><div style="flex:1"><span class="bf b bg z bk"><div class="hu ab q"><div class="ab q hv"><div class="ab q"><div><div class="bm" aria-hidden="false"><p class="bf b hw hx bk"><a class="af ag ah ai aj ak al am an ao ap aq ar hy" data-testid="authorName" href="https://medium.com/@vadim.arzamasov?source=post_page---byline--a65fccd61878--------------------------------" rel="noopener follow">Vadim Arzamasov</a></p></div></div></div><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span><p class="bf b hw hx dx"><button class="ib ic ah ai aj ak al am an ao ap aq ar id ie if" disabled="">Follow</button></p></div></div></span></div></div><div class="l ig"><span class="bf b bg z dx"><div class="ab cn ih ii ij"><div class="ik il ab"><div class="bf b bg z dx ab im"><span class="in l ig">Published in</span><div><div class="l" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar hy ab q" data-testid="publicationName" href="https://towardsdatascience.com/?source=post_page---byline--a65fccd61878--------------------------------" rel="noopener follow"><p class="bf b bg z io ip iq ir is it iu iv bk">Towards Data Science</p></a></div></div></div><div class="h k"><span class="hz ia" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div></div><span class="bf b bg z dx"><div class="ab ae"><span data-testid="storyReadTime">9 min read</span><div class="iw ix l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="bf b bg z dx">·</span></span></div><span data-testid="storyPublishDate">Aug 16, 2024</span></div></span></div></span></div></div></div><div class="ab cp iy iz ja jb jc jd je jf jg jh ji jj jk jl jm jn"><div class="h k w ea eb q"><div class="kd l"><div class="ab q ke kf"><div class="pw-multi-vote-icon ed in kg kh ki"><div class=""><div class="kj kk kl km kn ko kp am kq kr ks ki"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" d="M11.37.828 12 3.282l.63-2.454zM15.421 1.84l-1.185-.388-.338 2.5zM9.757 1.452l-1.184.389 1.523 2.112zM20.253 11.84 17.75 7.438c-.238-.353-.57-.584-.93-.643a.96.96 0 0 0-.753.183 1.13 1.13 0 0 0-.443.695c.014.019.03.033.044.053l2.352 4.138c1.614 2.95 1.1 5.771-1.525 8.395a7 7 0 0 1-.454.415c.997-.13 1.927-.61 2.773-1.457 2.705-2.704 2.517-5.585 1.438-7.377M12.066 9.01c-.129-.687.08-1.299.573-1.773l-2.062-2.063a1.123 1.123 0 0 0-1.555 0 1.1 1.1 0 0 0-.273.521z" clip-rule="evenodd"/><path fill-rule="evenodd" d="M14.741 8.309c-.18-.267-.446-.455-.728-.502a.67.67 0 0 0-.533.127c-.146.113-.59.458-.199 1.296l1.184 2.503a.448.448 0 0 1-.236.755.445.445 0 0 1-.483-.248L7.614 6.106A.816.816 0 1 0 6.459 7.26l3.643 3.644a.446.446 0 1 1-.631.63L5.83 7.896l-1.03-1.03a.82.82 0 0 0-1.395.577.81.81 0 0 0 .24.576l1.027 1.028 3.643 3.643a.444.444 0 0 1-.144.728.44.44 0 0 1-.486-.098l-3.64-3.64a.82.82 0 0 0-1.335.263.81.81 0 0 0 .178.89l1.535 1.534 2.287 2.288a.445.445 0 0 1-.63.63l-2.287-2.288a.813.813 0 0 0-1.393.578c0 .216.086.424.238.577l4.403 4.403c2.79 2.79 5.495 4.119 8.681.931 2.269-2.271 2.708-4.588 1.342-7.086z" clip-rule="evenodd"/></svg></div></div></div><div class="pw-multi-vote-count l kt ku kv kw kx ky kz"><p class="bf b dy z dx"><span class="kk">--</span></p></div></div></div><div><div class="bm" aria-hidden="false"><button class="ao kj la lb ab q ee lc ld" aria-label="responses"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24" class="le"><path d="M18.006 16.803c1.533-1.456 2.234-3.325 2.234-5.321C20.24 7.357 16.709 4 12.191 4S4 7.357 4 11.482c0 4.126 3.674 7.482 8.191 7.482.817 0 1.622-.111 2.393-.327.231.2.48.391.744.559 1.06.693 2.203 1.044 3.399 1.044.224-.008.4-.112.486-.287a.49.49 0 0 0-.042-.518c-.495-.67-.845-1.364-1.04-2.057a4 4 0 0 1-.125-.598zm-3.122 1.055-.067-.223-.315.096a8 8 0 0 1-2.311.338c-4.023 0-7.292-2.955-7.292-6.587 0-3.633 3.269-6.588 7.292-6.588 4.014 0 7.112 2.958 7.112 6.593 0 1.794-.608 3.469-2.027 4.72l-.195.168v.255c0 .056 0 .151.016.295.025.231.081.478.154.733.154.558.398 1.117.722 1.659a5.3 5.3 0 0 1-2.165-.845c-.276-.176-.714-.383-.941-.59z"/></svg></button></div></div></div><div class="ab q jo jp jq jr js jt ju jv jw jx jy jz ka kb kc"><div class="lf k j i d"/><div class="h k"><div><div class="bm" aria-hidden="false"><button aria-controls="addToCatalogBookmarkButton" aria-expanded="false" aria-label="Add to list bookmark button" data-testid="headerBookmarkButton" class="af ee ah ai aj ak al lg an ao ap id lh li lj" disabled=""><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24" class="av"><path fill="#000" d="M17.5 1.25a.5.5 0 0 1 1 0v2.5H21a.5.5 0 0 1 0 1h-2.5v2.5a.5.5 0 0 1-1 0v-2.5H15a.5.5 0 0 1 0-1h2.5zm-11 4.5a1 1 0 0 1 1-1H11a.5.5 0 0 0 0-1H7.5a2 2 0 0 0-2 2v14a.5.5 0 0 0 .8.4l5.7-4.4 5.7 4.4a.5.5 0 0 0 .8-.4v-8.5a.5.5 0 0 0-1 0v7.48l-5.2-4a.5.5 0 0 0-.6 0l-5.2 4z"/></svg></button></div></div></div><div class="ep lk cn"><div class="l ae"><div class="ab cb"><div class="ll lm ln lo lp lq ci bh"><div class="ab"><div class="bm bh" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0m9-10C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2m3.376 10.416-4.599 3.066a.5.5 0 0 1-.777-.416V8.934a.5.5 0 0 1 .777-.416l4.599 3.066a.5.5 0 0 1 0 .832" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bm" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bm" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M15.218 4.931a.4.4 0 0 1-.118.132l.012.006a.45.45 0 0 1-.292.074.5.5 0 0 1-.3-.13l-2.02-2.02v7.07c0 .28-.23.5-.5.5s-.5-.22-.5-.5v-7.04l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.79a.42.42 0 0 1 .068.498m-.106.138.008.004v-.01zM16 7.063h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11c-1.1 0-2-.9-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.15.5.5 0 0 1 .15.35.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9v-10.2c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">Share</p></div></button></div></div></div><div class="bm" aria-hidden="false"><div><div class="bm" aria-hidden="false"><button aria-label="More options" data-testid="headerStoryOptionsButton" class="af ee ah ai aj ak al lg an ao ap id lr ls ld lt lu lv lw lx s ly lz ma mb mc md me u mf mg mh"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" d="M4.385 12c0 .55.2 1.02.59 1.41.39.4.86.59 1.41.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.02.2-1.41.59-.4.39-.59.86-.59 1.41m5.62 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.42.59s1.02-.2 1.41-.59c.4-.39.59-.86.59-1.41s-.2-1.02-.59-1.41a1.93 1.93 0 0 0-1.41-.59c-.55 0-1.03.2-1.42.59s-.58.86-.58 1.41m5.6 0c0 .55.2 1.02.58 1.41.4.4.87.59 1.43.59s1.03-.2 1.42-.59.58-.86.58-1.41-.2-1.02-.58-1.41a1.93 1.93 0 0 0-1.42-.59c-.56 0-1.04.2-1.43.59s-.58.86-.58 1.41" clip-rule="evenodd"/></svg><div class="j i d"><p class="bf b bg z dx">More</p></div></button></div></div></div></div></div></div></div></div></div><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj mk"><img src="../Images/55a83b9cdcdd0c333303cd1cc2b0619f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vilI3Q4nlwqsAQLq3TOzSA.png"/></div></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Image created by authors with GPT-4o</figcaption></figure><p id="931a" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">Let’s dive right into a running example. Suppose a bank or a telecom company launches a new product/plan for existing customers. To promote this product, the company creates several call templates (scripts) for its sales representatives. The goal is to effectively convince customers to buy the new product or sign up for the new plan.</p><p id="30ca" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">Here’s how the campaign works:</p><ul class=""><li id="cae4" class="nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz bk"><strong class="nd fr">Call script creation: </strong>The marketing team develops multiple versions of the call script, each with a different approach to promoting the new product or plan.</li><li id="8e69" class="nb nc fq nd b go oa nf ng gr ob ni nj nk oc nm nn no od nq nr ns oe nu nv nw nx ny nz bk"><strong class="nd fr">Agent calls:</strong> Sales agents use these scripts to call a subset of customers. Each customer interaction uses one of the predefined scripts.</li><li id="b5e8" class="nb nc fq nd b go oa nf ng gr ob ni nj nk oc nm nn no od nq nr ns oe nu nv nw nx ny nz bk"><strong class="nd fr">Data Collection:</strong> During the calls, the company collects data on customer responses, such as interest shown, questions asked, and, ultimately conversion rates (i.e., how many customers buy the new product or sign up for the new plan).</li><li id="71e2" class="nb nc fq nd b go oa nf ng gr ob ni nj nk oc nm nn no od nq nr ns oe nu nv nw nx ny nz bk"><strong class="nd fr">Real-time analysis:</strong> The company analyzes this data in real time to evaluate the effectiveness of each script. This analysis helps determine which scripts are more successful in converting customers to the new plan/product.</li><li id="533e" class="nb nc fq nd b go oa nf ng gr ob ni nj nk oc nm nn no od nq nr ns oe nu nv nw nx ny nz bk"><strong class="nd fr">Strategy Update:</strong> Based on ongoing analysis, the company dynamically adjusts the frequency of use of each script. Scripts with higher conversion rates are used more often, ensuring that the campaign becomes increasingly effective over time.</li></ul><p id="9e1a" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">Next, we show how to model a simple version of this campaign using the conventional multi-armed bandit problem. As we add more details to make this model more realistic, we demonstrate how existing solutions and their simple adaptations fall short. We then present a new budgeted multi-armed bandit algorithm from our paper accepted for the KDD 2024 conference that performs very well at this task. We also provide links to the code and a short video summarizing the paper.</p><blockquote class="of og oh"><p id="2100" class="nb nc oi nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">In this story, “we” is used because I am writing it together with Marco Heyden (<a class="af oj" href="https://www.linkedin.com/in/marco-heyden-036375156/" rel="noopener ugc nofollow" target="_blank">Linkedin</a>, <a class="af oj" href="https://github.com/heymarco" rel="noopener ugc nofollow" target="_blank">Github</a>), the author of the algorithm idea and of our paper [1]. All subsequent plots are created by us and with the code from this <a class="af oj" href="https://github.com/heymarco/OmegaUCB/blob/medium_post/MediumGraphs.ipynb" rel="noopener ugc nofollow" target="_blank">Jupyter notebook</a>.</p></blockquote><h2 id="11a8" class="ok ol fq bf om on oo op oq or os ot ou nk ov ow ox no oy oz pa ns pb pc pd pe bk">Multi-armed Bandit Solution</h2><p id="6f15" class="pw-post-body-paragraph nb nc fq nd b go pf nf ng gr pg ni nj nk ph nm nn no pi nq nr ns pj nu nv nw fj bk">Our scenario is similar to a multi-armed bandit (MAB) problem. Imagine a player in a casino facing a slot machine (“bandit”) with multiple arms, each with an unknown payoff (reward) distribution. The player’s goal is to maximize their total winnings by deciding which arms to play and how often to play each one. The challenge lies in balancing <strong class="nd fr">exploration</strong>, trying different arms to gather information about their rewards, and <strong class="nd fr">exploitation</strong>, using the information gathered to play the arm with the highest known reward.</p><p id="8bdf" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">In our example, each call script acts like a slot machine arm, where the reward is the success of the script. The reward is 1 if the customer signs up for the new plan or buys the new product and 0 otherwise. For instance, three call scripts with conversion rates of <em class="oi">0.1</em>, <em class="oi">0.3</em>, and <em class="oi">0.7</em> have successes following a Bernoulli distribution with expected values of <em class="oi">0.1</em>, <em class="oi">0.3</em>, and <em class="oi">0.7</em>, respectively. The figure below illustrates the cumulative rewards for different strategies. The purple line represents using the <strong class="nd fr">script 1</strong> with a conversion rate of <em class="oi">0.1</em>, while the green line represents using the <strong class="nd fr">script 3</strong> with a conversion rate of <em class="oi">0.7</em>. These lines define the range of probable rewards. The light blue line shows the cumulative reward for a strategy that randomly selects a script for each call. In a realistic environment where only <strong class="nd fr">estimates</strong> of conversion rates are available, the cumulative reward of a good strategy should be close to the green line and at least above the light blue line.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj pk"><img src="../Images/b97615e347ddcfff1b6142a200d49b35.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LjL3P0oZR3re7Wghy6-6eA.png"/></div></div></figure><p id="1d6f" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">A popular strategy for the multi-armed bandit problem is the Upper Confidence Bound (UCB) algorithm [2]. It assigns an upper confidence bound to the expected reward of each arm (call script) and plays the arm with the highest upper confidence bound. In this way, the algorithm actively explores actions with high uncertainty while exploiting actions with high known rewards. Mathematically, the UCB algorithm plays the arm <em class="oi">i, </em>which solves</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj pl"><img src="../Images/6bee372fad712b4b37a1ca32275063d4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hfPmXvXm9Kks7O3ilCisEg.png"/></div></div></figure><ul class=""><li id="cd85" class="nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz bk"><em class="oi">rᵢ(t)</em> is the <strong class="nd fr">empirical</strong> mean reward of arm <em class="oi">i</em> up to time <em class="oi">t</em>.</li><li id="61eb" class="nb nc fq nd b go oa nf ng gr ob ni nj nk oc nm nn no od nq nr ns oe nu nv nw nx ny nz bk"><em class="oi">Nᵢ(t)</em> is the number of times arm <em class="oi">i</em> has been played up to time <em class="oi">t</em>.</li><li id="eb84" class="nb nc fq nd b go oa nf ng gr ob ni nj nk oc nm nn no od nq nr ns oe nu nv nw nx ny nz bk"><em class="oi">t</em> is the total number of plays so far.</li></ul><p id="6868" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">The white line in the figure below shows this strategy in action for our example.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj pk"><img src="../Images/a19ab6f9cf4b5b6e71d1cbfc8c39a10c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3bvdV0C6nX84cGm5z_LUVQ.png"/></div></div></figure><blockquote class="of og oh"><p id="c608" class="nb nc oi nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">This upper bound is based on the Chernoff-Hoeffding bounds assuming a payoff distribution with support in [0,1], which is exactly our case. For reward distributions with different support [a<em class="fq">ᵢ</em>ʳ,b<em class="fq">ᵢ</em>ʳ], where aᵢʳ and a<em class="fq">ᵢ</em>ʳ are finite, the UCB should be scaled accordingly:</p></blockquote><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj pm"><img src="../Images/faa210a12056d9487ddab651356ba58b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k303MnSEvtkzOq_9jFmTbg.png"/></div></div></figure><h2 id="9306" class="ok ol fq bf om on oo op oq or os ot ou nk ov ow ox no oy oz pa ns pb pc pd pe bk">The Importance of the Budget</h2><p id="3a30" class="pw-post-body-paragraph nb nc fq nd b go pf nf ng gr pg ni nj nk ph nm nn no pi nq nr ns pj nu nv nw fj bk">So far we have focused on maximizing the sum of rewards after a given number of calls. However, it is unrealistic to expect calls corresponding to different scripts to have the same duration. If the marketing team’s capacity does not allow them to reach all customers within a given time budget (e.g., several months), it would be more practical to maximize the cumulative reward for a given call duration rather than the number of calls.</p><p id="3807" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">In our example, assume that the call duration (=costs) for <strong class="nd fr">scripts 1</strong>, <strong class="nd fr">2</strong>, and <strong class="nd fr">3</strong> are constant (we will relax this assumption later) and equal <em class="oi">1</em>, <em class="oi">2</em>, and <em class="oi">8</em> minutes, respectively. If we now plot the results based on the total call duration instead of the number of calls, the strategy that always uses <strong class="nd fr">script 2</strong> becomes the best choice, while the strategy that uses <strong class="nd fr">script 3</strong> becomes the worst. The above UCB strategy that only considers conversion rates now performs much worse than a random strategy.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj pk"><img src="../Images/5a4d274d04fea2f00a452e848323ffa7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cYiDpk0s9QrUFv_5VqkglQ.png"/></div></div></figure><p id="287f" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">It is not difficult to cure the UCB strategy by normalizing reward estimates <em class="oi">rᵢ(t)</em> wit<em class="oi">h cᵢ</em> counterparts and adjusting the UCB as in formula (2) above:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj pn"><img src="../Images/2d4afca2106e95bd1087e51c69df2f2f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xe-lor5QR45Z9pmLkm1_jw.png"/></div></div></figure><p id="005e" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">The UCB strategy that was updated in this way is working quite well again:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj pk"><img src="../Images/b82a9d31388ad0b6c8de1bbe64f741b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rxOe7afyLwLEWZoydWvADA.png"/></div></div></figure><h2 id="4213" class="ok ol fq bf om on oo op oq or os ot ou nk ov ow ox no oy oz pa ns pb pc pd pe bk">Random Call Duration</h2><p id="4e12" class="pw-post-body-paragraph nb nc fq nd b go pf nf ng gr pg ni nj nk ph nm nn no pi nq nr ns pj nu nv nw fj bk">Observe that the assumption of a fixed call duration is also unrealistic. When both reward and cost are not fixed, there are several ways to extend the UCB strategy to this case, such as</p><p id="dea5" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk"><strong class="nd fr">Reductive:</strong> By treating the reward to cost ratio <em class="oi">vᵢ=rᵢ/cᵢ</em> as a single random variable and pulling the arm with the highest upper bound UCB<em class="oi">ᵢᵛ</em> of it:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj po"><img src="../Images/0d7ab7d3534c9c520e92024230b169cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ac5DIY_9ZBL7SmHlWiVB6g.png"/></div></div></figure><p id="3ae7" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk"><strong class="nd fr">United:</strong> By ignoring the variation in costs and using their estimates <em class="oi">cᵢ(t)</em> to scale the UCB<em class="oi">ᵢʳ</em> of rewards similarly to formula (3):</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj pp"><img src="../Images/d6594c1d73d09c1d7725f02b5e70fd15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pzb92QcPFep9mDK6HE-g5Q.png"/></div></div></figure><p id="9f8f" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk"><strong class="nd fr">Composite:</strong> By pulling the arm that maximizes the ratio UCB<em class="oi">ᵢʳ/</em>LCB<em class="oi">ᵢᶜ</em> of the upper reward bound to the lower cost bound:</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj pq"><img src="../Images/f9a22c90c36f6116bba9671560e2c8a1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hq9AUaWKeiUKvibz8cCz0g.png"/></div></div></figure><p id="3dbb" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">In (6) we assume that the rewards come from <em class="oi">[0,1]</em>, as before, to keep the formula a bit simpler.</p><p id="3b93" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">All the above strategies have problems, being either excessively optimistic, too pessimistic, or just optimizing the wrong quantity.</p><p id="0374" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">The<strong class="nd fr"> Reductive </strong>strategy (4)<strong class="nd fr"> </strong>seeks to maximize the expectation of the reward-cost ratio 𝔼(<em class="oi">vᵢ</em>)=𝔼(<em class="oi">rᵢ/cᵢ</em>). This is different from the campaign goal of maximizing reward while keeping costs within a given budget. For sufficiently high budgets, the latter is equivalent to maximizing the ratio of reward and cost expectations 𝔼(<em class="oi">rᵢ</em>)<em class="oi">/</em>𝔼(<em class="oi">cᵢ</em>). To see why 𝔼(<em class="oi">rᵢ/cᵢ</em>)<em class="oi">≠</em>𝔼(<em class="oi">rᵢ</em>)<em class="oi">/</em>𝔼(<em class="oi">cᵢ</em>), observe that if both <em class="oi">rᵢ</em> and <em class="oi">cᵢ</em> are i.i.d. Bernoulli distributed variables, then 𝔼(<em class="oi">rᵢ</em>)<em class="oi">/</em>𝔼(<em class="oi">cᵢ</em>)<em class="oi">=1</em>, while 𝔼(<em class="oi">rᵢ/cᵢ</em>) is infinite or undefined, depending on how you resolve the division by zero. The support of <em class="oi">vᵢ=rᵢ/cᵢ</em> is also infinite in this case, making the UCB formula (4) useless.</p><p id="6777" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">Because the <strong class="nd fr">United</strong> strategy does not account for cost variation, it often produces upper confidence bounds that are too tight, limiting the exploration part of the strategy. This happens whenever the empirical mean of the costs exceeds the true mean, e.g. in 50% of the cases with a symmetric cost distribution.</p><p id="4b36" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">The <strong class="nd fr">Composite</strong> strategy explicitly models uncertainty in costs. However, this model is too conservative, allowing the denominator to be zero or even negative(!). As a result, the composite strategy spends too many resources on exploration and undervalues the exploitation step.</p><p id="b60b" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">Note also that the upper bound for the mean reward discussed so far can be well above 1, even though we know that the reward takes values in <em class="oi">{0,1}</em>. In such a case, this bound is obviously too loose, which may increase exploration and thus partially offset the effect of considering the costs fixed in the <strong class="nd fr">United</strong> strategy.</p><p id="d379" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">The following plot shows the performance of all three strategies for our example setting, where we now model the call duration with beta distributions with support <em class="oi">[1,10]</em> and expected values of <em class="oi">1</em>, <em class="oi">2</em>, and <em class="oi">8</em> minutes for <strong class="nd fr">scripts 1</strong>, <strong class="nd fr">2</strong>, and <strong class="nd fr">3</strong>, respectively. The <strong class="nd fr">Reductive</strong> strategy performs almost as poorly as selecting a random script, the <strong class="nd fr">Composite</strong> strategy performs slightly better, and the <strong class="nd fr">United</strong> strategy emerges as the clear winner. But can one beat the <strong class="nd fr">United</strong> strategy?</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj pk"><img src="../Images/c3bfb542d5898b7868a92dfbc4232fc1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*eDbYFlOrAe1WCp260w-4RQ.png"/></div></div></figure><h2 id="3266" class="ok ol fq bf om on oo op oq or os ot ou nk ov ow ox no oy oz pa ns pb pc pd pe bk">Our Solution: Asymmetric Confidence Intervals</h2><p id="93b2" class="pw-post-body-paragraph nb nc fq nd b go pf nf ng gr pg ni nj nk ph nm nn no pi nq nr ns pj nu nv nw fj bk">Our ω-UCB strategy addresses the shortcomings of the previously described solutions. While we start with the same ratio of UCB<em class="oi">ᵢʳ</em>/LCB<em class="oi">ᵢᶜ</em> as the composite strategy, we use a different method to compute these bounds. Our confidence intervals are more precise and remain within the support of the rewards or costs. Specifically, let <em class="oi">p</em> be a bounded random variable — either a reward or a cost — with support <em class="oi">[a,b]</em>. We compute the confidence interval <em class="oi">[</em>LCB<em class="oi">ᵖ</em>, UCB<em class="oi">ᵖ]</em> for <em class="oi">p</em> as follows.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj pr"><img src="../Images/36754f8229e783e24d9eb3cfa9ef806a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Hckt8wOT6r73-HVv7edhqA.png"/></div></div></figure><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj pp"><img src="../Images/f0c4c5e86829d8df30dd5a937e530a54.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*M8N_VTXZdDl1HMjkBbcBMA.png"/></div></div></figure><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj pq"><img src="../Images/77c2468bdc80721b55824dd9fda421ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6SbygIqPvPLWnnnyznQtdw.png"/></div></div></figure><ul class=""><li id="273e" class="nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw nx ny nz bk"><em class="oi">μ</em> is the empirical mean of <em class="oi">p</em> at time <em class="oi">t</em>,</li><li id="9d54" class="nb nc fq nd b go oa nf ng gr ob ni nj nk oc nm nn no od nq nr ns oe nu nv nw nx ny nz bk"><em class="oi">σ²</em> is the empirical variance of <em class="oi">p</em> at time <em class="oi">t</em>,</li><li id="6e02" class="nb nc fq nd b go oa nf ng gr ob ni nj nk oc nm nn no od nq nr ns oe nu nv nw nx ny nz bk"><em class="oi">N</em> is the number of observations of <em class="oi">p</em> up to time <em class="oi">t</em>,</li><li id="38af" class="nb nc fq nd b go oa nf ng gr ob ni nj nk oc nm nn no od nq nr ns oe nu nv nw nx ny nz bk"><em class="oi">t</em> is the current time,</li><li id="dce9" class="nb nc fq nd b go oa nf ng gr ob ni nj nk oc nm nn no od nq nr ns oe nu nv nw nx ny nz bk"><em class="oi">c</em> is the number of arm pulls after which one expects reliable estimates of mean and variance; in practice, <em class="oi">c=30</em> works well,</li><li id="7581" class="nb nc fq nd b go oa nf ng gr ob ni nj nk oc nm nn no od nq nr ns oe nu nv nw nx ny nz bk"><em class="oi">ρ</em> is the parameter of ω-UCB; <em class="oi">ρ=1</em> gives better asymptotic properties of ω-UCB, but for practical use, when the number of games is <em class="oi">~10⁴</em> or less, we recommend <em class="oi">ρ=1/4.</em></li></ul><p id="45e4" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">The following figure shows how good the ω-UCB is. Using it provides almost the maximum possible cumulative reward.</p><figure class="ml mm mn mo mp mq mi mj paragraph-image"><div role="button" tabindex="0" class="mr ms ed mt bh mu"><div class="mi mj pk"><img src="../Images/b121d0fe1b5c56d663f8a5e30630e03f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qRgWQq3IRIRBIivfmBcsiQ.png"/></div></div></figure><p id="9e52" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">We also created a 2-minute video summarizing the idea of the ω-UCB:</p><figure class="ml mm mn mo mp mq"><div class="ps io l ed"><div class="pt pu l"/></div><figcaption class="mw mx my mi mj mz na bf b bg z dx">Video created by Marco Heyden for KDD 2024. If you enjoy it, please feel free to give it an upvote on YouTube</figcaption></figure><h2 id="1fad" class="ok ol fq bf om on oo op oq or os ot ou nk ov ow ox no oy oz pa ns pb pc pd pe bk">Final Thoughts</h2><p id="6111" class="pw-post-body-paragraph nb nc fq nd b go pf nf ng gr pg ni nj nk ph nm nn no pi nq nr ns pj nu nv nw fj bk">By now, you are well equipped with insights on how to optimize a marketing campaign in real time using instant customer feedback. We have described a powerful algorithm to help you do this. However, it would be overly optimistic to assume that this alone will guarantee success. Below, we outline a few additional considerations that can further enhance a campaign’s effectiveness.</p><p id="0b33" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">First, it is unlikely that the reward will be known immediately. Often, the best you can hope for is an indication of interest from the customer. Therefore, constructing a reliable proxy for the reward, perhaps using data from previous campaigns, is essential.</p><p id="b479" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">Next, this discussion has focused on selecting the best script for an average or representative customer. Digging a little deeper, it is likely that different scripts will work better for different groups of customers. The best script may vary by group. A simple approach would be to segment customers and treat each segment-script combination as a separate arm in the Budgeted MAB algorithm we described. In an earlier story, I discussed a method for identifying interesting customer segments; for a campaign, selecting an appropriate target variable for this method will be important.</p><div class="pv pw px py pz qa"><a rel="noopener follow" target="_blank" href="/find-unusual-segments-in-your-data-with-subgroup-discovery-2661a586e60c?source=post_page-----a65fccd61878--------------------------------"><div class="qb ab ig"><div class="qc ab co cb qd qe"><h2 class="bf fr hw z io qf iq ir qg it iv fp bk">Find Unusual Segments in Your Data with Subgroup Discovery</h2><div class="qh l"><h3 class="bf b hw z io qf iq ir qg it iv dx">Patient rule induction method finds 35% better segments than previously reported</h3></div><div class="qi l"><p class="bf b dy z io qf iq ir qg it iv dx">towardsdatascience.com</p></div></div><div class="qj l"><div class="qk l ql qm qn qj qo lq qa"/></div></div></a></div><p id="08af" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">Finally, in addition to customer characteristics, “environmental” factors such as time of day or day of week can affect the relative performance of scripts. To account for all of these factors, you might consider extending the methodology to <strong class="nd fr">contextual budgeted bandits</strong>, which is the subject of a separate story.</p><h2 id="710c" class="ok ol fq bf om on oo op oq or os ot ou nk ov ow ox no oy oz pa ns pb pc pd pe bk">References</h2><p id="2164" class="pw-post-body-paragraph nb nc fq nd b go pf nf ng gr pg ni nj nk ph nm nn no pi nq nr ns pj nu nv nw fj bk">[1] Marco Heyden, Vadim Arzamasov, Edouard Fouché, and Klemens Böhm. “Budgeted Multi-Armed Bandits with Asymmetric Confidence Intervals.” <em class="oi">KDD </em>’24</p><p id="c87e" class="pw-post-body-paragraph nb nc fq nd b go ne nf ng gr nh ni nj nk nl nm nn no np nq nr ns nt nu nv nw fj bk">[2] Peter Auer, Nicolo Cesa-Bianchi, and Paul Fischer. “Finite-time analysis of the multiarmed bandit problem.” <em class="oi">Machine learning</em> 47 (2002): 235–256.</p></div></div></div></div>    
</body>
</html>