- en: Dog Poop Compass
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 狗狗排便指南针
- en: 原文：[https://towardsdatascience.com/dog-poop-compass-bayesian-analysis-of-canine-business-f95a4b9f2bf9?source=collection_archive---------3-----------------------#2024-11-25](https://towardsdatascience.com/dog-poop-compass-bayesian-analysis-of-canine-business-f95a4b9f2bf9?source=collection_archive---------3-----------------------#2024-11-25)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://towardsdatascience.com/dog-poop-compass-bayesian-analysis-of-canine-business-f95a4b9f2bf9?source=collection_archive---------3-----------------------#2024-11-25](https://towardsdatascience.com/dog-poop-compass-bayesian-analysis-of-canine-business-f95a4b9f2bf9?source=collection_archive---------3-----------------------#2024-11-25)
- en: A Bayesian analysis of canine business
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 狗狗行为的贝叶斯分析
- en: '[](https://datawondering.com/?source=post_page---byline--f95a4b9f2bf9--------------------------------)[![Dima
    Sergeev](../Images/62e582badeef3041a535414ac5b79048.png)](https://datawondering.com/?source=post_page---byline--f95a4b9f2bf9--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--f95a4b9f2bf9--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--f95a4b9f2bf9--------------------------------)
    [Dima Sergeev](https://datawondering.com/?source=post_page---byline--f95a4b9f2bf9--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://datawondering.com/?source=post_page---byline--f95a4b9f2bf9--------------------------------)[![Dima
    Sergeev](../Images/62e582badeef3041a535414ac5b79048.png)](https://datawondering.com/?source=post_page---byline--f95a4b9f2bf9--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--f95a4b9f2bf9--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--f95a4b9f2bf9--------------------------------)
    [Dima Sergeev](https://datawondering.com/?source=post_page---byline--f95a4b9f2bf9--------------------------------)'
- en: ·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--f95a4b9f2bf9--------------------------------)
    ·22 min read·Nov 25, 2024
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: ·发表于[Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--f95a4b9f2bf9--------------------------------)
    ·阅读时间：22分钟·2024年11月25日
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: tl;dr
  id: totrans-6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: tl;dr
- en: Do dogs poop facing North and South? Turns out they do! Want to learn how to
    measure this at home using a compass app, Bayesian statistics, and one dog (dog
    not included)? Jump in!
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 狗狗是朝北和朝南排便吗？结果证明它们确实是！想学会如何使用指南针应用程序、贝叶斯统计和一只狗（狗狗不包括在内）在家里测量这个现象吗？那就跟我一起看看吧！
- en: Introduction
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 引言
- en: This is my dog. His name is Auri and he is a 5 year old Cavalier King Charles
    Spaniel.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 这是我的狗。它的名字叫Auri，是一只5岁的凯文犬（Cavalier King Charles Spaniel）。
- en: '![](../Images/5f8a4dec752dfd712c3586dc50a6a50c.png)'
  id: totrans-10
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/5f8a4dec752dfd712c3586dc50a6a50c.png)'
- en: Auri (image by author)
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: Auri（图由作者提供）
- en: As many other dog owners, during our walks I noticed that Auri has a very particular
    ritual when he needs to go to the bathroom. When he finds a perfect spot he starts
    circling around something like a compass.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 和许多其他狗主人一样，在我们散步时，我注意到Auri在需要去厕所时有一个非常独特的仪式。当他找到一个合适的地点时，他会开始围绕某个东西转圈，就像一个指南针。
- en: At first I was simply amused by this behaviour. After all, who knows what goes
    through a dog’s mind? But after a while I remembered reading a research paper
    from 2013 titled [“Dogs are sensitive to small variations of the Earth’s magnetic
    field”](https://frontiersinzoology.biomedcentral.com/counter/pdf/10.1186/1742-9994-10-80.pdf).
    The research was conducted on a relatively large sample of dogs and confirmed
    that “dogs preferred to excrete with the body being aligned along the north-south
    axis”.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 起初，我只是觉得这种行为很有趣。毕竟，谁知道狗狗在想些什么呢？但过了一段时间，我记得曾读过一篇2013年的研究论文，标题是[“Dogs are sensitive
    to small variations of the Earth’s magnetic field”](https://frontiersinzoology.biomedcentral.com/counter/pdf/10.1186/1742-9994-10-80.pdf)。这项研究在相对较大的狗狗样本中进行，证实了“狗狗倾向于在北南轴对齐的情况下排便”。
- en: '*Now that could be an interesting research to try out!* I thought to myself.
    And how lucky that I have a perfect test subject, a lovely canine of my own. I
    decided to replicate the findings and confirm (or debunk!) the hypothesis with
    Auri, my N=1 unsuspecting research participant.'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: '*这似乎是个有趣的研究课题！* 我心想。多么幸运，我正好有一个完美的实验对象——我自己心爱的狗狗。我决定复现这些发现，并通过Auri这个N=1的意外研究参与者来验证（或推翻！）这个假设。'
- en: And so began my long journey of data collection spanning multiple months and
    capturing over 150 of “alignment sessions” if you catch my drift.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 就这样，我开始了长达几个月的数据收集之旅，记录了超过150次的“对齐”行为，如果你明白我的意思的话。
- en: Data Collection
  id: totrans-16
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 数据收集
- en: For my study, I needed to have a compass measurement for every time Auri pooped.
    Thank to modern technological advancements we not only have [a calculator app
    for iPad](https://www.theverge.com/2024/6/10/24175487/ipad-calculator-app-ipados18-pencil-apple-wwdc2024)
    but also a [fairly accurate](https://www.simplymac.com/apps/how-accurate-is-the-iphone-compass)
    compass on a phone. And that’s what I decided to use.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 对于我的研究，我需要记录每次Auri排便时的指南针数据。得益于现代科技的进步，我们不仅有[iPad的计算器应用](https://www.theverge.com/2024/6/10/24175487/ipad-calculator-app-ipados18-pencil-apple-wwdc2024)，还可以在手机上使用[相当精确的](https://www.simplymac.com/apps/how-accurate-is-the-iphone-compass)指南针。于是我决定使用这个。
- en: The approach was very simple. Every time my dog settled to have some private
    time I opened the compass app, aligned my phone along Auri’s body and took a screenshot.
    In the original paper the authors eloquently called the alignment as *a compass
    direction of the thoracic spine (between scapulae) towards the head*. Very scientific.
    All it means is that the compass arrow is supposed to point at the same direction
    as dog’s head.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 方法非常简单。每次我的狗安静下来准备享受私人时光时，我就打开指南针应用程序，把手机与Auri的身体对齐，并截图。在原始论文中，作者优雅地将这种对齐称为*胸椎（肩胛骨之间）朝向头部的指南针方向*。非常科学。其实就是意味着指南针的箭头应指向与狗头相同的方向。
- en: '![](../Images/40d6a8344373312ad0c80743e791b191.png)'
  id: totrans-19
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/40d6a8344373312ad0c80743e791b191.png)'
- en: '[Dogs are sensitive to small variations of the Earth’s magnetic field, Vlastimil
    Hart et al.](https://frontiersinzoology.biomedcentral.com/counter/pdf/10.1186/1742-9994-10-80.pdf)'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: '[狗对地球磁场微小变化非常敏感，Vlastimil Hart等人](https://frontiersinzoology.biomedcentral.com/counter/pdf/10.1186/1742-9994-10-80.pdf)'
- en: Anyways, that’s what I did in total 150 something times over the course of a
    few months. I could almost sense the passer bys’ confusion mixed with curiosity
    as I was seemingly taking pictures of all my dog’s relief acts. But was it worth
    it? Let’s find out!
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 总之，这就是我在几个月的时间里总共做了大约150次的事情。每当我似乎在拍摄我家狗狗的排泄行为时，我几乎能感觉到路人们混合着困惑和好奇的目光。但这值得吗？让我们来看看吧！
- en: Analysis
  id: totrans-22
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 分析
- en: I’ll briefly discuss the data extraction and preprocessing here and then jump
    straight to working with circular distributions and hypothesis testing.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 我将在这里简要讨论数据提取和预处理，然后直接进入圆形分布和假设检验的部分。
- en: 'As always, all the code can be found on my GitHub here: [Data Wondering](https://github.com/DmitrySerg/data-wondering/tree/main/bayesian-dog-poop).'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 和往常一样，所有代码都可以在我的GitHub上找到：[Data Wondering](https://github.com/DmitrySerg/data-wondering/tree/main/bayesian-dog-poop)。
- en: How to process app screenshots?
  id: totrans-25
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 如何处理应用截图？
- en: 'After data collection I had a series of screenshots of the compass app:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 数据收集后，我得到了若干张指南针应用截图：
- en: '![](../Images/d2b8c3a46070b0eb2047d7317029992d.png)'
  id: totrans-27
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d2b8c3a46070b0eb2047d7317029992d.png)'
- en: Compass app screenshot (image by author)
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 指南针应用截图（作者提供的图片）
- en: Being lazy as I am I didn’t feel like scrolling through all of them patiently
    writing down the compass degrees. So I decided to send all those images to my
    notebook and automate the process.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 因为我懒得一张张图片地查看并耐心地写下指南针的度数，所以我决定将所有这些图片发送到我的笔记本，并自动化这个过程。
- en: The task was simple — all I needed from the images was the big numbers at the
    bottom of the screen. Fortunately, there are a lot of small pretrained networks
    out there that can do basic [OCR](https://en.wikipedia.org/wiki/Optical_character_recognition)
    (stands for Optical character recognition). I opted for an `[easyocr](https://github.com/JaidedAI/EasyOCR)`
    package which was a bit on a slower end but free and easy to work with.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 任务很简单——我只需要从这些图片中获取屏幕底部的大数字。幸运的是，有很多小型的预训练网络可以做基本的[光学字符识别（OCR）](https://en.wikipedia.org/wiki/Optical_character_recognition)。我选择了一个名为`[easyocr](https://github.com/JaidedAI/EasyOCR)`的包，虽然它稍慢一点，但免费且容易使用。
- en: I’ll walk you through a quick example of using `easyocr` alongside with `[opencv](https://opencv.org/)`
    to extract the numbers from a single screenshot.
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 我将为你展示一个简单的例子，演示如何使用`easyocr`与`[opencv](https://opencv.org/)`结合，从单张截图中提取数字。
- en: 'First, let’s load the image and display it:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们加载图像并显示它：
- en: '[PRE0]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: '![](../Images/c42af7627123c9f8bf71f71b333cbb6a.png)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c42af7627123c9f8bf71f71b333cbb6a.png)'
- en: Image by author
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 图片由作者提供
- en: 'Next, I convert the image to greyscale to remove any color information and
    make it less noisy:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我将图像转换为灰度，以去除任何颜色信息并减少噪声：
- en: '[PRE1]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '![](../Images/eb2cd69c076f290f6deee122198215a6.png)'
  id: totrans-38
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/eb2cd69c076f290f6deee122198215a6.png)'
- en: Image by author
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 图片由作者提供
- en: 'And then I zoom in on the area of interest:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 接着，我将放大感兴趣的区域：
- en: '![](../Images/6e9f14b9749c3719bfde09111822d570.png)'
  id: totrans-41
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/6e9f14b9749c3719bfde09111822d570.png)'
- en: Image by author
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 图片来源：作者
- en: Finally, I use *easyocr* to extract the numbers from the image. It does extract
    both the number and the confidence score but I am only interested in the number.
  id: totrans-43
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，我使用*easyocr*从图片中提取数字。它提取了数字和置信度评分，但我只对数字感兴趣。
- en: '[PRE2]'
  id: totrans-44
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '[PRE3]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: And that’s it! I wrote a simple for loop to iterate through all the screenshots
    and saved the results to a CSV file.
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 就是这样！我写了一个简单的for循环来遍历所有截图，并将结果保存到CSV文件中。
- en: 'Here’s a link to the full preprocessing notebook: [Data Preprocessing](https://github.com/DmitrySerg/data-wondering/blob/main/bayesian-dog-poop/notebooks/0-data-preprocessing.ipynb).'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 这是完整预处理笔记本的链接：[数据预处理](https://github.com/DmitrySerg/data-wondering/blob/main/bayesian-dog-poop/notebooks/0-data-preprocessing.ipynb)。
- en: '![](../Images/a068fb6851bf4c3f1511a667403b7d8b.png)'
  id: totrans-48
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a068fb6851bf4c3f1511a667403b7d8b.png)'
- en: Image by author
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 图片来源：作者
- en: 'Spinning the wheel: Circular Distributions'
  id: totrans-50
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 转动轮盘：圆形分布
- en: 'I don’t usually work with circular distributions so I had to do some reading.
    Unlike regular data that we are used to, circular data has a peculiar property:
    the “ends” of the distribution are connected.'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 我通常不处理圆形分布，因此我必须做一些阅读。与我们常见的常规数据不同，圆形数据有一个特殊的属性：分布的“端点”是连接的。
- en: For example, if you take the distribution of hours in a day, you would find
    that the distance between 23:00 and 00:00 is the same as between 00:00 and 01:00\.
    Or, in the case of compass degrees, the distance between 359° and 0° is the same
    as between 0° and 1°.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，如果你考虑一天中的小时分布，你会发现23:00到00:00之间的距离与00:00到01:00之间的距离是相同的。或者，在指南针角度的情况下，359°和0°之间的距离与0°和1°之间的距离是相同的。
- en: Even calculating a sample mean is not straightforward. A standard arithmetic
    mean between 360° and 0° would give 180° although both 360° and 0° point to the
    exact same direction.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: 即使计算样本均值也不是直截了当的。360°和0°之间的标准算术均值将是180°，尽管360°和0°指向完全相同的方向。
- en: 'Similarly in my case, I got almost perfectly opposite estimates when calculating
    the mean in an arithmetic and in correct way. I converted the degrees to radians
    using a helper function from this nice library: [pingouin](https://pingouin-stats.org/build/html/generated/pingouin.convert_angles.html#pingouin.convert_angles)
    and calculated the mean using the `circ_mean` function.'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 在我的情况下，计算算术均值和正确的均值时，我得到了几乎完全相反的估算。我使用这个不错的库中的辅助函数将角度转换为弧度：[pingouin](https://pingouin-stats.org/build/html/generated/pingouin.convert_angles.html#pingouin.convert_angles)，并使用`circ_mean`函数计算均值。
- en: '[PRE4]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '[PRE5]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: Next, I wanted to visualize the compass distribution. I used the [Von Mises
    distribution](https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.vonmises.html)
    to model the circular data and drew the polar plot using [matplotlib](https://matplotlib.org/stable/gallery/pie_and_polar_charts/polar_demo.html).
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，我想可视化指南针分布。我使用[冯·米塞斯分布](https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.vonmises.html)来建模圆形数据，并使用[matplotlib](https://matplotlib.org/stable/gallery/pie_and_polar_charts/polar_demo.html)绘制极坐标图。
- en: 'The **Von Mises** distribution is the circular analogue of the normal distribution.
    It is defined by two parameters: the mean location μ and the concentration κ.
    The concentration parameter controls the spread and is analogous to the inverse
    of the variance. When κ is 0 the distribution is uniform, as κ increases the distribution
    contracts around the mean.'
  id: totrans-58
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '**冯·米塞斯**分布是圆形分布的正态分布类比。它由两个参数定义：均值位置μ和集中度κ。集中度参数控制分布的扩展，类似于方差的倒数。当κ为0时，分布是均匀的，随着κ的增加，分布会围绕均值收缩。'
- en: 'Let’s import the necessary libraries and define the helper functions:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们导入必要的库并定义辅助函数：
- en: '[PRE6]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Now let’s load the data and plot the charts:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们加载数据并绘制图表：
- en: '[PRE7]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '![](../Images/c24f301cacfa262e4d67cac6d7174a2e.png)'
  id: totrans-63
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c24f301cacfa262e4d67cac6d7174a2e.png)'
- en: Circular histogram of doggy business (image by author)
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 狗狗排便的圆形直方图（图片来源：作者）
- en: From the histogram it’s clear that Auri has his preferences when choosing the
    relief direction. There’s a clear spike towards the North and a dip towards the
    South. Nice!
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 从直方图中可以明显看出，Auri在选择缓解方向时有自己的偏好。北方方向有明显的峰值，南方方向则有一个低谷。很棒！
- en: '![](../Images/222d793339b8090e7ae2514350de4bef.png)'
  id: totrans-66
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/222d793339b8090e7ae2514350de4bef.png)'
- en: Circular KDE of doggy business (image by author)
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 狗狗排便的圆形KDE（图片来源：作者）
- en: With the KDE plot we get a smoother representation of the distribution. And
    the good news is that it is very far from being a uniform circle.
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 通过KDE图，我们可以获得分布的更平滑表示。好消息是，它离均匀圆形非常远。
- en: It’s time to validate it statistically!
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 该是进行统计验证的时候了！
- en: Statistically Significant Poops
  id: totrans-70
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 统计学显著的排便
- en: Just as circular data requires special treatment for visualizations and distributions,
    it also requires special statistical tests.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 就像圆形数据需要特别的可视化和分布处理一样，它也需要特别的统计检验。
- en: I’ll be using a few tests from the [pingouin](https://pingouin-stats.org/) library
    I already mentioned earlier. The first test I’ll use is the [Rayleigh test](https://en.wikipedia.org/wiki/Rayleigh_test)
    which is a test for uniformity of circular data. The null hypothesis claims that
    the data is uniformly distributed around the circle and the alternative is that
    it is not.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 我将使用之前提到的 [pingouin](https://pingouin-stats.org/) 库中的几个测试。我将使用的第一个测试是 [Rayleigh
    检验](https://en.wikipedia.org/wiki/Rayleigh_test)，它是一个用于检验圆形数据均匀性的测试。原假设认为数据在圆周上均匀分布，备择假设认为数据不均匀。
- en: '[PRE8]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: '[PRE9]'
  id: totrans-74
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: Good news, everyone! The p-value is less than 0.05 and we reject the null hypothesis.
    Auri’s strategic poop positioning is not random!
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 好消息，大家！p值小于 0.05，我们拒绝原假设。Auri 的战略性排便位置并非随机的！
- en: The only downside is that the test [assumes](https://pingouin-stats.org/build/html/generated/pingouin.circ_rayleigh.html#:~:text=The%20assumptions%20for%20the%20Rayleigh%20test%20are%20that%20(1)%20the%20distribution%20has%20only%20one%20mode%20and%20(2)%20the%20data%20is%20sampled%20from%20a%20von%20Mises%20distribution.)
    that the distribution has only one mode and the data is sampled from a von Mises
    distribution. Oh well, let’s try something else then. Auri’s data clearly has
    multiple modes.
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 唯一的缺点是该测试[假设](https://pingouin-stats.org/build/html/generated/pingouin.circ_rayleigh.html#:~:text=The%20assumptions%20for%20the%20Rayleigh%20test%20are%20that%20(1)%20the%20distribution%20has%20only%20one%20mode%20and%20(2)%20the%20data%20is%20sampled%20from%20a%20von%20Mises%20distribution.)分布只有一个模态，并且数据是从冯·米塞斯分布中采样的。唉，那我们换个方法试试吧。Auri
    的数据显然有多个模态。
- en: 'The next on the list is the [V-test](https://pingouin-stats.org/build/html/generated/pingouin.circ_vtest.html).
    This test checks if the data is non-uniform with a specified mean direction. From
    the documentation we get that:'
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来是 [V 检验](https://pingouin-stats.org/build/html/generated/pingouin.circ_vtest.html)。该测试检查数据是否具有特定的均值方向且非均匀。从文档中我们得知：
- en: The V test has more power than the Rayleigh test and is preferred if there is
    reason to believe in a specific mean direction.
  id: totrans-78
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: V 检验比雷leigh检验有更高的效能，并且如果有理由相信某个特定的均值方向，推荐使用 V 检验。
- en: Perfect! Let’s try it.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: 完美！让我们试试。
- en: From the distribution it’s clear that Auri prefers the South direction above
    all. I’ll set the mean direction to *π* radians (South) and run the test.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: 从分布来看，很明显 Auri 更喜欢南方方向。我将均值方向设置为 *π* 弧度（南方），并运行测试。
- en: '[PRE10]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: '[PRE11]'
  id: totrans-82
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Now we’re getting somewhere! The p-value is close to zero and we reject the
    null hypothesis. Auri is a statistically significant South-facing pooper!
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们开始有进展了！p值接近零，我们拒绝原假设。Auri 是一个统计学上显著的南向排便者！
- en: 'Bayesian Poops: Math Part'
  id: totrans-84
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 贝叶斯排便：数学部分
- en: And now for something completely different. Let’s try a Bayesian approach.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 现在换个完全不同的方式。让我们尝试一种贝叶斯方法。
- en: 'To start, I decided to see how estimate of the mean direction changes as the
    sample size increased. The idea is simple: I’ll start with a circular uniform
    prior distribution and update it with every new data point.'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 一开始，我决定查看均值方向的估计值如何随着样本量的增加而变化。这个想法很简单：我会从一个圆形均匀的先验分布开始，并随着每一个新的数据点更新它。
- en: We’ll need to define a few things, so let’s get down to math. If you’re not
    a fan of equations, feel free to skip to the next section with cool visualizations!
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要定义一些概念，所以让我们开始进入数学部分。如果你不喜欢方程式，可以跳到下一部分，那里有很酷的可视化！
- en: 1\. The von Mises Distribution
  id: totrans-88
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 1\. 冯·米塞斯分布
- en: 'The von Mises distribution *p*(*θ*∣*μ*,*κ*) has a probability density function
    given by:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
  zh: 冯·米塞斯分布 *p*(*θ*∣*μ*,*κ*) 的概率密度函数为：
- en: '![](../Images/153d3e75814e41fee3e319b418c92d04.png)'
  id: totrans-90
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/153d3e75814e41fee3e319b418c92d04.png)'
- en: 'where:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
  zh: 其中：
- en: '*μ* is the mean direction'
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*μ* 是均值方向'
- en: '*κ* is the concentration parameter (analogous to the inverse of the variance
    in a normal distribution)'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*κ* 是集中参数（类似于正态分布中方差的倒数）'
- en: '*I*₀(*κ*) is the modified Bessel function of the first kind, ensuring the distribution
    is normalized'
  id: totrans-94
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*I*₀(*κ*) 是第一类修正贝塞尔函数，确保分布是标准化的。'
- en: 2\. Prior and Likelihood
  id: totrans-95
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 2\. 先验和似然性
- en: 'Suppose we have:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: 假设我们有：
- en: '**Prior** distribution:'
  id: totrans-97
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**先验** 分布：'
- en: '![](../Images/8010e8d19defce9596996125e37e3f10.png)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/8010e8d19defce9596996125e37e3f10.png)'
- en: '**Likelihood** for a new observation *θₙ*​:'
  id: totrans-99
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**似然性** 对于一个新的观察值 *θₙ*​：'
- en: '![](../Images/c9d1d390c5ee0568b67651f9e0c25829.png)'
  id: totrans-100
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/c9d1d390c5ee0568b67651f9e0c25829.png)'
- en: 'We want to update our prior using Bayes’ theorem:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 我们想使用贝叶斯定理更新我们的先验：
- en: '![](../Images/1d8f4c98f3ecf59bb25c702fea2008a5.png)'
  id: totrans-102
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1d8f4c98f3ecf59bb25c702fea2008a5.png)'
- en: where
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: 其中
- en: '![](../Images/809ddcb2163e11ec9ed62d25c60d82ea.png)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/809ddcb2163e11ec9ed62d25c60d82ea.png)'
- en: 3\. Multiply the Prior and Likelihood in the von Mises Form
  id: totrans-105
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 3\. 在 von Mises 形式中乘以先验和似然
- en: 'The product of two von Mises distributions with parameters (*μ*1​, *κ*1​) and
    (*μ*2​, *κ*2​) leads to another von Mises distribution with updated parameters.
    Let’s go through the steps:'
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 两个 von Mises 分布，参数分别为 (*μ*1​, *κ*1​) 和 (*μ*2​, *κ*2​)，它们的乘积会得到另一个 von Mises
    分布，具有更新后的参数。我们一步步来看：
- en: 'Given:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: 给定：
- en: '![](../Images/92d4f8bcc8d3c734ff8f511f99a8ba00.png)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/92d4f8bcc8d3c734ff8f511f99a8ba00.png)'
- en: and
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 并且
- en: '![](../Images/d8f77c2f341da83aa3755011b4a9ce09.png)'
  id: totrans-110
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d8f77c2f341da83aa3755011b4a9ce09.png)'
- en: 'the posterior is proportional to the product:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 后验与乘积成正比：
- en: '![](../Images/a74b4917ed7e0983db2e356c1ff07ab8.png)'
  id: totrans-112
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a74b4917ed7e0983db2e356c1ff07ab8.png)'
- en: 'Using the trigonometric identity for the sum of cosines:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 使用余弦和公式的三角恒等式：
- en: '![](../Images/8d1a83615e3beff9bdfdd82522036c45.png)'
  id: totrans-114
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/8d1a83615e3beff9bdfdd82522036c45.png)'
- en: 'This becomes:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
  zh: 这变为：
- en: '![](../Images/97d5cac76fba491d58565a68ad31a8d6.png)'
  id: totrans-116
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/97d5cac76fba491d58565a68ad31a8d6.png)'
- en: 4\. Convert to Polar Form for the Posterior
  id: totrans-117
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 4\. 转换为极坐标形式以获得后验
- en: Final stretch! The expression above is a von Mises distribution in disguise.
    We can rewrite it in the polar form to estimate the updated mean direction and
    concentration parameter.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 最后阶段！上面的表达式是一个伪装的 von Mises 分布。我们可以将其重新写成极坐标形式，从而估计更新后的平均方向和集中度参数。
- en: 'Let:'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 令：
- en: '![](../Images/38e1ec079dac7c897cfc0d05cc05dfb4.png)'
  id: totrans-120
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/38e1ec079dac7c897cfc0d05cc05dfb4.png)'
- en: 'Now the expression for posterior simplifies to:'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 现在后验表达式简化为：
- en: '![](../Images/fa65729c47adb45aeb8f1f47ec179f5b.png)'
  id: totrans-122
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/fa65729c47adb45aeb8f1f47ec179f5b.png)'
- en: Let’s pause here and take a closer look at the simplified expression.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们暂停一下，仔细看看这个简化的表达式。
- en: 'Notice that *C cos⁡(θ)+S sin⁡(θ)* is the dot product of two vectors *(C,S)*
    and *(cos⁡(θ),sin⁡(θ))* which we can represent as:'
  id: totrans-124
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 请注意，*C cos⁡(θ)+S sin⁡(θ)* 是两个向量 *(C,S)* 和 *(cos⁡(θ),sin⁡(θ))* 的点积，我们可以将其表示为：
- en: '![](../Images/e55fa1f7ad146a555e8d99c3ccae9565.png)'
  id: totrans-125
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/e55fa1f7ad146a555e8d99c3ccae9565.png)'
- en: where *ϕ* is the angle between the vectors *(C,S)* and *(cos⁡(θ),sin⁡(θ))*.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 其中 *ϕ* 是向量 *(C,S)* 和 *(cos⁡(θ),sin⁡(θ))* 之间的角度。
- en: '2\. The magnitudes of the vectors are:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 2\. 向量的大小是：
- en: '![](../Images/1269d39f1d6f2a13fb79e3ee462307fe.png)'
  id: totrans-128
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1269d39f1d6f2a13fb79e3ee462307fe.png)'
- en: '3\. The angle between the vector *(cos⁡(θ),sin⁡(θ))* and a positive x-axis
    is just *θ* and between (*C*,*S*) and a positive x-axis is, by definition:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 3\. 向量 *(cos⁡(θ),sin⁡(θ))* 和正 x 轴之间的角度就是 *θ*，而 (*C*,*S*) 和正 x 轴之间的角度，由定义为：
- en: '![](../Images/8d5262110a8eb0510b7fb1535870124c.png)'
  id: totrans-130
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/8d5262110a8eb0510b7fb1535870124c.png)'
- en: '4\. So the angle between the two vectors is:'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 4\. 那么两个向量之间的角度是：
- en: '![](../Images/9add255caf9dec0d8e5df60d5562c82f.png)'
  id: totrans-132
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/9add255caf9dec0d8e5df60d5562c82f.png)'
- en: 'Substitute our findings back into the simplified expression for the posterior:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: 将我们的发现代入简化后的后验表达式：
- en: '![](../Images/1c148acca19a7dcbcaccc482d3492e97.png)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1c148acca19a7dcbcaccc482d3492e97.png)'
- en: or
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: 或者
- en: '![](../Images/279236a278e5a9f1aa533be01b8966b9.png)'
  id: totrans-136
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/279236a278e5a9f1aa533be01b8966b9.png)'
- en: where
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 其中
- en: '*kappa_post*​ is the posterior concentration parameter:'
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*kappa_post*​ 是后验的集中度参数：'
- en: '![](../Images/af71fa7345762ab766cbd3321ca5c5e5.png)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/af71fa7345762ab766cbd3321ca5c5e5.png)'
- en: '*mu_post* is the posterior mean direction'
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*mu_post* 是后验的平均方向'
- en: '![](../Images/89a801944a9a6d545204de03fc64779e.png)'
  id: totrans-141
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/89a801944a9a6d545204de03fc64779e.png)'
- en: Yay, we made it! The posterior is also a von Mises distribution with updated
    parameters (*mu_post*, *kappa_post*). Now we can update the prior with every new
    observation and see how the mean direction changes.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 哇，我们做到了！后验也是一个 von Mises 分布，具有更新后的参数 (*mu_post*, *kappa_post*)。现在，我们可以通过每个新的观测值更新先验，并观察平均方向的变化。
- en: 'Bayesian Poops: Fun Part'
  id: totrans-143
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 贝叶斯小插曲：有趣的部分
- en: Welcome back to those of you who skipped the math and congratulations to those
    who made it through! Let’s code the Bayesian update and vizualize the results.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 欢迎回到那些跳过数学部分的朋友们，恭喜那些完成了的朋友！现在让我们编写贝叶斯更新代码，并可视化结果。
- en: First, let’s define the helper functions for visualizing the posterior distribution.
    We’ll need to it to create a nice animation later on.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，让我们定义一些辅助函数，用于可视化后验分布。稍后我们将用它来创建一个漂亮的动画。
- en: '[PRE12]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: Now we’re ready to write the update loop. Remember that we need to set our prior
    distribution. I’ll start with a circular uniform distribution which is equivalent
    to a von Mises distribution with a concentration parameter of 0\. For the *kappa_likelihood*
    I set a fixed moderate concentration parameter of 2\. That’ll make the posterior
    update more visible.
  id: totrans-147
  prefs: []
  type: TYPE_NORMAL
  zh: 现在我们准备写更新循环了。记住我们需要设置先验分布。我将从一个圆形均匀分布开始，它等价于一个冯·米塞斯分布，集中度参数为 0。对于 *kappa_likelihood*，我设置了一个固定的中等集中度参数
    2。这将使得后验更新更加明显。
- en: '[PRE13]'
  id: totrans-148
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'And that’s it! The code will generate a GIF showing the posterior distribution
    update with every new observation. Here’s the glorious result:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
  zh: 就是这样！该代码将生成一个 GIF，展示每次新观测后，后验分布的更新。这里是辉煌的结果：
- en: '![](../Images/d5a76b28902d12b5ed3cf7d2a22721d0.png)'
  id: totrans-150
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d5a76b28902d12b5ed3cf7d2a22721d0.png)'
- en: Posterior Distribution Updates (image by author)
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 后验分布更新（图像由作者提供）
- en: With every new observation the posterior distribution gets more and more concentrated
    around the true mean direction. If only I could replace the red line with Auri’s
    silhouette, it would be perfect!
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: 随着每次新的观测，后验分布变得越来越集中于真实的均值方向。如果我能用 Auri 的轮廓替代红线，那就完美了！
- en: 'We can further visualize the history of the posterior mean direction and concentration
    parameter. Let’s plot them:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以进一步可视化后验均值方向和集中度参数的历史。让我们绘制它们：
- en: '[PRE14]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: '![](../Images/d4c8d5d53048ea1461be6445f5414f86.png)'
  id: totrans-155
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/d4c8d5d53048ea1461be6445f5414f86.png)'
- en: Posterior mu, kappa evolution (image by author)
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 后验均值、kappa 演变（图像由作者提供）
- en: The plot shows how the posterior mean direction and concentration parameter
    evolve with every new observation. The mean direction eventually converges to
    the sample value, while the concentration parameter increases, as the estimate
    becomes more certain.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
  zh: 图表展示了后验均值方向和集中度参数随着每次新观测如何变化。均值方向最终收敛到样本值，而集中度参数随着估计的确定性增加而上升。
- en: 'Bayes Factor: PyMC for Doggy Compass'
  id: totrans-158
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 贝叶斯因子：PyMC 用于狗狗指南针
- en: 'The last thing I wanted to try was to use the [Bayes Factor](https://en.wikipedia.org/wiki/Bayes_factor#:~:text=7%20External%20links-,Definition,The%20key%20data%2Ddependent%20term)
    approach for hypothesis testing. The idea behind the Bayes Factor is very simple:
    it’s **the ratio of two marginal likelihoods** for two competing hypotheses/models.'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: 我最后想尝试的是使用[贝叶斯因子](https://en.wikipedia.org/wiki/Bayes_factor#:~:text=7%20External%20links-,Definition,The%20key%20data%2Ddependent%20term)方法进行假设检验。贝叶斯因子背后的思想非常简单：它是**两个竞争假设/模型的边际似然比**。
- en: 'In general, the Bayes Factor is defined as:'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
  zh: 通常，贝叶斯因子定义为：
- en: '![](../Images/6710866b0a2e923660c1aabceea9cc6e.png)'
  id: totrans-161
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/6710866b0a2e923660c1aabceea9cc6e.png)'
- en: 'where:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
  zh: 其中：
- en: '*p*(*D*∣*Mi*​) and *p*(*D*∣*Mj*​) are the marginal likelihoods of the data
    under the *i* and *j* hypothesis'
  id: totrans-163
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*p*(*D*∣*Mi*​) 和 *p*(*D*∣*Mj*​) 是在 *i* 和 *j* 假设下的数据边际似然'
- en: '*p*(*Mi*​∣*D*) and *p*(*Mj*​∣*D*) are the posterior probabilities of the models
    given the data'
  id: totrans-164
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*p*(*Mi*​∣*D*) 和 *p*(*Mj*​∣*D*) 是给定数据后的模型后验概率'
- en: '*p*(*Mi*​) and *p*(*Mj*​) are the prior probabilities of the models'
  id: totrans-165
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*p*(*Mi*​) 和 *p*(*Mj*​) 是模型的先验概率'
- en: 'The result is a number that tells us how much more likely one hypothesis is
    compared to the other. There are different approaches to interpret the Bayes Factor,
    but a common one is to use the Jeffreys’ scale by [Harold Jeffreys](https://en.wikipedia.org/wiki/Harold_Jeffreys):'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: 结果是一个数值，告诉我们一个假设比另一个假设更有可能。解释贝叶斯因子的方式有很多种，其中一种常见的方法是使用[哈罗德·杰弗里斯](https://en.wikipedia.org/wiki/Harold_Jeffreys)的杰弗里斯尺度：
- en: '![](../Images/0eaf9f40b882a7a1620073bbf551998e.png)'
  id: totrans-167
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/0eaf9f40b882a7a1620073bbf551998e.png)'
- en: What are the models you might ask? Simple! They are distributions with different
    parameters. I’ll be using PyMC to define the models and sample posterior distributions
    from them.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能会问，模型是什么？很简单！它们是具有不同参数的分布。我将使用 PyMC 来定义模型，并从中采样后验分布。
- en: First of all, let’s re-itroduce the null hypothesis. I still assume it’s a circular
    uniform Von Mises distribution with *kappa*=0 but this time we need to calculate
    the likelihood of the data under this hypothesis. To simplify further calculations,
    we’ll be calculating log-likelihoods.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，我们重新引入零假设。我仍然假设它是一个圆形均匀的冯·米塞斯分布，且*kappa*=0，但这次我们需要计算在此假设下数据的似然性。为了简化后续的计算，我们将计算对数似然。
- en: '[PRE15]'
  id: totrans-170
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Next, it’s time to build the alternative model. Starting with a simple scenario
    of a **Unimodal South** direction, where I assume that the distribution is concentrated
    around 180° or π in radians.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
  zh: 接下来，是时候构建备择模型了。首先从一个简单的场景开始：**单峰南方**方向，在这个场景下，我假设分布集中在180°或π弧度处。
- en: Unimodal South
  id: totrans-172
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 单峰南方
- en: Let’s define the model in PyMC. We’ll use Von Mises distribution with a fixed
    location parameter *μ*=*π* and a Half-Normal prior for the non-negative concentration
    parameter *κ*. This allows the model to learn the concentration parameter from
    the data and check if the South direction is preferred.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们在PyMC中定义模型。我们将使用冯·米塞斯分布，并设置固定位置参数*μ*=*π*，同时为非负浓度参数*κ*设置半正态先验。这使得模型能够从数据中学习浓度参数，并检查南方方向是否更受偏好。
- en: '[PRE16]'
  id: totrans-174
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: 'This gives us a nice simple model which we can also visualize:'
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
  zh: 这给我们提供了一个简单的模型，我们也可以将其可视化：
- en: '[PRE17]'
  id: totrans-176
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: '![](../Images/593f54b39c0eee81f5a23a73261c574a.png)'
  id: totrans-177
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/593f54b39c0eee81f5a23a73261c574a.png)'
- en: PyMC model graph (image by author)
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: PyMC模型图（作者提供的图片）
- en: 'And here’s the posterior distribution for the concentration parameter *κ*:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: 这是浓度参数*κ*的后验分布：
- en: '[PRE18]'
  id: totrans-180
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: '![](../Images/3fa40f32492d0ce6d1e920ef4f734a3f.png)'
  id: totrans-181
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/3fa40f32492d0ce6d1e920ef4f734a3f.png)'
- en: Posterior kappa distribution (image by author)
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
  zh: 后验kappa分布（作者提供的图片）
- en: All that’s left is to calculate the log-likelihood for the alternative model
    and the Bayes Factor.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
  zh: 剩下的就是计算备择模型的对数似然值和贝叶斯因子。
- en: '[PRE19]'
  id: totrans-184
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: '[PRE20]'
  id: totrans-185
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: Since we’re dividing the likelihood of the alternative model by the likelihood
    of the null model, the Bayes Factor indicates how much more likely the data is
    under the alternative hypothesis. In this case, we get 32.46, a very strong evidence,
    suggesting that the data is **not uniformly distributed** around the circle and
    there is **a preference for the South direction**.
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
  zh: 因为我们是将备择模型的似然除以原假设模型的似然，所以贝叶斯因子表明数据在备择假设下的可能性增加了多少。在这种情况下，我们得到了32.46，这是非常强的证据，表明数据**不是均匀分布**在圆周上，而是**偏向南方方向**。
- en: However, we additionally calculate the probability that the concentration parameter
    *kappa* is greater than 0.5\. This is a simple way to check if the distribution
    is significantly different from the uniform one. With the Unimodal South model,
    this probabiliy is only 0.0649, meaning that the distribution is still quite spread
    out.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，我们还计算了浓度参数*kappa*大于0.5的概率。这是一种简单的方法，用来检查分布是否显著不同于均匀分布。在单峰南方模型下，这个概率只有0.0649，意味着分布仍然相当分散。
- en: 'Let’s try another model: **Bimodal North-South Mixture**.'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们尝试另一个模型：**双峰南北混合模型**。
- en: Bimodal North-South Mixture
  id: totrans-189
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 双峰南北混合模型
- en: This time I’ll assume that the distribution is bimodal with peaks around 0°
    and 180°, just as we’ve seen in the compass rose.
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 这次我假设分布是双峰的，峰值分别位于0°和180°，正如我们在罗盘玫瑰图上看到的那样。
- en: To achieve this, I’ll need a mixture of two Von Mises distributions with different
    fixed mean directions and a shared concentration parameter.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: 为了实现这一点，我需要使用两个具有不同固定均值方向和共享浓度参数的冯·米塞斯分布的混合。
- en: 'Let’s define a few helper functions first:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，让我们定义一些辅助函数：
- en: '[PRE21]'
  id: totrans-193
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'And now back to the model:'
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
  zh: 现在回到模型：
- en: '[PRE22]'
  id: totrans-195
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Once again, let’s visualize the model graph and the posterior distribution
    for the concentration parameter *κ*:'
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
  zh: 再次，让我们可视化模型图和浓度参数*κ*的后验分布：
- en: '[PRE23]'
  id: totrans-197
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: '![](../Images/222efe40ea36448f214e2a79f610f7f4.png)'
  id: totrans-198
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/222efe40ea36448f214e2a79f610f7f4.png)'
- en: PyMC model graph (image by author)
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
  zh: PyMC模型图（作者提供的图片）
- en: '[PRE24]'
  id: totrans-200
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: '![](../Images/207caa35505a70f08a1b9cc1e25fe3c8.png)'
  id: totrans-201
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/207caa35505a70f08a1b9cc1e25fe3c8.png)'
- en: Posterior kappa distribution (image by author)
  id: totrans-202
  prefs: []
  type: TYPE_NORMAL
  zh: 后验kappa分布（作者提供的图片）
- en: 'And finally, let’s calculate the Bayes Factor and the probability that the
    concentration parameter *κ* is greater than 0.5:'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 最后，让我们计算贝叶斯因子和浓度参数*κ*大于0.5的概率：
- en: '[PRE25]'
  id: totrans-204
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: '[PRE26]'
  id: totrans-205
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: '**Fantastic!** Both our metrics indicate that this model is a much better fit
    for the data. The Bayes Factor suggests a **decisive evidence** and most of the
    posterior *κ* samples are greater than 0.5 with the mean value of 0.99 as we’ve
    seen on the distribution plot.'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
  zh: '**太棒了！** 我们的两个指标都表明这个模型更适合数据。贝叶斯因子表明**有决定性证据**，并且大多数后验*κ*样本大于0.5，均值为0.99，正如我们在分布图上看到的那样。'
- en: Let’s try a couple more models before wrapping up.
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
  zh: 在结束之前，让我们再试试其他几个模型。
- en: Bimodal West-South Mixture
  id: totrans-208
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 双峰西南混合模型
- en: This model once again assumes a bimodal distribution but this time with peaks
    around 270° and 180°, which were common directions in the compass rose.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
  zh: 这个模型再次假设一个双峰分布，但这次峰值位于270°和180°，这些方向在罗盘玫瑰图中较为常见。
- en: '[PRE27]'
  id: totrans-210
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: '[PRE28]'
  id: totrans-211
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: '![](../Images/5219e45a7ce051409efb73ec8d109d41.png)'
  id: totrans-212
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/5219e45a7ce051409efb73ec8d109d41.png)'
- en: Posterior kappa distribution (image by author)
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
  zh: 后验kappa分布（作者提供的图片）
- en: Nope, definitely not as good as the previous model. Next!
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 不，明显不如之前的模型好。下一个！
- en: Quadrimodal Mixture
  id: totrans-215
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 四态混合模型
- en: Final round. Maybe my dog really likes to align himself with the cardinal directions?
    Let’s try a quadrimodal distribution with peaks around 0°, 90°, 180°, and 270°.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
  zh: 最后一轮。也许我的狗确实喜欢与基准方向对齐？让我们尝试一个四态分布，峰值分别位于0°、90°、180°和270°。
- en: '[PRE29]'
  id: totrans-217
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: '[PRE30]'
  id: totrans-218
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: '![](../Images/7255e38fa56766715c59510730e66198.png)'
  id: totrans-219
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/7255e38fa56766715c59510730e66198.png)'
- en: Posterior kappa distribution (image by author)
  id: totrans-220
  prefs: []
  type: TYPE_NORMAL
  zh: 后验kappa分布（作者提供的图片）
- en: Well… Not really. Although the probability that the concentration parameter
    κ*κ* is greater than 0.5 is quite high, the Bayes Factor is 0.0.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
  zh: 嗯… 其实并不是。尽管集中参数κ*κ*大于0.5的概率相当高，但贝叶斯因子却是0.0。
- en: The great thing about Bayes Factor is that it penalizes overly complex models
    effectively preventing overfitting.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
  zh: 贝叶斯因子的优点在于它有效地惩罚过度复杂的模型，有效防止过拟合。
- en: Model Comparison
  id: totrans-223
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 模型比较
- en: Let’s summarize the results of all models using information criteria. We’ll
    use the [Widely Applicable Information Criterion](https://en.wikipedia.org/wiki/Watanabe%E2%80%93Akaike_information_criterion#:~:text=In%20statistics%2C%20the%20Widely%20Applicable,it%20wasn't%20trained%20on.)
    (WAIC) and the Leave-One-Out Cross-Validation (LOO) to compare the models.
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们用信息准则总结所有模型的结果。我们将使用[Widely Applicable Information Criterion](https://en.wikipedia.org/wiki/Watanabe%E2%80%93Akaike_information_criterion#:~:text=In%20statistics%2C%20the%20Widely%20Applicable,it%20wasn't%20trained%20on.)（WAIC）和Leave-One-Out
    Cross-Validation（LOO）来比较这些模型。
- en: '[PRE31]'
  id: totrans-225
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: '![](../Images/933f6bcd2e583901690ea52c834927aa.png)'
  id: totrans-226
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/933f6bcd2e583901690ea52c834927aa.png)'
- en: '[PRE32]'
  id: totrans-227
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: '![](../Images/9efe5507cc67224a3d34af59f266bc41.png)'
  id: totrans-228
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/9efe5507cc67224a3d34af59f266bc41.png)'
- en: '[PRE33]'
  id: totrans-229
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: '![](../Images/043cc2eaa59b47d70b13d446fdb79308.png)'
  id: totrans-230
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/043cc2eaa59b47d70b13d446fdb79308.png)'
- en: WAIC comparison (image by author)
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
  zh: WAIC比较（作者提供的图片）
- en: And we have a winner! The **Bimodal North-South model** is the best fit for
    the data according to both WAIC and LOO.
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
  zh: 我们找到了优胜者！根据WAIC和LOO，**双模态南北模型**是数据的最佳拟合模型。
- en: Conclusion
  id: totrans-233
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 结论
- en: '![](../Images/b56b077782d1353c637f65c70d300be5.png)'
  id: totrans-234
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/b56b077782d1353c637f65c70d300be5.png)'
- en: Christmas Auri (image by author)
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: Christmas Auri（作者提供的图片）
- en: What a journey! What started a few months ago as a simple observation of my
    dog’s pooping habits turned into a full-blown Bayesian analysis.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
  zh: 何等的旅程！几个月前仅仅是对我狗拉屎习惯的简单观察，现在却变成了全面的贝叶斯分析。
- en: In this article, I’ve shown how to model circular data, estimate the mean direction
    and concentration parameter, and update the posterior distribution with new observations.
    We’ve also seen how to use the Bayes Factor for hypothesis testing and compare
    models using information criteria.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
  zh: 在本文中，我展示了如何建模圆形数据，估计平均方向和集中参数，并通过新观察更新后验分布。我们还看到如何使用贝叶斯因子进行假设检验，并使用信息准则比较模型。
- en: And the results were super interesting! Auri does indeed have preferences and
    somehow manages to align himself across the North-South axis. If I ever get lost
    in the woods with my dog, I know what direction to follow. Just need a big enough
    sample size to be sure!
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 结果非常有趣！Auri确实有自己的喜好，并且在南北轴上能够对齐。如果我和我的狗迷失在树林中，我知道该往哪个方向走了。只需足够大的样本量来确认！
- en: I hope you enjoyed this journey as much as I did. If you have any questions
    or suggestions, feel free to reach out. And if you’d like to support my work,
    consider buying me a coffee ❤️
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
  zh: 希望您像我一样享受这段旅程。如果您有任何问题或建议，请随时联系。如果您想支持我的工作，请考虑给我买杯咖啡 ❤️
- en: '[![](../Images/961c46077716eccc51e2bd91a0299d05.png)](https://www.buymeacoffee.com/datawondering)'
  id: totrans-240
  prefs: []
  type: TYPE_NORMAL
  zh: '[![](../Images/961c46077716eccc51e2bd91a0299d05.png)](https://www.buymeacoffee.com/datawondering)'
- en: 'My socials:'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 我的社交媒体账号：
- en: '[Data Wondering blog [English]](https://substack.com/@datawondering)'
  id: totrans-242
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[数据漫游博客 [英语]](https://substack.com/@datawondering)'
- en: '[Data Wondering blog [Russian]](https://t.me/data_wondering)'
  id: totrans-243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[数据漫游博客 [俄语]](https://t.me/data_wondering)'
- en: 'References:'
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 参考文献：
- en: Dogs are sensitive to small variations of the Earth’s magnetic field, Vlastimil
    Hart et al., [[link]](https://frontiersinzoology.biomedcentral.com/counter/pdf/10.1186/1742-9994-10-80.pdf)
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 狗对地球磁场的微小变化很敏感，Vlastimil Hart等人，[[链接]](https://frontiersinzoology.biomedcentral.com/counter/pdf/10.1186/1742-9994-10-80.pdf)
- en: Biostatistical Analysis, Fifth Edition, Jerrold H. Zar, [[link]](https://bayesmath.com/wp-content/uploads/2021/05/Jerrold-H.-Zar-Biostatistical-Analysis-5th-Edition-Prentice-Hall-2009.pdf)
  id: totrans-246
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 生物统计分析，第五版，Jerrold H. Zar，[[链接]](https://bayesmath.com/wp-content/uploads/2021/05/Jerrold-H.-Zar-Biostatistical-Analysis-5th-Edition-Prentice-Hall-2009.pdf)
- en: PyMC, Probabilistic Programming in Python, [[link]](https://www.pymc.io/welcome.html)
  id: totrans-247
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: PyMC，Python中的概率编程，[[link]](https://www.pymc.io/welcome.html)
