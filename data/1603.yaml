- en: Safeguarding Demand Forecasting with Causal Graphs
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: åˆ©ç”¨å› æœå›¾ä¿æŠ¤éœ€æ±‚é¢„æµ‹
- en: åŸæ–‡ï¼š[https://towardsdatascience.com/safeguarding-demand-forecasting-with-causal-graphs-591511fc8e0e?source=collection_archive---------6-----------------------#2024-06-28](https://towardsdatascience.com/safeguarding-demand-forecasting-with-causal-graphs-591511fc8e0e?source=collection_archive---------6-----------------------#2024-06-28)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: åŸæ–‡ï¼š[https://towardsdatascience.com/safeguarding-demand-forecasting-with-causal-graphs-591511fc8e0e?source=collection_archive---------6-----------------------#2024-06-28](https://towardsdatascience.com/safeguarding-demand-forecasting-with-causal-graphs-591511fc8e0e?source=collection_archive---------6-----------------------#2024-06-28)
- en: Causal AI, exploring the integration of causal reasoning into machine learning
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å› æœ AIï¼Œæ¢ç´¢å°†å› æœæ¨ç†èå…¥æœºå™¨å­¦ä¹ 
- en: '[](https://medium.com/@raz1470?source=post_page---byline--591511fc8e0e--------------------------------)[![Ryan
    O''Sullivan](../Images/7cd161d38d67d2c0b7da2d8f3e7d33fe.png)](https://medium.com/@raz1470?source=post_page---byline--591511fc8e0e--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--591511fc8e0e--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--591511fc8e0e--------------------------------)
    [Ryan O''Sullivan](https://medium.com/@raz1470?source=post_page---byline--591511fc8e0e--------------------------------)'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://medium.com/@raz1470?source=post_page---byline--591511fc8e0e--------------------------------)[![Ryan
    O''Sullivan](../Images/7cd161d38d67d2c0b7da2d8f3e7d33fe.png)](https://medium.com/@raz1470?source=post_page---byline--591511fc8e0e--------------------------------)[](https://towardsdatascience.com/?source=post_page---byline--591511fc8e0e--------------------------------)[![Towards
    Data Science](../Images/a6ff2676ffcc0c7aad8aaf1d79379785.png)](https://towardsdatascience.com/?source=post_page---byline--591511fc8e0e--------------------------------)
    [Ryan O''Sullivan](https://medium.com/@raz1470?source=post_page---byline--591511fc8e0e--------------------------------)'
- en: Â·Published in [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--591511fc8e0e--------------------------------)
    Â·11 min readÂ·Jun 28, 2024
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: Â·å‘è¡¨äº [Towards Data Science](https://towardsdatascience.com/?source=post_page---byline--591511fc8e0e--------------------------------)
    Â·11åˆ†é’Ÿé˜…è¯»Â·2024å¹´6æœˆ28æ—¥
- en: --
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '![](../Images/04ae3f78a67df7e275299b9801cf319b.png)'
  id: totrans-6
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/04ae3f78a67df7e275299b9801cf319b.png)'
- en: Photo by [Boris Dunand](https://unsplash.com/@borisdunand?utm_source=medium&utm_medium=referral)
    on [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: å›¾ç‰‡æ¥è‡ª [Boris Dunand](https://unsplash.com/@borisdunand?utm_source=medium&utm_medium=referral)
    åœ¨ [Unsplash](https://unsplash.com/?utm_source=medium&utm_medium=referral)
- en: What is this series of articles about?
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: è¿™ç³»åˆ—æ–‡ç« çš„å†…å®¹æ˜¯ä»€ä¹ˆï¼Ÿ
- en: Welcome to my series on Causal AI, where we will explore the integration of
    causal reasoning into machine learning models. Expect to explore a number of practical
    applications across different business contexts.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: æ¬¢è¿æ¥åˆ°æˆ‘çš„å› æœ AI ç³»åˆ—æ–‡ç« ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬å°†æ¢ç´¢å°†å› æœæ¨ç†èå…¥æœºå™¨å­¦ä¹ æ¨¡å‹ã€‚ä½ å°†ä¼šçœ‹åˆ°åœ¨ä¸åŒå•†ä¸šèƒŒæ™¯ä¸‹çš„ä¸€äº›å®ç”¨åº”ç”¨ã€‚
- en: In the last article we covered *enhancing marketing mix modelling with Causal
    AI*. In this article we will move onto *safeguarding demand forecasting with causal
    graphs*.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºäº†*åˆ©ç”¨å› æœ AI å¼ºåŒ–è¥é”€ç»„åˆå»ºæ¨¡*ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†ç»§ç»­æ¢è®¨*åˆ©ç”¨å› æœå›¾ä¿æŠ¤éœ€æ±‚é¢„æµ‹*ã€‚
- en: 'If you missed the last article on marketing mix modelling, check it out here:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä½ é”™è¿‡äº†ä¸Šä¸€ç¯‡å…³äºè¥é”€ç»„åˆå»ºæ¨¡çš„æ–‡ç« ï¼Œè¯·åœ¨è¿™é‡ŒæŸ¥çœ‹ï¼š
- en: '[](/enhancing-marketing-mix-modelling-with-causal-ai-77f638bce3a9?source=post_page-----591511fc8e0e--------------------------------)
    [## Enhancing Marketing Mix Modelling with Causal AI'
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: '[](/enhancing-marketing-mix-modelling-with-causal-ai-77f638bce3a9?source=post_page-----591511fc8e0e--------------------------------)
    [## åˆ©ç”¨å› æœ AI å¼ºåŒ–è¥é”€ç»„åˆå»ºæ¨¡'
- en: Causal AI, exploring the integration of causal reasoning into machine learning
  id: totrans-13
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: å› æœ AIï¼Œæ¢ç´¢å°†å› æœæ¨ç†èå…¥æœºå™¨å­¦ä¹ 
- en: towardsdatascience.com](/enhancing-marketing-mix-modelling-with-causal-ai-77f638bce3a9?source=post_page-----591511fc8e0e--------------------------------)
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: towardsdatascience.com](/enhancing-marketing-mix-modelling-with-causal-ai-77f638bce3a9?source=post_page-----591511fc8e0e--------------------------------)
- en: Introduction
  id: totrans-15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ä»‹ç»
- en: In this article we will delve into how you can safeguard demand forecasting
    (or any forecasting use case to be honest) with causal graphs.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨å¦‚ä½•åˆ©ç”¨å› æœå›¾ä¿æŠ¤éœ€æ±‚é¢„æµ‹ï¼ˆæˆ–è€…è¯´ä»»ä½•é¢„æµ‹åº”ç”¨åœºæ™¯ï¼‰ä¸å—å½±å“ã€‚
- en: '**The following areas will be explored:**'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: '**ä»¥ä¸‹é¢†åŸŸå°†è¢«æ¢ç´¢ï¼š**'
- en: A quick forecasting 101.
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¿«é€Ÿçš„é¢„æµ‹å…¥é—¨ã€‚
- en: What is demand forecasting?
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä»€ä¹ˆæ˜¯éœ€æ±‚é¢„æµ‹ï¼Ÿ
- en: A refresher on causal graphs.
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å› æœå›¾å¤ä¹ ã€‚
- en: How can causal graphs safeguard demand forecasting?
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å› æœå›¾å¦‚ä½•ä¿æŠ¤éœ€æ±‚é¢„æµ‹ï¼Ÿ
- en: A Python case study illustrating how causal graphs can safeguard your forecasts
    from spurious correlations.
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸€ä¸ª Python æ¡ˆä¾‹ç ”ç©¶ï¼Œè¯´æ˜å› æœå›¾å¦‚ä½•ä¿æŠ¤ä½ çš„é¢„æµ‹å…å—è™šå‡ç›¸å…³æ€§çš„å½±å“ã€‚
- en: 'The full notebook can be found here:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: å®Œæ•´çš„ç¬”è®°æœ¬å¯ä»¥åœ¨è¿™é‡Œæ‰¾åˆ°ï¼š
- en: '[](https://github.com/raz1470/causal_ai/blob/main/notebooks/safeguarding%20demand%20forecasting%20with%20causal%20graphs.ipynb?source=post_page-----591511fc8e0e--------------------------------)
    [## causal_ai/notebooks/safeguarding demand forecasting with causal graphs.ipynb
    at main Â·â€¦'
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://github.com/raz1470/causal_ai/blob/main/notebooks/safeguarding%20demand%20forecasting%20with%20causal%20graphs.ipynb?source=post_page-----591511fc8e0e--------------------------------)
    [## causal_ai/notebooks/safeguarding demand forecasting with causal graphs.ipynb
    at main Â·â€¦'
- en: This project introduces Causal AI and how it can drive business value. - causal_ai/notebooks/safeguarding
    demandâ€¦
  id: totrans-25
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: æœ¬é¡¹ç›®ä»‹ç»äº†å› æœAIåŠå…¶å¦‚ä½•æ¨åŠ¨å•†ä¸šä»·å€¼ã€‚ - causal_ai/notebooks/safeguarding demandâ€¦
- en: github.com](https://github.com/raz1470/causal_ai/blob/main/notebooks/safeguarding%20demand%20forecasting%20with%20causal%20graphs.ipynb?source=post_page-----591511fc8e0e--------------------------------)
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: github.com](https://github.com/raz1470/causal_ai/blob/main/notebooks/safeguarding%20demand%20forecasting%20with%20causal%20graphs.ipynb?source=post_page-----591511fc8e0e--------------------------------)
- en: Forecasting
  id: totrans-27
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: é¢„æµ‹
- en: Forecasting 101
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: é¢„æµ‹åŸºç¡€çŸ¥è¯†
- en: Time series forecasting involves predicting future values based on historical
    observations.
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: æ—¶é—´åºåˆ—é¢„æµ‹æ˜¯åŸºäºå†å²è§‚å¯Ÿå€¼é¢„æµ‹æœªæ¥å€¼çš„è¿‡ç¨‹ã€‚
- en: '![](../Images/1b694d850081befe34ef0aec17da8522.png)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/1b694d850081befe34ef0aec17da8522.png)'
- en: User generated image
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: ç”¨æˆ·ç”Ÿæˆå›¾åƒ
- en: 'To start us off, there are a number of terms which it is worth getting familiar
    with:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†å¼€å§‹ï¼Œæœ‰ä¸€äº›æœ¯è¯­æ˜¯å€¼å¾—ç†Ÿæ‚‰çš„ï¼š
- en: '**Auto-correlation** â€” The correlation of a series with itâ€™s previous values
    at different time lags. Helps identify if there is a trend present.'
  id: totrans-33
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**è‡ªç›¸å…³** â€” æ˜¯ä¸€ä¸ªåºåˆ—ä¸å…¶åœ¨ä¸åŒæ—¶é—´æ»åä¸‹çš„å‰æœŸå€¼çš„ç›¸å…³æ€§ã€‚å¸®åŠ©è¯†åˆ«æ˜¯å¦å­˜åœ¨è¶‹åŠ¿ã€‚'
- en: '**Stationary** â€” This is when the statistical properties of a series are constant
    over time (e.g. mean, variance). Some forecasting methods assume stationarity.'
  id: totrans-34
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**å¹³ç¨³** â€” æ˜¯æŒ‡åºåˆ—çš„ç»Ÿè®¡å±æ€§ï¼ˆä¾‹å¦‚å‡å€¼ã€æ–¹å·®ï¼‰éšæ—¶é—´ä¿æŒä¸å˜ã€‚æŸäº›é¢„æµ‹æ–¹æ³•å‡è®¾åºåˆ—æ˜¯å¹³ç¨³çš„ã€‚'
- en: '**Differencing** â€” This is when we subtract the previous observation from the
    current observation to transform a non-stationary series into a stationary one.
    An important step for models which assume stationarity.'
  id: totrans-35
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**å·®åˆ†** â€” æ˜¯å°†å½“å‰è§‚å¯Ÿå€¼å‡å»å‰ä¸€ä¸ªè§‚å¯Ÿå€¼ï¼Œç”¨ä»¥å°†éå¹³ç¨³åºåˆ—è½¬åŒ–ä¸ºå¹³ç¨³åºåˆ—ã€‚å¯¹äºå‡è®¾å¹³ç¨³æ€§çš„æ¨¡å‹ï¼Œè¿™æ˜¯ä¸€ä¸ªé‡è¦æ­¥éª¤ã€‚'
- en: '**Seasonality** â€” A regular repeating cycle which occurs at a fixed interval
    (e.g. daily, weekly, yearly).'
  id: totrans-36
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**å­£èŠ‚æ€§** â€” åœ¨å›ºå®šæ—¶é—´é—´éš”å†…å®šæœŸé‡å¤å‡ºç°çš„å‘¨æœŸï¼ˆä¾‹å¦‚ï¼Œæ¯æ—¥ã€æ¯å‘¨ã€æ¯å¹´ï¼‰ã€‚'
- en: '**Trend** â€” The long term movement in a series.'
  id: totrans-37
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**è¶‹åŠ¿** â€” åºåˆ—ä¸­çš„é•¿æœŸå˜åŒ–ã€‚'
- en: '**Lag** â€” The number of time steps between an observation and a previous value.'
  id: totrans-38
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**æ»å** â€” è§‚å¯Ÿå€¼ä¸å…¶å‰ä¸€ä¸ªå€¼ä¹‹é—´çš„æ—¶é—´æ­¥æ•°ã€‚'
- en: '**Residuals** â€” The difference between predicted and actual values.'
  id: totrans-39
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**æ®‹å·®** â€” é¢„æµ‹å€¼ä¸å®é™…å€¼ä¹‹é—´çš„å·®å¼‚ã€‚'
- en: '**Moving average** â€” Used to smooth out short term fluctuations by averaging
    a fixed number of past observations.'
  id: totrans-40
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**ç§»åŠ¨å¹³å‡** â€” é€šè¿‡å¯¹å›ºå®šæ•°é‡çš„è¿‡å»è§‚å¯Ÿå€¼è¿›è¡Œå¹³å‡ï¼Œæ¥å¹³æ»‘çŸ­æœŸæ³¢åŠ¨ã€‚'
- en: '**Exponential smoothing** â€” Weights are applied to past observations, with
    more emphasis placed on recent values.'
  id: totrans-41
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**æŒ‡æ•°å¹³æ»‘** â€” å°†æƒé‡åº”ç”¨äºè¿‡å»çš„è§‚å¯Ÿå€¼ï¼Œå¼ºè°ƒæœ€è¿‘çš„æ•°å€¼ã€‚'
- en: '**Seasonal decomposition** â€” This is when we separate a time series into seasonal,
    trend and residual components.'
  id: totrans-42
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '**å­£èŠ‚æ€§åˆ†è§£** â€” æ˜¯å°†æ—¶é—´åºåˆ—åˆ†è§£ä¸ºå­£èŠ‚æ€§ã€è¶‹åŠ¿å’Œæ®‹å·®æˆåˆ†çš„è¿‡ç¨‹ã€‚'
- en: '![](../Images/5a2ceb597aa90c76f0b68ab324cab690.png)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/5a2ceb597aa90c76f0b68ab324cab690.png)'
- en: User generated image
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: ç”¨æˆ·ç”Ÿæˆå›¾åƒ
- en: 'There a a number of different methods which can be used for forecasting:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: æœ‰å¤šç§ä¸åŒçš„æ–¹æ³•å¯ç”¨äºé¢„æµ‹ï¼š
- en: '**ETS (Error, Trend, Seasonal)** â€” An exponential smoothing method that models
    error, trend and seasonality components.'
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ETSï¼ˆè¯¯å·®ã€è¶‹åŠ¿ã€å­£èŠ‚æ€§ï¼‰** â€” ä¸€ç§æŒ‡æ•°å¹³æ»‘æ–¹æ³•ï¼Œç”¨äºå»ºæ¨¡è¯¯å·®ã€è¶‹åŠ¿å’Œå­£èŠ‚æ€§æˆåˆ†ã€‚'
- en: '**Autoregressive models (AR models)** â€” Models the current value of the series
    as a linear combination of itâ€™s previous values.'
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**è‡ªå›å½’æ¨¡å‹ï¼ˆARæ¨¡å‹ï¼‰** â€” å°†åºåˆ—çš„å½“å‰å€¼å»ºæ¨¡ä¸ºå…¶å‰æœŸå€¼çš„çº¿æ€§ç»„åˆã€‚'
- en: '**Moving average models (MA models)** â€” Models the current value of the series
    as a linear combination of past forecast errors.'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**ç§»åŠ¨å¹³å‡æ¨¡å‹ï¼ˆMAæ¨¡å‹ï¼‰** â€” å°†åºåˆ—çš„å½“å‰å€¼å»ºæ¨¡ä¸ºè¿‡å»é¢„æµ‹è¯¯å·®çš„çº¿æ€§ç»„åˆã€‚'
- en: '**Autoregressive integrated moving average (ARIMA models)** â€” Combines AR and
    MA models with the incorporation of differencing to make the series stationary.'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**è‡ªå›å½’ç§¯åˆ†æ»‘åŠ¨å¹³å‡ï¼ˆARIMAæ¨¡å‹ï¼‰** â€” å°†ARå’ŒMAæ¨¡å‹ç»“åˆï¼Œé€šè¿‡å·®åˆ†ä½¿åºåˆ—å¹³ç¨³ã€‚'
- en: '**State space models** â€” Deconstructs the timeseries into individual components
    such as trend and seasonality.'
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**çŠ¶æ€ç©ºé—´æ¨¡å‹** â€” å°†æ—¶é—´åºåˆ—åˆ†è§£ä¸ºè¯¸å¦‚è¶‹åŠ¿å’Œå­£èŠ‚æ€§ç­‰ç‹¬ç«‹æˆåˆ†ã€‚'
- en: '**Hierarchical models** â€” A method which handles data structured in a hierarchy
    such as regions.'
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**å±‚çº§æ¨¡å‹** â€” å¤„ç†å¦‚åœ°åŒºç­‰å±‚æ¬¡ç»“æ„æ•°æ®çš„æ–¹æ³•ã€‚'
- en: '**Linear regression** â€” Uses one or more independent variable (feature) to
    predict the dependent variable (target).'
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**çº¿æ€§å›å½’** â€” ä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªè‡ªå˜é‡ï¼ˆç‰¹å¾ï¼‰æ¥é¢„æµ‹å› å˜é‡ï¼ˆç›®æ ‡ï¼‰ã€‚'
- en: '**Machine learning (ML)** â€” Uses more flexible algorithms like boosting to
    capture complex relationships.'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**æœºå™¨å­¦ä¹ ï¼ˆMLï¼‰** â€” ä½¿ç”¨æ›´åŠ çµæ´»çš„ç®—æ³•ï¼Œå¦‚æå‡æ³•ï¼Œæ¥æ•æ‰å¤æ‚çš„å…³ç³»ã€‚'
- en: 'If you want to dive further into this topic, I highly recommend the following
    resource which is well known as the go-to guide for forecasting (the version below
    is free ğŸ˜€):'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä½ æƒ³è¿›ä¸€æ­¥äº†è§£è¿™ä¸ªè¯é¢˜ï¼Œæˆ‘å¼ºçƒˆæ¨èä»¥ä¸‹èµ„æºï¼Œå®ƒè¢«å¹¿æ³›è®¤ä¸ºæ˜¯é¢„æµ‹çš„æƒå¨æŒ‡å—ï¼ˆä»¥ä¸‹ç‰ˆæœ¬æ˜¯å…è´¹çš„ğŸ˜€ï¼‰ï¼š
- en: '[](https://otexts.com/fpp3/?source=post_page-----591511fc8e0e--------------------------------)
    [## Forecasting: Principles and Practice (3rd ed)'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://otexts.com/fpp3/?source=post_page-----591511fc8e0e--------------------------------)
    [## é¢„æµ‹ï¼šåŸç†ä¸å®è·µï¼ˆç¬¬3ç‰ˆï¼‰'
- en: 3rd edition
  id: totrans-56
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: ç¬¬3ç‰ˆ
- en: otexts.com](https://otexts.com/fpp3/?source=post_page-----591511fc8e0e--------------------------------)
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: otexts.com](https://otexts.com/fpp3/?source=post_page-----591511fc8e0e--------------------------------)
- en: 'In terms of applying some of the forecasting models using Python, Iâ€™d recommend
    exploring Nixtla which has an extensive list of models implemented and an easy
    to use API:'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨ä½¿ç”¨Pythonåº”ç”¨ä¸€äº›é¢„æµ‹æ¨¡å‹æ—¶ï¼Œæˆ‘æ¨èæ¢ç´¢Nixtlaï¼Œå®ƒæœ‰å¹¿æ³›å®ç°çš„æ¨¡å‹åˆ—è¡¨ï¼Œå¹¶ä¸”æä¾›æ˜“äºä½¿ç”¨çš„APIï¼š
- en: '[](https://github.com/Nixtla?source=post_page-----591511fc8e0e--------------------------------)
    [## Nixtla'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://github.com/Nixtla?source=post_page-----591511fc8e0e--------------------------------)
    [## Nixtla'
- en: Open Source Time Series Ecosystem. Nixtla has 35 repositories available. Follow
    their code on GitHub.
  id: totrans-60
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: å¼€æºæ—¶é—´åºåˆ—ç”Ÿæ€ç³»ç»Ÿã€‚Nixtlaæœ‰35ä¸ªå¯ç”¨çš„ä»£ç åº“ã€‚ä½ å¯ä»¥åœ¨GitHubä¸Šå…³æ³¨ä»–ä»¬çš„ä»£ç ã€‚
- en: github.com](https://github.com/Nixtla?source=post_page-----591511fc8e0e--------------------------------)
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: github.com](https://github.com/Nixtla?source=post_page-----591511fc8e0e--------------------------------)
- en: Demand forecasting
  id: totrans-62
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: éœ€æ±‚é¢„æµ‹
- en: Predicting the demand for your product is important.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: é¢„æµ‹äº§å“çš„éœ€æ±‚éå¸¸é‡è¦ã€‚
- en: It can help manage your inventory, avoiding over or understocking.
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å®ƒæœ‰åŠ©äºç®¡ç†ä½ çš„åº“å­˜ï¼Œé¿å…è¿‡åº¦æˆ–ä¸è¶³çš„åº“å­˜ã€‚
- en: It can keep your customers satisfied, ensuring products are available when they
    want them.
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å®ƒå¯ä»¥ä¿æŒå®¢æˆ·æ»¡æ„ï¼Œç¡®ä¿äº§å“åœ¨å®¢æˆ·éœ€è¦æ—¶å¯ç”¨ã€‚
- en: Reducing holding costs and minimising waste is cost efficient.
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: é™ä½æŒæœ‰æˆæœ¬å¹¶å‡å°‘æµªè´¹æ˜¯æˆæœ¬æ•ˆç›Šé«˜çš„åšæ³•ã€‚
- en: Essential for strategic planning.
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¯¹äºæˆ˜ç•¥è§„åˆ’è‡³å…³é‡è¦ã€‚
- en: Keeping demand forecasts accurate is essential â€” In the next section letâ€™s start
    to think about how causal graphs could safeguard our forecastsâ€¦
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: ä¿æŒéœ€æ±‚é¢„æµ‹çš„å‡†ç¡®æ€§è‡³å…³é‡è¦ â€” åœ¨ä¸‹ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†å¼€å§‹æ€è€ƒå› æœå›¾å¦‚ä½•ä¿éšœæˆ‘ä»¬çš„é¢„æµ‹å‡†ç¡®æ€§â€¦
- en: Causal graphs
  id: totrans-69
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: å› æœå›¾
- en: Causal graph refresher
  id: totrans-70
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å› æœå›¾å›é¡¾
- en: 'Iâ€™ve covered causal graphs a few times in my series, but just in case you need
    a refresher check out my first article where I cover it in detail:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘åœ¨æˆ‘çš„ç³»åˆ—æ–‡ç« ä¸­è®¨è®ºè¿‡å› æœå›¾å‡ æ¬¡ï¼Œä½†ä»¥é˜²ä½ éœ€è¦å¤ä¹ ï¼Œå¯ä»¥æŸ¥çœ‹æˆ‘ç¬¬ä¸€ç¯‡è¯¦ç»†è®¨è®ºå› æœå›¾çš„æ–‡ç« ï¼š
- en: '[](/using-causal-graphs-to-answer-causal-questions-5fd1dd82fa90?source=post_page-----591511fc8e0e--------------------------------)
    [## Using Causal Graphs to answer causal questions'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: '[](/using-causal-graphs-to-answer-causal-questions-5fd1dd82fa90?source=post_page-----591511fc8e0e--------------------------------)
    [## ä½¿ç”¨å› æœå›¾å›ç­”å› æœé—®é¢˜'
- en: Causal AI, exploring the integration of causal reasoning into machine learning
  id: totrans-73
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: å› æœAIï¼Œæ¢ç´¢å°†å› æœæ¨ç†ä¸æœºå™¨å­¦ä¹ ç›¸ç»“åˆ
- en: towardsdatascience.com](/using-causal-graphs-to-answer-causal-questions-5fd1dd82fa90?source=post_page-----591511fc8e0e--------------------------------)
  id: totrans-74
  prefs: []
  type: TYPE_NORMAL
  zh: towardsdatascience.com](/using-causal-graphs-to-answer-causal-questions-5fd1dd82fa90?source=post_page-----591511fc8e0e--------------------------------)
- en: How can causal graphs safeguard demand forecasting?
  id: totrans-75
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: å› æœå›¾å¦‚ä½•ä¿éšœéœ€æ±‚é¢„æµ‹çš„å‡†ç¡®æ€§ï¼Ÿ
- en: Taking the graph below as an example, letâ€™s say we want to forecast our target
    variable. We find we have 3 variables which are correlated with it, so we use
    them as features. Why would including the spurious correlation be a problem? The
    more features we include the better our forecast right?
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: ä»¥ä¸‹é¢çš„å›¾ä¸ºä¾‹ï¼Œå‡è®¾æˆ‘ä»¬æƒ³é¢„æµ‹ç›®æ ‡å˜é‡ã€‚æˆ‘ä»¬å‘ç°æœ‰3ä¸ªä¸ç›®æ ‡å˜é‡ç›¸å…³çš„å˜é‡ï¼Œå› æ­¤æˆ‘ä»¬å°†å®ƒä»¬ä½œä¸ºç‰¹å¾ã€‚ä¸ºä»€ä¹ˆåŒ…å«è™šå‡çš„ç›¸å…³æ€§ä¼šæˆä¸ºé—®é¢˜ï¼Ÿæˆ‘ä»¬åŒ…å«æ›´å¤šç‰¹å¾ä¸æ˜¯èƒ½æé«˜é¢„æµ‹å‡†ç¡®æ€§å—ï¼Ÿ
- en: '![](../Images/66b864fdc1fb8642ba0489ffac247f8a.png)'
  id: totrans-77
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/66b864fdc1fb8642ba0489ffac247f8a.png)'
- en: User generated image
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: ç”¨æˆ·ç”Ÿæˆçš„å›¾ç‰‡
- en: Well, not reallyâ€¦.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: å—¯ï¼Œå…¶å®ä¸æ˜¯â€¦
- en: When it comes to demand forecasting one of the major problems is data drift.
    Data drift in itself isnâ€™t a problem if the relationship between the feature of
    interest and target remain constant. But when the relationship doesnâ€™t remain
    constant, our forecasting accuracy will deteriorate.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: åœ¨éœ€æ±‚é¢„æµ‹ä¸­ï¼Œä¸»è¦é—®é¢˜ä¹‹ä¸€æ˜¯æ•°æ®æ¼‚ç§»ã€‚æ•°æ®æ¼‚ç§»æœ¬èº«ä¸æ˜¯é—®é¢˜ï¼Œå¦‚æœç‰¹å¾ä¸ç›®æ ‡ä¹‹é—´çš„å…³ç³»ä¿æŒä¸å˜ã€‚ä½†æ˜¯ï¼Œå½“å…³ç³»ä¸å†ä¿æŒä¸å˜æ—¶ï¼Œæˆ‘ä»¬çš„é¢„æµ‹å‡†ç¡®æ€§å°±ä¼šä¸‹é™ã€‚
- en: But how is a causal graph going to help usâ€¦ The idea is that spurious correlations
    are much more likely to drift, and much more likely to cause problems when they
    do.
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
  zh: ä½†å› æœå›¾å¦‚ä½•å¸®åŠ©æˆ‘ä»¬å‘¢â€¦â€¦ è¿™ä¸ªæ¦‚å¿µæ˜¯ï¼Œè™šå‡ç›¸å…³æ€§æ›´å¯èƒ½å‘ç”Ÿæ¼‚ç§»ï¼Œå¹¶ä¸”ä¸€æ—¦å‘ç”Ÿæ¼‚ç§»ï¼Œå®ƒä»¬æ›´å¯èƒ½å¼•å‘é—®é¢˜ã€‚
- en: Not convinced? OK itâ€™s time to jump into the case study then!
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: è¿˜ä¸ç›¸ä¿¡å—ï¼Ÿå¥½çš„ï¼Œé‚£å°±è®©æˆ‘ä»¬è·³å…¥æ¡ˆä¾‹ç ”ç©¶å§ï¼
- en: Case study
  id: totrans-83
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: æ¡ˆä¾‹ç ”ç©¶
- en: Background
  id: totrans-84
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: èƒŒæ™¯
- en: Your friend has bought an ice cream van. They paid a consultant a lot of money
    to build them a demand forecast model. It worked really well for the first few
    months, but in the last couple of months your friend has been understocking ice
    cream! They remember that your job title was â€œdata something or otherâ€ and come
    to you for advice.
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ çš„æœ‹å‹ä¹°äº†ä¸€è¾†å†°æ·‡æ·‹è½¦ã€‚ä»–ä»¬æ”¯ä»˜äº†å¤§é‡è´¹ç”¨ç»™ä¸€ä¸ªé¡¾é—®ï¼Œå»ºç«‹äº†ä¸€ä¸ªéœ€æ±‚é¢„æµ‹æ¨¡å‹ã€‚è¿™ä¸ªæ¨¡å‹åœ¨æœ€åˆå‡ ä¸ªæœˆè¿ä½œå¾—éå¸¸å¥½ï¼Œä½†åœ¨è¿‡å»å‡ ä¸ªæœˆé‡Œï¼Œä½ çš„æœ‹å‹ä¸€ç›´åœ¨ç¼ºè´§å†°æ·‡æ·‹ï¼ä»–ä»¬è®°å¾—ä½ çš„èŒä½æ˜¯â€œæ•°æ®ä»€ä¹ˆä»€ä¹ˆâ€å¹¶æ¥æ‰¾ä½ å¯»æ±‚å»ºè®®ã€‚
- en: Creating the case study data
  id: totrans-86
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: åˆ›å»ºæ¡ˆä¾‹ç ”ç©¶æ•°æ®
- en: 'Let me start by explaining how I created the data for this case study. I created
    a simple causal graph with the following characteristics:'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘å…ˆè§£é‡Šä¸€ä¸‹æˆ‘æ˜¯å¦‚ä½•ä¸ºè¿™ä¸ªæ¡ˆä¾‹ç ”ç©¶åˆ›å»ºæ•°æ®çš„ã€‚æˆ‘åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„å› æœå›¾ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹å¾ï¼š
- en: Ice cream sales is the target node (X0)
  id: totrans-88
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: å†°æ·‡æ·‹é”€å”®æ˜¯ç›®æ ‡èŠ‚ç‚¹ï¼ˆX0ï¼‰
- en: Coastal visits is a direct cause of ice cream sales (X1)
  id: totrans-89
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æµ·æ»¨è®¿é—®æ˜¯å†°æ·‡æ·‹é”€å”®çš„ç›´æ¥åŸå› ï¼ˆX1ï¼‰
- en: Temperature is an indirect cause of ice cream sales (X2)
  id: totrans-90
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æ¸©åº¦æ˜¯å†°æ·‡æ·‹é”€å”®çš„é—´æ¥åŸå› ï¼ˆX2ï¼‰
- en: Sharks attacks is a spurious correlation (X3)
  id: totrans-91
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: é²¨é±¼æ”»å‡»æ˜¯ä¸€ä¸ªè™šå‡ç›¸å…³ï¼ˆX3ï¼‰
- en: '![](../Images/8038224febe818d6a49a2d0980df047f.png)'
  id: totrans-92
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/8038224febe818d6a49a2d0980df047f.png)'
- en: User generated image
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: ç”¨æˆ·ç”Ÿæˆçš„å›¾åƒ
- en: 'I then used the following data generating process:'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åæˆ‘ä½¿ç”¨äº†ä»¥ä¸‹æ•°æ®ç”Ÿæˆè¿‡ç¨‹ï¼š
- en: '![](../Images/087d0da8feedce2a5c4b85776f7c2157.png)'
  id: totrans-95
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/087d0da8feedce2a5c4b85776f7c2157.png)'
- en: User generated image
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
  zh: ç”¨æˆ·ç”Ÿæˆçš„å›¾åƒ
- en: 'You can see that each node is influenced by past values of itself and a noise
    term as well as itâ€™s direct parents. To create the data I use a handy module from
    the time series causal analysis python package Tigramite:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½å—å…¶è¿‡å»å€¼ã€å™ªå£°é¡¹ä»¥åŠç›´æ¥çˆ¶èŠ‚ç‚¹çš„å½±å“ã€‚ä¸ºäº†ç”Ÿæˆæ•°æ®ï¼Œæˆ‘ä½¿ç”¨äº†æ¥è‡ªæ—¶é—´åºåˆ—å› æœåˆ†æ Python åŒ… Tigramite çš„ä¸€ä¸ªæ–¹ä¾¿æ¨¡å—ï¼š
- en: '[](https://github.com/jakobrunge/tigramite/tree/master?source=post_page-----591511fc8e0e--------------------------------)
    [## GitHub - jakobrunge/tigramite: Tigramite is a python package for causal inference
    with a focus onâ€¦'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: '[](https://github.com/jakobrunge/tigramite/tree/master?source=post_page-----591511fc8e0e--------------------------------)
    [## GitHub - jakobrunge/tigramite: Tigramite æ˜¯ä¸€ä¸ªä¸“æ³¨äºæ—¶é—´åºåˆ—æ•°æ®çš„å› æœæ¨æ–­ Python åŒ…â€¦'
- en: Tigramite is a python package for causal inference with a focus on time series
    data. The Tigramite documentation is atâ€¦
  id: totrans-99
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: Tigramite æ˜¯ä¸€ä¸ªä¸“æ³¨äºæ—¶é—´åºåˆ—æ•°æ®çš„å› æœæ¨æ–­ Python åŒ…ã€‚Tigramite çš„æ–‡æ¡£å¯ä»¥åœ¨â€¦
- en: github.com](https://github.com/jakobrunge/tigramite/tree/master?source=post_page-----591511fc8e0e--------------------------------)
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: github.com](https://github.com/jakobrunge/tigramite/tree/master?source=post_page-----591511fc8e0e--------------------------------)
- en: 'Tigramite is a great package but I am not going to cover it in detail this
    time around as is deserves it own article! Below we use the structural_causal_process
    module following the data generating process above:'
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: Tigramite æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„åŒ…ï¼Œä½†è¿™æ¬¡æˆ‘ä¸ä¼šè¯¦ç»†ä»‹ç»å®ƒï¼Œå› ä¸ºå®ƒå€¼å¾—å†™ä¸€ç¯‡ç‹¬ç«‹çš„æ–‡ç« ï¼åœ¨ä¸‹é¢çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä½¿ç”¨ structural_causal_process
    æ¨¡å—ï¼ŒæŒ‰ç…§ä¸Šé¢çš„æ•°æ®ç”Ÿæˆè¿‡ç¨‹è¿›è¡Œæ“ä½œï¼š
- en: '[PRE0]'
  id: totrans-102
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'We can then visualise our time series:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶åæˆ‘ä»¬å¯ä»¥å°†æ—¶é—´åºåˆ—å¯è§†åŒ–ï¼š
- en: '[PRE1]'
  id: totrans-104
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: '![](../Images/176957d122740457eda755b7ea92f421.png)'
  id: totrans-105
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/176957d122740457eda755b7ea92f421.png)'
- en: User generated image
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: ç”¨æˆ·ç”Ÿæˆçš„å›¾åƒ
- en: Now you understand how I have created the data, lets get back to the case study
    in the next section!
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
  zh: ç°åœ¨ä½ å·²ç»ç†è§£äº†æˆ‘å¦‚ä½•åˆ›å»ºæ•°æ®ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å›åˆ°ä¸‹ä¸€èŠ‚çš„æ¡ˆä¾‹ç ”ç©¶ï¼
- en: Understanding the data generating process
  id: totrans-108
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: ç†è§£æ•°æ®ç”Ÿæˆè¿‡ç¨‹
- en: 'You start by trying to understand the data generating process by taking the
    data used in the model. There are 3 features included in the model:'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ é¦–å…ˆè¦é€šè¿‡åˆ†ææ¨¡å‹ä¸­ä½¿ç”¨çš„æ•°æ®æ¥ç†è§£æ•°æ®ç”Ÿæˆè¿‡ç¨‹ã€‚æ¨¡å‹ä¸­åŒ…å«äº† 3 ä¸ªç‰¹å¾ï¼š
- en: Coastal visits
  id: totrans-110
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æµ·æ»¨è®¿é—®
- en: Temperature
  id: totrans-111
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æ¸©åº¦
- en: Shark attacks
  id: totrans-112
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: é²¨é±¼æ”»å‡»
- en: 'To get an understanding of the causal graph, you use PCMCI (which is has a
    great implementation in Tigramite), a method which is suitable for causal time
    series discovery. I am not going to cover PCMCI this time round as it needs itâ€™s
    own dedicated article. However, if you are unfamiliar with causal discovery in
    general, use my previous article to get a good introduction:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: ä¸ºäº†ç†è§£å› æœå›¾ï¼Œä½ å¯ä»¥ä½¿ç”¨ PCMCIï¼ˆTigramite ä¸­æœ‰å¾ˆå¥½çš„å®ç°ï¼‰ï¼Œè¿™æ˜¯ä¸€ç§é€‚åˆå› æœæ—¶é—´åºåˆ—å‘ç°çš„æ–¹æ³•ã€‚æˆ‘è¿™æ¬¡ä¸ä¼šè¯¦ç»†ä»‹ç» PCMCIï¼Œå› ä¸ºå®ƒéœ€è¦ä¸€ç¯‡ä¸“é—¨çš„æ–‡ç« ã€‚ä¸è¿‡ï¼Œå¦‚æœä½ å¯¹å› æœå‘ç°ä¸å¤ªç†Ÿæ‚‰ï¼Œå¯ä»¥å‚è€ƒæˆ‘ä¹‹å‰çš„æ–‡ç« æ¥è·å¾—ä¸€ä¸ªå¾ˆå¥½çš„å…¥é—¨ï¼š
- en: '[](/making-causal-discovery-work-in-real-world-business-settings-80e80c5f66b8?source=post_page-----591511fc8e0e--------------------------------)
    [## Making Causal Discovery work in real-world business settings'
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: '[](/making-causal-discovery-work-in-real-world-business-settings-80e80c5f66b8?source=post_page-----591511fc8e0e--------------------------------)
    [## ä½¿å› æœå‘ç°èƒ½å¤Ÿåœ¨ç°å®ä¸–ç•Œçš„å•†ä¸šç¯å¢ƒä¸­è¿ä½œ'
- en: Causal AI, exploring the integration of causal reasoning into machine learning
  id: totrans-115
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: å› æœäººå·¥æ™ºèƒ½ï¼Œæ¢ç´¢å°†å› æœæ¨ç†é›†æˆåˆ°æœºå™¨å­¦ä¹ ä¸­çš„æ–¹æ³•
- en: towardsdatascience.com](/making-causal-discovery-work-in-real-world-business-settings-80e80c5f66b8?source=post_page-----591511fc8e0e--------------------------------)
    ![](../Images/ef72754fb775f028a38e302643adcd49.png)
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: '[towardsdatascience.com](/making-causal-discovery-work-in-real-world-business-settings-80e80c5f66b8?source=post_page-----591511fc8e0e--------------------------------)
    ![](../Images/ef72754fb775f028a38e302643adcd49.png)'
- en: User generated image
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: ç”¨æˆ·ç”Ÿæˆçš„å›¾ç‰‡
- en: 'The causal graph output from PCMCI can be seen above. The following things
    jump out:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: ä»PCMCIè¾“å‡ºçš„å› æœå›¾å¦‚ä¸Šæ‰€ç¤ºã€‚ä»¥ä¸‹å‡ ç‚¹æ˜¾è€Œæ˜“è§ï¼š
- en: Coastal visits is a direct cause of ice cream sales
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æµ·æ»¨è®¿é—®æ˜¯å†°æ·‡æ·‹é”€å”®çš„ç›´æ¥åŸå› 
- en: Temperature is an in-direct cause of ice cream sales
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: æ¸©åº¦æ˜¯å†°æ·‡æ·‹é”€å”®çš„é—´æ¥åŸå› 
- en: Sharks attacks is a spurious correlation
  id: totrans-121
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: é²¨é±¼æ”»å‡»æ˜¯ä¸€ä¸ªè™šå‡ç›¸å…³æ€§
- en: You question why anyone with any common sense would include shark attacks as
    a feature! Looking at the documentation it seems that the consultant used ChatGPT
    to get a list of features to consider for the model and then used autoML to train
    the model.
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ è´¨ç–‘ä»»ä½•æœ‰å¸¸è¯†çš„äººæ€ä¹ˆä¼šæŠŠé²¨é±¼æ”»å‡»ä½œä¸ºç‰¹å¾ï¼æŸ¥çœ‹æ–‡æ¡£åï¼Œä¼¼ä¹é¡¾é—®æ˜¯ä½¿ç”¨ChatGPTè·å–äº†ä¸€ä¸ªå¾…è€ƒè™‘ç‰¹å¾çš„åˆ—è¡¨ï¼Œç„¶åä½¿ç”¨autoMLè®­ç»ƒäº†æ¨¡å‹ã€‚
- en: So if ChatGPT and autoML think shark attacks should be in the model, surely
    it canâ€™t be doing any harm?
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: æ‰€ä»¥ï¼Œå¦‚æœChatGPTå’ŒautoMLè®¤ä¸ºé²¨é±¼æ”»å‡»åº”è¯¥åœ¨æ¨¡å‹ä¸­ï¼Œéš¾é“å®ƒä¸ä¼šé€ æˆä»»ä½•å±å®³å—ï¼Ÿ
- en: Pre-processing the case study data
  id: totrans-124
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: é¢„å¤„ç†æ¡ˆä¾‹ç ”ç©¶æ•°æ®
- en: 'Next letâ€™s visit how I pre-processed the data to make it suitable for this
    case study. To create our features we need to pick up the lagged values for each
    column (look back at the data generating process to understand why the features
    need to be the lagged values):'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•å¯¹æ•°æ®è¿›è¡Œé¢„å¤„ç†ï¼Œä»¥ä½¿å…¶é€‚åˆè¿™ä¸ªæ¡ˆä¾‹ç ”ç©¶ã€‚ä¸ºäº†åˆ›å»ºç‰¹å¾ï¼Œæˆ‘ä»¬éœ€è¦è·å–æ¯ä¸€åˆ—çš„æ»åå€¼ï¼ˆæŸ¥çœ‹æ•°æ®ç”Ÿæˆè¿‡ç¨‹ä»¥ç†è§£ä¸ºä½•ç‰¹å¾éœ€è¦æ˜¯æ»åå€¼ï¼‰ï¼š
- en: '[PRE2]'
  id: totrans-126
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: '![](../Images/298d7e072e0a8fa2f6989842e6bd4ce1.png)'
  id: totrans-127
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/298d7e072e0a8fa2f6989842e6bd4ce1.png)'
- en: User generated image
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
  zh: ç”¨æˆ·ç”Ÿæˆçš„å›¾ç‰‡
- en: 'We could use these lagged features to predict ice cream sales, but before we
    do letâ€™s introduce some data drift to the spurious correlation:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™äº›æ»åç‰¹å¾æ¥é¢„æµ‹å†°æ·‡æ·‹é”€å”®ï¼Œä½†åœ¨æ­¤ä¹‹å‰ï¼Œè®©æˆ‘ä»¬ç»™è™šå‡ç›¸å…³æ€§å¼•å…¥ä¸€äº›æ•°æ®æ¼‚ç§»ï¼š
- en: '[PRE3]'
  id: totrans-130
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '![](../Images/979c0b072e146bec980c912f27650c7d.png)'
  id: totrans-131
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/979c0b072e146bec980c912f27650c7d.png)'
- en: User generated image
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: ç”¨æˆ·ç”Ÿæˆçš„å›¾ç‰‡
- en: Letâ€™s go back to the case study and understand what we are seeing. Why has the
    number of shark attacks drifted? You do some research and find out that one of
    the causes of shark attacks is the number of people surfing. In recent months
    there has been a huge rise in the popularity of surfing, causing an increase in
    shark attacks. So how did this effect the ice cream sales forecasting?
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
  zh: è®©æˆ‘ä»¬å›åˆ°æ¡ˆä¾‹ç ”ç©¶ï¼Œç†è§£æˆ‘ä»¬æ‰€çœ‹åˆ°çš„å†…å®¹ã€‚ä¸ºä»€ä¹ˆé²¨é±¼æ”»å‡»çš„æ•°é‡å‘ç”Ÿäº†å˜åŒ–ï¼Ÿä½ åšäº†ä¸€äº›ç ”ç©¶ï¼Œå‘ç°é²¨é±¼æ”»å‡»çš„åŸå› ä¹‹ä¸€æ˜¯å†²æµªäººæ•°çš„å¢åŠ ã€‚æœ€è¿‘å‡ ä¸ªæœˆï¼Œå†²æµªçš„æ™®åŠåº¦å¤§å¹…ä¸Šå‡ï¼Œå¯¼è‡´äº†é²¨é±¼æ”»å‡»çš„å¢åŠ ã€‚é‚£ä¹ˆï¼Œè¿™å¯¹å†°æ·‡æ·‹é”€å”®é¢„æµ‹æœ‰ä»€ä¹ˆå½±å“å‘¢ï¼Ÿ
- en: Model training
  id: totrans-134
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: æ¨¡å‹è®­ç»ƒ
- en: 'You decide to recreate the model using the same features as the consultant
    and then using just the direct causes:'
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
  zh: ä½ å†³å®šä½¿ç”¨ä¸é¡¾é—®ç›¸åŒçš„ç‰¹å¾é‡æ–°åˆ›å»ºæ¨¡å‹ï¼Œç„¶åä»…ä½¿ç”¨ç›´æ¥åŸå› ï¼š
- en: '[PRE4]'
  id: totrans-136
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: The model trained on just the direct causes looks good on both the train and
    test set.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: åªä½¿ç”¨ç›´æ¥åŸå› è®­ç»ƒçš„æ¨¡å‹åœ¨è®­ç»ƒé›†å’Œæµ‹è¯•é›†ä¸Šéƒ½è¡¨ç°å¾—å¾ˆå¥½ã€‚
- en: '[PRE5]'
  id: totrans-138
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '![](../Images/a99b661eb27182a3109420cb80d4d844.png)'
  id: totrans-139
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/a99b661eb27182a3109420cb80d4d844.png)'
- en: User generated image
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: ç”¨æˆ·ç”Ÿæˆçš„å›¾ç‰‡
- en: However, when you train the model using all of the features you see that the
    model performs well on the train set but not the test set. Seemâ€™s like you identified
    the problem!
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: ç„¶è€Œï¼Œå½“ä½ ä½¿ç”¨æ‰€æœ‰ç‰¹å¾è®­ç»ƒæ¨¡å‹æ—¶ï¼Œä½ ä¼šå‘ç°æ¨¡å‹åœ¨è®­ç»ƒé›†ä¸Šè¡¨ç°è‰¯å¥½ï¼Œä½†åœ¨æµ‹è¯•é›†ä¸Šå´è¡¨ç°ä¸ä½³ã€‚çœ‹èµ·æ¥ä½ å·²ç»æ‰¾åˆ°äº†é—®é¢˜æ‰€åœ¨ï¼
- en: '[PRE6]'
  id: totrans-142
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '![](../Images/34b3554125a3463125a1508807f62962.png)'
  id: totrans-143
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/34b3554125a3463125a1508807f62962.png)'
- en: User generated image
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: ç”¨æˆ·ç”Ÿæˆçš„å›¾ç‰‡
- en: When we compare the predictions from both models of the test set we can see
    why your friend has been understocking on ice cream!
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: å½“æˆ‘ä»¬æ¯”è¾ƒä¸¤ä¸ªæ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šçš„é¢„æµ‹æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸ºä»€ä¹ˆä½ çš„æœ‹å‹ä¼šåœ¨å†°æ·‡æ·‹åº“å­˜ä¸Šå‡ºç°çŸ­ç¼ºï¼
- en: '[PRE7]'
  id: totrans-146
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '![](../Images/4c4b584d2faa4298eb39573a56423033.png)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
  zh: '![](../Images/4c4b584d2faa4298eb39573a56423033.png)'
- en: User generated image
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
  zh: ç”¨æˆ·ç”Ÿæˆçš„å›¾ç‰‡
- en: Closing thoughts
  id: totrans-149
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: ç»“è¯­
- en: 'Today we explored how harmful including spurious correlations in your forecasting
    models can be. Letâ€™s finish off with some closing thoughts:'
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
  zh: ä»Šå¤©ï¼Œæˆ‘ä»¬æ¢è®¨äº†åœ¨é¢„æµ‹æ¨¡å‹ä¸­åŒ…å«è™šå‡ç›¸å…³æ€§ä¼šå¸¦æ¥å¤šä¹ˆä¸¥é‡çš„å½±å“ã€‚æœ€åï¼Œè®©æˆ‘ä»¬æ€»ç»“ä¸€äº›æ€è€ƒï¼š
- en: The aim of this article was to start you thinking about how understanding the
    causal graph can improve your forecasts.
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æœ¬æ–‡çš„ç›®çš„æ˜¯è®©ä½ å¼€å§‹æ€è€ƒå¦‚ä½•é€šè¿‡ç†è§£å› æœå›¾æ¥æ”¹å–„ä½ çš„é¢„æµ‹ã€‚
- en: I know the example was a little over-exaggerated (I would hope common sense
    would have helped in this scenario!) but it hopefully illustrates the point.
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: æˆ‘çŸ¥é“è¿™ä¸ªä¾‹å­æœ‰ç‚¹å¤¸å¼ ï¼ˆæˆ‘å¸Œæœ›å¸¸è¯†åœ¨è¿™ç§æƒ…å†µä¸‹èƒ½èµ·ä½œç”¨ï¼ï¼‰ï¼Œä½†å®ƒå¸Œæœ›èƒ½å¤Ÿè¯´æ˜é—®é¢˜ã€‚
- en: Another interesting point to mention is that the coefficient for shark attacks
    was negative. This is another pitfall as logically we would have expected this
    spurious correlation to be positive.
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: å¦ä¸€ä¸ªæœ‰è¶£çš„ç‚¹æ˜¯é²¨é±¼æ”»å‡»çš„ç³»æ•°æ˜¯è´Ÿå€¼ã€‚è¿™æ˜¯å¦ä¸€ä¸ªé™·é˜±ï¼Œå› ä¸ºä»é€»è¾‘ä¸Šè®²ï¼Œæˆ‘ä»¬æœ¬æ¥ä¼šæœŸæœ›è¿™ç§è™šå‡ç›¸å…³æ€§æ˜¯æ­£å€¼ã€‚
- en: Medium-long term demand forecasting it very hard â€” You often need a forecasting
    model for each feature to be able to forecast multiple timesteps ahead. Interesting,
    causal graphs (specifically structural causal models) lend themselves well to
    this problem.
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: ä¸­é•¿æœŸéœ€æ±‚é¢„æµ‹éå¸¸å›°éš¾â€”â€”ä½ é€šå¸¸éœ€è¦ä¸ºæ¯ä¸ªç‰¹å¾å»ºç«‹ä¸€ä¸ªé¢„æµ‹æ¨¡å‹ï¼Œä»¥ä¾¿èƒ½å¤Ÿé¢„æµ‹å¤šä¸ªæ—¶é—´æ­¥çš„æœªæ¥ã€‚ æœ‰è¶£çš„æ˜¯ï¼Œå› æœå›¾ï¼ˆç‰¹åˆ«æ˜¯ç»“æ„å› æœæ¨¡å‹ï¼‰éå¸¸é€‚åˆè§£å†³è¿™ä¸ªé—®é¢˜ã€‚
- en: Follow me if you want to continue this journey into Causal AI â€” In the next
    article we see how we move onto comparing how CUPED and double machine learning
    can help power your experiments.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: å¦‚æœä½ æƒ³ç»§ç»­æ·±å…¥äº†è§£å› æœ AIï¼Œè¯·å…³æ³¨æˆ‘â€”â€”åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨å¦‚ä½•æ¯”è¾ƒCUPEDå’ŒåŒé‡æœºå™¨å­¦ä¹ å¦‚ä½•å¸®åŠ©æ¨åŠ¨ä½ çš„å®éªŒã€‚
